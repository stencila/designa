import{L as LRParser,C as ContextTracker,E as ExternalTokenizer}from"./index-82af852d.js";import{N as NodeProp,h as LRLanguage,j as indentNodeProp,m as foldNodeProp,b as styleTags,f as LanguageSupport,s as syntaxTree,t as tags}from"./stencila-editor-a35809c0.js";import"./index-2305c23c.js";import"./slotSelectors-df70e421.js";import"./languageUtils-2c49a4c4.js";var StartTag=1,StartCloseTag=2,MissingCloseTag=3,mismatchedStartCloseTag=4,incompleteStartCloseTag=5,commentContent$1=36,piContent$1=37,cdataContent$1=38,Element$1=10,OpenTag=12;function nameChar(e){return e==45||e==46||e==58||e>=65&&e<=90||e==95||e>=97&&e<=122||e>=161}function isSpace(e){return e==9||e==10||e==13||e==32}var cachedName=null,cachedInput=null,cachedPos=0;function tagNameAfter(e,t){var O=e.pos+t;if(cachedInput==e&&cachedPos==O)return cachedName;while(isSpace(e.peek(t)))t++;var a="";for(;;){var n=e.peek(t);if(!nameChar(n))break;a+=String.fromCharCode(n);t++}cachedInput=e;cachedPos=O;return cachedName=a||null}function ElementContext(e,t){this.name=e;this.parent=t;this.hash=t?t.hash:0;for(var O=0;O<e.length;O++)this.hash+=(this.hash<<4)+e.charCodeAt(O)+(e.charCodeAt(O)<<8)}var elementContext=new ContextTracker({start:null,shift:function(e,t,O,a){return t==StartTag?new ElementContext(tagNameAfter(a,1)||"",e):e},reduce:function(e,t){return t==Element$1&&e?e.parent:e},reuse:function(e,t,O,a){var n=t.type.id;return n==StartTag||n==OpenTag?new ElementContext(tagNameAfter(a,1)||"",e):e},hash:function(e){return e?e.hash:0},strict:false});var startTag=new ExternalTokenizer((function(e,t){if(e.next!=60)return;e.advance();if(e.next==47){e.advance();var O=tagNameAfter(e,0);if(!O)return e.acceptToken(incompleteStartCloseTag);if(t.context&&O==t.context.name)return e.acceptToken(StartCloseTag);for(var a=t.context;a;a=a.parent)if(a.name==O)return e.acceptToken(MissingCloseTag,-2);e.acceptToken(mismatchedStartCloseTag)}else if(e.next!=33&&e.next!=63){return e.acceptToken(StartTag)}}),{contextual:true});function scanTo(e,t){return new ExternalTokenizer((function(O){for(var a=0,n=0;;n++){if(O.next<0){if(n)O.acceptToken(e);break}if(O.next==t.charCodeAt(a)){a++;if(a==t.length){if(n>t.length)O.acceptToken(e,1-t.length);break}}else{a=0}O.advance()}}))}var commentContent=scanTo(commentContent$1,"--\x3e");var piContent=scanTo(piContent$1,"?>");var cdataContent=scanTo(cdataContent$1,"]]>");var parser=LRParser.deserialize({version:13,states:"-OOQOaOOOcObO'#CcOkOdO'#CdOOOP'#Cv'#CvOsOaO'#DTO!XOaOOOOOQ'#Cw'#CwO!aObO,58}OOOP,58},58}OOOS'#Cx'#CxO!iOdO,59OOOOP,59O,59OOOOP-E6t-E6tO!qO`O'#ChO#kOqO'#CfOOOP'#Cf'#CfO#rOaO'#CyQ$TOPOOO$YOaOOOOOQ-E6u-E6uOOOP1G.i1G.iOOOS-E6v-E6vOOOP1G.j1G.jOOOO'#Cz'#CzO$hO`O,59SO$pO!bO,59SO%OOhO'#CqO%WO`O'#CrOOOP'#D]'#D]OOOP'#C}'#C}O%`OqO,59QO%gO`O'#CsOOOP,59Q,59QOOOP,59e,59eOOOP-E6w-E6wO$TOPOOOOOO-E6x-E6xO%oO!bO1G.nO%oO!bO1G.nO%}O`O'#CjO&VO!bO'#C{O&eO!bO1G.nOOOP1G.n1G.nOOOP1G.{1G.{OOOW'#DO'#DOO&pOhO,59]OOOP,59],59]O&xO`O,59^O'QO`O,59^OOOP-E6{-E6{OOOP1G.l1G.lO'YO`O,59_O'bO`O,59_O'jO!bO7+$YO'xO!bO7+$YOOOP7+$Y7+$YOOOP7+$g7+$gO(TO`O,59UO(]O`O,59UO(eO!bO,59gOOOO-E6y-E6yOOOW-E6|-E6|OOOP1G.w1G.wO(sO`O1G.xO(sO`O1G.xOOOP1G.x1G.xO({O`O1G.yO({O`O1G.yOOOP1G.y1G.yO)TO!bO<<GtOOOP<<Gt<<GtOOOP<<HR<<HRO(]O`O1G.pO(]O`O1G.pO)`O#tO'#CmOOOO1G.p1G.pO)nO`O7+$dOOOP7+$d7+$dO)vO`O7+$eOOOP7+$e7+$eOOOPAN=`AN=`OOOPAN=mAN=mO(]O`O7+$[OOOO7+$[7+$[OOOO'#C|'#C|O*OO#tO,59XOOOO,59X,59XOOOP<<HO<<HOOOOP<<HP<<HPOOOO<<Gv<<GvOOOO-E6z-E6zOOOO1G.s1G.s",stateData:"*^~OyPOzRO|QOPwPXwP~OtUOxWO~OuXO{ZO~OyPOzRO|QOPwXXwXswX~OP]OXbO~OtUOxdO~OuXO{fO~O]iOzgO~OP]OQoOSkOTlOblOclOdlOyPO|QO!RjO~ORpO~P!yOyPOzRO|QOPwPswP~OP]O~OyPOzRO|QOPwP~O]uOzgO~OZzO_wOh{OzgO~Ov|O!Q!OO~O]!QOzgO~OR!SO~P!yO]!UOzgO~OZ!XO_wOh!YOzgO~O`![OzgO~OzgOZoX_oXhoX~OZ!XO_wOh!YO~Ov|O!Q!`O~O]!aOzgO~OZ!cOzgO~O]!dOzgO~OZ!fOzgO~OZ!hO_wOh!iOzgO~OZ!hO_wOh!iO~O`!jOzgO~OzgO}!lO~OzgOZoa_oahoa~OZ!oOzgO~OZ!qOzgO~OZ!rO_wOh!sO~Ob!vOc!vO}!xO!O!vO~OZ!yOzgO~OZ!zOzgO~Ob!vOc!vO}!}O!O!vO~O",goto:"&S!QPPPPPPP!R!RP!]P!fP!mPP!vPPP!X!X#QP#W#_#g#m#s#z%S%c%i%oPPPP%uPPPPPPP&OWROS`bTl^nU`TasTl^nZ^T^ans_xiuvy!V!W!gQ!m![S!u!j!kR!{!tQp^R!SnZ_T^ansUSO`bR[SQVPRcVQYQReYSaTsRraQh]jthv!P!T!V!Z!]!b!e!k!n!p!tQviQ!PkQ!ToQ!VuQ!ZwQ!]xQ!b!QQ!e!UQ!k![Q!n!aQ!p!dR!t!jQyiS!WuvU!^y!W!gR!g!VQ!w!lR!|!wQn^R!RnQ}jR!_}QTOQq`RsbTm^n",nodeNames:"âš  StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Comment ProcessingInst DoctypeDecl Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue EntityReference CharacterReference Text Cdata MismatchedCloseTag CloseTag SelfCloseEndTag SelfClosingTag",maxTerm:49,context:elementContext,nodeProps:[[NodeProp.closedBy,1,"SelfCloseEndTag EndTag",12,"CloseTag MissingCloseTag"],[NodeProp.openedBy,11,"StartTag StartCloseTag",23,"OpenTag",24,"StartTag"]],skippedNodes:[0],repeatNodeCount:9,tokenData:"Az~R!WOX$kXY%rYZ%rZ]$k]^%r^p$kpq%rqr$krs&tsv$kvw'Uw}$k}!O(q!O!P$k!P!Q*n!Q![$k![!]+z!]!^$k!^!_/s!_!`=i!`!a>U!a!b>q!b!c$k!c!}+z!}#P$k#P#Q?}#Q#R$k#R#S+z#S#T$k#T#o+z#o%W$k%W%o+z%o%p$k%p&a+z&a&b$k&b1p+z1p4U$k4U4d+z4d4e$k4e$IS+z$IS$I`$k$I`$Ib+z$Ib$Kh$k$Kh%#t+z%#t&/x$k&/x&Et+z&Et&FV$k&FV;'S+z;'S;:j/S;:j?&r$k?&r?Ah+z?Ah?BY$k?BY?Mn+z?Mn~$kY$rUdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_~$kQ%ZRdQOv%Uw!^%U!_~%UW%iR!OWOr%dsv%dw~%d_%{]dQ!OWzTOX$kXY%rYZ%rZ]$k]^%r^p$kpq%rqr$krs%Usv$kw!^$k!^!_%d!_~$kZ&{R}XdQOv%Uw!^%U!_~%U~'XTOp'hqs'hst(Pt!]'h!^~'h~'kTOp'hqs'ht!]'h!]!^'z!^~'h~(POb~~(SROp(]q!](]!^~(]~(`SOp(]q!](]!]!^(l!^~(]~(qOc~Z(xWdQ!OWOr$krs%Usv$kw}$k}!O)b!O!^$k!^!_%d!_~$kZ)iWdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!a*R!a~$kZ*[UxPdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_~$k^*uWdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!a+_!a~$k^+hUhSdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_~$k_,V}_S]PdQ!OWOr$krs%Usv$kw}$k}!O+z!O!P+z!P!Q$k!Q![+z![!]+z!]!^$k!^!_%d!_!c$k!c!}+z!}#R$k#R#S+z#S#T$k#T#o+z#o$}$k$}%O+z%O%W$k%W%o+z%o%p$k%p&a+z&a&b$k&b1p+z1p4U+z4U4d+z4d4e$k4e$IS+z$IS$I`$k$I`$Ib+z$Ib$Je$k$Je$Jg+z$Jg$Kh$k$Kh%#t+z%#t&/x$k&/x&Et+z&Et&FV$k&FV;'S+z;'S;:j/S;:j?&r$k?&r?Ah+z?Ah?BY$k?BY?Mn+z?Mn~$k_/ZWdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_;=`$k;=`<%l+z<%l~$kZ/xU!OWOq%dqr0[sv%dw!a%d!a!b=X!b~%dZ0aZ!OWOr%dsv%dw}%d}!O1S!O!f%d!f!g1x!g!}%d!}#O5s#O#W%d#W#X:k#X~%dZ1XT!OWOr%dsv%dw}%d}!O1h!O~%dZ1oRyR!OWOr%dsv%dw~%dX1}T!OWOr%dsv%dw!q%d!q!r2^!r~%dX2cT!OWOr%dsv%dw!e%d!e!f2r!f~%dX2wT!OWOr%dsv%dw!v%d!v!w3W!w~%dX3]T!OWOr%dsv%dw!{%d!{!|3l!|~%dX3qT!OWOr%dsv%dw!r%d!r!s4Q!s~%dX4VT!OWOr%dsv%dw!g%d!g!h4f!h~%dX4kV!OWOr4frs5Qsv4fvw5Qw!`4f!`!a5c!a~4fP5TRO!`5Q!`!a5^!a~5QP5cOXPX5jRXP!OWOr%dsv%dw~%dY5xV!OWOr%dsv%dw!e%d!e!f6_!f#V%d#V#W8w#W~%dY6dT!OWOr%dsv%dw!f%d!f!g6s!g~%dY6xT!OWOr%dsv%dw!c%d!c!d7X!d~%dY7^T!OWOr%dsv%dw!v%d!v!w7m!w~%dY7rT!OWOr%dsv%dw!c%d!c!d8R!d~%dY8WT!OWOr%dsv%dw!}%d!}#O8g#O~%dY8nR!OW!RQOr%dsv%dw~%dY8|T!OWOr%dsv%dw#W%d#W#X9]#X~%dY9bT!OWOr%dsv%dw#T%d#T#U9q#U~%dY9vT!OWOr%dsv%dw#h%d#h#i:V#i~%dY:[T!OWOr%dsv%dw#T%d#T#U8R#U~%dX:pT!OWOr%dsv%dw#c%d#c#d;P#d~%dX;UT!OWOr%dsv%dw#V%d#V#W;e#W~%dX;jT!OWOr%dsv%dw#h%d#h#i;y#i~%dX<OT!OWOr%dsv%dw#m%d#m#n<_#n~%dX<dT!OWOr%dsv%dw#d%d#d#e<s#e~%dX<xT!OWOr%dsv%dw#X%d#X#Y4f#Y~%dZ=`R|R!OWOr%dsv%dw~%dZ=rU`PdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_~$k_>_UZTdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_~$kZ>xWdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!a?b!a~$kZ?kU{PdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_~$kZ@UWdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_#P$k#P#Q@n#Q~$kZ@uWdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!aA_!a~$kZAhU!QPdQ!OWOr$krs%Usv$kw!^$k!^!_%d!_~$k",tokenizers:[startTag,commentContent,piContent,cdataContent,0,1,2,3],topRules:{Document:[0,6]},tokenPrec:0});function tagName(e,t){var O=t&&t.getChild("TagName");return O?e.sliceString(O.from,O.to):""}function elementName(e,t){var O=t&&t.firstChild;return!O||O.name!="OpenTag"?"":tagName(e,O)}function attrName(e,t,O){var a=t&&t.getChildren("Attribute").find((function(e){return e.from<=O&&e.to>=O}));var n=a&&a.getChild("AttributeName");return n?e.sliceString(n.from,n.to):""}function findParentElement(e){for(var t=e&&e.parent;t;t=t.parent)if(t.name=="Element")return t;return null}function findLocation(e,t){var O;var a=syntaxTree(e).resolveInner(t,-1),n=null;for(var r=a;!n&&r.parent;r=r.parent)if(r.name=="OpenTag"||r.name=="CloseTag"||r.name=="SelfClosingTag"||r.name=="MismatchedCloseTag")n=r;if(n&&(n.to>t||n.lastChild.type.isError)){var o=n.parent;if(a.name=="TagName")return n.name=="CloseTag"||n.name=="MismatchedCloseTag"?{type:"closeTag",from:a.from,context:o}:{type:"openTag",from:a.from,context:findParentElement(o)};if(a.name=="AttributeName")return{type:"attrName",from:a.from,context:n};if(a.name=="AttributeValue")return{type:"attrValue",from:a.from,context:n};var s=a==n||a.name=="Attribute"?a.childBefore(t):a;if((s===null||s===void 0?void 0:s.name)=="StartTag")return{type:"openTag",from:t,context:findParentElement(o)};if((s===null||s===void 0?void 0:s.name)=="StartCloseTag"&&s.to<=t)return{type:"closeTag",from:t,context:o};if((s===null||s===void 0?void 0:s.name)=="Is")return{type:"attrValue",from:t,context:n};if(s)return{type:"attrName",from:t,context:n};return null}else if(a.name=="StartCloseTag"){return{type:"closeTag",from:t,context:a.parent}}while(a.parent&&a.to==t&&!((O=a.lastChild)===null||O===void 0?void 0:O.type.isError))a=a.parent;if(a.name=="Element"||a.name=="Text"||a.name=="Document")return{type:"tag",from:t,context:a.name=="Element"?a:findParentElement(a)};return null}var Element=function(){function e(e,t,O){this.attrs=t;this.attrValues=O;this.children=[];this.name=e.name;this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name});this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name});this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2});this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"});this.text=e.textContent?e.textContent.map((function(e){return{label:e,type:"text"}})):[]}return e}();var Identifier=/^[:\-\.\w\u00b7-\uffff]*$/;function attrCompletion(e){return Object.assign(Object.assign({type:"property"},e.completion||{}),{label:e.name})}function valueCompletion(e){return typeof e=="string"?{label:'"'.concat(e,'"'),type:"constant"}:/^"/.test(e.label)?e:Object.assign(Object.assign({},e),{label:'"'.concat(e.label,'"')})}function completeFromSchema(e,t){var O=[],a=[];var n=Object.create(null);for(var r=0,o=t;r<o.length;r++){var s=o[r];var i=attrCompletion(s);O.push(i);if(s.global)a.push(i);if(s.values)n[s.name]=s.values.map(valueCompletion)}var d=[],l=[];var c=Object.create(null);var m=function(e){var t=a,r=n;if(e.attributes)t=t.concat(e.attributes.map((function(e){if(typeof e=="string")return O.find((function(t){return t.label==e}))||{label:e,type:"property"};if(e.values){if(r==n)r=Object.create(r);r[e.name]=e.values.map(valueCompletion)}return attrCompletion(e)})));var o=new Element(e,t,r);c[o.name]=o;d.push(o);if(e.top)l.push(o)};for(var g=0,u=e;g<u.length;g++){var s=u[g];m(s)}if(!l.length)l=d;for(var f=0;f<d.length;f++){var s=e[f],p=d[f];if(s.children){for(var v=0,$=s.children;v<$.length;v++){var k=$[v];if(c[k])p.children.push(c[k])}}else{p.children=d}}return function(e){var t;var O=e.state.doc,r=findLocation(e.state,e.pos);if(!r||r.type=="tag"&&!e.explicit)return null;var o=r.type,s=r.from,i=r.context;if(o=="openTag"){var m=l;var g=elementName(O,i);if(g){var u=c[g];m=(u===null||u===void 0?void 0:u.children)||d}return{from:s,options:m.map((function(e){return e.completion})),span:Identifier}}else if(o=="closeTag"){var g=elementName(O,i);return g?{from:s,to:e.pos+(O.sliceString(e.pos,e.pos+1)==">"?1:0),options:[((t=c[g])===null||t===void 0?void 0:t.closeNameCompletion)||{label:g+">",type:"type"}],span:Identifier}:null}else if(o=="attrName"){var u=c[tagName(O,i)];return{from:s,options:(u===null||u===void 0?void 0:u.attrs)||a,span:Identifier}}else if(o=="attrValue"){var f=attrName(O,i,s);if(!f)return null;var u=c[tagName(O,i)];var p=((u===null||u===void 0?void 0:u.attrValues)||n)[f];if(!p||!p.length)return null;return{from:s,to:e.pos+(O.sliceString(e.pos,e.pos+1)=='"'?1:0),options:p,span:/^"[^"]*"?$/}}else if(o=="tag"){var g=elementName(O,i),u=c[g];var v=[],$=i&&i.lastChild;if(g&&(!$||$.name!="CloseTag"||tagName(O,$)!=g))v.push(u?u.closeCompletion:{label:"</"+g+">",type:"type",boost:2});var k=v.concat(((u===null||u===void 0?void 0:u.children)||(i?d:l)).map((function(e){return e.openCompletion})));if(i&&(u===null||u===void 0?void 0:u.text.length)){var T=i.firstChild;if(T.to>e.pos-20&&!/\S/.test(e.state.sliceDoc(T.to,e.pos)))k=k.concat(u.text)}return{from:s,options:k,span:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}else{return null}}}var xmlLanguage=LRLanguage.define({parser:parser.configure({props:[indentNodeProp.add({Element:function(e){var t=/^\s*<\//.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},"OpenTag CloseTag SelfClosingTag":function(e){return e.column(e.node.from)+e.unit}}),foldNodeProp.add({Element:function(e){var t=e.firstChild,O=e.lastChild;if(!t||t.name!="OpenTag")return null;return{from:t.to,to:O.name=="CloseTag"?O.from:e.to}}}),styleTags({Text:tags.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":tags.angleBracket,TagName:tags.tagName,"MismatchedCloseTag/Tagname":[tags.tagName,tags.invalid],AttributeName:tags.attributeName,AttributeValue:tags.attributeValue,Is:tags.definitionOperator,"EntityReference CharacterReference":tags.character,Comment:tags.blockComment,ProcessingInst:tags.processingInstruction,DoctypeDecl:tags.documentMeta,Cdata:tags.special(tags.string)})]}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/$/}});function xml(e){if(e===void 0){e={}}return new LanguageSupport(xmlLanguage,xmlLanguage.data.of({autocomplete:completeFromSchema(e.elements||[],e.attributes||[])}))}export{completeFromSchema,xml,xmlLanguage};
//# sourceMappingURL=index-20290304.js.map