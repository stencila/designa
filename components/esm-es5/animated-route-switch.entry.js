var __awaiter=this&&this.__awaiter||function(e,t,r,n){function a(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n["throw"](e))}catch(t){i(t)}}function c(e){e.done?r(e.value):a(e.value).then(o,s)}c((n=n.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,a&&(i=o[0]&2?a["return"]:o[0]?a["throw"]||((i=a["return"])&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;if(a=0,i)o=[o[0]&2,i.value];switch(o[0]){case 0:case 1:i=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;a=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}if(i[2])r.ops.pop();r.trys.pop();continue}o=t.call(e,r)}catch(s){o=[6,s];a=0}finally{n=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};import{r as registerInstance,a as getContext,h,c as getElement}from"./index-2305c23c.js";import{e as exitChildren,a as enterChildren}from"./index-af0083ae.js";var DEFAULT_DELIMITER="/";var DEFAULT_DELIMITERS="./";var PATH_REGEXP=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");var parse=function(e,t){var r=[];var n=0;var a=0;var i="";var o=t&&t.delimiter||DEFAULT_DELIMITER;var s=t&&t.delimiters||DEFAULT_DELIMITERS;var c=false;var l;while((l=PATH_REGEXP.exec(e))!==null){var u=l[0];var f=l[1];var p=l.index;i+=e.slice(a,p);a=p+u.length;if(f){i+=f[1];c=true;continue}var h="";var v=e[a];var g=l[2];var d=l[3];var m=l[4];var x=l[5];if(!c&&i.length){var b=i.length-1;if(s.indexOf(i[b])>-1){h=i[b];i=i.slice(0,b)}}if(i){r.push(i);i="";c=false}var T=h!==""&&v!==undefined&&v!==h;var y=x==="+"||x==="*";var E=x==="?"||x==="*";var w=h||o;var R=d||m;r.push({name:g||n++,prefix:h,delimiter:w,optional:E,repeat:y,partial:T,pattern:R?escapeGroup(R):"[^"+escapeString(w)+"]+?"})}if(i||a<e.length){r.push(i+e.substr(a))}return r};var escapeString=function(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")};var escapeGroup=function(e){return e.replace(/([=!:$/()])/g,"\\$1")};var flags=function(e){return e&&e.sensitive?"":"i"};var regexpToRegexp=function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r){for(var n=0;n<r.length;n++){t.push({name:n,prefix:null,delimiter:null,optional:false,repeat:false,partial:false,pattern:null})}}return e};var arrayToRegexp=function(e,t,r){var n=[];for(var a=0;a<e.length;a++){n.push(pathToRegexp(e[a],t,r).source)}return new RegExp("(?:"+n.join("|")+")",flags(r))};var stringToRegexp=function(e,t,r){return tokensToRegExp(parse(e,r),t,r)};var tokensToRegExp=function(e,t,r){r=r||{};var n=r.strict;var a=r.end!==false;var i=escapeString(r.delimiter||DEFAULT_DELIMITER);var o=r.delimiters||DEFAULT_DELIMITERS;var s=[].concat(r.endsWith||[]).map(escapeString).concat("$").join("|");var c="";var l=false;for(var u=0;u<e.length;u++){var f=e[u];if(typeof f==="string"){c+=escapeString(f);l=u===e.length-1&&o.indexOf(f[f.length-1])>-1}else{var p=escapeString(f.prefix||"");var h=f.repeat?"(?:"+f.pattern+")(?:"+p+"(?:"+f.pattern+"))*":f.pattern;if(t)t.push(f);if(f.optional){if(f.partial){c+=p+"("+h+")?"}else{c+="(?:"+p+"("+h+"))?"}}else{c+=p+"("+h+")"}}}if(a){if(!n)c+="(?:"+i+")?";c+=s==="$"?"$":"(?="+s+")"}else{if(!n)c+="(?:"+i+"(?="+s+"))?";if(!l)c+="(?="+i+"|"+s+")"}return new RegExp("^"+c,flags(r))};var pathToRegexp=function(e,t,r){if(e instanceof RegExp){return regexpToRegexp(e,t)}if(Array.isArray(e)){return arrayToRegexp(e,t,r)}return stringToRegexp(e,t,r)};var cacheCount=0;var patternCache={};var cacheLimit=1e4;var compilePath=function(e,t){var r="".concat(t.end).concat(t.strict);var n=patternCache[r]||(patternCache[r]={});var a=JSON.stringify(e);if(n[a]){return n[a]}var i=[];var o=pathToRegexp(e,i,t);var s={re:o,keys:i};if(cacheCount<cacheLimit){n[a]=s;cacheCount+=1}return s};var matchPath=function(e,t){if(t===void 0){t={}}if(typeof t==="string"){t={path:t}}var r=t.path,n=r===void 0?"/":r,a=t.exact,i=a===void 0?false:a,o=t.strict,s=o===void 0?false:o;var c=compilePath(n,{end:i,strict:s}),l=c.re,u=c.keys;var f=l.exec(e);if(!f){return null}var p=f[0],h=f.slice(1);var v=e===p;if(i&&!v){return null}return{path:n,url:n==="/"&&p===""?"/":p,isExact:v,params:u.reduce((function(e,t,r){e[t.name]=h[r];return e}),{})}};var getUniqueId=function(){return((Math.random()*1e17).toString().match(/.{4}/g)||[]).join("-")};var getMatch=function(e,t,r){return matchPath(e,{path:t,exact:r,strict:true})};var isHTMLStencilRouteElement=function(e){return e.tagName==="STENCIL-ROUTE"};var AnimatedRouteSwitch=function(){function e(e){registerInstance(this,e);this.group=getUniqueId();this.subscribers=[];this.queue=getContext(this,"queue")}e.prototype.componentWillLoad=function(){if(this.location!=null){this.regenerateSubscribers(this.location)}else{console.warn('<animated-route-switch> requires the "location" prop in order to be wired to Stencil Router.')}};e.prototype.regenerateSubscribers=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n;var a=this;return __generator(this,(function(i){switch(i.label){case 0:console.log(e);if(e==null){return[2]}t=-1;this.subscribers=Array.prototype.slice.call(this.el.children).filter(isHTMLStencilRouteElement).map((function(r,n){var a=getMatch(e.pathname,r.url,r.exact);if(a&&t===-1){t=n}return{el:r,match:a}}));if(t===-1){return[2]}if(this.activeIndex===t){this.subscribers[t].el.match=this.subscribers[t].match;return[2]}this.prevIndex=this.activeIndex;this.activeIndex=t;r=this.subscribers[this.prevIndex];if(!r)return[3,2];return[4,exitChildren(r.el)];case 1:i.sent();i.label=2;case 2:n=this.subscribers[this.activeIndex];if(typeof this.scrollTopOffset==="number"){n.el.scrollTopOffset=this.scrollTopOffset}n.el.group=this.group;n.el.match=n.match;n.el.componentUpdated=function(e){a.queue.write((function(){a.subscribers.forEach((function(e,t){e.el.componentUpdated=undefined;if(t===a.activeIndex){e.el.style.display="";return enterChildren(e.el)}if(typeof a.scrollTopOffset==="number"){e.el.scrollTopOffset=a.scrollTopOffset}e.el.group=a.group;e.el.match=null;e.el.style.display="none"}))}));if(a.routeViewsUpdated){a.routeViewsUpdated(Object.assign({scrollTopOffset:a.scrollTopOffset},e))}};return[2]}}))}))};e.prototype.render=function(){return h("slot",null)};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{location:["regenerateSubscribers"]}},enumerable:false,configurable:true});return e}();export{AnimatedRouteSwitch as animated_route_switch};
//# sourceMappingURL=animated-route-switch.entry.js.map