function simpleMode(e){ensureState(e,"start");var n={},t=e.languageData||{},r=false;for(var s in e)if(s!=t&&e.hasOwnProperty(s)){var o=n[s]=[],i=e[s];for(var a=0;a<i.length;a++){var l=i[a];o.push(new Rule(l,e));if(l.indent||l.dedent)r=true}}return{startState:function(){return{state:"start",pending:null,indent:r?[]:null}},copyState:function(e){var n={state:e.state,pending:e.pending,indent:e.indent&&e.indent.slice(0)};if(e.stack)n.stack=e.stack.slice(0);return n},token:tokenFunction(n),indent:indentFunction(n,t),languageData:t}}function ensureState(e,n){if(!e.hasOwnProperty(n))throw new Error("Undefined state "+n+" in simple mode")}function toRegex(e,n){if(!e)return/(?:)/;var t="";if(e instanceof RegExp){if(e.ignoreCase)t="i";e=e.source}else{e=String(e)}return new RegExp((n===false?"":"^")+"(?:"+e+")",t)}function asToken(e){if(!e)return null;if(e.apply)return e;if(typeof e=="string")return e.replace(/\./g," ");var n=[];for(var t=0;t<e.length;t++)n.push(e[t]&&e[t].replace(/\./g," "));return n}function Rule(e,n){if(e.next||e.push)ensureState(n,e.next||e.push);this.regex=toRegex(e.regex);this.token=asToken(e.token);this.data=e}function tokenFunction(e){return function(n,t){if(t.pending){var r=t.pending.shift();if(t.pending.length==0)t.pending=null;n.pos+=r.text.length;return r.token}var s=e[t.state];for(var o=0;o<s.length;o++){var i=s[o];var a=(!i.data.sol||n.sol())&&n.match(i.regex);if(a){if(i.data.next){t.state=i.data.next}else if(i.data.push){(t.stack||(t.stack=[])).push(t.state);t.state=i.data.push}else if(i.data.pop&&t.stack&&t.stack.length){t.state=t.stack.pop()}if(i.data.indent)t.indent.push(n.indentation()+n.indentUnit);if(i.data.dedent)t.indent.pop();var l=i.token;if(l&&l.apply)l=l(a);if(a.length>2&&i.token&&typeof i.token!="string"){t.pending=[];for(var u=2;u<a.length;u++)if(a[u])t.pending.push({text:a[u],token:i.token[u-1]});n.backUp(a[0].length-(a[1]?a[1].length:0));return l[0]}else if(l&&l.join){return l[0]}else{return l}}}n.next();return null}}function indentFunction(e,n){return function(t,r){if(t.indent==null||n.dontIndentStates&&n.doneIndentState.indexOf(t.state)>-1)return null;var s=t.indent.length-1,o=e[t.state];e:for(;;){for(var i=0;i<o.length;i++){var a=o[i];if(a.data.dedent&&a.data.dedentIfLineStart!==false){var l=a.regex.exec(r);if(l&&l[0]){s--;if(a.next||a.push)o=e[a.next||a.push];r=r.slice(l[0].length);continue e}}}break}return s<0?0:t.indent[s]}}var from="from";var fromRegex=new RegExp("^(\\s*)\\b("+from+")\\b","i");var shells=["run","cmd","entrypoint","shell"];var shellsAsArrayRegex=new RegExp("^(\\s*)("+shells.join("|")+")(\\s+\\[)","i");var expose="expose";var exposeRegex=new RegExp("^(\\s*)("+expose+")(\\s+)","i");var others=["arg","from","maintainer","label","env","add","copy","volume","user","workdir","onbuild","stopsignal","healthcheck","shell"];var instructions=[from,expose].concat(shells).concat(others),instructionRegex="("+instructions.join("|")+")",instructionOnlyLine=new RegExp("^(\\s*)"+instructionRegex+"(\\s*)(#.*)?$","i"),instructionWithArguments=new RegExp("^(\\s*)"+instructionRegex+"(\\s+)","i");var dockerFile=simpleMode({start:[{regex:/^\s*#.*$/,sol:true,token:"comment"},{regex:fromRegex,token:[null,"keyword"],sol:true,next:"from"},{regex:instructionOnlyLine,token:[null,"keyword",null,"error"],sol:true},{regex:shellsAsArrayRegex,token:[null,"keyword",null],sol:true,next:"array"},{regex:exposeRegex,token:[null,"keyword",null],sol:true,next:"expose"},{regex:instructionWithArguments,token:[null,"keyword",null],sol:true,next:"arguments"},{regex:/./,token:null}],from:[{regex:/\s*$/,token:null,next:"start"},{regex:/(\s*)(#.*)$/,token:[null,"error"],next:"start"},{regex:/(\s*\S+\s+)(as)/i,token:[null,"keyword"],next:"start"},{token:null,next:"start"}],single:[{regex:/(?:[^\\']|\\.)/,token:"string"},{regex:/'/,token:"string",pop:true}],double:[{regex:/(?:[^\\"]|\\.)/,token:"string"},{regex:/"/,token:"string",pop:true}],array:[{regex:/\]/,token:null,next:"start"},{regex:/"(?:[^\\"]|\\.)*"?/,token:"string"}],expose:[{regex:/\d+$/,token:"number",next:"start"},{regex:/[^\d]+$/,token:null,next:"start"},{regex:/\d+/,token:"number"},{regex:/[^\d]+/,token:null},{token:null,next:"start"}],arguments:[{regex:/^\s*#.*$/,sol:true,token:"comment"},{regex:/"(?:[^\\"]|\\.)*"?$/,token:"string",next:"start"},{regex:/"/,token:"string",push:"double"},{regex:/'(?:[^\\']|\\.)*'?$/,token:"string",next:"start"},{regex:/'/,token:"string",push:"single"},{regex:/[^#"']+[\\`]$/,token:null},{regex:/[^#"']+$/,token:null,next:"start"},{regex:/[^#"']+/,token:null},{token:null,next:"start"}],languageData:{commentTokens:{line:"#"}}});export{dockerFile};
//# sourceMappingURL=dockerfile-fbfef70c.js.map