{"version":3,"file":"sessionStatus.js","sourceRoot":"","sources":["../../../src/components/documentToolbar/sessionStatus.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,WAAW,IAAI,EAAE,EAAE,MAAM,YAAY,CAAA;AAC9C,OAAO,EAAuB,CAAC,EAAS,MAAM,eAAe,CAAA;AAC7D,OAAO,EAAE,KAAK,IAAI,CAAC,EAAE,MAAM,OAAO,CAAA;AAClC,OAAO,EAAE,IAAI,EAAE,MAAM,gBAAgB,CAAA;AACrC,OAAO,EAAE,YAAY,EAAoC,MAAM,WAAW,CAAA;AAQ1E,MAAM,eAAe,GAAG,CAAC,QAAkB,EAAU,EAAE,CACrD,YAAY,CAAC,QAAQ,CAAC;EACpB,CAAC,CAAC,QAAQ,CAAC,aAAa;EACxB,CAAC,CAAC,8BAA8B,CAAA;AAEpC,MAAM,eAAe,GAAG,CAAC,SAAmB,EAAU,EAAE,CACtD,IAAI,CACF,SAAS,EACT,EAAE,CAAC,IAAI,CACL,GAAG,EAAE,CAAC,oBAAoB,EAC1B,GAAG,EAAE,CAAC,oBAAoB,EAC1B,eAAe,EACf,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,aAAa,EAC1B,eAAe,EACf,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,aAAa,CAC3B,CACF,CAAA;AAEH,MAAM,CAAC,MAAM,aAAa,GAAoC,CAC5D,EAAE,OAAO,EAAE,GAAG,EAAE,EAChB,QAAQ,EACR,EAAE,CAAC,CACH,YACE,KAAK,EAAE;IACL,cAAc,EAAE,IAAI;IACpB,MAAM,EAAE,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC;IAC7B,OAAO,EAAE,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC;GAC/B,IAEA,IAAI,CACH,OAAO,EACP,EAAE,CAAC,IAAI,CACL,GAAG,EAAE,CAAC,EAAE,EACR,GAAG,EAAE,CAAC,CACJ;EACE,qBAAe,IAAI,EAAC,UAAU,GAAiB;EAC/C,gBAAO,eAAe,CAAC,GAAG,CAAC,CAAQ,CAC9B,CACR,EACD,CAAC,oBAAoB,EAAE,EAAE,CAAC,CACxB;EACE,qBAAe,IAAI,EAAC,UAAU,GAAiB;EAC/C,gBAAO,eAAe,CAAC,oBAAoB,CAAC,CAAQ,CAC/C,CACR,EACD,CAAC,iBAAiB,EAAE,EAAE,CAAC,CACrB,gBACG,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CACrB;EACE,qBAAe,IAAI,EAAC,UAAU,GAAiB;EAC/C,iBAAiB,CAAC,MAAM;CACzB,CACF,CAAC,CAAC,CAAC,CACF,gBAAO,QAAQ,CAAQ,CACxB,CACI,CACR,EACD,CAAC,GAAG,EAAE,EAAE,CAAC,CACP;EACE,qBAAe,IAAI,EAAC,eAAe,GAAiB;EACpD,gBAAO,eAAe,CAAC,GAAG,CAAC,CAAQ,CAC9B,CACR,EACD,GAAG,EAAE,CAAC,CACJ,wBAAkB,IAAI,EAAC,2BAA2B;EAChD,qBAAe,IAAI,EAAC,OAAO,GAAiB;EAC3C,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,gBAAO,QAAQ,CAAQ,CACpC,CACpB,CACF,CACF,CACI,CACR,CAAA","sourcesContent":["import { datumEither as DE } from '@nll/datum'\nimport { FunctionalComponent, h, VNode } from '@stencil/core'\nimport { array as A } from 'fp-ts'\nimport { pipe } from 'fp-ts/function'\nimport { isErrorGuard, JobDatum, JobError, SessionDatum } from './executa'\n\ninterface HelloProps {\n  session: SessionDatum\n  job: JobDatum\n  children?: VNode | VNode[]\n}\n\nconst jobErrorMessage = (jobError: JobError): string =>\n  isErrorGuard(jobError)\n    ? jobError.statusMessage\n    : 'An unexpected error occurred'\n\nconst jobStatusString = (jobObject: JobDatum): string =>\n  pipe(\n    jobObject,\n    DE.fold(\n      () => 'Requesting session',\n      () => 'Requesting session',\n      jobErrorMessage,\n      (job) => job.statusMessage,\n      jobErrorMessage,\n      (job) => job.statusMessage\n    )\n  )\n\nexport const SessionStatus: FunctionalComponent<HelloProps> = (\n  { session, job },\n  children\n) => (\n  <span\n    class={{\n      documentStatus: true,\n      danger: DE.isFailure(session),\n      success: DE.isSuccess(session),\n    }}\n  >\n    {pipe(\n      session,\n      DE.fold(\n        () => '',\n        () => (\n          <span>\n            <stencila-icon icon=\"loader-2\"></stencila-icon>\n            <span>{jobStatusString(job)}</span>\n          </span>\n        ),\n        (refreshingErroredJob) => (\n          <span>\n            <stencila-icon icon=\"loader-2\"></stencila-icon>\n            <span>{jobErrorMessage(refreshingErroredJob)}</span>\n          </span>\n        ),\n        (refreshingSession) => (\n          <span>\n            {A.isEmpty(children) ? (\n              [\n                <stencila-icon icon=\"loader-2\"></stencila-icon>,\n                refreshingSession.status,\n              ]\n            ) : (\n              <span>{children}</span>\n            )}\n          </span>\n        ),\n        (err) => (\n          <span>\n            <stencila-icon icon=\"error-warning\"></stencila-icon>\n            <span>{jobErrorMessage(err)}</span>\n          </span>\n        ),\n        () => (\n          <stencila-tooltip text=\"Compute session is active\">\n            <stencila-icon icon=\"pulse\"></stencila-icon>\n            {A.isEmpty(children) ? null : <span>{children}</span>}\n          </stencila-tooltip>\n        )\n      )\n    )}\n  </span>\n)\n"]}