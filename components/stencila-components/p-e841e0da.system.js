var __extends=this&&this.__extends||function(){var e=function(t,r){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return e(t,r)};return function(t,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var __spreadArray=this&&this.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++){if(s||!(n in t)){if(!s)s=Array.prototype.slice.call(t,0,n);s[n]=t[n]}}return e.concat(s||Array.prototype.slice.call(t))};System.register(["./p-2e66c77c.system.js","./p-3805cf1f.system.js","./p-6cc918a4.system.js","./p-33366d5a.system.js","./p-5cd8524a.system.js","./p-7777e2fb.system.js","./p-450f0050.system.js"],(function(e){"use strict";var t,r,n,i,s,a,o,f,h,l,u,p,c,d,v,g,m,k,x,y,b;return{setters:[function(e){t=e.a;r=e.N;n=e.e;i=e.P;s=e.T;a=e.p;o=e.L;f=e.s;h=e.o;l=e.x;u=e.y;p=e.f;c=e.d;d=e.b;v=e.t;g=e.m;m=e.j;k=e.l;x=e.z;y=e.c},function(e){b=e.html},function(){},function(){},function(){},function(){},function(){}],execute:function(){var L;e("markdown",ut);var S=function(){function e(e,t,n,i,s,a,o){this.type=e;this.value=t;this.from=n;this.hash=i;this.end=s;this.children=a;this.positions=o;this.hashProp=[[r.contextHash,i]]}e.create=function(t,r,n,i,s){var a=i+(i<<8)+t+(r<<4)|0;return new e(t,r,n,a,s,[],[])};e.prototype.addChild=function(e,t){if(e.prop(r.contextHash)!=this.hash)e=new s(e.type,e.children,e.positions,e.length,this.hashProp);this.children.push(e);this.positions.push(t)};e.prototype.toTree=function(e,r){var n=this;if(r===void 0){r=this.end}var i=this.children.length-1;if(i>=0)r=Math.max(r,this.positions[i]+this.children[i].length+this.from);var a=new s(e.types[this.type],this.children,this.positions,r-this.from).balance({makeTree:function(e,r,i){return new s(t.none,e,r,i,n.hashProp)}});return a};return e}();var w;(function(e){e[e["Document"]=1]="Document";e[e["CodeBlock"]=2]="CodeBlock";e[e["FencedCode"]=3]="FencedCode";e[e["Blockquote"]=4]="Blockquote";e[e["HorizontalRule"]=5]="HorizontalRule";e[e["BulletList"]=6]="BulletList";e[e["OrderedList"]=7]="OrderedList";e[e["ListItem"]=8]="ListItem";e[e["ATXHeading1"]=9]="ATXHeading1";e[e["ATXHeading2"]=10]="ATXHeading2";e[e["ATXHeading3"]=11]="ATXHeading3";e[e["ATXHeading4"]=12]="ATXHeading4";e[e["ATXHeading5"]=13]="ATXHeading5";e[e["ATXHeading6"]=14]="ATXHeading6";e[e["SetextHeading1"]=15]="SetextHeading1";e[e["SetextHeading2"]=16]="SetextHeading2";e[e["HTMLBlock"]=17]="HTMLBlock";e[e["LinkReference"]=18]="LinkReference";e[e["Paragraph"]=19]="Paragraph";e[e["CommentBlock"]=20]="CommentBlock";e[e["ProcessingInstructionBlock"]=21]="ProcessingInstructionBlock";e[e["Escape"]=22]="Escape";e[e["Entity"]=23]="Entity";e[e["HardBreak"]=24]="HardBreak";e[e["Emphasis"]=25]="Emphasis";e[e["StrongEmphasis"]=26]="StrongEmphasis";e[e["Link"]=27]="Link";e[e["Image"]=28]="Image";e[e["InlineCode"]=29]="InlineCode";e[e["HTMLTag"]=30]="HTMLTag";e[e["Comment"]=31]="Comment";e[e["ProcessingInstruction"]=32]="ProcessingInstruction";e[e["URL"]=33]="URL";e[e["HeaderMark"]=34]="HeaderMark";e[e["QuoteMark"]=35]="QuoteMark";e[e["ListMark"]=36]="ListMark";e[e["LinkMark"]=37]="LinkMark";e[e["EmphasisMark"]=38]="EmphasisMark";e[e["CodeMark"]=39]="CodeMark";e[e["CodeText"]=40]="CodeText";e[e["CodeInfo"]=41]="CodeInfo";e[e["LinkTitle"]=42]="LinkTitle";e[e["LinkLabel"]=43]="LinkLabel"})(w||(w={}));var C=function(){function e(e,t){this.start=e;this.content=t;this.marks=[];this.parsers=[]}return e}();var A=function(){function e(){this.text="";this.baseIndent=0;this.basePos=0;this.depth=0;this.markers=[];this.pos=0;this.indent=0;this.next=-1}e.prototype.forward=function(){if(this.basePos>this.pos)this.forwardInner()};e.prototype.forwardInner=function(){var e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent);this.pos=e;this.next=e==this.text.length?-1:this.text.charCodeAt(e)};e.prototype.skipSpace=function(e){return E(this.text,e)};e.prototype.reset=function(e){this.text=e;this.baseIndent=this.basePos=this.pos=this.indent=0;this.forwardInner();this.depth=1;while(this.markers.length)this.markers.pop()};e.prototype.moveBase=function(e){this.basePos=e;this.baseIndent=this.countIndent(e,this.pos,this.indent)};e.prototype.moveBaseColumn=function(e){this.baseIndent=e;this.basePos=this.findColumn(e)};e.prototype.addMarker=function(e){this.markers.push(e)};e.prototype.countIndent=function(e,t,r){if(t===void 0){t=0}if(r===void 0){r=0}for(var n=t;n<e;n++)r+=this.text.charCodeAt(n)==9?4-r%4:1;return r};e.prototype.findColumn=function(e){var t=0;for(var r=0;t<this.text.length&&r<e;t++)r+=this.text.charCodeAt(t)==9?4-r%4:1;return t};e.prototype.scrub=function(){if(!this.baseIndent)return this.text;var e="";for(var t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)};return e}();function T(e,t,r){if(r.pos==r.text.length||e!=t.block&&r.indent>=t.stack[r.depth+1].value+r.baseIndent)return true;if(r.indent>=r.baseIndent+4)return false;var n=(e.type==w.OrderedList?_:j)(r,t,false);return n>0&&(e.type!=w.BulletList||O(r,t,false)<0)&&r.text.charCodeAt(r.pos+n-1)==e.value}var I=(L={},L[w.Blockquote]=function(e,t,r){if(r.next!=62)return false;r.markers.push(ce(w.QuoteMark,t.lineStart+r.pos,t.lineStart+r.pos+1));r.moveBase(r.pos+(B(r.text.charCodeAt(r.pos+1))?2:1));e.end=t.lineStart+r.text.length;return true},L[w.ListItem]=function(e,t,r){if(r.indent<r.baseIndent+e.value&&r.next>-1)return false;r.moveBaseColumn(r.baseIndent+e.value);return true},L[w.OrderedList]=T,L[w.BulletList]=T,L[w.Document]=function(){return true},L);function B(e){return e==32||e==9||e==10||e==13}function E(e,t){if(t===void 0){t=0}while(t<e.length&&B(e.charCodeAt(t)))t++;return t}function M(e,t,r){while(t>r&&B(e.charCodeAt(t-1)))t--;return t}function H(e){if(e.next!=96&&e.next!=126)return-1;var t=e.pos+1;while(t<e.text.length&&e.text.charCodeAt(t)==e.next)t++;if(t<e.pos+3)return-1;if(e.next==96)for(var r=t;r<e.text.length;r++)if(e.text.charCodeAt(r)==96)return-1;return t}function P(e){return e.next!=62?-1:e.text.charCodeAt(e.pos+1)==32?2:1}function O(e,t,r){if(e.next!=42&&e.next!=45&&e.next!=95)return-1;var n=1;for(var i=e.pos+1;i<e.text.length;i++){var s=e.text.charCodeAt(i);if(s==e.next)n++;else if(!B(s))return-1}if(r&&e.next==45&&X(e)>-1&&e.depth==t.stack.length)return-1;return n<3?-1:1}function N(e,t){for(var r=e.stack.length-1;r>=0;r--)if(e.stack[r].type==t)return true;return false}function j(e,t,r){return(e.next==45||e.next==43||e.next==42)&&(e.pos==e.text.length-1||B(e.text.charCodeAt(e.pos+1)))&&(!r||N(t,w.BulletList)||e.skipSpace(e.pos+2)<e.text.length)?1:-1}function _(e,t,r){var n=e.pos,i=e.next;for(;;){if(i>=48&&i<=57)n++;else break;if(n==e.text.length)return-1;i=e.text.charCodeAt(n)}if(n==e.pos||n>e.pos+9||i!=46&&i!=41||n<e.text.length-1&&!B(e.text.charCodeAt(n+1))||r&&!N(t,w.OrderedList)&&(e.skipSpace(n+1)==e.text.length||n>e.pos+1||e.next!=49))return-1;return n+1-e.pos}function R(e){if(e.next!=35)return-1;var t=e.pos+1;while(t<e.text.length&&e.text.charCodeAt(t)==35)t++;if(t<e.text.length&&e.text.charCodeAt(t)!=32)return-1;var r=t-e.pos;return r>6?-1:r}function X(e){if(e.next!=45&&e.next!=61||e.indent>=e.baseIndent+4)return-1;var t=e.pos+1;while(t<e.text.length&&e.text.charCodeAt(t)==e.next)t++;var r=t;while(t<e.text.length&&B(e.text.charCodeAt(t)))t++;return t==e.text.length?r:-1}var z=/^[ \t]*$/,D=/-->/,q=/\?>/;var $=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,D],[/^\s*<\?/,q],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,z],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,z]];function F(e,t,r){if(e.next!=60)return-1;var n=e.text.slice(e.pos);for(var i=0,s=$.length-(r?1:0);i<s;i++)if($[i][0].test(n))return i;return-1}function U(e,t){var r=e.countIndent(t,e.pos,e.indent);var n=e.countIndent(e.skipSpace(t),t,r);return n>=r+5?r+1:n}function Q(e,t,r){var n=e.length-1;if(n>=0&&e[n].to==t&&e[n].type==w.CodeText)e[n].to=r;else e.push(ce(w.CodeText,t,r))}var Z={LinkReference:undefined,IndentedCode:function(e,t){var r=t.baseIndent+4;if(t.indent<r)return false;var n=t.findColumn(r);var i=e.lineStart+n,s=e.lineStart+t.text.length;var a=[],o=[];Q(a,i,s);while(e.nextLine()&&t.depth>=e.stack.length){if(t.pos==t.text.length){Q(o,e.lineStart-1,e.lineStart);for(var f=0,h=t.markers;f<h.length;f++){var l=h[f];o.push(l)}}else if(t.indent<r){break}else{if(o.length){for(var u=0,p=o;u<p.length;u++){var l=p[u];if(l.type==w.CodeText)Q(a,l.from,l.to);else a.push(l)}o=[]}Q(a,e.lineStart-1,e.lineStart);for(var c=0,d=t.markers;c<d.length;c++){var l=d[c];a.push(l)}s=e.lineStart+t.text.length;var v=e.lineStart+t.findColumn(t.baseIndent+4);if(v<s)Q(a,v,s)}}if(o.length){o=o.filter((function(e){return e.type!=w.CodeText}));if(o.length)t.markers=o.concat(t.markers)}e.addNode(e.buffer.writeElements(a,-i).finish(w.CodeBlock,s-i),i);return true},FencedCode:function(e,t){var r=H(t);if(r<0)return false;var n=e.lineStart+t.pos,i=t.next,s=r-t.pos;var a=t.skipSpace(r),o=M(t.text,t.text.length,a);var f=[ce(w.CodeMark,n,n+s)];if(a<o)f.push(ce(w.CodeInfo,e.lineStart+a,e.lineStart+o));for(var h=true;e.nextLine()&&t.depth>=e.stack.length;h=false){var l=t.pos;if(t.indent-t.baseIndent<4)while(l<t.text.length&&t.text.charCodeAt(l)==i)l++;if(l-t.pos>=s&&t.skipSpace(l)==t.text.length){for(var u=0,p=t.markers;u<p.length;u++){var c=p[u];f.push(c)}f.push(ce(w.CodeMark,e.lineStart+t.pos,e.lineStart+l));e.nextLine();break}else{if(!h)Q(f,e.lineStart-1,e.lineStart);for(var d=0,v=t.markers;d<v.length;d++){var c=v[d];f.push(c)}var g=e.lineStart+t.basePos,m=e.lineStart+t.text.length;if(g<m)Q(f,g,m)}}e.addNode(e.buffer.writeElements(f,-n).finish(w.FencedCode,e.prevLineEnd()-n),n);return true},Blockquote:function(e,t){var r=P(t);if(r<0)return false;e.startContext(w.Blockquote,t.pos);e.addNode(w.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1);t.moveBase(t.pos+r);return null},HorizontalRule:function(e,t){if(O(t,e,false)<0)return false;var r=e.lineStart+t.pos;e.nextLine();e.addNode(w.HorizontalRule,r);return true},BulletList:function(e,t){var r=j(t,e,false);if(r<0)return false;if(e.block.type!=w.BulletList)e.startContext(w.BulletList,t.basePos,t.next);var n=U(t,t.pos+1);e.startContext(w.ListItem,t.basePos,n-t.baseIndent);e.addNode(w.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+r);t.moveBaseColumn(n);return null},OrderedList:function(e,t){var r=_(t,e,false);if(r<0)return false;if(e.block.type!=w.OrderedList)e.startContext(w.OrderedList,t.basePos,t.text.charCodeAt(t.pos+r-1));var n=U(t,t.pos+r);e.startContext(w.ListItem,t.basePos,n-t.baseIndent);e.addNode(w.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+r);t.moveBaseColumn(n);return null},ATXHeading:function(e,t){var r=R(t);if(r<0)return false;var n=t.pos,i=e.lineStart+n;var s=M(t.text,t.text.length,n),a=s;while(a>n&&t.text.charCodeAt(a-1)==t.next)a--;if(a==s||a==n||!B(t.text.charCodeAt(a-1)))a=t.text.length;var o=e.buffer.write(w.HeaderMark,0,r).writeElements(e.parser.parseInline(t.text.slice(n+r+1,a),i+r+1),-i);if(a<t.text.length)o.write(w.HeaderMark,a-n,s-n);var f=o.finish(w.ATXHeading1-1+r,t.text.length-n);e.nextLine();e.addNode(f,i);return true},HTMLBlock:function(e,t){var r=F(t,e,false);if(r<0)return false;var n=e.lineStart+t.pos,i=$[r][1];var s=[],a=i!=z;while(!i.test(t.text)&&e.nextLine()){if(t.depth<e.stack.length){a=false;break}for(var o=0,f=t.markers;o<f.length;o++){var h=f[o];s.push(h)}}if(a)e.nextLine();var l=i==D?w.CommentBlock:i==q?w.ProcessingInstructionBlock:w.HTMLBlock;var u=e.prevLineEnd();e.addNode(e.buffer.writeElements(s,-n).finish(l,u-n),n);return true},SetextHeading:undefined};var V=function(){function e(e){this.stage=0;this.elts=[];this.pos=0;this.start=e.start;this.advance(e.content)}e.prototype.nextLine=function(e,t,r){if(this.stage==-1)return false;var n=r.content+"\n"+t.scrub();var i=this.advance(n);if(i>-1&&i<n.length)return this.complete(e,r,i);return false};e.prototype.finish=function(e,t){if((this.stage==2||this.stage==3)&&E(t.content,this.pos)==t.content.length)return this.complete(e,t,t.content.length);return false};e.prototype.complete=function(e,t,r){e.addLeafElement(t,ce(w.LinkReference,this.start,this.start+r,this.elts));return true};e.prototype.nextStage=function(e){if(e){this.pos=e.to-this.start;this.elts.push(e);this.stage++;return true}if(e===false)this.stage=-1;return false};e.prototype.advance=function(e){for(;;){if(this.stage==-1){return-1}else if(this.stage==0){if(!this.nextStage(Ce(e,this.pos,this.start,true)))return-1;if(e.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(ce(w.LinkMark,this.pos+this.start,this.pos+this.start+1));this.pos++}else if(this.stage==1){if(!this.nextStage(Se(e,E(e,this.pos),this.start)))return-1}else if(this.stage==2){var t=E(e,this.pos),r=0;if(t>this.pos){var n=we(e,t,this.start);if(n){var i=G(e,n.to-this.start);if(i>0){this.nextStage(n);r=i}}}if(!r)r=G(e,this.pos);return r>0&&r<e.length?r:-1}else{return G(e,this.pos)}}};return e}();function G(e,t){for(;t<e.length;t++){var r=e.charCodeAt(t);if(r==10)break;if(!B(r))return-1}return t}var K=function(){function e(){}e.prototype.nextLine=function(e,t,r){var n=t.depth<e.stack.length?-1:X(t);var i=t.next;if(n<0)return false;var s=ce(w.HeaderMark,e.lineStart+t.pos,e.lineStart+n);e.nextLine();e.addLeafElement(r,ce(i==61?w.SetextHeading1:w.SetextHeading2,r.start,e.prevLineEnd(),__spreadArray(__spreadArray([],e.parser.parseInline(r.content,r.start),true),[s],false)));return true};e.prototype.finish=function(){return false};return e}();var J={LinkReference:function(e,t){return t.content.charCodeAt(0)==91?new V(t):null},SetextHeading:function(){return new K}};var W=[function(e,t){return R(t)>=0},function(e,t){return H(t)>=0},function(e,t){return P(t)>=0},function(e,t){return j(t,e,true)>=0},function(e,t){return _(t,e,true)>=0},function(e,t){return O(t,e,true)>=0},function(e,t){return F(t,e,true)>=0}];var Y={text:"",end:0};var ee=function(){function e(e,t,r,n){this.parser=e;this.input=t;this.ranges=n;this.line=new A;this.atEnd=false;this.dontInject=new Set;this.stoppedAt=null;this.rangeI=0;this.to=n[n.length-1].to;this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=n[0].from;this.block=S.create(w.Document,0,this.lineStart,0,0);this.stack=[this.block];this.fragments=r.length?new Be(r,t):null;this.readLine()}Object.defineProperty(e.prototype,"parsedPos",{get:function(){return this.absoluteLineStart},enumerable:false,configurable:true});e.prototype.advance=function(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();var e=this.line;for(;;){while(e.depth<this.stack.length)this.finishContext();for(var t=0,r=e.markers;t<r.length;t++){var n=r[t];this.addNode(n.type,n.from,n.to)}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(var i=0,s=this.parser.blockParsers;i<s.length;i++){var a=s[i];if(a){var o=a(this,e);if(o!=false){if(o==true)return null;e.forward();continue e}}}break}var f=new C(this.lineStart+e.pos,e.text.slice(e.pos));for(var h=0,l=this.parser.leafBlockParsers;h<l.length;h++){var u=l[h];if(u){var p=u(this,f);if(p)f.parsers.push(p)}}e:while(this.nextLine()){if(e.pos==e.text.length)break;if(e.indent<e.baseIndent+4){for(var c=0,d=this.parser.endLeafBlock;c<d.length;c++){var v=d[c];if(v(this,e,f))break e}}for(var g=0,m=f.parsers;g<m.length;g++){var k=m[g];if(k.nextLine(this,e,f))return null}f.content+="\n"+e.scrub();for(var x=0,y=e.markers;x<y.length;x++){var b=y[x];f.marks.push(b)}}this.finishLeaf(f);return null};e.prototype.stopAt=function(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e};e.prototype.reuseFragment=function(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return false;var t=this.fragments.takeNodes(this);if(!t)return false;var r=t,n=this.absoluteLineStart+t;for(var i=1;i<this.ranges.length;i++){var s=this.ranges[i-1].to,a=this.ranges[i].from;if(s>=this.lineStart&&a<n)r-=a-s}this.lineStart+=r;this.absoluteLineStart+=t;this.moveRangeI();if(this.absoluteLineStart<this.to){this.lineStart++;this.absoluteLineStart++;this.readLine()}else{this.atEnd=true;this.readLine()}return true};Object.defineProperty(e.prototype,"depth",{get:function(){return this.stack.length},enumerable:false,configurable:true});e.prototype.parentType=function(e){if(e===void 0){e=this.depth-1}return this.parser.nodeSet.types[this.stack[e].type]};e.prototype.nextLine=function(){this.lineStart+=this.line.text.length;if(this.absoluteLineEnd>=this.to){this.absoluteLineStart=this.absoluteLineEnd;this.atEnd=true;this.readLine();return false}else{this.lineStart++;this.absoluteLineStart=this.absoluteLineEnd+1;this.moveRangeI();this.readLine();return true}};e.prototype.moveRangeI=function(){while(this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to)this.rangeI++};e.prototype.scanLine=function(e){var t=Y;t.end=e;if(e>=this.to){t.text=""}else{t.text=this.lineChunkAt(t.end);t.end+=t.text.length;if(this.ranges.length>1){var r=this.absoluteLineStart,n=this.rangeI;while(this.ranges[n].to<t.end){n++;var i=this.ranges[n].from;var s=this.lineChunkAt(i);t.end=i+s.length;t.text=t.text.slice(0,this.ranges[n-1].to-r)+s;r=t.end-t.text.length}}}return t};e.prototype.readLine=function(){var e=this.line,t=this.scanLine(this.absoluteLineStart),r=t.text,n=t.end;this.absoluteLineEnd=n;e.reset(r);for(;e.depth<this.stack.length;e.depth++){var i=this.stack[e.depth],s=this.parser.skipContextMarkup[i.type];if(!s)throw new Error("Unhandled block context "+w[i.type]);if(!s(i,this,e))break;e.forward()}};e.prototype.lineChunkAt=function(e){var t=this.input.chunk(e),r;if(!this.input.lineChunks){var n=t.indexOf("\n");r=n<0?t:t.slice(0,n)}else{r=t=="\n"?"":t}return e+r.length>this.to?r.slice(0,this.to-e):r};e.prototype.prevLineEnd=function(){return this.atEnd?this.lineStart:this.lineStart-1};e.prototype.startContext=function(e,t,r){if(r===void 0){r=0}this.block=S.create(e,r,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length);this.stack.push(this.block)};e.prototype.startComposite=function(e,t,r){if(r===void 0){r=0}this.startContext(this.parser.getNodeType(e),t,r)};e.prototype.addNode=function(e,t,r){if(typeof e=="number")e=new s(this.parser.nodeSet.types[e],he,he,(r!==null&&r!==void 0?r:this.prevLineEnd())-t);this.block.addChild(e,t-this.block.from)};e.prototype.addElement=function(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)};e.prototype.addLeafElement=function(e,t){this.addNode(this.buffer.writeElements(Te(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)};e.prototype.finishContext=function(){var e=this.stack.pop();var t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from);this.block=t};e.prototype.finish=function(){while(this.stack.length>1)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))};e.prototype.addGaps=function(e){return this.ranges.length>1?te(this.ranges,0,e.topNode,this.ranges[0].from,this.dontInject):e};e.prototype.finishLeaf=function(e){for(var t=0,r=e.parsers;t<r.length;t++){var n=r[t];if(n.finish(this,e))return}var i=Te(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(i,-e.start).finish(w.Paragraph,e.content.length),e.start)};e.prototype.elt=function(e,t,r,n){if(typeof e=="string")return ce(this.parser.getNodeType(e),t,r,n);return new pe(e,t)};Object.defineProperty(e.prototype,"buffer",{get:function(){return new le(this.parser.nodeSet)},enumerable:false,configurable:true});return e}();function te(e,t,r,n,i){if(i.has(r.tree))return r.tree;var a=e[t].to;var o=[],f=[],h=r.from+n;function l(r,i){while(i?r>=a:r>a){var s=e[t+1].from-a;n+=s;r+=s;t++;a=e[t].to}}for(var u=r.firstChild;u;u=u.nextSibling){l(u.from+n,true);var p=u.from+n,c=void 0;if(u.to+n>a){c=te(e,t,u,n,i);l(u.to+n,false)}else{c=u.toTree()}o.push(c);f.push(p-h)}l(r.to+n,false);return new s(r.type,o,f,r.to+n-h,r.tree?r.tree.propValues:undefined)}var re=function(e){__extends(i,e);function i(t,r,n,i,s,a,o,f,h){var l=e.call(this)||this;l.nodeSet=t;l.blockParsers=r;l.leafBlockParsers=n;l.blockNames=i;l.endLeafBlock=s;l.skipContextMarkup=a;l.inlineParsers=o;l.inlineNames=f;l.wrappers=h;l.nodeTypes=Object.create(null);for(var u=0,p=t.types;u<p.length;u++){var c=p[u];l.nodeTypes[c.name]=c.id}return l}i.prototype.createParse=function(e,t,r){var n=new ee(this,e,t,r);for(var i=0,s=this.wrappers;i<s.length;i++){var a=s[i];n=a(n,e,t,r)}return n};i.prototype.configure=function(e){var s=ie(e);if(!s)return this;var a=this,o=a.nodeSet,f=a.skipContextMarkup;var h=this.blockParsers.slice(),l=this.leafBlockParsers.slice(),u=this.blockNames.slice(),p=this.inlineParsers.slice(),c=this.inlineNames.slice(),d=this.endLeafBlock.slice(),v=this.wrappers;if(ne(s.defineNodes)){f=Object.assign({},f);var g=o.types.slice();var m=function(e){var n=typeof e=="string"?{name:e}:e,i=n.name,s=n.block,a=n.composite;if(g.some((function(e){return e.name==i})))return"continue";if(a)f[g.length]=function(e,t,r){return a(t,r,e.value)};var o=g.length;var h=a?["Block","BlockContext"]:!s?undefined:o>=w.ATXHeading1&&o<=w.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"];g.push(t.define({id:o,name:i,props:h&&[[r.group,h]]}))};for(var k=0,x=s.defineNodes;k<x.length;k++){var y=x[k];m(y)}o=new n(g)}if(ne(s.props))o=o.extend.apply(o,s.props);if(ne(s.remove)){for(var b=0,L=s.remove;b<L.length;b++){var S=L[b];var C=this.blockNames.indexOf(S),A=this.inlineNames.indexOf(S);if(C>-1)h[C]=l[C]=undefined;if(A>-1)p[A]=undefined}}if(ne(s.parseBlock)){for(var T=0,I=s.parseBlock;T<I.length;T++){var B=I[T];var E=u.indexOf(B.name);if(E>-1){h[E]=B.parse;l[E]=B.leaf}else{var M=B.before?se(u,B.before):B.after?se(u,B.after)+1:u.length-1;h.splice(M,0,B.parse);l.splice(M,0,B.leaf);u.splice(M,0,B.name)}if(B.endLeaf)d.push(B.endLeaf)}}if(ne(s.parseInline)){for(var H=0,P=s.parseInline;H<P.length;H++){var O=P[H];var E=c.indexOf(O.name);if(E>-1){p[E]=O.parse}else{var M=O.before?se(c,O.before):O.after?se(c,O.after)+1:c.length-1;p.splice(M,0,O.parse);c.splice(M,0,O.name)}}}if(s.wrap)v=v.concat(s.wrap);return new i(o,h,l,u,d,f,p,c,v)};i.prototype.getNodeType=function(e){var t=this.nodeTypes[e];if(t==null)throw new RangeError("Unknown node type '".concat(e,"'"));return t};i.prototype.parseInline=function(e,t){var r=new Ae(this,e,t);e:for(var n=t;n<r.end;){var i=r.char(n);for(var s=0,a=this.inlineParsers;s<a.length;s++){var o=a[s];if(o){var f=o(r,i,n);if(f>=0){n=f;continue e}}}n++}return r.resolveMarkers(0)};return i}(i);function ne(e){return e!=null&&e.length>0}function ie(e){if(!Array.isArray(e))return e;if(e.length==0)return null;var t=ie(e[0]);if(e.length==1)return t;var r=ie(e.slice(1));if(!r||!t)return t||r;var n=function(e,t){return(e||he).concat(t||he)};var i=t.wrap,s=r.wrap;return{props:n(t.props,r.props),defineNodes:n(t.defineNodes,r.defineNodes),parseBlock:n(t.parseBlock,r.parseBlock),parseInline:n(t.parseInline,r.parseInline),remove:n(t.remove,r.remove),wrap:!i?s:!s?i:function(e,t,r,n){return i(s(e,t,r,n),t,r,n)}}}function se(e,t){var r=e.indexOf(t);if(r<0)throw new RangeError("Position specified relative to unknown parser ".concat(t));return r}var ae=[t.none];for(var oe=1,fe=void 0;fe=w[oe];oe++){ae[oe]=t.define({id:oe,name:fe,props:oe>=w.Escape?[]:[[r.group,oe in I?["Block","BlockContext"]:["Block","LeafBlock"]]]})}var he=[];var le=function(){function e(e){this.nodeSet=e;this.content=[];this.nodes=[]}e.prototype.write=function(e,t,r,n){if(n===void 0){n=0}this.content.push(e,t,r,4+n*4);return this};e.prototype.writeElements=function(e,t){if(t===void 0){t=0}for(var r=0,n=e;r<n.length;r++){var i=n[r];i.writeTo(this,t)}return this};e.prototype.finish=function(e,t){return s.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})};return e}();var ue=function(){function e(e,t,r,n){if(n===void 0){n=he}this.type=e;this.from=t;this.to=r;this.children=n}e.prototype.writeTo=function(e,t){var r=e.content.length;e.writeElements(this.children,t);e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-r)};e.prototype.toTree=function(e){return new le(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)};return e}();var pe=function(){function e(e,t){this.tree=e;this.from=t}Object.defineProperty(e.prototype,"to",{get:function(){return this.from+this.tree.length},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"type",{get:function(){return this.tree.type.id},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"children",{get:function(){return he},enumerable:false,configurable:true});e.prototype.writeTo=function(e,t){e.nodes.push(this.tree);e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)};e.prototype.toTree=function(){return this.tree};return e}();function ce(e,t,r,n){return new ue(e,t,r,n)}var de={resolve:"Emphasis",mark:"EmphasisMark"};var ve={resolve:"Emphasis",mark:"EmphasisMark"};var ge={},me={};var ke=function(){function e(e,t,r,n){this.type=e;this.from=t;this.to=r;this.side=n}return e}();var xe="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";var ye=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{ye=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch(pt){}var be={Escape:function(e,t,r){if(t!=92||r==e.end-1)return-1;var n=e.char(r+1);for(var i=0;i<xe.length;i++)if(xe.charCodeAt(i)==n)return e.append(ce(w.Escape,r,r+2));return-1},Entity:function(e,t,r){if(t!=38)return-1;var n=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(e.slice(r+1,r+31));return n?e.append(ce(w.Entity,r,r+1+n[0].length)):-1},InlineCode:function(e,t,r){if(t!=96||r&&e.char(r-1)==96)return-1;var n=r+1;while(n<e.end&&e.char(n)==96)n++;var i=n-r,s=0;for(;n<e.end;n++){if(e.char(n)==96){s++;if(s==i&&e.char(n+1)!=96)return e.append(ce(w.InlineCode,r,n+1,[ce(w.CodeMark,r,r+i),ce(w.CodeMark,n+1-i,n+1)]))}else{s=0}}return-1},HTMLTag:function(e,t,r){if(t!=60||r==e.end-1)return-1;var n=e.slice(r+1,e.end);var i=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(n);if(i)return e.append(ce(w.URL,r,r+1+i[0].length));var s=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(n);if(s)return e.append(ce(w.Comment,r,r+1+s[0].length));var a=/^\?[^]*?\?>/.exec(n);if(a)return e.append(ce(w.ProcessingInstruction,r,r+1+a[0].length));var o=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(n);if(!o)return-1;return e.append(ce(w.HTMLTag,r,r+1+o[0].length))},Emphasis:function(e,t,r){if(t!=95&&t!=42)return-1;var n=r+1;while(e.char(n)==t)n++;var i=e.slice(r-1,r),s=e.slice(n,n+1);var a=ye.test(i),o=ye.test(s);var f=/\s|^$/.test(i),h=/\s|^$/.test(s);var l=!h&&(!o||f||a);var u=!f&&(!a||h||o);var p=l&&(t==42||!u||a);var c=u&&(t==42||!l||o);return e.append(new ke(t==95?de:ve,r,n,(p?1:0)|(c?2:0)))},HardBreak:function(e,t,r){if(t==92&&e.char(r+1)==10)return e.append(ce(w.HardBreak,r,r+2));if(t==32){var n=r+1;while(e.char(n)==32)n++;if(e.char(n)==10&&n>=r+2)return e.append(ce(w.HardBreak,r,n+1))}return-1},Link:function(e,t,r){return t==91?e.append(new ke(ge,r,r+1,1)):-1},Image:function(e,t,r){return t==33&&e.char(r+1)==91?e.append(new ke(me,r,r+2,1)):-1},LinkEnd:function(e,t,r){if(t!=93)return-1;for(var n=e.parts.length-1;n>=0;n--){var i=e.parts[n];if(i instanceof ke&&(i.type==ge||i.type==me)){if(!i.side||e.skipSpace(i.to)==r&&!/[(\[]/.test(e.slice(r+1,r+2))){e.parts[n]=null;return-1}var s=e.takeContent(n);var a=e.parts[n]=Le(e,s,i.type==ge?w.Link:w.Image,i.from,r+1);if(i.type==ge)for(var o=0;o<n;o++){var f=e.parts[o];if(f instanceof ke&&f.type==ge)f.side=0}return a.to}}return-1}};function Le(e,t,r,n,i){var s=e.text,a=e.char(i),o=i;t.unshift(ce(w.LinkMark,n,n+(r==w.Image?2:1)));t.push(ce(w.LinkMark,i-1,i));if(a==40){var f=e.skipSpace(i+1);var h=Se(s,f-e.offset,e.offset),l=void 0;if(h){f=e.skipSpace(h.to);l=we(s,f-e.offset,e.offset);if(l)f=e.skipSpace(l.to)}if(e.char(f)==41){t.push(ce(w.LinkMark,i,i+1));o=f+1;if(h)t.push(h);if(l)t.push(l);t.push(ce(w.LinkMark,f,o))}}else if(a==91){var u=Ce(s,i-e.offset,e.offset,false);if(u){t.push(u);o=u.to}}return ce(r,n,o,t)}function Se(e,t,r){var n=e.charCodeAt(t);if(n==60){for(var i=t+1;i<e.length;i++){var s=e.charCodeAt(i);if(s==62)return ce(w.URL,t+r,i+1+r);if(s==60||s==10)return false}return null}else{var a=0,i=t;for(var o=false;i<e.length;i++){var s=e.charCodeAt(i);if(B(s)){break}else if(o){o=false}else if(s==40){a++}else if(s==41){if(!a)break;a--}else if(s==92){o=true}}return i>t?ce(w.URL,t+r,i+r):i==e.length?null:false}}function we(e,t,r){var n=e.charCodeAt(t);if(n!=39&&n!=34&&n!=40)return false;var i=n==40?41:n;for(var s=t+1,a=false;s<e.length;s++){var o=e.charCodeAt(s);if(a)a=false;else if(o==i)return ce(w.LinkTitle,t+r,s+1+r);else if(o==92)a=true}return null}function Ce(e,t,r,n){for(var i=false,s=t+1,a=Math.min(e.length,s+999);s<a;s++){var o=e.charCodeAt(s);if(i)i=false;else if(o==93)return n?false:ce(w.LinkLabel,t+r,s+1+r);else{if(n&&!B(o))n=false;if(o==91)return false;else if(o==92)i=true}}return null}var Ae=function(){function e(e,t,r){this.parser=e;this.text=t;this.offset=r;this.parts=[]}e.prototype.char=function(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)};Object.defineProperty(e.prototype,"end",{get:function(){return this.offset+this.text.length},enumerable:false,configurable:true});e.prototype.slice=function(e,t){return this.text.slice(e-this.offset,t-this.offset)};e.prototype.append=function(e){this.parts.push(e);return e.to};e.prototype.addDelimiter=function(e,t,r,n,i){return this.append(new ke(e,t,r,(n?1:0)|(i?2:0)))};e.prototype.addElement=function(e){return this.append(e)};e.prototype.resolveMarkers=function(e){for(var t=e;t<this.parts.length;t++){var r=this.parts[t];if(!(r instanceof ke&&r.type.resolve&&r.side&2))continue;var n=r.type==de||r.type==ve;var i=r.to-r.from;var s=void 0,a=t-1;for(;a>=e;a--){var o=this.parts[a];if(!(o instanceof ke&&o.side&1&&o.type==r.type)||n&&(r.side&1||o.side&2)&&(o.to-o.from+i)%3==0&&((o.to-o.from)%3||i%3))continue;s=o;break}if(!s)continue;var f=r.type.resolve,h=[];var l=s.from,u=r.to;if(n){var p=Math.min(2,s.to-s.from,i);l=s.to-p;u=r.from+p;f=p==1?"Emphasis":"StrongEmphasis"}if(s.type.mark)h.push(this.elt(s.type.mark,l,s.to));for(var c=a+1;c<t;c++){if(this.parts[c]instanceof ue)h.push(this.parts[c]);this.parts[c]=null}if(r.type.mark)h.push(this.elt(r.type.mark,r.from,u));var d=this.elt(f,l,u,h);this.parts[a]=n&&s.from!=l?new ke(s.type,s.from,l,s.side):null;var v=this.parts[t]=n&&r.to!=u?new ke(r.type,u,r.to,r.side):null;if(v)this.parts.splice(t,0,d);else this.parts[t]=d}var g=[];for(var t=e;t<this.parts.length;t++){var o=this.parts[t];if(o instanceof ue)g.push(o)}return g};e.prototype.findOpeningDelimiter=function(e){for(var t=this.parts.length-1;t>=0;t--){var r=this.parts[t];if(r instanceof ke&&r.type==e)return t}return null};e.prototype.takeContent=function(e){var t=this.resolveMarkers(e);this.parts.length=e;return t};e.prototype.skipSpace=function(e){return E(this.text,e-this.offset)+this.offset};e.prototype.elt=function(e,t,r,n){if(typeof e=="string")return ce(this.parser.getNodeType(e),t,r,n);return new pe(e,t)};return e}();function Te(e,t){if(!t.length)return e;if(!e.length)return t;var r=e.slice(),n=0;for(var i=0,s=t;i<s.length;i++){var a=s[i];while(n<r.length&&r[n].to<a.to)n++;if(n<r.length&&r[n].from<a.from){var o=r[n];if(o instanceof ue)r[n]=new ue(o.type,o.from,o.to,Te(o.children,[a]))}else{r.splice(n++,0,a)}}return r}var Ie=[w.CodeBlock,w.ListItem,w.OrderedList,w.BulletList];var Be=function(){function e(e,t){this.fragments=e;this.input=t;this.i=0;this.fragment=null;this.fragmentEnd=-1;this.cursor=null;if(e.length)this.fragment=e[this.i++]}e.prototype.nextFragment=function(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null;this.cursor=null;this.fragmentEnd=-1};e.prototype.moveTo=function(e,t){while(this.fragment&&this.fragment.to<=e)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return false;if(this.fragmentEnd<0){var r=this.fragment.to;while(r>0&&this.input.read(r-1,r)!="\n")r--;this.fragmentEnd=r?r-1:0}var n=this.cursor;if(!n){n=this.cursor=this.fragment.tree.cursor();n.firstChild()}var i=e+this.fragment.offset;while(n.to<=i)if(!n.parent())return false;for(;;){if(n.from>=i)return this.fragment.from<=t;if(!n.childAfter(i))return false}};e.prototype.matches=function(e){var t=this.cursor.tree;return t&&t.prop(r.contextHash)==e};e.prototype.takeNodes=function(e){var t=this.cursor,r=this.fragment.offset,n=this.fragmentEnd-(this.fragment.openEnd?1:0);var i=e.absoluteLineStart,s=i,a=e.block.children.length;var o=s,f=a;for(;;){if(t.to-r>n){if(t.type.isAnonymous&&t.firstChild())continue;break}e.dontInject.add(t.tree);e.addNode(t.tree,t.from-r);if(t.type.is("Block")){if(Ie.indexOf(t.type.id)<0){s=t.to-r;a=e.block.children.length}else{s=o;a=f;o=t.to-r;f=e.block.children.length}}if(!t.nextSibling())break}while(e.block.children.length>a){e.block.children.pop();e.block.positions.pop()}return s-i};return e}();var Ee=new re(new n(ae),Object.keys(Z).map((function(e){return Z[e]})),Object.keys(Z).map((function(e){return J[e]})),Object.keys(Z),W,I,Object.keys(be).map((function(e){return be[e]})),Object.keys(be),[]);function Me(e,t,r){var n=[];for(var i=e.firstChild,s=t;;i=i.nextSibling){var a=i?i.from:r;if(a>s)n.push({from:s,to:a});if(!i)break;s=i.to}return n}function He(e){var t=e.codeParser,r=e.htmlParser;var n=a((function(e,n){var i=e.type.id;if(t&&(i==w.CodeBlock||i==w.FencedCode)){var s="";if(i==w.FencedCode){var a=e.node.getChild(w.CodeInfo);if(a)s=n.read(a.from,a.to)}var o=t(s);if(o)return{parser:o,overlay:function(e){return e.type.id==w.CodeText}}}else if(r&&(i==w.HTMLBlock||i==w.HTMLTag)){return{parser:r,overlay:Me(e.node,e.from,e.to)}}return null}));return{wrap:n}}var Pe={resolve:"Strikethrough",mark:"StrikethroughMark"};var Oe={defineNodes:["Strikethrough","StrikethroughMark"],parseInline:[{name:"Strikethrough",parse:function(e,t,r){if(t!=126||e.char(r+1)!=126)return-1;return e.addDelimiter(Pe,r,r+2,true,true)},after:"Emphasis"}]};function Ne(e,t,r,n,i){if(r===void 0){r=0}if(i===void 0){i=0}var s=0,a=true,o=-1,f=-1,h=false;var l=function(){n.push(e.elt("TableCell",i+o,i+f,e.parser.parseInline(t.slice(o,f),i+o)))};for(var u=r;u<t.length;u++){var p=t.charCodeAt(u);if(p==124&&!h){if(!a||o>-1)s++;a=false;if(n){if(o>-1)l();n.push(e.elt("TableDelimiter",u+i,u+i+1))}o=f=-1}else if(h||p!=32&&p!=9){if(o<0)o=u;f=u+1}h=!h&&p==92}if(o>-1){s++;if(n)l()}return s}function je(e,t){for(var r=t;r<e.length;r++){var n=e.charCodeAt(r);if(n==124)return true;if(n==92)r++}return false}var _e=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;var Re=function(){function e(){this.rows=null}e.prototype.nextLine=function(e,t,r){if(this.rows==null){this.rows=false;var n=void 0;if((t.next==45||t.next==58||t.next==124)&&_e.test(n=t.text.slice(t.pos))){var i=[],s=Ne(e,r.content,0,i,r.start);if(s==Ne(e,n,t.pos))this.rows=[e.elt("TableHeader",r.start,r.start+r.content.length,i),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)]}}else if(this.rows){var a=[];Ne(e,t.text,t.pos,a,e.lineStart);this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,a))}return false};e.prototype.finish=function(e,t){if(!this.rows)return false;e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows));return true};return e}();var Xe={defineNodes:[{name:"Table",block:true},"TableHeader","TableRow","TableCell","TableDelimiter"],parseBlock:[{name:"Table",leaf:function(e,t){return je(t.content,0)?new Re:null},endLeaf:function(e,t,r){if(r.parsers.some((function(e){return e instanceof Re}))||!je(t.text,t.basePos))return false;var n=e.scanLine(e.absoluteLineEnd+1).text;return _e.test(n)&&Ne(e,t.text,t.basePos)==Ne(e,n,t.basePos)},before:"SetextHeading"}]};var ze=function(){function e(){}e.prototype.nextLine=function(){return false};e.prototype.finish=function(e,t){e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,__spreadArray([e.elt("TaskMarker",t.start,t.start+3)],e.parser.parseInline(t.content.slice(3),t.start+3),true)));return true};return e}();var De={defineNodes:[{name:"Task",block:true},"TaskMarker"],parseBlock:[{name:"TaskList",leaf:function(e,t){return/^\[[ xX]\]/.test(t.content)&&e.parentType().name=="ListItem"?new ze:null},after:"SetextHeading"}]};var qe=[Xe,De,Oe];function $e(e,t,r){return function(n,i,s){if(i!=e||n.char(s+1)==e)return-1;var a=[n.elt(r,s,s+1)];for(var o=s+1;o<n.end;o++){var f=n.char(o);if(f==e)return n.addElement(n.elt(t,s,o+1,a.concat(n.elt(r,o,o+1))));if(f==92)a.push(n.elt("Escape",o,o+++2));if(B(f))break}return-1}}var Fe={defineNodes:["Superscript","SuperscriptMark"],parseInline:[{name:"Superscript",parse:$e(94,"Superscript","SuperscriptMark")}]};var Ue={defineNodes:["Subscript","SubscriptMark"],parseInline:[{name:"Subscript",parse:$e(126,"Subscript","SubscriptMark")}]};var Qe={defineNodes:["Emoji"],parseInline:[{name:"Emoji",parse:function(e,t,r){var n;if(t!=58||!(n=/^[a-zA-Z_0-9]+:/.exec(e.slice(r+1,e.end))))return-1;return e.addElement(e.elt("Emoji",r,r+1+n[0].length))}}]};var Ze=c({block:{open:"\x3c!--",close:"--\x3e"}});var Ve=Ee.configure({props:[d({"Blockquote/...":v.quote,HorizontalRule:v.contentSeparator,"ATXHeading1/... SetextHeading1/...":v.heading1,"ATXHeading2/... SetextHeading2/...":v.heading2,"ATXHeading3/...":v.heading3,"ATXHeading4/...":v.heading4,"ATXHeading5/...":v.heading5,"ATXHeading6/...":v.heading6,"Comment CommentBlock":v.comment,Escape:v.escape,Entity:v.character,"Emphasis/...":v.emphasis,"StrongEmphasis/...":v.strong,"Link/... Image/...":v.link,"OrderedList/... BulletList/...":v.list,"BlockQuote/...":v.quote,"InlineCode CodeText":v.monospace,URL:v.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":v.processingInstruction,"CodeInfo LinkLabel":v.labelName,LinkTitle:v.string,Paragraph:v.content}),g.add((function(e){if(!e.is("Block")||e.is("Document"))return undefined;return function(e,t){return{from:t.doc.lineAt(e.from).to,to:e.to}}})),m.add({Document:function(){return null}}),k.add({Document:Ze})]});function Ge(e){return new o(Ze,e,e.nodeSet.types.find((function(e){return e.name=="Document"})))}var Ke=e("commonmarkLanguage",Ge(Ve));var Je=Ve.configure([qe,Ue,Fe,Qe,{props:[d({"TableDelimiter SubscriptMark SuperscriptMark StrikethroughMark":v.processingInstruction,"TableHeader/...":v.heading,"Strikethrough/...":v.strikethrough,TaskMarker:v.atom,Task:v.list,Emoji:v.character,"Subscript Superscript":v.special(v.content),TableCell:v.content})]}]);var We=e("markdownLanguage",Ge(Je));function Ye(e,t){return function(r){var n=r&&x.matchLanguageName(e,r,true);if(!n)return t?t.parser:null;if(n.support)return n.support.language.parser;return y.getSkippingParser(n.load())}}function et(e,t){return t.sliceString(e.from,e.from+50)}var tt=function(){function e(e,t,r,n,i,s,a){this.node=e;this.from=t;this.to=r;this.spaceBefore=n;this.spaceAfter=i;this.type=s;this.item=a}e.prototype.blank=function(e){if(e===void 0){e=true}var t=this.spaceBefore;if(this.node.name=="Blockquote")t+=">";else for(var r=this.to-this.from-t.length-this.spaceAfter.length;r>0;r--)t+=" ";return t+(e?this.spaceAfter:"")};e.prototype.marker=function(e,t){var r=this.node.name=="OrderedList"?String(+nt(this.item,e)[2]+t):"";return this.spaceBefore+r+this.type+this.spaceAfter};return e}();function rt(e,t,r){var n=[];for(var i=e;i&&i.name!="Document";i=i.parent){if(i.name=="ListItem"||i.name=="Blockquote")n.push(i)}var s=[],a=0;for(var o=n.length-1;o>=0;o--){var f=n[o],h=void 0,l=a;if(f.name=="Blockquote"&&(h=/^[ \t]*>( ?)/.exec(t.slice(a)))){a+=h[0].length;s.push(new tt(f,l,a,"",h[1],">",null))}else if(f.name=="ListItem"&&f.parent.name=="OrderedList"&&(h=/^([ \t]*)\d+([.)])([ \t]*)/.exec(et(f,r)))){var u=h[3],p=h[0].length;if(u.length>=4){u=u.slice(0,u.length-4);p-=4}a+=p;s.push(new tt(f.parent,l,a,h[1],u,h[2],f))}else if(f.name=="ListItem"&&f.parent.name=="BulletList"&&(h=/^([ \t]*)([-+*])([ \t]+)/.exec(et(f,r)))){var u=h[3],p=h[0].length;if(u.length>4){u=u.slice(0,u.length-4);p-=4}a+=p;s.push(new tt(f.parent,l,a,h[1],u,h[2],f))}}return s}function nt(e,t){return/^(\s*)(\d+)(?=[.)])/.exec(t.sliceString(e.from,e.from+10))}function it(e,t,r,n){if(n===void 0){n=0}for(var i=-1,s=e;;){if(s.name=="ListItem"){var a=nt(s,t);var o=+a[2];if(i>=0){if(o!=i+1)return;r.push({from:s.from+a[1].length,to:s.from+a[0].length,insert:String(i+2+n)})}i=o}var f=s.nextSibling;if(!f)break;s=f}}var st=e("insertNewlineContinueMarkup",(function(e){var t=e.state,r=e.dispatch;var n=f(t),i=t.doc;var s=null,a=t.changeByRange((function(e){if(!e.empty||!We.isActiveAt(t,e.from))return s={range:e};var r=e.from,a=i.lineAt(r);var o=rt(n.resolveInner(r,-1),a.text,i);while(o.length&&o[o.length-1].from>r-a.from)o.pop();if(!o.length)return s={range:e};var f=o[o.length-1];if(f.to-f.spaceAfter.length>r-a.from)return s={range:e};var l=r>=f.to-f.spaceAfter.length&&!/\S/.test(a.text.slice(f.to));if(f.item&&l){if(f.node.firstChild.to>=r||a.from>0&&!/[^\s>]/.test(i.lineAt(a.from-1).text)){var u=o.length>1?o[o.length-2]:null;var p=void 0,c="";if(u&&u.item){p=a.from+u.from;c=u.marker(i,1)}else{p=a.from+(u?u.to:0)}var d=[{from:p,to:r,insert:c}];if(f.node.name=="OrderedList")it(f.item,i,d,-2);if(u&&u.node.name=="OrderedList")it(u.item,i,d);return{range:h.cursor(p+c.length),changes:d}}else{var v="";for(var g=0,m=o.length-2;g<=m;g++)v+=o[g].blank(g<m);v+=t.lineBreak;return{range:h.cursor(r+v.length),changes:{from:a.from,insert:v}}}}if(f.node.name=="Blockquote"&&l&&a.from){var k=i.lineAt(a.from-1),x=/>\s*$/.exec(k.text);if(x&&x.index==f.from){var y=t.changes([{from:k.from+x.index,to:k.to},{from:a.from+f.from,to:a.to}]);return{range:e.map(y),changes:y}}}var b=[];if(f.node.name=="OrderedList")it(f.item,i,b);var L=t.lineBreak;var S=f.item&&f.item.from<a.from;if(!S||/^[\s\d.)\-+*>]*/.exec(a.text)[0].length>=f.to){for(var g=0,m=o.length-1;g<=m;g++)L+=g==m&&!S?o[g].marker(i,1):o[g].blank()}var w=r;while(w>a.from&&/\s/.test(a.text.charAt(w-a.from-1)))w--;b.push({from:w,to:r,insert:L});return{range:h.cursor(w+L.length),changes:b}}));if(s)return false;r(t.update(a,{scrollIntoView:true,userEvent:"input"}));return true}));function at(e){return e.name=="QuoteMark"||e.name=="ListMark"}function ot(e,t){var r=e.resolveInner(t,-1),n=t;if(at(r)){n=r.from;r=r.parent}for(var i=void 0;i=r.childBefore(n);){if(at(i)){n=i.from}else if(i.name=="OrderedList"||i.name=="BulletList"){r=i.lastChild;n=r.to}else{break}}return r}var ft=e("deleteMarkupBackward",(function(e){var t=e.state,r=e.dispatch;var n=f(t);var i=null,s=t.changeByRange((function(e){var r=e.from,s=t.doc;if(e.empty&&We.isActiveAt(t,e.from)){var a=s.lineAt(r);var o=rt(ot(n,r),a.text,s);if(o.length){var f=o[o.length-1];var l=f.to-f.spaceAfter.length+(f.spaceAfter?1:0);if(r-a.from>l&&!/\S/.test(a.text.slice(l,r-a.from)))return{range:h.cursor(a.from+l),changes:{from:a.from+l,to:r}};if(r-a.from==l){var u=a.from+f.from;if(f.item&&f.node.from<f.item.from&&/\S/.test(a.text.slice(f.from,f.to)))return{range:e,changes:{from:u,to:a.from+f.to,insert:f.blank()}};if(u<r)return{range:h.cursor(u),changes:{from:u,to:r}}}}}return i={range:e}}));if(i)return false;r(t.update(s,{scrollIntoView:true,userEvent:"delete"}));return true}));var ht=e("markdownKeymap",[{key:"Enter",run:st},{key:"Backspace",run:ft}]);var lt=b({matchClosingTags:false});function ut(e){if(e===void 0){e={}}var t=e.codeLanguages,r=e.defaultCodeLanguage,n=e.addKeymap,i=n===void 0?true:n,s=e.base,a=s===void 0?Ke:s,o=a.parser;if(!(o instanceof re))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");var f=e.extensions?[e.extensions]:[];var h=[lt.support],c;if(r instanceof p){h.push(r.support);c=r.language}else if(r){c=r}var d=t||c?Ye(t||[],c):undefined;f.push(He({codeParser:d,htmlParser:lt.language.parser}));if(i)h.push(l.high(u.of(ht)));return new p(Ge(o.configure(f)),h)}}}}));
//# sourceMappingURL=p-e841e0da.system.js.map