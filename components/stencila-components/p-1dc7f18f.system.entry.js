var __extends=this&&this.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]};return e(t,n)};return function(t,n){if(typeof n!=="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();var __makeTemplateObject=this&&this.__makeTemplateObject||function(e,t){if(Object.defineProperty){Object.defineProperty(e,"raw",{value:t})}else{e.raw=t}return e};var __assign=this&&this.__assign||function(){__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i))e[i]=t[i]}return e};return __assign.apply(this,arguments)};var __awaiter=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):i(e.value).then(o,u)}s((r=r.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(e){return function(t){return s([e,t])}}function s(o){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(a=o[0]&2?i["return"]:o[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;if(i=0,a)o=[o[0]&2,a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;i=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(a=n.trys,a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){n.label=o[1];break}if(o[0]===6&&n.label<a[1]){n.label=a[1];a=o;break}if(a&&n.label<a[2]){n.label=a[2];n.ops.push(o);break}if(a[2])n.ops.pop();n.trys.pop();continue}o=t.call(e,n)}catch(u){o=[6,u];i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++){if(a||!(r in t)){if(!a)a=Array.prototype.slice.call(t,0,r);a[r]=t[r]}}return e.concat(a||Array.prototype.slice.call(t))};var __values=this&&this.__values||function(e){var t=typeof Symbol==="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length==="number")return{next:function(){if(e&&r>=e.length)e=void 0;return{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};System.register(["./p-6cc918a4.system.js","./p-b47cb0bd.system.js","./p-f887c8bb.system.js","./p-71a7e6d9.system.js","./p-fcf839e9.system.js"],(function(e){"use strict";var t,n,r,i,a,o,u,s,l,f,c,d,h,p,v,g,m,y,b,x,_,w,A,O,E,k,D,C,F,S,j,M,B,N,T,z,P,R,L,I,U,q,W,H,G,$,V,Y,X,J,Q,Z,K,ee,te,ne,re,ie,ae,oe,ue,se,le,fe,ce,de,he;return{setters:[function(e){t=e.r;n=e.f;r=e.h;i=e.c;a=e.e},function(e){o=e.w;u=e.h;s=e.e;l=e.t;f=e.c;c=e.s;d=e.m;h=e.a;p=e.b;v=e.p;g=e.d;m=e.f;y=e.g;b=e.i;x=e.j;_=e.k;w=e.l;A=e.n;O=e.x;E=e.y;k=e.o;D=e.B;C=e.q;F=e.R;S=e.r;j=e.u;M=e.v;B=e.C;N=e.z;T=e.A;z=e.D;P=e.E;R=e.F;L=e.G;I=e.H;U=e.I;q=e.J;W=e.K;H=e.L;G=e.M;$=e.N;V=e.O;Y=e.P;X=e.Q;J=e.S;Q=e.T;Z=e.U;K=e.V;ee=e.W;te=e.X;ne=e.Y;re=e.Z;ie=e._;ae=e.$;oe=e.a0;ue=e.a1;se=e.a2;le=e.a3;fe=e.a4},function(e){ce=e.c},function(e){de=e.c;he=e.i},function(){}],execute:function(){var pe,ve,ge,me,ye,be,xe,_e,we,Ae,Oe;
/*!
       * https://github.com/Starcounter-Jack/JSON-Patch
       * (c) 2017 Joachim Wester
       * MIT license
       */var Ee=undefined&&undefined.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();var ke=Object.prototype.hasOwnProperty;function De(e,t){return ke.call(e,t)}function Ce(e){if(Array.isArray(e)){var t=new Array(e.length);for(var n=0;n<t.length;n++){t[n]=""+n}return t}if(Object.keys){return Object.keys(e)}var t=[];for(var r in e){if(De(e,r)){t.push(r)}}return t}function Fe(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Se(e){var t=0;var n=e.length;var r;while(t<n){r=e.charCodeAt(t);if(r>=48&&r<=57){t++;continue}return false}return true}function je(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function Me(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Be(e){if(e===undefined){return true}if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++){if(Be(e[t])){return true}}}else if(typeof e==="object"){var r=Ce(e);var i=r.length;for(var t=0;t<i;t++){if(Be(e[r[t]])){return true}}}}return false}function Ne(e,t){var n=[e];for(var r in t){var i=typeof t[r]==="object"?JSON.stringify(t[r],null,2):t[r];if(typeof i!=="undefined"){n.push(r+": "+i)}}return n.join("\n")}var Te=function(e){Ee(t,e);function t(t,n,r,i,a){var o=this.constructor;var u=e.call(this,Ne(t,{name:n,index:r,operation:i,tree:a}))||this;u.name=n;u.index=r;u.operation=i;u.tree=a;Object.setPrototypeOf(u,o.prototype);u.message=Ne(t,{name:n,index:r,operation:i,tree:a});return u}return t}(Error);var ze=Te;var Pe=Fe;var Re={add:function(e,t,n){e[t]=this.value;return{newDocument:n}},remove:function(e,t,n){var r=e[t];delete e[t];return{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];e[t]=this.value;return{newDocument:n,removed:r}},move:function(e,t,n){var r=Ie(n,this.path);if(r){r=Fe(r)}var i=Ue(n,{op:"remove",path:this.from}).removed;Ue(n,{op:"add",path:this.path,value:i});return{newDocument:n,removed:r}},copy:function(e,t,n){var r=Ie(n,this.from);Ue(n,{op:"add",path:this.path,value:Fe(r)});return{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:$e(e[t],this.value)}},_get:function(e,t,n){this.value=e[t];return{newDocument:n}}};var Le={add:function(e,t,n){if(Se(t)){e.splice(t,0,this.value)}else{e[t]=this.value}return{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];e[t]=this.value;return{newDocument:n,removed:r}},move:Re.move,copy:Re.copy,test:Re.test,_get:Re._get};function Ie(e,t){if(t==""){return e}var n={op:"_get",path:t};Ue(e,n);return n.value}function Ue(e,t,n,r,i,a){if(n===void 0){n=false}if(r===void 0){r=true}if(i===void 0){i=true}if(a===void 0){a=0}if(n){if(typeof n=="function"){n(t,0,e,t.path)}else{He(t,0)}}if(t.path===""){var o={newDocument:e};if(t.op==="add"){o.newDocument=t.value;return o}else if(t.op==="replace"){o.newDocument=t.value;o.removed=e;return o}else if(t.op==="move"||t.op==="copy"){o.newDocument=Ie(e,t.from);if(t.op==="move"){o.removed=e}return o}else if(t.op==="test"){o.test=$e(e,t.value);if(o.test===false){throw new ze("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}o.newDocument=e;return o}else if(t.op==="remove"){o.removed=e;o.newDocument=null;return o}else if(t.op==="_get"){t.value=e;return o}else{if(n){throw new ze("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e)}else{return o}}}else{if(!r){e=Fe(e)}var u=t.path||"";var s=u.split("/");var l=e;var f=1;var c=s.length;var d=undefined;var h=void 0;var p=void 0;if(typeof n=="function"){p=n}else{p=He}while(true){h=s[f];if(h&&h.indexOf("~")!=-1){h=Me(h)}if(i&&h=="__proto__"){throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README")}if(n){if(d===undefined){if(l[h]===undefined){d=s.slice(0,f).join("/")}else if(f==c-1){d=t.path}if(d!==undefined){p(t,0,e,d)}}}f++;if(Array.isArray(l)){if(h==="-"){h=l.length}else{if(n&&!Se(h)){throw new ze("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e)}else if(Se(h)){h=~~h}}if(f>=c){if(n&&t.op==="add"&&h>l.length){throw new ze("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e)}var o=Le[t.op].call(t,l,h,e);if(o.test===false){throw new ze("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}return o}}else{if(f>=c){var o=Re[t.op].call(t,l,h,e);if(o.test===false){throw new ze("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}return o}}l=l[h];if(n&&f<c&&(!l||typeof l!=="object")){throw new ze("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}}function qe(e,t,n,r,i){if(r===void 0){r=true}if(i===void 0){i=true}if(n){if(!Array.isArray(t)){throw new ze("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}}if(!r){e=Fe(e)}var a=new Array(t.length);for(var o=0,u=t.length;o<u;o++){a[o]=Ue(e,t[o],n,true,i,o);e=a[o].newDocument}a.newDocument=e;return a}function We(e,t,n){var r=Ue(e,t);if(r.test===false){throw new ze("Test operation failed","TEST_OPERATION_FAILED",n,t,e)}return r.newDocument}function He(e,t,n,r){if(typeof e!=="object"||e===null||Array.isArray(e)){throw new ze("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n)}else if(!Re[e.op]){throw new ze("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}else if(typeof e.path!=="string"){throw new ze("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n)}else if(e.path.indexOf("/")!==0&&e.path.length>0){throw new ze('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n)}else if((e.op==="move"||e.op==="copy")&&typeof e.from!=="string"){throw new ze("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===undefined){throw new ze("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&Be(e.value)){throw new ze("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n)}else if(n){if(e.op=="add"){var i=e.path.split("/").length;var a=r.split("/").length;if(i!==a+1&&i!==a){throw new ze("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r){throw new ze("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:undefined};var u=Ge([o],n);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE"){throw new ze("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}}function Ge(e,t,n){try{if(!Array.isArray(e)){throw new ze("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}if(t){qe(Fe(t),Fe(e),n||true)}else{n=n||He;for(var r=0;r<e.length;r++){n(e[r],r,t,undefined)}}}catch(Bse){if(Bse instanceof ze){return Bse}else{throw Bse}}}function $e(e,t){if(e===t)return true;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){a=e.length;if(a!=t.length)return false;for(i=a;i--!==0;)if(!$e(e[i],t[i]))return false;return true}if(n!=r)return false;var u=Object.keys(e);a=u.length;if(a!==Object.keys(t).length)return false;for(i=a;i--!==0;)if(!t.hasOwnProperty(u[i]))return false;for(i=a;i--!==0;){o=u[i];if(!$e(e[o],t[o]))return false}return true}return e!==e&&t!==t}var Ve=Object.freeze({__proto__:null,JsonPatchError:ze,deepClone:Pe,getValueByPointer:Ie,applyOperation:Ue,applyPatch:qe,applyReducer:We,validator:He,validate:Ge,_areEquals:$e});
/*!
       * https://github.com/Starcounter-Jack/JSON-Patch
       * (c) 2017 Joachim Wester
       * MIT license
       */var Ye=new WeakMap;var Xe=function(){function e(e){this.observers=new Map;this.obj=e}return e}();var Je=function(){function e(e,t){this.callback=e;this.observer=t}return e}();function Qe(e){return Ye.get(e)}function Ze(e,t){return e.observers.get(t)}function Ke(e,t){e.observers.delete(t.callback)}function et(e,t){t.unobserve()}function tt(e,t){var n=[];var r;var i=Qe(e);if(!i){i=new Xe(e);Ye.set(e,i)}else{var a=Ze(i,t);r=a&&a.observer}if(r){return r}r={};i.value=Fe(e);if(t){r.callback=t;r.next=null;var o=function(){nt(r)};var u=function(){clearTimeout(r.next);r.next=setTimeout(o)};if(typeof window!=="undefined"){window.addEventListener("mouseup",u);window.addEventListener("keyup",u);window.addEventListener("mousedown",u);window.addEventListener("keydown",u);window.addEventListener("change",u)}}r.patches=n;r.object=e;r.unobserve=function(){nt(r);clearTimeout(r.next);Ke(i,r);if(typeof window!=="undefined"){window.removeEventListener("mouseup",u);window.removeEventListener("keyup",u);window.removeEventListener("mousedown",u);window.removeEventListener("keydown",u);window.removeEventListener("change",u)}};i.observers.set(t,new Je(t,r));return r}function nt(e,t){if(t===void 0){t=false}var n=Ye.get(e.object);rt(n.value,e.object,e.patches,"",t);if(e.patches.length){qe(n.value,e.patches)}var r=e.patches;if(r.length>0){e.patches=[];if(e.callback){e.callback(r)}}return r}function rt(e,t,n,r,i){if(t===e){return}if(typeof t.toJSON==="function"){t=t.toJSON()}var a=Ce(t);var o=Ce(e);var u=false;for(var s=o.length-1;s>=0;s--){var l=o[s];var f=e[l];if(De(t,l)&&!(t[l]===undefined&&f!==undefined&&Array.isArray(t)===false)){var c=t[l];if(typeof f=="object"&&f!=null&&typeof c=="object"&&c!=null&&Array.isArray(f)===Array.isArray(c)){rt(f,c,n,r+"/"+je(l),i)}else{if(f!==c){if(i){n.push({op:"test",path:r+"/"+je(l),value:Fe(f)})}n.push({op:"replace",path:r+"/"+je(l),value:Fe(c)})}}}else if(Array.isArray(e)===Array.isArray(t)){if(i){n.push({op:"test",path:r+"/"+je(l),value:Fe(f)})}n.push({op:"remove",path:r+"/"+je(l)});u=true}else{if(i){n.push({op:"test",path:r,value:e})}n.push({op:"replace",path:r,value:t})}}if(!u&&a.length==o.length){return}for(var s=0;s<a.length;s++){var l=a[s];if(!De(e,l)&&t[l]!==undefined){n.push({op:"add",path:r+"/"+je(l),value:Fe(t[l])})}}}function it(e,t,n){if(n===void 0){n=false}var r=[];rt(e,t,r,"",n);return r}var at=Object.freeze({__proto__:null,unobserve:et,observe:tt,generate:nt,compare:it});Object.assign({},Ve,at,{JsonPatchError:Te,deepClone:Fe,escapePathComponent:je,unescapePathComponent:Me});var ot=/("(?:[^\\"]|\\.)*")|[:,]/g;var ut=function e(t,n){var r,i,a;n=n||{};r=JSON.stringify([1],undefined,n.indent===undefined?2:n.indent).slice(2,-3);i=r===""?Infinity:n.maxLength===undefined?80:n.maxLength;a=n.replacer;return function e(t,n,o){var u,s,l,f,c,d,h,p,v,g,m,y;if(t&&typeof t.toJSON==="function"){t=t.toJSON()}m=JSON.stringify(t,a);if(m===undefined){return m}h=i-n.length-o;if(m.length<=h){v=m.replace(ot,(function(e,t){return t||e+" "}));if(v.length<=h){return v}}if(a!=null){t=JSON.parse(m);a=undefined}if(typeof t==="object"&&t!==null){p=n+r;l=[];s=0;if(Array.isArray(t)){g="[";u="]";h=t.length;for(;s<h;s++){l.push(e(t[s],p,s===h-1?0:1)||"null")}}else{g="{";u="}";d=Object.keys(t);h=d.length;for(;s<h;s++){f=d[s];c=JSON.stringify(f)+": ";y=e(t[f],p,c.length+(s===h-1?0:1));if(y!==undefined){l.push(c+y)}}}if(l.length>0){return[g,r+l.join(",\n"+p),u].join("\n"+n)}}return m}(t,"",0)};function st(e,t,n){e.fields=t||[];e.fname=n;return e}function lt(e){return e==null?null:e.fname}function ft(e){return e==null?null:e.fields}function ct(e){return e.length===1?dt(e[0]):ht(e)}var dt=function(e){return function(t){return t[e]}};var ht=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r){n=n[e[r]]}return n}};function pt(e){throw Error(e)}function vt(e){var t=[],n=e.length;var r=null,i=0,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<n;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u++);o=u}else if(s===r){l();r=null;i=-1}else if(r){continue}else if(o===i&&s==='"'){o=u+1;r=s}else if(o===i&&s==="'"){o=u+1;r=s}else if(s==="."&&!i){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();i=o=u+1}else if(s==="]"){if(!i)pt("Access path missing open bracket: "+e);if(i>0)l();i=0;o=u+1}}if(i)pt("Access path missing closing bracket: "+e);if(r)pt("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}function gt(e,t,n){var r=vt(e);e=r.length===1?r[0]:e;return st((n&&n.get||ct)(r),[e],t||e)}var mt=gt("id");var yt=st((function(e){return e}),[],"identity");var bt=st((function(){return 0}),[],"zero");var xt=st((function(){return 1}),[],"one");var _t=st((function(){return true}),[],"true");var wt=st((function(){return false}),[],"false");function At(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var Ot=0;var Et=1;var kt=2;var Dt=3;var Ct=4;function Ft(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:At;var r=e||Ot;return{level:function(e){if(arguments.length){r=+e;return this}else{return r}},error:function(){if(r>=Et)n(t||"error","ERROR",arguments);return this},warn:function(){if(r>=kt)n(t||"warn","WARN",arguments);return this},info:function(){if(r>=Dt)n(t||"log","INFO",arguments);return this},debug:function(){if(r>=Ct)n(t||"log","DEBUG",arguments);return this}}}var St=Array.isArray;function jt(e){return e===Object(e)}var Mt=function(e){return e!=="__proto__"};function Bt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}return t.reduce((function(e,t){for(var n in t){if(n==="signals"){e.signals=Tt(e.signals,t.signals)}else{var r=n==="legend"?{layout:1}:n==="style"?true:null;Nt(e,n,t[n],r)}}return e}),{})}function Nt(e,t,n,r){if(!Mt(t))return;var i,a;if(jt(n)&&!St(n)){a=jt(e[t])?e[t]:e[t]={};for(i in n){if(r&&(r===true||r[i])){Nt(a,i,n[i])}else if(Mt(i)){a[i]=n[i]}}}else{e[t]=n}}function Tt(e,t){if(e==null)return t;var n={},r=[];function i(e){if(!n[e.name]){n[e.name]=1;r.push(e)}}t.forEach(i);e.forEach(i);return r}function zt(e){return e[e.length-1]}function Pt(e){return e==null||e===""?null:+e}var Rt=function(e){return function(t){return e*Math.exp(t)}};var Lt=function(e){return function(t){return Math.log(e*t)}};var It=function(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}};var Ut=function(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}};var qt=function(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}};function Wt(e,t,n,r){var i=n(e[0]),a=n(zt(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function Ht(e,t){return Wt(e,t,Pt,yt)}function Gt(e,t){var n=Math.sign(e[0]);return Wt(e,t,Lt(n),Rt(n))}function $t(e,t,n){return Wt(e,t,qt(n),qt(1/n))}function Vt(e,t,n){return Wt(e,t,It(n),Ut(n))}function Yt(e,t,n,r,i){var a=r(e[0]),o=r(zt(e)),u=t!=null?r(t):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function Xt(e,t,n){return Yt(e,t,n,Pt,yt)}function Jt(e,t,n){var r=Math.sign(e[0]);return Yt(e,t,n,Lt(r),Rt(r))}function Qt(e,t,n,r){return Yt(e,t,n,qt(r),qt(1/r))}function Zt(e,t,n,r){return Yt(e,t,n,It(r),Ut(r))}function Kt(e){return 1+~~(new Date(e).getMonth()/3)}function en(e){return 1+~~(new Date(e).getUTCMonth()/3)}function tn(e){return e!=null?St(e)?e:[e]:[]}function nn(e,t,n){var r=e[0],i=e[1],a;if(i<r){a=i;i=r;r=a}a=i-r;return a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function rn(e){return typeof e==="function"}var an="descending";function on(e,t,n){n=n||{};t=tn(t)||[];var r=[],i=[],a={},o=n.comparator||sn;tn(e).forEach((function(e,o){if(e==null)return;r.push(t[o]===an?-1:1);i.push(e=rn(e)?e:gt(e,null,n));(ft(e)||[]).forEach((function(e){return a[e]=1}))}));return i.length===0?null:st(o(i,r),Object.keys(a))}var un=function(e,t){return(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0};var sn=function(e,t){return e.length===1?ln(e[0],t[0]):fn(e,t,e.length)};var ln=function(e,t){return function(n,r){return un(e(n),e(r))*t}};var fn=function(e,t,n){t.push(0);return function(r,i){var a,o=0,u=-1;while(o===0&&++u<n){a=e[u];o=un(a(r),a(i))}return o*t[u]}};function cn(e){return rn(e)?e:function(){return e}}function dn(e,t){var n;return function(r){if(n)clearTimeout(n);n=setTimeout((function(){return t(r),n=null}),e)}}function hn(e){for(var t,n=void 0,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function pn(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}function vn(e,t){var n=e.length;var r=-1,i,a,o,u,s;if(t==null){while(++r<n){a=e[r];if(a!=null&&a>=a){i=o=a;break}}if(r===n)return[-1,-1];u=s=r;while(++r<n){a=e[r];if(a!=null){if(i>a){i=a;u=r}if(o<a){o=a;s=r}}}}else{while(++r<n){a=t(e[r],r,e);if(a!=null&&a>=a){i=o=a;break}}if(r===n)return[-1,-1];u=s=r;while(++r<n){a=t(e[r],r,e);if(a!=null){if(i>a){i=a;u=r}if(o<a){o=a;s=r}}}}return[u,s]}var gn=Object.prototype.hasOwnProperty;function mn(e,t){return gn.call(e,t)}var yn={};function bn(e){var t={},n;function r(e){return mn(t,e)&&t[e]!==yn}var i={size:0,empty:0,object:t,has:r,get:function(e){return r(e)?t[e]:undefined},set:function(e,n){if(!r(e)){++i.size;if(t[e]===yn)--i.empty}t[e]=n;return this},delete:function(e){if(r(e)){--i.size;++i.empty;t[e]=yn}return this},clear:function(){i.size=i.empty=0;i.object=t={}},test:function(e){if(arguments.length){n=e;return i}else{return n}},clean:function(){var e={};var r=0;for(var a in t){var o=t[a];if(o!==yn&&(!n||!n(o))){e[a]=o;++r}}i.size=r;i.empty=0;i.object=t=e}};if(e)Object.keys(e).forEach((function(t){i.set(t,e[t])}));return i}function xn(e,t,n,r,i,a){if(!n&&n!==0)return a;var o=+n;var u=e[0],s=zt(e),l;if(s<u){l=u;u=s;s=l}l=Math.abs(t-u);var f=Math.abs(s-t);return l<f&&l<=o?r:f<=o?i:a}function _n(e,t,n){var r=e.prototype=Object.create(t.prototype);Object.defineProperty(r,"constructor",{value:e,writable:true,enumerable:true,configurable:true});return hn(r,n)}function wn(e,t,n,r){var i=t[0],a=t[t.length-1],o;if(i>a){o=i;i=a;a=o}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)}function An(e){return typeof e==="boolean"}function On(e){return Object.prototype.toString.call(e)==="[object Date]"}function En(e){return e&&rn(e[Symbol.iterator])}function kn(e){return typeof e==="number"}function Dn(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Cn(e){return typeof e==="string"}function Fn(e,t,n){if(e){e=t?tn(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):tn(e)}var r=e&&e.length,i=n&&n.get||ct,a=function(e){return i(t?[e]:vt(e))};var o;if(!r){o=function(){return""}}else if(r===1){var u=a(e[0]);o=function(e){return""+u(e)}}else{var s=e.map(a);o=function(e){var t=""+s[0](e),n=0;while(++n<r)t+="|"+s[n](e);return t}}return st(o,e,"key")}function Sn(e,t){var n=e[0],r=zt(e),i=+t;return!i?n:i===1?r:n+i*(r-n)}var jn=1e4;function Mn(e){e=+e||jn;var t,n,r;var i=function(){t={};n={};r=0};var a=function(i,a){if(++r>e){n=t;t={};r=1}return t[i]=a};i();return{clear:i,has:function(e){return mn(t,e)||mn(n,e)},get:function(e){return mn(t,e)?t[e]:mn(n,e)?a(e,n[e]):undefined},set:function(e,n){return mn(t,e)?t[e]=n:a(e,n)}}}function Bn(e,t,n,r){var i=t.length,a=n.length;if(!a)return t;if(!i)return n;var o=r||new t.constructor(i+a);var u=0,s=0,l=0;for(;u<i&&s<a;++l){o[l]=e(t[u],n[s])>0?n[s++]:t[u++]}for(;u<i;++u,++l){o[l]=t[u]}for(;s<a;++s,++l){o[l]=n[s]}return o}function Nn(e,t){var n="";while(--t>=0)n+=e;return n}function Tn(e,t,n,r){var i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?Nn(i,o)+a:r==="center"?Nn(i,~~(o/2))+a+Nn(i,Math.ceil(o/2)):a+Nn(i,o)}function zn(e){return e&&zt(e)-e[0]||0}function Pn(e){return St(e)?"["+e.map(Pn)+"]":jt(e)||Cn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Rn(e){return e==null||e===""?null:!e||e==="false"||e==="0"?false:!!e}var Ln=function(e){return kn(e)?e:On(e)?e:Date.parse(e)};function In(e,t){t=t||Ln;return e==null||e===""?null:t(e)}function Un(e){return e==null||e===""?null:e+""}function qn(e){var t={},n=e.length;for(var r=0;r<n;++r)t[e[r]]=true;return t}function Wn(e,t,n,r){var i=r!=null?r:"…",a=e+"",o=a.length,u=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i}function Hn(e,t,n){if(e){if(t){var r=e.length;for(var i=0;i<r;++i){var a=t(e[i]);if(a)n(a,i,e)}}else{e.forEach(n)}}}var Gn={},$n={},Vn=34,Yn=10,Xn=13;function Jn(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Qn(e,t){var n=Jn(e);return function(r,i){return t(n(r),i,e)}}function Zn(e){var t=Object.create(null),n=[];e.forEach((function(e){for(var r in e){if(!(r in t)){n.push(t[r]=r)}}}));return n}function Kn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function er(e){return e<0?"-"+Kn(-e,6):e>9999?"+"+Kn(e,6):Kn(e,4)}function tr(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":er(e.getUTCFullYear())+"-"+Kn(e.getUTCMonth()+1,2)+"-"+Kn(e.getUTCDate(),2)+(i?"T"+Kn(t,2)+":"+Kn(n,2)+":"+Kn(r,2)+"."+Kn(i,3)+"Z":r?"T"+Kn(t,2)+":"+Kn(n,2)+":"+Kn(r,2)+"Z":n||t?"T"+Kn(t,2)+":"+Kn(n,2)+"Z":"")}function nr(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var n,r,a=i(e,(function(e,i){if(n)return n(e,i-1);r=e,n=t?Qn(e,t):Jn(e)}));a.columns=r||[];return a}function i(e,t){var r=[],i=e.length,a=0,o=0,u,s=i<=0,l=false;if(e.charCodeAt(i-1)===Yn)--i;if(e.charCodeAt(i-1)===Xn)--i;function f(){if(s)return $n;if(l)return l=false,Gn;var t,r=a,o;if(e.charCodeAt(r)===Vn){while(a++<i&&e.charCodeAt(a)!==Vn||e.charCodeAt(++a)===Vn);if((t=a)>=i)s=true;else if((o=e.charCodeAt(a++))===Yn)l=true;else if(o===Xn){l=true;if(e.charCodeAt(a)===Yn)++a}return e.slice(r+1,t-1).replace(/""/g,'"')}while(a<i){if((o=e.charCodeAt(t=a++))===Yn)l=true;else if(o===Xn){l=true;if(e.charCodeAt(a)===Yn)++a}else if(o!==n)continue;return e.slice(r,t)}return s=true,e.slice(r,i)}while((u=f())!==$n){var c=[];while(u!==Gn&&u!==$n)c.push(u),u=f();if(t&&(c=t(c,o++))==null)continue;r.push(c)}return r}function a(t,n){return t.map((function(t){return n.map((function(e){return f(t[e])})).join(e)}))}function o(t,n){if(n==null)n=Zn(t);return[n.map(f).join(e)].concat(a(t,n)).join("\n")}function u(e,t){if(t==null)t=Zn(e);return a(e,t).join("\n")}function s(e){return e.map(l).join("\n")}function l(t){return t.map(f).join(e)}function f(e){return e==null?"":e instanceof Date?tr(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:r,parseRows:i,format:o,formatBody:u,formatRows:s,formatRow:l,formatValue:f}}function rr(e){return e}function ir(e){if(e==null)return rr;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(e,u){if(!u)t=n=0;var s=2,l=e.length,f=new Array(l);f[0]=(t+=e[0])*r+a;f[1]=(n+=e[1])*i+o;while(s<l)f[s]=e[s],++s;return f}}function ar(e,t){var n,r=e.length,i=r-t;while(i<--r)n=e[i],e[i++]=e[r],e[r]=n}function or(e,t){if(typeof t==="string")t=e.objects[t];return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map((function(t){return ur(e,t)}))}:ur(e,t)}function ur(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=sr(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function sr(e,t){var n=ir(e.transform),r=e.arcs;function i(e,t){if(t.length)t.pop();for(var i=r[e<0?~e:e],a=0,o=i.length;a<o;++a){t.push(n(i[a],a))}if(e<0)ar(t,o)}function a(e){return n(e)}function o(e){var t=[];for(var n=0,r=e.length;n<r;++n)i(e[n],t);if(t.length<2)t.push(t[0]);return t}function u(e){var t=o(e);while(t.length<4)t.push(t[0]);return t}function s(e){return e.map(u)}function l(e){var t=e.type,n;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(l)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=o(e.arcs);break;case"MultiLineString":n=e.arcs.map(o);break;case"Polygon":n=s(e.arcs);break;case"MultiPolygon":n=e.arcs.map(s);break;default:return null}return{type:t,coordinates:n}}return l(t)}function lr(e,t){var n={},r={},i={},a=[],o=-1;t.forEach((function(n,r){var i=e.arcs[n<0?~n:n],a;if(i.length<3&&!i[1][0]&&!i[1][1]){a=t[++o],t[o]=n,t[r]=a}}));t.forEach((function(e){var t=u(e),n=t[0],a=t[1],o,s;if(o=i[n]){delete i[o.end];o.push(e);o.end=a;if(s=r[a]){delete r[s.start];var l=s===o?o:o.concat(s);r[l.start=o.start]=i[l.end=s.end]=l}else{r[o.start]=i[o.end]=o}}else if(o=r[a]){delete r[o.start];o.unshift(e);o.start=n;if(s=i[n]){delete i[s.end];var f=s===o?o:s.concat(o);r[f.start=s.start]=i[f.end=o.end]=f}else{r[o.start]=i[o.end]=o}}else{o=[e];r[o.start=n]=i[o.end=a]=o}}));function u(t){var n=e.arcs[t<0?~t:t],r=n[0],i;if(e.transform)i=[0,0],n.forEach((function(e){i[0]+=e[0],i[1]+=e[1]}));else i=n[n.length-1];return t<0?[i,r]:[r,i]}function s(e,t){for(var r in e){var i=e[r];delete t[i.start];delete i.start;delete i.end;i.forEach((function(e){n[e<0?~e:e]=1}));a.push(i)}}s(i,r);s(r,i);t.forEach((function(e){if(!n[e<0?~e:e])a.push([e])}));return a}function fr(e){return sr(e,cr.apply(this,arguments))}function cr(e,t,n){var r,i,a;if(arguments.length>1)r=dr(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:lr(e,r)}}function dr(e,t,n){var r=[],i=[],a;function o(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:a})}function u(e){e.forEach(o)}function s(e){e.forEach(u)}function l(e){e.forEach(s)}function f(e){switch(a=e,e.type){case"GeometryCollection":e.geometries.forEach(f);break;case"LineString":u(e.arcs);break;case"MultiLineString":case"Polygon":s(e.arcs);break;case"MultiPolygon":l(e.arcs);break}}f(t);i.forEach(n==null?function(e){r.push(e[0].i)}:function(e){if(n(e[0].g,e[e.length-1].g))r.push(e[0].i)});return r}function hr(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function pr(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function vr(e){var t,n,r;if(e.length!==2){t=hr;n=function(t,n){return hr(e(t),n)};r=function(t,n){return e(t)-n}}else{t=e===hr||e===pr?e:gr;n=e;r=e}function i(e,r,i,a){if(i===void 0){i=0}if(a===void 0){a=e.length}if(i<a){if(t(r,r)!==0)return a;do{var o=i+a>>>1;if(n(e[o],r)<0)i=o+1;else a=o}while(i<a)}return i}function a(e,r,i,a){if(i===void 0){i=0}if(a===void 0){a=e.length}if(i<a){if(t(r,r)!==0)return a;do{var o=i+a>>>1;if(n(e[o],r)<=0)i=o+1;else a=o}while(i<a)}return i}function o(e,t,n,a){if(n===void 0){n=0}if(a===void 0){a=e.length}var o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o}return{left:i,center:o,right:a}}function gr(){return 0}function mr(e){return e===null?NaN:+e}function yr(e,t){var n,r,i,a,o,u,s;return __generator(this,(function(l){switch(l.label){case 0:if(!(t===undefined))return[3,5];n=0,r=e;l.label=1;case 1:if(!(n<r.length))return[3,4];i=r[n];if(!(i!=null&&(i=+i)>=i))return[3,3];return[4,i];case 2:l.sent();l.label=3;case 3:n++;return[3,1];case 4:return[3,9];case 5:a=-1;o=0,u=e;l.label=6;case 6:if(!(o<u.length))return[3,9];s=u[o];if(!((s=t(s,++a,e))!=null&&(s=+s)>=s))return[3,8];return[4,s];case 7:l.sent();l.label=8;case 8:o++;return[3,6];case 9:return[2]}}))}var br=vr(hr);var xr=br.right;var _r=br.left;vr(mr).center;function wr(e,t){var n=0;var r;var i=0;var a=0;if(t===undefined){for(var o=0,u=e;o<u.length;o++){var s=u[o];if(s!=null&&(s=+s)>=s){r=s-i;i+=r/++n;a+=r*(s-i)}}}else{var l=-1;for(var f=0,c=e;f<c.length;f++){var d=c[f];if((d=t(d,++l,e))!=null&&(d=+d)>=d){r=d-i;i+=r/++n;a+=r*(d-i)}}}if(n>1)return a/(n-1)}function Ar(e,t){var n=wr(e,t);return n?Math.sqrt(n):n}var Or=function(){function e(){this._partials=new Float64Array(32);this._n=0}e.prototype.add=function(e){var t=this._partials;var n=0;for(var r=0;r<this._n&&r<32;r++){var i=t[r],a=e+i,o=Math.abs(e)<Math.abs(i)?e-(a-i):i-(a-e);if(o)t[n++]=o;e=a}t[n]=e;this._n=n+1;return this};e.prototype.valueOf=function(){var e=this._partials;var t=this._n,n,r,i,a=0;if(t>0){a=e[--t];while(t>0){n=a;r=e[--t];a=n+r;i=r-(a-n);if(i)break}if(t>0&&(i<0&&e[t-1]<0||i>0&&e[t-1]>0)){r=i*2;n=a+r;if(r==n-a)a=n}}return a};return e}();var Er=function(e){Ee(t,e);function t(t,n){if(n===void 0){n=Sr}var r=e.call(this)||this;Object.defineProperties(r,{_intern:{value:new Map},_key:{value:n}});if(t!=null)for(var i=0,a=t;i<a.length;i++){var o=a[i],u=o[0],s=o[1];r.set(u,s)}return r}t.prototype.get=function(t){return e.prototype.get.call(this,Dr(this,t))};t.prototype.has=function(t){return e.prototype.has.call(this,Dr(this,t))};t.prototype.set=function(t,n){return e.prototype.set.call(this,Cr(this,t),n)};t.prototype.delete=function(t){return e.prototype.delete.call(this,Fr(this,t))};return t}(Map);var kr=function(e){Ee(t,e);function t(t,n){if(n===void 0){n=Sr}var r=e.call(this)||this;Object.defineProperties(r,{_intern:{value:new Map},_key:{value:n}});if(t!=null)for(var i=0,a=t;i<a.length;i++){var o=a[i];r.add(o)}return r}t.prototype.has=function(t){return e.prototype.has.call(this,Dr(this,t))};t.prototype.add=function(t){return e.prototype.add.call(this,Cr(this,t))};t.prototype.delete=function(t){return e.prototype.delete.call(this,Fr(this,t))};return t}(Set);function Dr(e,t){var n=e._intern,r=e._key;var i=r(t);return n.has(i)?n.get(i):t}function Cr(e,t){var n=e._intern,r=e._key;var i=r(t);if(n.has(i))return n.get(i);n.set(i,t);return t}function Fr(e,t){var n=e._intern,r=e._key;var i=r(t);if(n.has(i)){t=n.get(i);n.delete(i)}return t}function Sr(e){return e!==null&&typeof e==="object"?e.valueOf():e}function jr(e,t){return Array.from(t,(function(t){return e[t]}))}function Mr(e){if(e===void 0){e=hr}if(e===hr)return Br;if(typeof e!=="function")throw new TypeError("compare is not a function");return function(t,n){var r=e(t,n);if(r||r===0)return r;return(e(n,n)===0)-(e(t,t)===0)}}function Br(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var Nr=Math.sqrt(50),Tr=Math.sqrt(10),zr=Math.sqrt(2);function Pr(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Nr?10:a>=Tr?5:a>=zr?2:1;var u,s,l;if(i<0){l=Math.pow(10,-i)/o;u=Math.round(e*l);s=Math.round(t*l);if(u/l<e)++u;if(s/l>t)--s;l=-l}else{l=Math.pow(10,i)*o;u=Math.round(e/l);s=Math.round(t/l);if(u*l<e)++u;if(s*l>t)--s}if(s<u&&.5<=n&&n<2)return Pr(e,t,n*2);return[u,s,l]}function Rr(e,t,n){t=+t,e=+e,n=+n;if(!(n>0))return[];if(e===t)return[e];var r=t<e,i=r?Pr(t,e,n):Pr(e,t,n),a=i[0],o=i[1],u=i[2];if(!(o>=a))return[];var s=o-a+1,l=new Array(s);if(r){if(u<0)for(var f=0;f<s;++f)l[f]=(o-f)/-u;else for(var f=0;f<s;++f)l[f]=(o-f)*u}else{if(u<0)for(var f=0;f<s;++f)l[f]=(a+f)/-u;else for(var f=0;f<s;++f)l[f]=(a+f)*u}return l}function Lr(e,t,n){t=+t,e=+e,n=+n;return Pr(e,t,n)[2]}function Ir(e,t,n){t=+t,e=+e,n=+n;var r=t<e,i=r?Lr(t,e,n):Lr(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Ur(e,t){var n;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a!=null&&(n<a||n===undefined&&a>=a)){n=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if((l=t(l,++o,e))!=null&&(n<l||n===undefined&&l>=l)){n=l}}}return n}function qr(e,t){var n;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a!=null&&(n>a||n===undefined&&a>=a)){n=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if((l=t(l,++o,e))!=null&&(n>l||n===undefined&&l>=l)){n=l}}}return n}function Wr(e,t,n,r,i){if(n===void 0){n=0}if(r===void 0){r=Infinity}t=Math.floor(t);n=Math.floor(Math.max(0,n));r=Math.floor(Math.min(e.length-1,r));if(!(n<=t&&t<=r))return e;i=i===undefined?Br:Mr(i);while(r>n){if(r-n>600){var a=r-n+1;var o=t-n+1;var u=Math.log(a);var s=.5*Math.exp(2*u/3);var l=.5*Math.sqrt(u*s*(a-s)/a)*(o-a/2<0?-1:1);var f=Math.max(n,Math.floor(t-o*s/a+l));var c=Math.min(r,Math.floor(t+(a-o)*s/a+l));Wr(e,t,f,c,i)}var d=e[t];var h=n;var p=r;Hr(e,n,t);if(i(e[r],d)>0)Hr(e,n,r);while(h<p){Hr(e,h,p),++h,--p;while(i(e[h],d)<0)++h;while(i(e[p],d)>0)--p}if(i(e[n],d)===0)Hr(e,n,p);else++p,Hr(e,p,r);if(p<=t)n=p+1;if(t<=p)r=p-1}return e}function Hr(e,t,n){var r=e[t];e[t]=e[n];e[n]=r}function Gr(e,t,n){e=Float64Array.from(yr(e,n));if(!(r=e.length)||isNaN(t=+t))return;if(t<=0||r<2)return qr(e);if(t>=1)return Ur(e);var r,i=(r-1)*t,a=Math.floor(i),o=Ur(Wr(e,a).subarray(0,a+1)),u=qr(e.subarray(a+1));return o+(u-o)*(i-a)}function $r(e,t,n){if(n===void 0){n=mr}if(!(r=e.length)||isNaN(t=+t))return;if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),u=+n(e[a+1],a+1,e);return o+(u-o)*(i-a)}function Vr(e,t){var n=0;var r=0;if(t===undefined){for(var i=0,a=e;i<a.length;i++){var o=a[i];if(o!=null&&(o=+o)>=o){++n,r+=o}}}else{var u=-1;for(var s=0,l=e;s<l.length;s++){var f=l[s];if((f=t(f,++u,e))!=null&&(f=+f)>=f){++n,r+=f}}}if(n)return r/n}function Yr(e,t){return Gr(e,.5,t)}function Xr(e){var t,n,r;return __generator(this,(function(i){switch(i.label){case 0:t=0,n=e;i.label=1;case 1:if(!(t<n.length))return[3,4];r=n[t];return[5,__values(r)];case 2:i.sent();i.label=3;case 3:t++;return[3,1];case 4:return[2]}}))}function Jr(e){return Array.from(Xr(e))}function Qr(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a}function Zr(e,t){var n=0;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a=+a){n+=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if(l=+t(l,++o,e)){n+=l}}}return n}function Kr(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ei(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ti(e){return e=ei(Math.abs(e)),e?e[1]:NaN}function ni(e,t){return function(n,r){var i=n.length,a=[],o=0,u=e[0],s=0;while(i>0&&u>0){if(s+u+1>r)u=Math.max(1,r-s);a.push(n.substring(i-=u,i+u));if((s+=u+1)>r)break;u=e[o=(o+1)%e.length]}return a.reverse().join(t)}}function ri(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var ii=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ai(e){if(!(t=ii.exec(e)))throw new Error("invalid format: "+e);var t;return new oi({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ai.prototype=oi.prototype;function oi(e){this.fill=e.fill===undefined?" ":e.fill+"";this.align=e.align===undefined?">":e.align+"";this.sign=e.sign===undefined?"-":e.sign+"";this.symbol=e.symbol===undefined?"":e.symbol+"";this.zero=!!e.zero;this.width=e.width===undefined?undefined:+e.width;this.comma=!!e.comma;this.precision=e.precision===undefined?undefined:+e.precision;this.trim=!!e.trim;this.type=e.type===undefined?"":e.type+""}oi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ui(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n){switch(e[n]){case".":r=i=n;break;case"0":if(r===0)r=n;i=n;break;default:if(!+e[n])break e;if(r>0)r=0;break}}return r>0?e.slice(0,r)+e.slice(i+1):e}var si;function li(e,t){var n=ei(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(si=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ei(e,Math.max(0,t+a-1))[0]}function fi(e,t){var n=ei(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var ci={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:Kr,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return fi(e*100,t)},r:fi,s:li,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function di(e){return e}var hi=Array.prototype.map,pi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function vi(e){var t=e.grouping===undefined||e.thousands===undefined?di:ni(hi.call(e.grouping,Number),e.thousands+""),n=e.currency===undefined?"":e.currency[0]+"",r=e.currency===undefined?"":e.currency[1]+"",i=e.decimal===undefined?".":e.decimal+"",a=e.numerals===undefined?di:ri(hi.call(e.numerals,String)),o=e.percent===undefined?"%":e.percent+"",u=e.minus===undefined?"−":e.minus+"",s=e.nan===undefined?"NaN":e.nan+"";function l(e){e=ai(e);var l=e.fill,f=e.align,c=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;if(y==="n")v=true,y="g";else if(!ci[y])g===undefined&&(g=12),m=true,y="g";if(h||l==="0"&&f==="=")h=true,l="0",f="=";var b=d==="$"?n:d==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=d==="$"?r:/[%p]/.test(y)?o:"";var _=ci[y],w=/[defgprs%]/.test(y);g=g===undefined?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function A(e){var n=b,r=x,o,d,A;if(y==="c"){r=_(e)+r;e=""}else{e=+e;var O=e<0||1/e<0;e=isNaN(e)?s:_(Math.abs(e),g);if(m)e=ui(e);if(O&&+e===0&&c!=="+")O=false;n=(O?c==="("?c:u:c==="-"||c==="("?"":c)+n;r=(y==="s"?pi[8+si/3]:"")+r+(O&&c==="("?")":"");if(w){o=-1,d=e.length;while(++o<d){if(A=e.charCodeAt(o),48>A||A>57){r=(A===46?i+e.slice(o+1):e.slice(o))+r;e=e.slice(0,o);break}}}}if(v&&!h)e=t(e,Infinity);var E=n.length+e.length+r.length,k=E<p?new Array(p-E+1).join(l):"";if(v&&h)e=t(k+e,k.length?p-r.length:Infinity),k="";switch(f){case"<":e=n+e+r+k;break;case"=":e=n+k+e+r;break;case"^":e=k.slice(0,E=k.length>>1)+n+e+r+k.slice(E);break;default:e=k+n+e+r;break}return a(e)}A.toString=function(){return e+""};return A}function f(e,t){var n=l((e=ai(e),e.type="f",e)),r=Math.max(-8,Math.min(8,Math.floor(ti(t)/3)))*3,i=Math.pow(10,-r),a=pi[8+r/3];return function(e){return n(i*e)+a}}return{format:l,formatPrefix:f}}var gi;var mi;var yi;bi({thousands:",",grouping:[3],currency:["$",""]});function bi(e){gi=vi(e);mi=gi.format;yi=gi.formatPrefix;return gi}function xi(e){return Math.max(0,-ti(Math.abs(e)))}function _i(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ti(t)/3)))*3-ti(Math.abs(e)))}function wi(e,t){e=Math.abs(e),t=Math.abs(t)-e;return Math.max(0,ti(t)-ti(e))+1}var Ai=new Date,Oi=new Date;function Ei(e,t,n,r){function i(t){return e(t=arguments.length===0?new Date:new Date(+t)),t}i.floor=function(t){return e(t=new Date(+t)),t};i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n};i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n};i.offset=function(e,n){return t(e=new Date(+e),n==null?1:Math.floor(n)),e};i.range=function(n,r,a){var o=[];n=i.ceil(n);a=a==null?1:Math.floor(a);if(!(n<r)||!(a>0))return o;var u;do{o.push(u=new Date(+n)),t(n,a),e(n)}while(u<n&&n<r);return o};i.filter=function(n){return Ei((function(t){if(t>=t)while(e(t),!n(t))t.setTime(t-1)}),(function(e,r){if(e>=e){if(r<0)while(++r<=0){while(t(e,-1),!n(e)){}}else while(--r>=0){while(t(e,+1),!n(e)){}}}}))};if(n){i.count=function(t,r){Ai.setTime(+t),Oi.setTime(+r);e(Ai),e(Oi);return Math.floor(n(Ai,Oi))};i.every=function(e){e=Math.floor(e);return!isFinite(e)||!(e>0)?null:!(e>1)?i:i.filter(r?function(t){return r(t)%e===0}:function(t){return i.count(0,t)%e===0})}}return i}var ki=Ei((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));ki.every=function(e){e=Math.floor(e);if(!isFinite(e)||!(e>0))return null;if(!(e>1))return ki;return Ei((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e}))};var Di=1e3;var Ci=Di*60;var Fi=Ci*60;var Si=Fi*24;var ji=Si*7;var Mi=Si*30;var Bi=Si*365;var Ni=Ei((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Di)}),(function(e,t){return(t-e)/Di}),(function(e){return e.getUTCSeconds()}));var Ti=Ei((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Di)}),(function(e,t){e.setTime(+e+t*Ci)}),(function(e,t){return(t-e)/Ci}),(function(e){return e.getMinutes()}));var zi=Ei((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*Ci)}),(function(e,t){return(t-e)/Ci}),(function(e){return e.getUTCMinutes()}));var Pi=Ei((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Di-e.getMinutes()*Ci)}),(function(e,t){e.setTime(+e+t*Fi)}),(function(e,t){return(t-e)/Fi}),(function(e){return e.getHours()}));var Ri=Ei((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Fi)}),(function(e,t){return(t-e)/Fi}),(function(e){return e.getUTCHours()}));var Li=Ei((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ci)/Si}),(function(e){return e.getDate()-1}));var Ii=Ei((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Si}),(function(e){return e.getUTCDate()-1}));var Ui=Ei((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Si}),(function(e){return Math.floor(e/Si)}));function qi(e){return Ei((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7);t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t*7)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ci)/ji}))}var Wi=qi(0);var Hi=qi(1);qi(2);qi(3);var Gi=qi(4);qi(5);qi(6);function $i(e){return Ei((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7);t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t*7)}),(function(e,t){return(t-e)/ji}))}var Vi=$i(0);var Yi=$i(1);$i(2);$i(3);var Xi=$i(4);$i(5);$i(6);var Ji=Ei((function(e){e.setDate(1);e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12}),(function(e){return e.getMonth()}));var Qi=Ei((function(e){e.setUTCDate(1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12}),(function(e){return e.getUTCMonth()}));var Zi=Ei((function(e){e.setMonth(0,1);e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));Zi.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ei((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e);t.setMonth(0,1);t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)}))};var Ki=Ei((function(e){e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));Ki.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ei((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e);t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}))};function ea(e,t,n,r,i,a){var o=[[Ni,1,Di],[Ni,5,5*Di],[Ni,15,15*Di],[Ni,30,30*Di],[a,1,Ci],[a,5,5*Ci],[a,15,15*Ci],[a,30,30*Ci],[i,1,Fi],[i,3,3*Fi],[i,6,6*Fi],[i,12,12*Fi],[r,1,Si],[r,2,2*Si],[n,1,ji],[t,1,Mi],[t,3,3*Mi],[e,1,Bi]];function u(e,t,n){var r;var i=t<e;if(i)r=[t,e],e=r[0],t=r[1];var a=n&&typeof n.range==="function"?n:s(e,t,n);var o=a?a.range(e,+t+1):[];return i?o.reverse():o}function s(t,n,r){var i=Math.abs(n-t)/r;var a=vr((function(e){var t=e[2];return t})).right(o,i);if(a===o.length)return e.every(Ir(t/Bi,n/Bi,r));if(a===0)return ki.every(Math.max(Ir(t,n,r),1));var u=o[i/o[a-1][2]<o[a][2]/i?a-1:a],s=u[0],l=u[1];return s.every(l)}return[u,s]}var ta=ea(Ki,Qi,Vi,Ui,Ri,zi),na=ta[0],ra=ta[1];var ia=ea(Zi,Ji,Wi,Li,Pi,Ti),aa=ia[0],oa=ia[1];var ua="year";var sa="quarter";var la="month";var fa="week";var ca="date";var da="day";var ha="dayofyear";var pa="hours";var va="minutes";var ga="seconds";var ma="milliseconds";var ya=[ua,sa,la,fa,ca,da,ha,pa,va,ga,ma];var ba=ya.reduce((function(e,t,n){return e[t]=1+n,e}),{});function xa(e){var t=tn(e).slice(),n={};if(!t.length)pt("Missing time unit.");t.forEach((function(e){if(mn(ba,e)){n[e]=1}else{pt("Invalid time unit: ".concat(e,"."))}}));var r=(n[fa]||n[da]?1:0)+(n[sa]||n[la]||n[ca]?1:0)+(n[ha]?1:0);if(r>1){pt("Incompatible time units: ".concat(e))}t.sort((function(e,t){return ba[e]-ba[t]}));return t}var _a=(pe={},pe[ua]="%Y ",pe[sa]="Q%q ",pe[la]="%b ",pe[ca]="%d ",pe[fa]="W%U ",pe[da]="%a ",pe[ha]="%j ",pe[pa]="%H:00",pe[va]="00:%M",pe[ga]=":%S",pe[ma]=".%L",pe["".concat(ua,"-").concat(la)]="%Y-%m ",pe["".concat(ua,"-").concat(la,"-").concat(ca)]="%Y-%m-%d ",pe["".concat(pa,"-").concat(va)]="%H:%M",pe);function wa(e,t){var n=hn({},_a,t),r=xa(e),i=r.length;var a="",o=0,u,s;for(o=0;o<i;){for(u=r.length;u>o;--u){s=r.slice(o,u).join("-");if(n[s]!=null){a+=n[s];o=u;break}}}return a.trim()}var Aa=new Date;function Oa(e){Aa.setFullYear(e);Aa.setMonth(0);Aa.setDate(1);Aa.setHours(0,0,0,0);return Aa}function Ea(e){return Da(new Date(e))}function ka(e){return Ca(new Date(e))}function Da(e){return Li.count(Oa(e.getFullYear())-1,e)}function Ca(e){return Wi.count(Oa(e.getFullYear())-1,e)}function Fa(e){return Oa(e).getDay()}function Sa(e,t,n,r,i,a,o){if(0<=e&&e<100){var u=new Date(-1,t,n,r,i,a,o);u.setFullYear(e);return u}return new Date(e,t,n,r,i,a,o)}function ja(e){return Ba(new Date(e))}function Ma(e){return Na(new Date(e))}function Ba(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return Ii.count(t-1,e)}function Na(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return Vi.count(t-1,e)}function Ta(e){Aa.setTime(Date.UTC(e,0,1));return Aa.getUTCDay()}function za(e,t,n,r,i,a,o){if(0<=e&&e<100){var u=new Date(Date.UTC(-1,t,n,r,i,a,o));u.setUTCFullYear(n.y);return u}return new Date(Date.UTC(e,t,n,r,i,a,o))}function Pa(e,t,n,r,i){var a=t||1,o=zt(e),u=function(e,t,i){i=i||e;return Ra(n[i],r[i],e===o&&a,t)};var s=new Date,l=qn(e),f=l[ua]?u(ua):cn(2012),c=l[la]?u(la):l[sa]?u(sa):bt,d=l[fa]&&l[da]?u(da,1,fa+da):l[fa]?u(fa,1):l[da]?u(da,1):l[ca]?u(ca,1):l[ha]?u(ha,1):xt,h=l[pa]?u(pa):bt,p=l[va]?u(va):bt,v=l[ga]?u(ga):bt,g=l[ma]?u(ma):bt;return function(e){s.setTime(+e);var t=f(s);return i(t,c(s),d(s,t),h(s),p(s),v(s),g(s))}}function Ra(e,t,n,r){var i=n<=1?e:r?function(t,i){return r+n*Math.floor((e(t,i)-r)/n)}:function(t,r){return n*Math.floor(e(t,r)/n)};return t?function(e,n){return t(i(e,n),n)}:i}function La(e,t,n){return t+e*7-(n+6)%7}var Ia=(ve={},ve[ua]=function(e){return e.getFullYear()},ve[sa]=function(e){return Math.floor(e.getMonth()/3)},ve[la]=function(e){return e.getMonth()},ve[ca]=function(e){return e.getDate()},ve[pa]=function(e){return e.getHours()},ve[va]=function(e){return e.getMinutes()},ve[ga]=function(e){return e.getSeconds()},ve[ma]=function(e){return e.getMilliseconds()},ve[ha]=function(e){return Da(e)},ve[fa]=function(e){return Ca(e)},ve[fa+da]=function(e,t){return La(Ca(e),e.getDay(),Fa(t))},ve[da]=function(e,t){return La(1,e.getDay(),Fa(t))},ve);var Ua=(ge={},ge[sa]=function(e){return 3*e},ge[fa]=function(e,t){return La(e,0,Fa(t))},ge);function qa(e,t){return Pa(e,t||1,Ia,Ua,Sa)}var Wa=(me={},me[ua]=function(e){return e.getUTCFullYear()},me[sa]=function(e){return Math.floor(e.getUTCMonth()/3)},me[la]=function(e){return e.getUTCMonth()},me[ca]=function(e){return e.getUTCDate()},me[pa]=function(e){return e.getUTCHours()},me[va]=function(e){return e.getUTCMinutes()},me[ga]=function(e){return e.getUTCSeconds()},me[ma]=function(e){return e.getUTCMilliseconds()},me[ha]=function(e){return Ba(e)},me[fa]=function(e){return Na(e)},me[da]=function(e,t){return La(1,e.getUTCDay(),Ta(t))},me[fa+da]=function(e,t){return La(Na(e),e.getUTCDay(),Ta(t))},me);var Ha=(ye={},ye[sa]=function(e){return 3*e},ye[fa]=function(e,t){return La(e,0,Ta(t))},ye);function Ga(e,t){return Pa(e,t||1,Wa,Ha,za)}var $a=(be={},be[ua]=Zi,be[sa]=Ji.every(3),be[la]=Ji,be[fa]=Wi,be[ca]=Li,be[da]=Li,be[ha]=Li,be[pa]=Pi,be[va]=Ti,be[ga]=Ni,be[ma]=ki,be);var Va=(xe={},xe[ua]=Ki,xe[sa]=Qi.every(3),xe[la]=Qi,xe[fa]=Vi,xe[ca]=Ii,xe[da]=Ii,xe[ha]=Ii,xe[pa]=Ri,xe[va]=zi,xe[ga]=Ni,xe[ma]=ki,xe);function Ya(e){return $a[e]}function Xa(e){return Va[e]}function Ja(e,t,n){return e?e.offset(t,n):undefined}function Qa(e,t,n){return Ja(Ya(e),t,n)}function Za(e,t,n){return Ja(Xa(e),t,n)}function Ka(e,t,n,r){return e?e.range(t,n,r):undefined}function eo(e,t,n,r){return Ka(Ya(e),t,n,r)}function to(e,t,n,r){return Ka(Xa(e),t,n,r)}var no=1e3,ro=no*60,io=ro*60,ao=io*24,oo=ao*7,uo=ao*30,so=ao*365;var lo=[ua,la,ca,pa,va,ga,ma],fo=lo.slice(0,-1),co=fo.slice(0,-1),ho=co.slice(0,-1),po=ho.slice(0,-1),vo=[ua,fa],go=[ua,la],mo=[ua];var yo=[[fo,1,no],[fo,5,5*no],[fo,15,15*no],[fo,30,30*no],[co,1,ro],[co,5,5*ro],[co,15,15*ro],[co,30,30*ro],[ho,1,io],[ho,3,3*io],[ho,6,6*io],[ho,12,12*io],[po,1,ao],[vo,1,oo],[go,1,uo],[go,3,3*uo],[mo,1,so]];function bo(e){var t=e.extent,n=e.maxbins||40,r=Math.abs(zn(t))/n;var i=vr((function(e){return e[2]})).right(yo,r),a,o;if(i===yo.length){a=mo,o=Ir(t[0]/so,t[1]/so,n)}else if(i){i=yo[r/yo[i-1][2]<yo[i][2]/r?i-1:i];a=i[0];o=i[1]}else{a=lo;o=Math.max(Ir(t[0],t[1],n),1)}return{units:a,step:o}}function xo(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);t.setFullYear(e.y);return t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function _o(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));t.setUTCFullYear(e.y);return t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function wo(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Ao(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,u=e.months,s=e.shortMonths;var l=So(i),f=jo(i),c=So(a),d=jo(a),h=So(o),p=jo(o),v=So(u),g=jo(u),m=So(s),y=jo(s);var b={a:B,A:N,b:T,B:z,c:null,d:Zo,e:Zo,f:ru,g:pu,G:gu,H:Ko,I:eu,j:tu,L:nu,m:iu,M:au,p:P,q:R,Q:Lu,s:Iu,S:ou,u:uu,U:su,V:fu,w:cu,W:du,x:null,X:null,y:hu,Y:vu,Z:mu,"%":Ru};var x={a:L,A:I,b:U,B:q,c:null,d:yu,e:yu,f:Au,g:Nu,G:zu,H:bu,I:xu,j:_u,L:wu,m:Ou,M:Eu,p:W,q:H,Q:Lu,s:Iu,S:ku,u:Du,U:Cu,V:Su,w:ju,W:Mu,x:null,X:null,y:Bu,Y:Tu,Z:Pu,"%":Ru};var _={a:k,A:D,b:C,B:F,c:S,d:qo,e:qo,f:Yo,g:Ro,G:Po,H:Ho,I:Ho,j:Wo,L:Vo,m:Uo,M:Go,p:E,q:Io,Q:Jo,s:Qo,S:$o,u:Bo,U:No,V:To,w:Mo,W:zo,x:j,X:M,y:Ro,Y:Po,Z:Lo,"%":Xo};b.x=w(n,b);b.X=w(r,b);b.c=w(t,b);x.x=w(n,x);x.X=w(r,x);x.c=w(t,x);function w(e,t){return function(n){var r=[],i=-1,a=0,o=e.length,u,s,l;if(!(n instanceof Date))n=new Date(+n);while(++i<o){if(e.charCodeAt(i)===37){r.push(e.slice(a,i));if((s=Oo[u=e.charAt(++i)])!=null)u=e.charAt(++i);else s=u==="e"?" ":"0";if(l=t[u])u=l(n,s);r.push(u);a=i+1}}r.push(e.slice(a,i));return r.join("")}}function A(e,t){return function(n){var r=wo(1900,undefined,1),i=O(r,e,n+="",0),a,o;if(i!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(r.s*1e3+("L"in r?r.L:0));if(t&&!("Z"in r))r.Z=0;if("p"in r)r.H=r.H%12+r.p*12;if(r.m===undefined)r.m="q"in r?r.q:0;if("V"in r){if(r.V<1||r.V>53)return null;if(!("w"in r))r.w=1;if("Z"in r){a=_o(wo(r.y,0,1)),o=a.getUTCDay();a=o>4||o===0?Yi.ceil(a):Yi(a);a=Ii.offset(a,(r.V-1)*7);r.y=a.getUTCFullYear();r.m=a.getUTCMonth();r.d=a.getUTCDate()+(r.w+6)%7}else{a=xo(wo(r.y,0,1)),o=a.getDay();a=o>4||o===0?Hi.ceil(a):Hi(a);a=Li.offset(a,(r.V-1)*7);r.y=a.getFullYear();r.m=a.getMonth();r.d=a.getDate()+(r.w+6)%7}}else if("W"in r||"U"in r){if(!("w"in r))r.w="u"in r?r.u%7:"W"in r?1:0;o="Z"in r?_o(wo(r.y,0,1)).getUTCDay():xo(wo(r.y,0,1)).getDay();r.m=0;r.d="W"in r?(r.w+6)%7+r.W*7-(o+5)%7:r.w+r.U*7-(o+6)%7}if("Z"in r){r.H+=r.Z/100|0;r.M+=r.Z%100;return _o(r)}return xo(r)}}function O(e,t,n,r){var i=0,a=t.length,o=n.length,u,s;while(i<a){if(r>=o)return-1;u=t.charCodeAt(i++);if(u===37){u=t.charAt(i++);s=_[u in Oo?t.charAt(i++):u];if(!s||(r=s(e,n,r))<0)return-1}else if(u!=n.charCodeAt(r++)){return-1}}return r}function E(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=f.get(r[0].toLowerCase()),n+r[0].length):-1}function k(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1}function D(e,t,n){var r=c.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1}function C(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1}function F(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1}function S(e,n,r){return O(e,t,n,r)}function j(e,t,r){return O(e,n,t,r)}function M(e,t,n){return O(e,r,t,n)}function B(e){return o[e.getDay()]}function N(e){return a[e.getDay()]}function T(e){return s[e.getMonth()]}function z(e){return u[e.getMonth()]}function P(e){return i[+(e.getHours()>=12)]}function R(e){return 1+~~(e.getMonth()/3)}function L(e){return o[e.getUTCDay()]}function I(e){return a[e.getUTCDay()]}function U(e){return s[e.getUTCMonth()]}function q(e){return u[e.getUTCMonth()]}function W(e){return i[+(e.getUTCHours()>=12)]}function H(e){return 1+~~(e.getUTCMonth()/3)}return{format:function(e){var t=w(e+="",b);t.toString=function(){return e};return t},parse:function(e){var t=A(e+="",false);t.toString=function(){return e};return t},utcFormat:function(e){var t=w(e+="",x);t.toString=function(){return e};return t},utcParse:function(e){var t=A(e+="",true);t.toString=function(){return e};return t}}}var Oo={"-":"",_:" ",0:"0"},Eo=/^\s*\d+/,ko=/^%/,Do=/[\\^$*+?|[\]().{}]/g;function Co(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function Fo(e){return e.replace(Do,"\\$&")}function So(e){return new RegExp("^(?:"+e.map(Fo).join("|")+")","i")}function jo(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function Mo(e,t,n){var r=Eo.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Bo(e,t,n){var r=Eo.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function No(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function To(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function zo(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Po(e,t,n){var r=Eo.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Ro(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Lo(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Io(e,t,n){var r=Eo.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Uo(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function qo(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Wo(e,t,n){var r=Eo.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ho(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Go(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function $o(e,t,n){var r=Eo.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Vo(e,t,n){var r=Eo.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Yo(e,t,n){var r=Eo.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Xo(e,t,n){var r=ko.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Jo(e,t,n){var r=Eo.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Qo(e,t,n){var r=Eo.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Zo(e,t){return Co(e.getDate(),t,2)}function Ko(e,t){return Co(e.getHours(),t,2)}function eu(e,t){return Co(e.getHours()%12||12,t,2)}function tu(e,t){return Co(1+Li.count(Zi(e),e),t,3)}function nu(e,t){return Co(e.getMilliseconds(),t,3)}function ru(e,t){return nu(e,t)+"000"}function iu(e,t){return Co(e.getMonth()+1,t,2)}function au(e,t){return Co(e.getMinutes(),t,2)}function ou(e,t){return Co(e.getSeconds(),t,2)}function uu(e){var t=e.getDay();return t===0?7:t}function su(e,t){return Co(Wi.count(Zi(e)-1,e),t,2)}function lu(e){var t=e.getDay();return t>=4||t===0?Gi(e):Gi.ceil(e)}function fu(e,t){e=lu(e);return Co(Gi.count(Zi(e),e)+(Zi(e).getDay()===4),t,2)}function cu(e){return e.getDay()}function du(e,t){return Co(Hi.count(Zi(e)-1,e),t,2)}function hu(e,t){return Co(e.getFullYear()%100,t,2)}function pu(e,t){e=lu(e);return Co(e.getFullYear()%100,t,2)}function vu(e,t){return Co(e.getFullYear()%1e4,t,4)}function gu(e,t){var n=e.getDay();e=n>=4||n===0?Gi(e):Gi.ceil(e);return Co(e.getFullYear()%1e4,t,4)}function mu(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Co(t/60|0,"0",2)+Co(t%60,"0",2)}function yu(e,t){return Co(e.getUTCDate(),t,2)}function bu(e,t){return Co(e.getUTCHours(),t,2)}function xu(e,t){return Co(e.getUTCHours()%12||12,t,2)}function _u(e,t){return Co(1+Ii.count(Ki(e),e),t,3)}function wu(e,t){return Co(e.getUTCMilliseconds(),t,3)}function Au(e,t){return wu(e,t)+"000"}function Ou(e,t){return Co(e.getUTCMonth()+1,t,2)}function Eu(e,t){return Co(e.getUTCMinutes(),t,2)}function ku(e,t){return Co(e.getUTCSeconds(),t,2)}function Du(e){var t=e.getUTCDay();return t===0?7:t}function Cu(e,t){return Co(Vi.count(Ki(e)-1,e),t,2)}function Fu(e){var t=e.getUTCDay();return t>=4||t===0?Xi(e):Xi.ceil(e)}function Su(e,t){e=Fu(e);return Co(Xi.count(Ki(e),e)+(Ki(e).getUTCDay()===4),t,2)}function ju(e){return e.getUTCDay()}function Mu(e,t){return Co(Yi.count(Ki(e)-1,e),t,2)}function Bu(e,t){return Co(e.getUTCFullYear()%100,t,2)}function Nu(e,t){e=Fu(e);return Co(e.getUTCFullYear()%100,t,2)}function Tu(e,t){return Co(e.getUTCFullYear()%1e4,t,4)}function zu(e,t){var n=e.getUTCDay();e=n>=4||n===0?Xi(e):Xi.ceil(e);return Co(e.getUTCFullYear()%1e4,t,4)}function Pu(){return"+0000"}function Ru(){return"%"}function Lu(e){return+e}function Iu(e){return Math.floor(+e/1e3)}var Uu;var qu;var Wu;var Hu;var Gu;$u({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function $u(e){Uu=Ao(e);qu=Uu.format;Wu=Uu.parse;Hu=Uu.utcFormat;Gu=Uu.utcParse;return Uu}function Vu(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function Yu(e,t){return function(n){var r=e(n),i=r.indexOf(t);if(i<0)return r;var a=Xu(r,i);var o=a<r.length?r.slice(a):"";while(--a>i)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function Xu(e,t){var n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;){r=e.charCodeAt(n);if(r>=48&&r<=57)return n+1}}function Ju(e){var t=Vu(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=ai(e||",");if(n.precision==null){n.precision=12;switch(n.type){case"%":n.precision-=2;break;case"e":n.precision-=1;break}return Yu(t(n),t(".1f")(1)[1])}else{return t(n)}},formatSpan:function(e,r,i,a){a=ai(a==null?",f":a);var o=Ir(e,r,i),u=Math.max(Math.abs(e),Math.abs(r));var s;if(a.precision==null){switch(a.type){case"s":{if(!isNaN(s=_i(o,u))){a.precision=s}return n(a,u)}case"":case"e":case"g":case"p":case"r":{if(!isNaN(s=wi(o,u))){a.precision=s-(a.type==="e")}break}case"f":case"%":{if(!isNaN(s=xi(o))){a.precision=s-(a.type==="%")*2}break}}}return t(a)}}}var Qu;Zu();function Zu(){return Qu=Ju({format:mi,formatPrefix:yi})}function Ku(e){return Ju(vi(e))}function es(e){return arguments.length?Qu=Ku(e):Qu}function ts(e,t,n){n=n||{};if(!jt(n)){pt("Invalid time multi-format specifier: ".concat(n))}var r=t(ga),i=t(va),a=t(pa),o=t(ca),u=t(fa),s=t(la),l=t(sa),f=t(ua),c=e(n[ma]||".%L"),d=e(n[ga]||":%S"),h=e(n[va]||"%I:%M"),p=e(n[pa]||"%I %p"),v=e(n[ca]||n[da]||"%a %d"),g=e(n[fa]||"%b %d"),m=e(n[la]||"%B"),y=e(n[sa]||"%B"),b=e(n[ua]||"%Y");return function(e){return(r(e)<e?c:i(e)<e?d:a(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:g:f(e)<e?l(e)<e?m:y:b)(e)}}function ns(e){var t=Vu(e.format),n=Vu(e.utcFormat);return{timeFormat:function(e){return Cn(e)?t(e):ts(t,Ya,e)},utcFormat:function(e){return Cn(e)?n(e):ts(n,Xa,e)},timeParse:Vu(e.parse),utcParse:Vu(e.utcParse)}}var rs;is();function is(){return rs=ns({format:qu,parse:Wu,utcFormat:Hu,utcParse:Gu})}function as(e){return ns(Ao(e))}function os(e){return arguments.length?rs=as(e):rs}var us=function(e,t){return hn({},e,t)};function ss(e,t){var n=e?Ku(e):es();var r=t?as(t):os();return us(n,r)}function ls(e,t){var n=arguments.length;if(n&&n!==2){pt("defaultLocale expects either zero or two arguments.")}return n?us(es(e),os(t)):us(es(),os())}function fs(){Zu();is();return ls()}var cs=/^(data:|([A-Za-z]+:)?\/\/)/;var ds=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i;var hs=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;var ps="file://";function vs(e,t){return function(n){return{options:n||{},sanitize:ms,load:gs,fileAccess:!!t,file:ys(t),http:xs(e)}}}function gs(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.sanitize(e,t)];case 1:n=i.sent(),r=n.href;return[2,n.localFile?this.file(r):this.http(r,t)]}}))}))}function ms(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r,i,a,o,u,s;return __generator(this,(function(l){t=hn({},this.options,t);n=this.fileAccess,r={href:null};u=ds.test(e.replace(hs,""));if(e==null||typeof e!=="string"||!u){pt("Sanitize failure, invalid URI: "+Pn(e))}s=cs.test(e);if((o=t.baseURL)&&!s){if(!e.startsWith("/")&&!o.endsWith("/")){e="/"+e}e=o+e}a=(i=e.startsWith(ps))||t.mode==="file"||t.mode!=="http"&&!s&&n;if(i){e=e.slice(ps.length)}else if(e.startsWith("//")){if(t.defaultProtocol==="file"){e=e.slice(2);a=true}else{e=(t.defaultProtocol||"http")+":"+e}}Object.defineProperty(r,"localFile",{value:!!a});r.href=e;if(t.target){r.target=t.target+""}if(t.rel){r.rel=t.rel+""}if(t.context==="image"&&t.crossOrigin){r.crossOrigin=t.crossOrigin+""}return[2,r]}))}))}function ys(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){if(e)r(e);else n(t)}))}))}:bs}function bs(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){pt("No file system access.");return[2]}))}))}function xs(e){return e?function(t,n){return __awaiter(this,void 0,void 0,(function(){var r,i,a;return __generator(this,(function(o){switch(o.label){case 0:r=hn({},this.options.http,n),i=n&&n.response;return[4,e(t,r)];case 1:a=o.sent();return[2,!a.ok?pt(a.status+""+a.statusText):rn(a[i])?a[i]():a.text()]}}))}))}:_s}function _s(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){pt("No HTTP fetch method available.");return[2]}))}))}var ws=function(e){return e!=null&&e===e};var As=function(e){return e==="true"||e==="false"||e===true||e===false};var Os=function(e){return!Number.isNaN(Date.parse(e))};var Es=function(e){return!Number.isNaN(+e)&&!(e instanceof Date)};var ks=function(e){return Es(e)&&Number.isInteger(+e)};var Ds={boolean:Rn,integer:Pt,number:Pt,date:In,string:Un,unknown:yt};var Cs=[As,ks,Es,Os];var Fs=["boolean","integer","number","date"];function Ss(e,t){if(!e||!e.length)return"unknown";var n=e.length,r=Cs.length,i=Cs.map((function(e,t){return t+1}));for(var a=0,o=0,u=void 0,s;a<n;++a){s=t?e[a][t]:e[a];for(u=0;u<r;++u){if(i[u]&&ws(s)&&!Cs[u](s)){i[u]=0;++o;if(o===Cs.length)return"string"}}}return Fs[i.reduce((function(e,t){return e===0?t:e}),0)-1]}function js(e,t){return t.reduce((function(t,n){t[n]=Ss(e,n);return t}),{})}function Ms(e){var t=function(t,n){var r={delimiter:e};return Bs(t,n?hn(n,r):r)};t.responseType="text";return t}function Bs(e,t){if(t.header){e=t.header.map(Pn).join(t.delimiter)+"\n"+e}return nr(t.delimiter).parse(e+"")}Bs.responseType="text";function Ns(e){return typeof Buffer==="function"&&rn(Buffer.isBuffer)?Buffer.isBuffer(e):false}function Ts(e,t){var n=t&&t.property?gt(t.property):yt;return jt(e)&&!Ns(e)?zs(n(e),t):n(JSON.parse(e))}Ts.responseType="json";function zs(e,t){if(!St(e)&&En(e)){e=__spreadArray([],e,true)}return t&&t.copy?JSON.parse(JSON.stringify(e)):e}var Ps={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function Rs(e,t){var n,r,i,a;e=Ts(e,t);if(t&&t.feature){n=or;i=t.feature}else if(t&&t.mesh){n=fr;i=t.mesh;a=Ps[t.filter]}else{pt("Missing TopoJSON feature or mesh parameter.")}r=(r=e.objects[i])?n(e,r,a):pt("Invalid TopoJSON object: "+i);return r&&r.features||[r]}Rs.responseType="json";var Ls={dsv:Bs,csv:Ms(","),tsv:Ms("\t"),json:Ts,topojson:Rs};function Is(e,t){if(arguments.length>1){Ls[e]=t;return this}else{return mn(Ls,e)?Ls[e]:null}}function Us(e){var t=Is(e);return t&&t.responseType||"text"}function qs(e,t,n,r){t=t||{};var i=Is(t.type||"json");if(!i)pt("Unknown data format type: "+t.type);e=i(e,t);if(t.parse)Ws(e,t.parse,n,r);if(mn(e,"columns"))delete e.columns;return e}function Ws(e,t,n,r){if(!e.length)return;var i=os();n=n||i.timeParse;r=r||i.utcParse;var a=e.columns||Object.keys(e[0]),o,u,s,l,f,c;if(t==="auto")t=js(e,a);a=Object.keys(t);var d=a.map((function(e){var i=t[e];var a,o;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){a=i.split(/:(.+)?/,2);o=a[1];if(o[0]==="'"&&o[o.length-1]==="'"||o[0]==='"'&&o[o.length-1]==='"'){o=o.slice(1,-1)}var u=a[0]==="utc"?r:n;return u(o)}if(!Ds[i]){throw Error("Illegal format pattern: "+e+":"+i)}return Ds[i]}));for(s=0,f=e.length,c=a.length;s<f;++s){o=e[s];for(l=0;l<c;++l){u=a[l];o[u]=d[l](o[u])}}}var Hs=vs(typeof fetch!=="undefined"&&fetch,null);function Gs(e){var t=e||yt,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e);if(r[i]){r[i]=0;var a=n.indexOf(e);if(a>=0)n.splice(a,1)}return n};return n}function $s(e,t){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,t(e)];case 1:r.sent();return[3,3];case 2:n=r.sent();e.error(n);return[3,3];case 3:return[2]}}))}))}var Vs=Symbol("vega_id");var Ys=1;function Xs(e){return!!(e&&Js(e))}function Js(e){return e[Vs]}function Qs(e,t){e[Vs]=t;return e}function Zs(e){var t=e===Object(e)?e:{data:e};return Js(t)?t:Qs(t,Ys++)}function Ks(e){return el(e,Zs({}))}function el(e,t){for(var n in e)t[n]=e[n];return t}function tl(e,t){return Qs(t,Js(e))}function nl(e,t){return!e?null:t?function(n,r){return e(n,r)||Js(t(n))-Js(t(r))}:function(t,n){return e(t,n)||Js(t)-Js(n)}}function rl(e){return e&&e.constructor===il}function il(){var e=[],t=[],n=[],r=[],i=[];var a=null,o=false;return{constructor:il,insert:function(t){var n=tn(t),r=n.length;for(var i=0;i<r;++i)e.push(n[i]);return this},remove:function(e){var n=rn(e)?r:t,i=tn(e),a=i.length;for(var o=0;o<a;++o)n.push(i[o]);return this},modify:function(e,t,r){var a={field:t,value:cn(r)};if(rn(e)){a.filter=e;i.push(a)}else{a.tuple=e;n.push(a)}return this},encode:function(e,t){if(rn(e))i.push({filter:e,field:t});else n.push({tuple:e,field:t});return this},clean:function(e){a=e;return this},reflow:function(){o=true;return this},pulse:function(u,s){var l={},f={};var c,d,h,p,v,g;for(c=0,d=s.length;c<d;++c){l[Js(s[c])]=1}for(c=0,d=t.length;c<d;++c){v=t[c];l[Js(v)]=-1}for(c=0,d=r.length;c<d;++c){p=r[c];s.forEach((function(e){if(p(e))l[Js(e)]=-1}))}for(c=0,d=e.length;c<d;++c){v=e[c];g=Js(v);if(l[g]){l[g]=1}else{u.add.push(Zs(e[c]))}}for(c=0,d=s.length;c<d;++c){v=s[c];if(l[Js(v)]<0)u.rem.push(v)}function m(e,t,n){if(n){e[t]=n(e)}else{u.encode=t}if(!o)f[Js(e)]=e}for(c=0,d=n.length;c<d;++c){h=n[c];v=h.tuple;p=h.field;g=l[Js(v)];if(g>0){m(v,p,h.value);u.modifies(p)}}for(c=0,d=i.length;c<d;++c){h=i[c];p=h.filter;s.forEach((function(e){if(p(e)&&l[Js(e)]>0){m(e,h.field,h.value)}}));u.modifies(h.field)}if(o){u.mod=t.length||r.length?s.filter((function(e){return l[Js(e)]>0})):s.slice()}else{for(g in f)u.mod.push(f[g])}if(a||a==null&&(t.length||r.length)){u.clean(true)}return u}}}var al="_:mod:_";function ol(){Object.defineProperty(this,al,{writable:true,value:{}})}ol.prototype={set:function(e,t,n,r){var i=this,a=i[e],o=i[al];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=St(n)?1+n.length:-1}return i},modified:function(e,t){var n=this[al];if(!arguments.length){for(var r in n){if(n[r])return true}return false}else if(St(e)){for(var r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear:function(){this[al]={};return this}};var ul=0;var sl="pulse",ll=new ol;var fl=1,cl=2;function dl(e,t,n,r){this.id=++ul;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}function hl(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}dl.prototype={targets:function(){return this._targets||(this._targets=Gs(mt))},set:function(e){if(this.value!==e){this.value=e;return 1}else{return 0}},skip:hl(fl),modified:hl(cl),parameters:function(e,t,n){var r=this;t=t!==false;var i=this._argval=this._argval||new ol,a=this._argops=this._argops||[],o=[];var u,s,l,f;var c=function(e,n,u){if(u instanceof dl){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}};for(u in e){s=e[u];if(u===sl){tn(s).forEach((function(e){if(!(e instanceof dl)){pt("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));this.source=s}else if(St(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o},marshall:function(e){var t=this._argval||ll,n=this._argops;var r,i,a,o;if(n){var u=n.length;for(i=0;i<u;++i){r=n[i];a=r.op;o=a.modified()&&a.stamp===e;t.set(r.name,r.index,a.value,o)}if(n.initonly){for(i=0;i<u;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t},detach:function(){var e=this._argops;var t,n,r,i;if(e){for(t=0,n=e.length;t<n;++t){r=e[t];i=r.op;if(i._targets){i._targets.remove(this)}}}this.pulse=null;this.source=null},evaluate:function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}},run:function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e}};function pl(e,t,n,r){var i=1,a;if(e instanceof dl){a=e}else if(e&&e.prototype instanceof dl){a=new e}else if(rn(e)){a=new dl(null,e)}else{i=0;a=new dl(e,t)}this.rank(a);if(i){r=n;n=t}if(n)this.connect(a,a.parameters(n,r));this.touch(a);return a}function vl(e,t){var n=e.rank,r=t.length;for(var i=0;i<r;++i){if(n<t[i].rank){this.rerank(e);return}}}var gl=0;function ml(e,t,n){this.id=++gl;this.value=null;if(n)this.receive=n;if(e)this._filter=e;if(t)this._apply=t}function yl(e,t,n){return new ml(e,t,n)}ml.prototype={_filter:_t,_apply:yt,targets:function(){return this._targets||(this._targets=Gs(mt))},consume:function(e){if(!arguments.length)return!!this._consume;this._consume=!!e;return this},receive:function(e){if(this._filter(e)){var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(var i=0;i<r;++i)n[i].receive(t);if(this._consume){e.preventDefault();e.stopPropagation()}}},filter:function(e){var t=yl(e);this.targets().add(t);return t},apply:function(e){var t=yl(null,e);this.targets().add(t);return t},merge:function(){var e=yl();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t){arguments[t].targets().add(e)}return e},throttle:function(e){var t=-1;return this.filter((function(){var n=Date.now();if(n-t>e){t=n;return 1}else{return 0}}))},debounce:function(e){var t=yl();this.targets().add(yl(null,null,dn(e,(function(e){var n=e.dataflow;t.receive(e);if(n&&n.run)n.run()}))));return t},between:function(e,t){var n=false;e.targets().add(yl(null,null,(function(){return n=true})));t.targets().add(yl(null,null,(function(){return n=false})));return this.filter((function(){return n}))},detach:function(){this._filter=_t;this._targets=null}};function bl(e,t,n,r){var i=this,a=yl(n,r),o=function(e){e.dataflow=i;try{a.receive(e)}catch(pt){i.error(pt)}finally{i.run()}};var u;if(typeof e==="string"&&typeof document!=="undefined"){u=document.querySelectorAll(e)}else{u=tn(e)}var s=u.length;for(var l=0;l<s;++l){u[l].addEventListener(t,o)}return a}function xl(e,t){var n=this.locale();return qs(e,t,n.timeParse,n.utcParse)}function _l(e,t,n){t=this.parse(t,n);return this.pulse(e,this.changeset().insert(t))}function wl(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r,i,a;return __generator(this,(function(o){switch(o.label){case 0:n=this;r=0;o.label=1;case 1:o.trys.push([1,3,,4]);return[4,n.loader().load(e,{context:"dataflow",response:Us(t&&t.type)})];case 2:i=o.sent();try{i=n.parse(i,t)}catch(u){r=-2;n.warn("Data ingestion failed",e,u)}return[3,4];case 3:a=o.sent();r=-1;n.warn("Loading failed",e,a);return[3,4];case 4:return[2,{data:i,status:r}]}}))}))}function Al(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r,i,a;return __generator(this,(function(o){switch(o.label){case 0:r=this,i=r._pending||Ol(r);i.requests+=1;return[4,r.request(t,n)];case 1:a=o.sent();r.pulse(e,r.changeset().remove(_t).insert(a.data||[]));i.done();return[2,a]}}))}))}function Ol(e){var t;var n=new Promise((function(e){return t=e}));n.requests=0;n.done=function(){if(--n.requests===0){e._pending=null;t(e)}};return e._pending=n}var El={skip:true};function kl(e,t,n,r,i){var a=e instanceof dl?Cl:Dl;a(this,e,t,n,r,i);return this}function Dl(e,t,n,r,i,a){var o=hn({},a,El);var u,s;if(!rn(n))n=cn(n);if(r===undefined){u=function(t){return e.touch(n(t))}}else if(rn(r)){s=new dl(null,r,i,false);u=function(t){s.evaluate(t);var r=n(t),i=s.value;rl(i)?e.pulse(r,i,a):e.update(r,i,o)}}else{u=function(t){return e.update(n(t),r,o)}}t.apply(u)}function Cl(e,t,n,r,i,a){if(r===undefined){t.targets().add(n)}else{var o=a||{},u=new dl(null,Fl(n,r),i,false);u.modified(o.force);u.rank=t.rank;t.targets().add(u);if(n){u.skip(true);u.value=n.value;u.targets().add(n);e.connect(n,[u])}}}function Fl(e,t){t=rn(t)?t:cn(t);return e?function(n,r){var i=t(n,r);if(!e.skip()){e.skip(i!==this.value).value=i}return i}:t}function Sl(e){e.rank=++this._rank}function jl(e){var t=[e];var n,r,i;while(t.length){this.rank(n=t.pop());if(r=n._targets){for(i=r.length;--i>=0;){t.push(n=r[i]);if(n===e)pt("Cycle detected in dataflow graph.")}}}}var Ml={};var Bl=1<<0,Nl=1<<1,Tl=1<<2,zl=Bl|Nl,Pl=Bl|Tl,Rl=Bl|Nl|Tl,Ll=1<<3,Il=1<<4,Ul=1<<5,ql=1<<6;function Wl(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}function Hl(e,t){var n=[];Hn(e,t,(function(e){return n.push(e)}));return n}function Gl(e,t){var n={};e.visit(t,(function(e){n[Js(e)]=1}));return function(e){return n[Js(e)]?null:e}}function $l(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}Wl.prototype={StopPropagation:Ml,ADD:Bl,REM:Nl,MOD:Tl,ADD_REM:zl,ADD_MOD:Pl,ALL:Rl,REFLOW:Ll,SOURCE:Il,NO_SOURCE:Ul,NO_FIELDS:ql,fork:function(e){return new Wl(this.dataflow).init(this,e)},clone:function(){var e=this.fork(Rl);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(Rl|Il)},addAll:function(){var e=this;var t=!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length;if(t){return e}else{e=new Wl(this.dataflow).init(this);e.add=e.source;e.rem=[];return e}},init:function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&ql)){n.fields=e.fields}if(t&Bl){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&Nl){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&Tl){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&Ul){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source;if(e.cleans)n.cleans=e.cleans}return n},runAfter:function(e){this.dataflow.runAfter(e)},changed:function(e){var t=e||Rl;return t&Bl&&this.add.length||t&Nl&&this.rem.length||t&Tl&&this.mod.length},reflow:function(e){if(e)return this.fork(Rl).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(Tl,Gl(this,Bl))}return this},clean:function(e){if(arguments.length){this.cleans=!!e;return this}else{return this.cleans}},modifies:function(e){var t=this.fields||(this.fields={});if(St(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this},modified:function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:St(e)?e.some((function(e){return n[e]})):n[e]},filter:function(e,t){var n=this;if(e&Bl)n.addF=$l(n.addF,t);if(e&Nl)n.remF=$l(n.remF,t);if(e&Tl)n.modF=$l(n.modF,t);if(e&Il)n.srcF=$l(n.srcF,t);return n},materialize:function(e){e=e||Rl;var t=this;if(e&Bl&&t.addF){t.add=Hl(t.add,t.addF);t.addF=null}if(e&Nl&&t.remF){t.rem=Hl(t.rem,t.remF);t.remF=null}if(e&Tl&&t.modF){t.mod=Hl(t.mod,t.modF);t.modF=null}if(e&Il&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t},visit:function(e,t){var n=this,r=t;if(e&Il){Hn(n.source,n.srcF,r);return n}if(e&Bl)Hn(n.add,n.addF,r);if(e&Nl)Hn(n.rem,n.remF,r);if(e&Tl)Hn(n.mod,n.modF,r);var i=n.source;if(e&Ll&&i){var a=n.add.length+n.mod.length;if(a===i.length);else if(a){Hn(i,Gl(n,Pl),r)}else{Hn(i,n.srcF,r)}}return n}};function Vl(e,t,n,r){var i=this;var a=0;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(var o=0,u=n;o<u.length;o++){var s=u[o];if(s.stamp!==t)continue;if(s.fields){var l=i.fields||(i.fields={});for(var f in s.fields){l[f]=1}}if(s.changed(i.ADD))a|=i.ADD;if(s.changed(i.REM))a|=i.REM;if(s.changed(i.MOD))a|=i.MOD}this.changes=a}_n(Vl,Wl,{fork:function(e){var t=new Wl(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD)this.visit(t.ADD,(function(e){return t.add.push(e)}));if(e&t.REM)this.visit(t.REM,(function(e){return t.rem.push(e)}));if(e&t.MOD)this.visit(t.MOD,(function(e){return t.mod.push(e)}))}return t},changed:function(e){return this.changes&e},modified:function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:St(e)?e.some((function(e){return n[e]})):n[e]},filter:function(){pt("MultiPulse does not support filtering.")},materialize:function(){pt("MultiPulse does not support materialization.")},visit:function(e,t){var n=this,r=n.pulses,i=r.length;var a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n}});function Yl(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r,i,a,o,u,s,l,f,c,d;return __generator(this,(function(h){switch(h.label){case 0:r=this,i=[];if(r._pulse)return[2,Zl(r)];if(!r._pending)return[3,2];return[4,r._pending];case 1:h.sent();h.label=2;case 2:if(!t)return[3,4];return[4,$s(r,t)];case 3:h.sent();h.label=4;case 4:if(!r._touched.length){r.debug("Dataflow invoked, but nothing to do.");return[2,r]}a=++r._clock;r._pulse=new Wl(r,a,e);r._touched.forEach((function(e){return r._enqueue(e,true)}));r._touched=Gs(mt);o=0;h.label=5;case 5:h.trys.push([5,11,,12]);h.label=6;case 6:if(!(r._heap.size()>0))return[3,10];u=r._heap.pop();if(u.rank!==u.qrank){r._enqueue(u,true);return[3,6]}s=u.run(r._getPulse(u,e));if(!s.then)return[3,8];return[4,s];case 7:s=h.sent();return[3,9];case 8:if(s.async){i.push(s.async);s=Ml}h.label=9;case 9:if(s!==Ml){if(u._targets)u._targets.forEach((function(e){return r._enqueue(e)}))}++o;return[3,6];case 10:return[3,12];case 11:f=h.sent();r._heap.clear();l=f;return[3,12];case 12:r._input={};r._pulse=null;r.debug("Pulse ".concat(a,": ").concat(o," operators"));if(l){r._postrun=[];r.error(l)}if(!r._postrun.length)return[3,16];c=r._postrun.sort((function(e,t){return t.priority-e.priority}));r._postrun=[];d=0;h.label=13;case 13:if(!(d<c.length))return[3,16];return[4,$s(r,c[d].callback)];case 14:h.sent();h.label=15;case 15:++d;return[3,13];case 16:if(!n)return[3,18];return[4,$s(r,n)];case 17:h.sent();h.label=18;case 18:if(i.length){Promise.all(i).then((function(e){return r.runAsync(null,(function(){e.forEach((function(e){try{e(r)}catch(t){r.error(t)}}))}))}))}return[2,r]}}))}))}function Xl(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r;var i=this;return __generator(this,(function(a){switch(a.label){case 0:if(!this._running)return[3,2];return[4,this._running];case 1:a.sent();return[3,0];case 2:r=function(){return i._running=null};(this._running=this.evaluate(e,t,n)).then(r,r);return[2,this._running]}}))}))}function Jl(e,t,n){return this._pulse?Zl(this):(this.evaluate(e,t,n),this)}function Ql(e,t,n){if(this._pulse||t){this._postrun.push({priority:n||0,callback:e})}else{try{e(this)}catch(r){this.error(r)}}}function Zl(e){e.error("Dataflow already running. Use runAsync() to chain invocations.");return e}function Kl(e,t){var n=e.stamp<this._clock;if(n)e.stamp=this._clock;if(n||t){e.qrank=e.rank;this._heap.push(e)}}function ef(e,t){var n=e.source,r=this._clock;return n&&St(n)?new Vl(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||tf(this._pulse,n&&n.pulse)}function tf(e,t){if(t&&t.stamp===e.stamp){return t}e=e.fork();if(t&&t!==Ml){e.source=t.source}return e}var nf={skip:false,force:false};function rf(e,t){var n=t||nf;if(this._pulse){this._enqueue(e)}else{this._touched.add(e)}if(n.skip)e.skip(true);return this}function af(e,t,n){var r=n||nf;if(e.set(t)||r.force){this.touch(e,r)}return this}function of(e,t,n){this.touch(e,n||nf);var r=new Wl(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];r.target=e;this._input[e.id]=t.pulse(r,i);return this}function uf(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){t.push(n);return sf(t,0,t.length-1,e)},pop:function(){var n=t.pop();var r;if(t.length){r=t[0];t[0]=n;lf(t,0,e)}else{r=n}return r}}}function sf(e,t,n,r){var i,a;var o=e[n];while(n>t){a=n-1>>1;i=e[a];if(r(o,i)<0){e[n]=i;n=a;continue}break}return e[n]=o}function lf(e,t,n){var r=t,i=e.length,a=e[t];var o=(t<<1)+1,u;while(o<i){u=o+1;if(u<i&&n(e[o],e[u])>=0){o=u}e[t]=e[o];t=o;o=(t<<1)+1}e[t]=a;return sf(e,r,t,n)}function ff(){this.logger(Ft());this.logLevel(Et);this._clock=0;this._rank=0;this._locale=ls();try{this._loader=Hs()}catch(Bse){}this._touched=Gs(mt);this._input={};this._pulse=null;this._heap=uf((function(e,t){return e.qrank-t.qrank}));this._postrun=[]}function cf(e){return function(){return this._log[e].apply(this,arguments)}}ff.prototype={stamp:function(){return this._clock},loader:function(e){if(arguments.length){this._loader=e;return this}else{return this._loader}},locale:function(e){if(arguments.length){this._locale=e;return this}else{return this._locale}},logger:function(e){if(arguments.length){this._log=e;return this}else{return this._log}},error:cf("error"),warn:cf("warn"),info:cf("info"),debug:cf("debug"),logLevel:cf("level"),cleanThreshold:1e4,add:pl,connect:vl,rank:Sl,rerank:jl,pulse:of,touch:rf,update:af,changeset:il,ingest:_l,parse:xl,preload:Al,request:wl,events:bl,on:kl,evaluate:Yl,run:Jl,runAsync:Xl,runAfter:Ql,_enqueue:Kl,_getPulse:ef};function df(e,t){dl.call(this,e,null,t)}_n(df,dl,{run:function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n},evaluate:function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n},transform:function(){}});var hf={};function pf(e){var t=vf(e);return t&&t.Definition||null}function vf(e){e=e&&e.toLowerCase();return mn(hf,e)?hf[e]:null}function gf(e,t){var n,r,i,a,o,u,s;return __generator(this,(function(l){switch(l.label){case 0:if(!(t==null))return[3,5];n=0,r=e;l.label=1;case 1:if(!(n<r.length))return[3,4];i=r[n];if(!(i!=null&&i!==""&&(i=+i)>=i))return[3,3];return[4,i];case 2:l.sent();l.label=3;case 3:n++;return[3,1];case 4:return[3,9];case 5:a=-1;o=0,u=e;l.label=6;case 6:if(!(o<u.length))return[3,9];s=u[o];s=t(s,++a,e);if(!(s!=null&&s!==""&&(s=+s)>=s))return[3,8];return[4,s];case 7:l.sent();l.label=8;case 8:o++;return[3,6];case 9:return[2]}}))}function mf(e,t,n){var r=Float64Array.from(gf(e,n));r.sort(hr);return t.map((function(e){return $r(r,e)}))}function yf(e,t){return mf(e,[.25,.5,.75],t)}function bf(e,t){var n=e.length,r=Ar(e,t),i=yf(e,t),a=(i[2]-i[0])/1.34,o=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*o*Math.pow(n,-.2)}function xf(e){var t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];var a=e.extent[0],o=e.extent[1],u,s,l,f,c,d;var h=e.span||o-a||Math.abs(a)||1;if(e.step){u=e.step}else if(e.steps){f=h/t;for(c=0,d=e.steps.length;c<d&&e.steps[c]<f;++c);u=e.steps[Math.max(0,c-1)]}else{s=Math.ceil(Math.log(t)/r);l=e.minstep||0;u=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-s));while(Math.ceil(h/u)>t){u*=n}for(c=0,d=i.length;c<d;++c){f=u/i[c];if(f>=l&&h/f<=t)u=f}}f=Math.log(u);var p=f>=0?0:~~(-f/r)+1,v=Math.pow(n,-p-1);if(e.nice||e.nice===undefined){f=Math.floor(a/u+v)*u;a=a<f?f-u:f;o=Math.ceil(o/u)*u}return{start:a,stop:o===a?a+u:o,step:u}}var _f=Math.random;function wf(e){_f=e}function Af(e,t,n,r){if(!e.length)return[undefined,undefined];var i=Float64Array.from(gf(e,r)),a=i.length,o=t;var u,s,l,f;for(l=0,f=Array(o);l<o;++l){for(u=0,s=0;s<a;++s){u+=i[~~(_f()*a)]}f[l]=u/a}f.sort(hr);return[Gr(f,n/2),Gr(f,1-n/2)]}function Of(e,t,n,r){r=r||function(e){return e};var i=e.length,a=new Float64Array(i);var o=0,u=1,s=r(e[0]),l=s,f=s+t,c;for(;u<i;++u){c=r(e[u]);if(c>=f){l=(s+l)/2;for(;o<u;++o)a[o]=l;f=c+t;s=c}l=c}l=(s+l)/2;for(;o<u;++o)a[o]=l;return n?Ef(a,t+t/4):a}function Ef(e,t){var n=e.length;var r=0,i=1,a,o;while(e[r]===e[i])++i;while(i<n){a=i+1;while(e[i]===e[a])++a;if(e[i]-e[i-1]<t){o=i+(r+a-i-i>>1);while(o<i)e[o++]=e[i];while(o>i)e[o--]=e[r]}r=i;i=a}return e}function kf(e){return function(){e=(1103515245*e+12345)%2147483647;return e/2147483647}}function Df(e,t){if(t==null){t=e;e=0}var n,r,i;var a={min:function(e){if(arguments.length){n=e||0;i=r-n;return a}else{return n}},max:function(e){if(arguments.length){r=e||0;i=r-n;return a}else{return r}},sample:function(){return n+Math.floor(i*_f())},pdf:function(e){return e===Math.floor(e)&&e>=n&&e<r?1/i:0},cdf:function(e){var t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/i},icdf:function(e){return e>=0&&e<=1?n-1+Math.floor(e*i):NaN}};return a.min(e).max(t)}var Cf=Math.sqrt(2*Math.PI);var Ff=Math.SQRT2;var Sf=NaN;function jf(e,t){e=e||0;t=t==null?1:t;var n=0,r=0,i,a;if(Sf===Sf){n=Sf;Sf=NaN}else{do{n=_f()*2-1;r=_f()*2-1;i=n*n+r*r}while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i);n*=a;Sf=r*a}return e+n*t}function Mf(e,t,n){n=n==null?1:n;var r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*Cf)}function Bf(e,t,n){t=t||0;n=n==null?1:n;var r=(e-t)/n,i=Math.abs(r);var a;if(i>37){a=0}else{var o=Math.exp(-i*i/2);var u;if(i<7.07106781186547){u=.0352624965998911*i+.700383064443688;u=u*i+6.37396220353165;u=u*i+33.912866078383;u=u*i+112.079291497871;u=u*i+221.213596169931;u=u*i+220.206867912376;a=o*u;u=.0883883476483184*i+1.75566716318264;u=u*i+16.064177579207;u=u*i+86.7807322029461;u=u*i+296.564248779674;u=u*i+637.333633378831;u=u*i+793.826512519948;u=u*i+440.413735824752;a=a/u}else{u=i+.65;u=i+4/u;u=i+3/u;u=i+2/u;u=i+1/u;a=o/u/2.506628274631}}return r>0?1-a:a}function Nf(e,t,n){if(e<0||e>1)return NaN;return(t||0)+(n==null?1:n)*Ff*Tf(2*e-1)}function Tf(e){var t=-Math.log((1-e)*(1+e)),n;if(t<6.25){t-=3.125;n=-364441206401782e-35;n=-16850591381820166e-35+n*t;n=128584807152564e-32+n*t;n=11157877678025181e-33+n*t;n=-1333171662854621e-31+n*t;n=20972767875968562e-33+n*t;n=6637638134358324e-30+n*t;n=-4054566272975207e-29+n*t;n=-8151934197605472e-29+n*t;n=26335093153082323e-28+n*t;n=-12975133253453532e-27+n*t;n=-5415412054294628e-26+n*t;n=1.0512122733215323e-9+n*t;n=-4.112633980346984e-9+n*t;n=-2.9070369957882005e-8+n*t;n=4.2347877827932404e-7+n*t;n=-13654692000834679e-22+n*t;n=-13882523362786469e-21+n*t;n=.00018673420803405714+n*t;n=-.000740702534166267+n*t;n=-.006033670871430149+n*t;n=.24015818242558962+n*t;n=1.6536545626831027+n*t}else if(t<16){t=Math.sqrt(t)-3.25;n=2.2137376921775787e-9;n=9.075656193888539e-8+n*t;n=-2.7517406297064545e-7+n*t;n=1.8239629214389228e-8+n*t;n=15027403968909828e-22+n*t;n=-4013867526981546e-21+n*t;n=29234449089955446e-22+n*t;n=12475304481671779e-21+n*t;n=-47318229009055734e-21+n*t;n=6828485145957318e-20+n*t;n=24031110387097894e-21+n*t;n=-.0003550375203628475+n*t;n=.0009532893797373805+n*t;n=-.0016882755560235047+n*t;n=.002491442096107851+n*t;n=-.003751208507569241+n*t;n=.005370914553590064+n*t;n=1.0052589676941592+n*t;n=3.0838856104922208+n*t}else if(Number.isFinite(t)){t=Math.sqrt(t)-5;n=-27109920616438573e-27;n=-2.555641816996525e-10+n*t;n=1.5076572693500548e-9+n*t;n=-3.789465440126737e-9+n*t;n=7.61570120807834e-9+n*t;n=-1.496002662714924e-8+n*t;n=2.914795345090108e-8+n*t;n=-6.771199775845234e-8+n*t;n=2.2900482228026655e-7+n*t;n=-9.9298272942317e-7+n*t;n=4526062597223154e-21+n*t;n=-1968177810553167e-20+n*t;n=7599527703001776e-20+n*t;n=-.00021503011930044477+n*t;n=-.00013871931833623122+n*t;n=1.0103004648645344+n*t;n=4.849906401408584+n*t}else{n=Infinity}return n*e}function zf(e,t){var n,r;var i={mean:function(e){if(arguments.length){n=e||0;return i}else{return n}},stdev:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return jf(n,r)},pdf:function(e){return Mf(e,n,r)},cdf:function(e){return Bf(e,n,r)},icdf:function(e){return Nf(e,n,r)}};return i.mean(e).stdev(t)}function Pf(e,t){var n=zf();var r=0;var i={data:function(n){if(arguments.length){e=n;r=n?n.length:0;return i.bandwidth(t)}else{return e}},bandwidth:function(n){if(!arguments.length)return t;t=n;if(!t&&e)t=bf(e);return i},sample:function(){return e[~~(_f()*r)]+t*n.sample()},pdf:function(i){var a=0,o=0;for(;o<r;++o){a+=n.pdf((i-e[o])/t)}return a/t/r},cdf:function(i){var a=0,o=0;for(;o<r;++o){a+=n.cdf((i-e[o])/t)}return a/r},icdf:function(){throw Error("KDE icdf not supported.")}};return i.data(e)}function Rf(e,t){e=e||0;t=t==null?1:t;return Math.exp(e+jf()*t)}function Lf(e,t,n){if(e<=0)return 0;t=t||0;n=n==null?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Cf*e)}function If(e,t,n){return Bf(Math.log(e),t,n)}function Uf(e,t,n){return Math.exp(Nf(e,t,n))}function qf(e,t){var n,r;var i={mean:function(e){if(arguments.length){n=e||0;return i}else{return n}},stdev:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return Rf(n,r)},pdf:function(e){return Lf(e,n,r)},cdf:function(e){return If(e,n,r)},icdf:function(e){return Uf(e,n,r)}};return i.mean(e).stdev(t)}function Wf(e,t){var n=0,r;function i(e){var t=[];var r=0,i;for(i=0;i<n;++i){r+=t[i]=e[i]==null?1:+e[i]}for(i=0;i<n;++i){t[i]/=r}return t}var a={weights:function(e){if(arguments.length){r=i(t=e||[]);return a}return t},distributions:function(r){if(arguments.length){if(r){n=r.length;e=r}else{n=0;e=[]}return a.weights(t)}return e},sample:function(){var t=_f();var i=e[n-1],a=r[0],o=0;for(;o<n-1;a+=r[++o]){if(t<a){i=e[o];break}}return i.sample()},pdf:function(t){var i=0,a=0;for(;a<n;++a){i+=r[a]*e[a].pdf(t)}return i},cdf:function(t){var i=0,a=0;for(;a<n;++a){i+=r[a]*e[a].cdf(t)}return i},icdf:function(){throw Error("Mixture icdf not supported.")}};return a.distributions(e).weights(t)}function Hf(e,t){if(t==null){t=e==null?1:e;e=0}return e+(t-e)*_f()}function Gf(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=t&&e<=n?1/(n-t):0}function $f(e,t,n){if(n==null){n=t==null?1:t;t=0}return e<t?0:e>n?1:(e-t)/(n-t)}function Vf(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=0&&e<=1?t+e*(n-t):NaN}function Yf(e,t){var n,r;var i={min:function(e){if(arguments.length){n=e||0;return i}else{return n}},max:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return Hf(n,r)},pdf:function(e){return Gf(e,n,r)},cdf:function(e){return $f(e,n,r)},icdf:function(e){return Vf(e,n,r)}};if(t==null){t=e==null?1:e;e=0}return i.min(e).max(t)}function Xf(e,t,n,r){var i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i,o=t-a*e;return[o,a]}function Jf(e,t,n,r){e=e.filter((function(e){var r=t(e),i=n(e);return r!=null&&(r=+r)>=r&&i!=null&&(i=+i)>=i}));if(r){e.sort((function(e,n){return t(e)-t(n)}))}var i=e.length,a=new Float64Array(i),o=new Float64Array(i);var u=0,s=0,l=0,f,c,d;for(var h=0,p=e;h<p.length;h++){d=p[h];a[u]=f=+t(d);o[u]=c=+n(d);++u;s+=(f-s)/u;l+=(c-l)/u}for(u=0;u<i;++u){a[u]-=s;o[u]-=l}return[a,o,s,l]}function Qf(e,t,n,r){var i=-1,a,o;for(var u=0,s=e;u<s.length;u++){var l=s[u];a=t(l);o=n(l);if(a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o){r(a,o,++i)}}}function Zf(e,t,n,r,i){var a=0,o=0;Qf(e,t,n,(function(e,t){var n=t-i(e),u=t-r;a+=n*n;o+=u*u}));return 1-a/o}function Kf(e,t,n){var r=0,i=0,a=0,o=0,u=0;Qf(e,t,n,(function(e,t){++u;r+=(e-r)/u;i+=(t-i)/u;a+=(e*t-a)/u;o+=(e*e-o)/u}));var s=Xf(r,i,a,o),l=function(e){return s[0]+s[1]*e};return{coef:s,predict:l,rSquared:Zf(e,t,n,i,l)}}function ec(e,t,n){var r=0,i=0,a=0,o=0,u=0;Qf(e,t,n,(function(e,t){++u;e=Math.log(e);r+=(e-r)/u;i+=(t-i)/u;a+=(e*t-a)/u;o+=(e*e-o)/u}));var s=Xf(r,i,a,o),l=function(e){return s[0]+s[1]*Math.log(e)};return{coef:s,predict:l,rSquared:Zf(e,t,n,i,l)}}function tc(e,t,n){var r=Jf(e,t,n),i=r[0],a=r[1],o=r[2],u=r[3];var s=0,l=0,f=0,c=0,d=0,h,p,v;Qf(e,t,n,(function(e,t){h=i[d++];p=Math.log(t);v=h*t;s+=(t*p-s)/d;l+=(v-l)/d;f+=(v*p-f)/d;c+=(h*v-c)/d}));var g=Xf(l/u,s/u,f/u,c/u),m=g[0],y=g[1],b=function(e){return Math.exp(m+y*(e-o))};return{coef:[Math.exp(m-y*o),y],predict:b,rSquared:Zf(e,t,n,u,b)}}function nc(e,t,n){var r=0,i=0,a=0,o=0,u=0,s=0;Qf(e,t,n,(function(e,t){var n=Math.log(e),l=Math.log(t);++s;r+=(n-r)/s;i+=(l-i)/s;a+=(n*l-a)/s;o+=(n*n-o)/s;u+=(t-u)/s}));var l=Xf(r,i,a,o),f=function(e){return l[0]*Math.pow(e,l[1])};l[0]=Math.exp(l[0]);return{coef:l,predict:f,rSquared:Zf(e,t,n,u,f)}}function rc(e,t,n){var r=Jf(e,t,n),i=r[0],a=r[1],o=r[2],u=r[3],s=i.length;var l=0,f=0,c=0,d=0,h=0,p,v,g,m;for(p=0;p<s;){v=i[p];g=a[p++];m=v*v;l+=(m-l)/p;f+=(m*v-f)/p;c+=(m*m-c)/p;d+=(v*g-d)/p;h+=(m*g-h)/p}var y=c-l*l,b=l*y-f*f,x=(h*l-d*f)/b,_=(d*y-h*f)/b,w=-x*l,A=function(e){e=e-o;return x*e*e+_*e+w+u};return{coef:[w-_*o+x*o*o+u,_-2*x*o,x],predict:A,rSquared:Zf(e,t,n,u,A)}}function ic(e,t,n,r){if(r===1)return Kf(e,t,n);if(r===2)return rc(e,t,n);var i=Jf(e,t,n),a=i[0],o=i[1],u=i[2],s=i[3],l=a.length,f=[],c=[],d=r+1;var h,p,v,g,m;for(h=0;h<d;++h){for(v=0,g=0;v<l;++v){g+=Math.pow(a[v],h)*o[v]}f.push(g);m=new Float64Array(d);for(p=0;p<d;++p){for(v=0,g=0;v<l;++v){g+=Math.pow(a[v],h+p)}m[p]=g}c.push(m)}c.push(f);var y=oc(c),b=function(e){e-=u;var t=s+y[0]+y[1]*e+y[2]*e*e;for(h=3;h<d;++h)t+=y[h]*Math.pow(e,h);return t};return{coef:ac(d,y,-u,s),predict:b,rSquared:Zf(e,t,n,s,b)}}function ac(e,t,n,r){var i=Array(e);var a,o,u,s;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a){u=t[a];s=1;i[a]+=u;for(o=1;o<=a;++o){s*=(a+1-o)/o;i[a-o]+=u*Math.pow(n,o)*s}}i[0]+=r;return i}function oc(e){var t=e.length-1,n=[];var r,i,a,o,u;for(r=0;r<t;++r){o=r;for(i=r+1;i<t;++i){if(Math.abs(e[r][i])>Math.abs(e[r][o])){o=i}}for(a=r;a<t+1;++a){u=e[a][r];e[a][r]=e[a][o];e[a][o]=u}for(i=r+1;i<t;++i){for(a=t;a>=r;a--){e[a][i]-=e[a][r]*e[r][i]/e[r][r]}}}for(i=t-1;i>=0;--i){u=0;for(a=i+1;a<t;++a){u+=e[a][i]*n[a]}n[i]=(e[t][i]-u)/e[i][i]}return n}var uc=2,sc=1e-12;function lc(e,t,n,r){var i=Jf(e,t,n,true),a=i[0],o=i[1],u=i[2],s=i[3],l=a.length,f=Math.max(2,~~(r*l)),c=new Float64Array(l),d=new Float64Array(l),h=new Float64Array(l).fill(1);for(var p=-1;++p<=uc;){var v=[0,f-1];for(var g=0;g<l;++g){var m=a[g],y=v[0],b=v[1],x=m-a[y]>a[b]-m?y:b;var _=0,w=0,A=0,O=0,E=0;var k=1/Math.abs(a[x]-m||1);for(var D=y;D<=b;++D){var C=a[D],F=o[D],S=fc(Math.abs(m-C)*k)*h[D],j=C*S;_+=S;w+=j;A+=F*S;O+=F*j;E+=C*j}var M=Xf(w/_,A/_,O/_,E/_),B=M[0],N=M[1];c[g]=B+N*m;d[g]=Math.abs(o[g]-c[g]);cc(a,g+1,v)}if(p===uc){break}var T=Yr(d);if(Math.abs(T)<sc)break;for(var g=0,z=void 0,P;g<l;++g){z=d[g]/(6*T);h[g]=z>=1?sc:(P=1-z*z)*P}}return dc(a,c,u,s)}function fc(e){return(e=1-e*e*e)*e*e}function cc(e,t,n){var r=e[t];var i=n[0],a=n[1]+1;if(a>=e.length)return;while(t>i&&e[a]-r<=r-e[i]){n[0]=++i;n[1]=a;++a}}function dc(e,t,n,r){var i=e.length,a=[];var o=0,u=0,s=[],l;for(;o<i;++o){l=e[o]+n;if(s[0]===l){s[1]+=(t[o]-s[1])/++u}else{u=0;s[1]+=r;s=[l,t[o]];a.push(s)}}s[1]+=r;return a}var hc=.5*Math.PI/180;function pc(e,t,n,r){n=n||25;r=Math.max(n,r||200);var i=function(t){return[t,e(t)]},a=t[0],o=t[1],u=o-a,s=u/r,l=[i(a)],f=[];if(n===r){for(var c=1;c<r;++c){l.push(i(a+c/n*u))}l.push(i(o));return l}else{f.push(i(o));for(var c=n;--c>0;){f.push(i(a+c/n*u))}}var d=l[0];var h=f[f.length-1];var p=1/u;var v=vc(d[1],f);while(h){var g=i((d[0]+h[0])/2);var m=g[0]-d[0]>=s;if(m&&gc(d,g,h,p,v)>hc){f.push(g)}else{d=h;l.push(h);f.pop()}h=f[f.length-1]}return l}function vc(e,t){var n=e;var r=e;var i=t.length;for(var a=0;a<i;++a){var o=t[a][1];if(o<n)n=o;if(o>r)r=o}return 1/(r-n)}function gc(e,t,n,r,i){var a=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),o=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(a-o)}function mc(e){return function(t){var n=e.length;var r=1,i=String(e[0](t));for(;r<n;++r){i+="|"+e[r](t)}return i}}function yc(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:mc(e)}function bc(e,t,n){return n||e+(!t?"":"_"+t)}var xc=function(){};var _c={init:xc,add:xc,rem:xc,idx:0};var wc={values:{init:function(e){return e.cell.store=true},value:function(e){return e.cell.data.values()},idx:-1},count:{value:function(e){return e.cell.num}},__count__:{value:function(e){return e.missing+e.valid}},missing:{value:function(e){return e.missing}},valid:{value:function(e){return e.valid}},sum:{init:function(e){return e.sum=0},value:function(e){return e.sum},add:function(e,t){return e.sum+=+t},rem:function(e,t){return e.sum-=t}},product:{init:function(e){return e.product=1},value:function(e){return e.valid?e.product:undefined},add:function(e,t){return e.product*=t},rem:function(e,t){return e.product/=t}},mean:{init:function(e){return e.mean=0},value:function(e){return e.valid?e.mean:undefined},add:function(e,t){return e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:function(e,t){return e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}},average:{value:function(e){return e.valid?e.mean:undefined},req:["mean"],idx:1},variance:{init:function(e){return e.dev=0},value:function(e){return e.valid>1?e.dev/(e.valid-1):undefined},add:function(e,t){return e.dev+=e.mean_d*(t-e.mean)},rem:function(e,t){return e.dev-=e.mean_d*(t-e.mean)},req:["mean"],idx:1},variancep:{value:function(e){return e.valid>1?e.dev/e.valid:undefined},req:["variance"],idx:2},stdev:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid-1)):undefined},req:["variance"],idx:2},stdevp:{value:function(e){return e.valid>1?Math.sqrt(e.dev/e.valid):undefined},req:["variance"],idx:2},stderr:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):undefined},req:["variance"],idx:2},distinct:{value:function(e){return e.cell.data.distinct(e.get)},req:["values"],idx:3},ci0:{value:function(e){return e.cell.data.ci0(e.get)},req:["values"],idx:3},ci1:{value:function(e){return e.cell.data.ci1(e.get)},req:["values"],idx:3},median:{value:function(e){return e.cell.data.q2(e.get)},req:["values"],idx:3},q1:{value:function(e){return e.cell.data.q1(e.get)},req:["values"],idx:3},q3:{value:function(e){return e.cell.data.q3(e.get)},req:["values"],idx:3},min:{init:function(e){return e.min=undefined},value:function(e){return e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min},add:function(e,t){if(t<e.min||e.min===undefined)e.min=t},rem:function(e,t){if(t<=e.min)e.min=NaN},req:["values"],idx:4},max:{init:function(e){return e.max=undefined},value:function(e){return e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max},add:function(e,t){if(t>e.max||e.max===undefined)e.max=t},rem:function(e,t){if(t>=e.max)e.max=NaN},req:["values"],idx:4},argmin:{init:function(e){return e.argmin=undefined},value:function(e){return e.argmin||e.cell.data.argmin(e.get)},add:function(e,t,n){if(t<e.min)e.argmin=n},rem:function(e,t){if(t<=e.min)e.argmin=undefined},req:["min","values"],idx:3},argmax:{init:function(e){return e.argmax=undefined},value:function(e){return e.argmax||e.cell.data.argmax(e.get)},add:function(e,t,n){if(t>e.max)e.argmax=n},rem:function(e,t){if(t>=e.max)e.argmax=undefined},req:["max","values"],idx:3}};var Ac=Object.keys(wc).filter((function(e){return e!=="__count__"}));function Oc(e,t){return function(n){return hn({name:e,out:n||e},_c,t)}}__spreadArray(__spreadArray([],Ac,true),["__count__"],false).forEach((function(e){wc[e]=Oc(e,wc[e])}));function Ec(e,t){return wc[e](t)}function kc(e,t){return e.idx-t.idx}function Dc(e){var t={};e.forEach((function(e){return t[e.name]=e}));var n=function(e){if(!e.req)return;e.req.forEach((function(e){if(!t[e])n(t[e]=wc[e]())}))};e.forEach(n);return Object.values(t).sort(kc)}function Cc(){var e=this;this.valid=0;this.missing=0;this._ops.forEach((function(t){return t.init(e)}))}function Fc(e,t){var n=this;if(e==null||e===""){++this.missing;return}if(e!==e)return;++this.valid;this._ops.forEach((function(r){return r.add(n,e,t)}))}function Sc(e,t){var n=this;if(e==null||e===""){--this.missing;return}if(e!==e)return;--this.valid;this._ops.forEach((function(r){return r.rem(n,e,t)}))}function jc(e){var t=this;this._out.forEach((function(n){return e[n.out]=n.value(t)}));return e}function Mc(e,t){var n=t||yt,r=Dc(e),i=e.slice().sort(kc);function a(e){this._ops=r;this._out=i;this.cell=e;this.init()}a.prototype.init=Cc;a.prototype.add=Fc;a.prototype.rem=Sc;a.prototype.set=jc;a.prototype.get=n;a.fields=e.map((function(e){return e.out}));return a}function Bc(e){this._key=e?gt(e):Js;this.reset()}var Nc=Bc.prototype;Nc.reset=function(){this._add=[];this._rem=[];this._ext=null;this._get=null;this._q=null};Nc.add=function(e){this._add.push(e)};Nc.rem=function(e){this._rem.push(e)};Nc.values=function(){this._get=null;if(this._rem.length===0)return this._add;var e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={};var u,s,l;for(u=0;u<i;++u){o[n(t[u])]=1}for(u=0,s=0;u<r;++u){if(o[n(l=e[u])]){o[n(l)]=0}else{a[s++]=l}}this._rem=[];return this._add=a};Nc.distinct=function(e){var t=this.values(),n={};var r=t.length,i=0,a;while(--r>=0){a=e(t[r])+"";if(!mn(n,a)){n[a]=1;++i}}return i};Nc.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=vn(t,e);this._ext=[t[n[0]],t[n[1]]];this._get=e}return this._ext};Nc.argmin=function(e){return this.extent(e)[0]||{}};Nc.argmax=function(e){return this.extent(e)[1]||{}};Nc.min=function(e){var t=this.extent(e)[0];return t!=null?e(t):undefined};Nc.max=function(e){var t=this.extent(e)[1];return t!=null?e(t):undefined};Nc.quartile=function(e){if(this._get!==e||!this._q){this._q=yf(this.values(),e);this._get=e}return this._q};Nc.q1=function(e){return this.quartile(e)[0]};Nc.q2=function(e){return this.quartile(e)[1]};Nc.q3=function(e){return this.quartile(e)[2]};Nc.ci=function(e){if(this._get!==e||!this._ci){this._ci=Af(this.values(),1e3,.05,e);this._get=e}return this._ci};Nc.ci0=function(e){return this.ci(e)[0]};Nc.ci1=function(e){return this.ci(e)[1]};function Tc(e){df.call(this,null,e);this._adds=[];this._mods=[];this._alen=0;this._mlen=0;this._drop=true;this._cross=false;this._dims=[];this._dnames=[];this._measures=[];this._countOnly=false;this._counts=null;this._prev=null;this._inputs=null;this._outputs=null}Tc.Definition={type:"Aggregate",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:Ac},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"drop",type:"boolean",default:true},{name:"cross",type:"boolean",default:false},{name:"key",type:"field"}]};_n(Tc,df,{transform:function(e,t){var n=this;var r=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.modified();r.stamp=i.stamp;if(r.value&&(a||t.modified(r._inputs,true))){r._prev=r.value;r.value=a?r.init(e):Object.create(null);t.visit(t.SOURCE,(function(e){return r.add(e)}))}else{r.value=r.value||r.init(e);t.visit(t.REM,(function(e){return r.rem(e)}));t.visit(t.ADD,(function(e){return r.add(e)}))}i.modifies(r._outputs);r._drop=e.drop!==false;if(e.cross&&r._dims.length>1){r._drop=false;r.cross()}if(t.clean()&&r._drop){i.clean(true).runAfter((function(){return n.clean()}))}return r.changes(i)},cross:function(){var e=this,t=e.value,n=e._dnames,r=n.map((function(){return{}})),i=n.length;function a(e){var t,a,o,u;for(t in e){o=e[t].tuple;for(a=0;a<i;++a){r[a][u=o[n[a]]]=u}}}a(e._prev);a(t);function o(a,u,s){var l=n[s],f=r[s++];for(var c in f){var d=a?a+"|"+c:c;u[l]=f[c];if(s<i)o(d,u,s);else if(!t[d])e.cell(d,u)}}o("",{},0)},init:function(e){var t=this._inputs=[],n=this._outputs=[],r={};function i(e){var n=tn(ft(e)),i=n.length;var a=0,o;for(;a<i;++a){if(!r[o=n[a]]){r[o]=1;t.push(o)}}}this._dims=tn(e.groupby);this._dnames=this._dims.map((function(e){var t=lt(e);i(e);n.push(t);return t}));this.cellkey=e.key?e.key:yc(this._dims);this._countOnly=true;this._counts=[];this._measures=[];var a=e.fields||[null],o=e.ops||["count"],u=e.as||[],s=a.length,l={};var f,c,d,h,p,v;if(s!==o.length){pt("Unmatched number of fields and aggregate ops.")}for(v=0;v<s;++v){f=a[v];c=o[v];if(f==null&&c!=="count"){pt("Null aggregate field specified.")}h=lt(f);p=bc(c,h,u[v]);n.push(p);if(c==="count"){this._counts.push(p);continue}d=l[h];if(!d){i(f);d=l[h]=[];d.field=f;this._measures.push(d)}if(c!=="count")this._countOnly=false;d.push(Ec(c,p))}this._measures=this._measures.map((function(e){return Mc(e,e.field)}));return Object.create(null)},cellkey:yc(),cell:function(e,t){var n=this.value[e];if(!n){n=this.value[e]=this.newcell(e,t);this._adds[this._alen++]=n}else if(n.num===0&&this._drop&&n.stamp<this.stamp){n.stamp=this.stamp;this._adds[this._alen++]=n}else if(n.stamp<this.stamp){n.stamp=this.stamp;this._mods[this._mlen++]=n}return n},newcell:function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:false};if(!this._countOnly){var r=this._measures,i=r.length;n.agg=Array(i);for(var a=0;a<i;++a){n.agg[a]=new r[a](n)}}if(n.store){n.data=new Bc}return n},newtuple:function(e,t){var n=this._dnames,r=this._dims,i=r.length,a={};for(var o=0;o<i;++o){a[n[o]]=r[o](e)}return t?tl(t.tuple,a):Zs(a)},clean:function(){var e=this.value;for(var t in e){if(e[t].num===0){delete e[t]}}},add:function(e){var t=this.cellkey(e),n=this.cell(t,e);n.num+=1;if(this._countOnly)return;if(n.store)n.data.add(e);var r=n.agg;for(var i=0,a=r.length;i<a;++i){r[i].add(r[i].get(e),e)}},rem:function(e){var t=this.cellkey(e),n=this.cell(t,e);n.num-=1;if(this._countOnly)return;if(n.store)n.data.rem(e);var r=n.agg;for(var i=0,a=r.length;i<a;++i){r[i].rem(r[i].get(e),e)}},celltuple:function(e){var t=e.tuple,n=this._counts;if(e.store){e.data.values()}for(var r=0,i=n.length;r<i;++r){t[n[r]]=e.num}if(!this._countOnly){var a=e.agg;for(var r=0,i=a.length;r<i;++r){a[r].set(t)}}return t},changes:function(e){var t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,u=e.mod;var s,l,f,c;if(r)for(l in r){s=r[l];if(!i||s.num)o.push(s.tuple)}for(f=0,c=this._alen;f<c;++f){a.push(this.celltuple(t[f]));t[f]=null}for(f=0,c=this._mlen;f<c;++f){s=n[f];(s.num===0&&i?o:u).push(this.celltuple(s));n[f]=null}this._alen=this._mlen=0;this._prev=null;return e}});var zc=1e-14;function Pc(e){df.call(this,null,e)}Pc.Definition={type:"Bin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:true,default:[5,2]},{name:"extent",type:"number",array:true,length:2,required:true},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:true},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:true},{name:"name",type:"string"},{name:"as",type:"string",array:true,length:2,default:["bin0","bin1"]}]};_n(Pc,df,{transform:function(e,t){var n=e.interval!==false,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],u=o[0],s=o[1];var l;if(e.modified()){t=t.reflow(true);l=t.SOURCE}else{l=t.modified(ft(e.field))?t.ADD_MOD:t.ADD}t.visit(l,n?function(e){var t=r(e);e[u]=t;e[s]=t==null?null:i+a*(1+(t-i)/a)}:function(e){return e[u]=r(e)});return t.modifies(n?o:u)},_bins:function(e){if(this.value&&!e.modified()){return this.value}var t=e.field,n=xf(e),r=n.step;var i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,u;if((o=e.anchor)!=null){u=o-(i+r*Math.floor((o-i)/r));i+=u;a+=u}var s=function(e){var n=Pt(t(e));return n==null?null:n<i?-Infinity:n>a?+Infinity:(n=Math.max(i,Math.min(n,a-r)),i+r*Math.floor(zc+(n-i)/r))};s.start=i;s.stop=n.stop;s.step=r;return this.value=st(s,ft(t),e.name||"bin_"+lt(t))}});function Rc(e,t,n){var r=e;var i=t||[],a=n||[],o={},u=0;return{add:function(e){return a.push(e)},remove:function(e){return o[r(e)]=++u},size:function(){return i.length},data:function(e,t){if(u){i=i.filter((function(e){return!o[r(e)]}));o={};u=0}if(t&&e){i.sort(e)}if(a.length){i=e?Bn(e,i,a.sort(e)):i.concat(a);a=[]}return i}}}function Lc(e){df.call(this,[],e)}Lc.Definition={type:"Collect",metadata:{source:true},params:[{name:"sort",type:"compare"}]};_n(Lc,df,{transform:function(e,t){var n=t.fork(t.ALL),r=Rc(Js,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));n.visit(n.REM,r.remove);this.modified(a);this.value=n.source=r.data(nl(i),a);if(t.source&&t.source.root){this.value.root=t.source.root}return n}});function Ic(e){dl.call(this,null,Uc,e)}_n(Ic,dl);function Uc(e){return this.value&&!e.modified()?this.value:on(e.fields,e.orders)}function qc(e){df.call(this,null,e)}qc.Definition={type:"CountPattern",metadata:{generates:true,changes:true},params:[{name:"field",type:"field",required:true},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:true,length:2,default:["text","count"]}]};function Wc(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}_n(qc,df,{transform:function(e,t){var n=function(t){return function(n){var r=Wc(u(n),e.case,a)||[],i;for(var s=0,l=r.length;s<l;++s){if(!o.test(i=r[s]))t(i)}}};var r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,u=e.field,s=e.as||["text","count"],l=n((function(e){return i[e]=1+(i[e]||0)})),f=n((function(e){return i[e]-=1}));if(r){t.visit(t.SOURCE,l)}else{t.visit(t.ADD,l);t.visit(t.REM,f)}return this._finish(t,s)},_parameterCheck:function(e,t){var n=false;if(e.modified("stopwords")||!this._stop){this._stop=new RegExp("^"+(e.stopwords||"")+"$","i");n=true}if(e.modified("pattern")||!this._match){this._match=new RegExp(e.pattern||"[\\w']+","g");n=true}if(e.modified("field")||t.modified(e.field.fields)){n=true}if(n)this._counts={};return n},_finish:function(e,t){var n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);var u,s,l;for(u in n){s=r[u];l=n[u]||0;if(!s&&l){r[u]=s=Zs({});s[i]=u;s[a]=l;o.add.push(s)}else if(l===0){if(s)o.rem.push(s);n[u]=null;r[u]=null}else if(s[a]!==l){s[a]=l;o.mod.push(s)}}return o.modifies(t)}});function Hc(e){df.call(this,null,e)}Hc.Definition={type:"Cross",metadata:{generates:true},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:true,length:2,default:["a","b"]}]};_n(Hc,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],a=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");var u=this.value;if(o){if(u)n.rem=u;u=t.materialize(t.SOURCE).source;n.add=this.value=Gc(u,i,a,e.filter||_t)}else{n.mod=u}n.source=this.value;return n.modifies(r)}});function Gc(e,t,n,r){var i=[],a={},o=e.length,u=0,s,l;for(;u<o;++u){a[t]=l=e[u];for(s=0;s<o;++s){a[n]=e[s];if(r(a)){i.push(Zs(a));a={};a[t]=l}}}return i}var $c={kde:Pf,mixture:Wf,normal:zf,lognormal:qf,uniform:Yf};var Vc="distributions",Yc="function",Xc="field";function Jc(e,t){var n=e[Yc];if(!mn($c,n)){pt("Unknown distribution function: "+n)}var r=$c[n]();for(var i in e){if(i===Xc){r.data((e.from||t()).map(e[i]))}else if(i===Vc){r[i](e[i].map((function(e){return Jc(e,t)})))}else if(typeof r[i]===Yc){r[i](e[i])}}return r}function Qc(e){df.call(this,null,e)}var Zc=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:true},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];var Kc={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:true,params:Zc},{name:"weights",type:"number",array:true}]};Qc.Definition={type:"Density",metadata:{generates:true},params:[{name:"extent",type:"number",array:true,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Zc.concat(Kc)},{name:"as",type:"string",array:true,default:["value","density"]}]};_n(Qc,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=Jc(e.distribution,ed(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200;var o=e.method||"pdf";if(o!=="pdf"&&o!=="cdf"){pt("Invalid density method: "+o)}if(!e.extent&&!r.data){pt("Missing density extent parameter.")}o=r[o];var u=e.as||["value","density"],s=e.extent||pn(r.data()),l=pc(o,s,i,a).map((function(e){var t={};t[u[0]]=e[0];t[u[1]]=e[1];return Zs(t)}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n}});function ed(e){return function(){return e.materialize(e.SOURCE).source}}function td(e,t){if(!e)return null;return e.map((function(e,n){return t[n]||lt(e)}))}function nd(e,t,n){var r=[],i=function(e){return e(s)};var a,o,u,s,l,f;if(t==null){r.push(e.map(n))}else{for(a={},o=0,u=e.length;o<u;++o){s=e[o];l=t.map(i);f=a[l];if(!f){a[l]=f=[];f.dims=l;r.push(f)}f.push(n(s))}}return r}var rd="bin";function id(e){df.call(this,null,e)}id.Definition={type:"DotBin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:false},{name:"as",type:"string",default:rd}]};var ad=function(e,t){return zn(pn(e,t))/30};_n(id,df,{transform:function(e,t){if(this.value&&!(e.modified()||t.changed())){return t}var n=t.materialize(t.SOURCE).source,r=nd(t.source,e.groupby,yt),i=e.smooth||false,a=e.field,o=e.step||ad(n,a),u=nl((function(e,t){return a(e)-a(t)})),s=e.as||rd,l=r.length;var f=Infinity,c=-Infinity,d=0,h;for(;d<l;++d){var p=r[d].sort(u);h=-1;for(var v=0,g=Of(p,o,i,a);v<g.length;v++){var m=g[v];if(m<f)f=m;if(m>c)c=m;p[++h][s]=m}}this.value={start:f,stop:c,step:o};return t.reflow(true).modifies(s)}});function od(e){dl.call(this,null,ud,e);this.modified(true)}_n(od,dl);function ud(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:st((function(n){return t(n,e)}),ft(t),lt(t))}function sd(e){df.call(this,[undefined,undefined],e)}sd.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:true}]};_n(sd,df,{transform:function(e,t){var n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");var a=n[0],o=n[1];if(i||a==null){a=+Infinity;o=-Infinity}t.visit(i?t.SOURCE:t.ADD,(function(e){var t=Pt(r(e));if(t!=null){if(t<a)a=t;if(t>o)o=t}}));if(!Number.isFinite(a)||!Number.isFinite(o)){var u=lt(r);if(u)u=' for field "'.concat(u,'"');t.dataflow.warn("Infinite extent".concat(u,": [").concat(a,", ").concat(o,"]"));a=o=undefined}this.value=[a,o]}});function ld(e,t){dl.call(this,e);this.parent=t;this.count=0}_n(ld,dl,{connect:function(e){this.detachSubflow=e.detachSubflow;this.targets().add(e);return e.source=this},add:function(e){this.count+=1;this.value.add.push(e)},rem:function(e){this.count-=1;this.value.rem.push(e)},mod:function(e){this.value.mod.push(e)},init:function(e){this.value.init(e,e.NO_SOURCE)},evaluate:function(){return this.value}});function fd(e){df.call(this,{},e);this._keys=bn();var t=this._targets=[];t.active=0;t.forEach=function(e){for(var n=0,r=t.active;n<r;++n){e(t[n],n,t)}}}_n(fd,df,{activate:function(e){this._targets[this._targets.active++]=e},subflow:function(e,t,n,r){var i=this.value;var a=mn(i,e)&&i[e],o,u;if(!a){u=r||(u=this._group[e])&&u.tuple;o=n.dataflow;a=new ld(n.fork(n.NO_SOURCE),this);o.add(a).connect(t(o,e,u));i[e]=a;this.activate(a)}else if(a.value.stamp<n.stamp){a.init(n);this.activate(a)}return a},clean:function(){var e=this.value;var t=0;for(var n in e){if(e[n].count===0){var r=e[n].detachSubflow;if(r)r();delete e[n];++t}}if(t){var i=this._targets.filter((function(e){return e&&e.count>0}));this.initTargets(i)}},initTargets:function(e){var t=this._targets,n=t.length,r=e?e.length:0;var i=0;for(;i<r;++i){t[i]=e[i]}for(;i<n&&t[i]!=null;++i){t[i]=null}t.active=r},transform:function(e,t){var n=this;var r=t.dataflow,i=e.key,a=e.subflow,o=this._keys,u=e.modified("key"),s=function(e){return n.subflow(e,a,t)};this._group=e.group||{};this.initTargets();t.visit(t.REM,(function(e){var t=Js(e),n=o.get(t);if(n!==undefined){o.delete(t);s(n).rem(e)}}));t.visit(t.ADD,(function(e){var t=i(e);o.set(Js(e),t);s(t).add(e)}));if(u||t.modified(i.fields)){t.visit(t.MOD,(function(e){var t=Js(e),n=o.get(t),r=i(e);if(n===r){s(r).mod(e)}else{o.set(t,r);s(n).rem(e);s(r).add(e)}}))}else if(t.changed(t.MOD)){t.visit(t.MOD,(function(e){s(o.get(Js(e))).mod(e)}))}if(u){t.visit(t.REFLOW,(function(e){var t=Js(e),n=o.get(t),r=i(e);if(n!==r){o.set(t,r);s(n).rem(e);s(r).add(e)}}))}if(t.clean()){r.runAfter((function(){n.clean();o.clean()}))}else if(o.empty>r.cleanThreshold){r.runAfter(o.clean)}return t}});function cd(e){dl.call(this,null,dd,e)}_n(cd,dl);function dd(e){return this.value&&!e.modified()?this.value:St(e.name)?tn(e.name).map((function(e){return gt(e)})):gt(e.name,e.as)}function hd(e){df.call(this,bn(),e)}hd.Definition={type:"Filter",metadata:{changes:true},params:[{name:"expr",type:"expr",required:true}]};_n(hd,df,{transform:function(e,t){var n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,u=i.mod,s=e.expr;var l=true;t.visit(t.REM,(function(e){var t=Js(e);if(!r.has(t))o.push(e);else r.delete(t)}));t.visit(t.ADD,(function(t){if(s(t,e))a.push(t);else r.set(Js(t),1)}));function f(t){var n=Js(t),i=s(t,e),f=r.get(n);if(i&&f){r.delete(n);a.push(t)}else if(!i&&!f){r.set(n,1);o.push(t)}else if(l&&i&&!f){u.push(t)}}t.visit(t.MOD,f);if(e.modified()){l=false;t.visit(t.REFLOW,f)}if(r.empty>n.cleanThreshold)n.runAfter(r.clean);return i}});function pd(e){df.call(this,[],e)}pd.Definition={type:"Flatten",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"index",type:"string"},{name:"as",type:"string",array:true}]};_n(pd,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=td(r,e.as||[]),a=e.index||null,o=i.length;n.rem=this.value;t.visit(t.SOURCE,(function(e){var t=r.map((function(t){return t(e)})),u=t.reduce((function(e,t){return Math.max(e,t.length)}),0);var s=0,l,f,c;for(;s<u;++s){f=Ks(e);for(l=0;l<o;++l){f[i[l]]=(c=t[l][s])==null?null:c}if(a){f[a]=s}n.add.push(f)}}));this.value=n.source=n.add;if(a)n.modifies(a);return n.modifies(i)}});function vd(e){df.call(this,[],e)}vd.Definition={type:"Fold",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true,length:2,default:["key","value"]}]};_n(vd,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(lt),a=e.as||["key","value"],o=a[0],u=a[1],s=r.length;n.rem=this.value;t.visit(t.SOURCE,(function(e){for(var t=0,a=void 0;t<s;++t){a=Ks(e);a[o]=i[t];a[u]=r[t](e);n.add.push(a)}}));this.value=n.source=n.add;return n.modifies(a)}});function gd(e){df.call(this,null,e)}gd.Definition={type:"Formula",metadata:{modifies:true},params:[{name:"expr",type:"expr",required:true},{name:"as",type:"string",required:true},{name:"initonly",type:"boolean"}]};_n(gd,df,{transform:function(e,t){var n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;if(i){t=t.materialize().reflow(true)}if(!e.initonly){t.modifies(r)}return t.visit(a,(function(t){return t[r]=n(t,e)}))}});function md(e){df.call(this,[],e)}_n(md,df,{transform:function(e,t){var n=t.fork(t.ALL),r=e.generator;var i=this.value,a=e.size-i.length,o,u,s;if(a>0){for(o=[];--a>=0;){o.push(s=Zs(r(e)));i.push(s)}n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else{u=i.slice(0,-a);n.rem=n.rem.length?n.materialize(n.REM).rem.concat(u):u;i=i.slice(-a)}n.source=this.value=i;return n}});var yd={value:"value",median:Yr,mean:Vr,min:qr,max:Ur};var bd=[];function xd(e){df.call(this,[],e)}xd.Definition={type:"Impute",metadata:{changes:true},params:[{name:"field",type:"field",required:true},{name:"key",type:"field",required:true},{name:"keyvals",array:true},{name:"groupby",type:"field",array:true},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function _d(e){var t=e.method||yd.value,n;if(yd[t]==null){pt("Unrecognized imputation method: "+t)}else if(t===yd.value){n=e.value!==undefined?e.value:0;return function(){return n}}else{return yd[t]}}function wd(e){var t=e.field;return function(e){return e?t(e):NaN}}_n(xd,df,{transform:function(e,t){var n=t.fork(t.ALL),r=_d(e),i=wd(e),a=lt(e.field),o=lt(e.key),u=(e.groupby||[]).map(lt),s=Ad(t.source,e.groupby,e.key,e.keyvals),l=[],f=this.value,c=s.domain.length,d,h,p,v,g,m,y,b,x,_;for(g=0,b=s.length;g<b;++g){d=s[g];p=d.values;h=NaN;for(y=0;y<c;++y){if(d[y]!=null)continue;v=s.domain[y];_={_impute:true};for(m=0,x=p.length;m<x;++m)_[u[m]]=p[m];_[o]=v;_[a]=Number.isNaN(h)?h=r(d,i):h;l.push(Zs(_))}}if(l.length)n.add=n.materialize(n.ADD).add.concat(l);if(f.length)n.rem=n.materialize(n.REM).rem.concat(f);this.value=l;return n}});function Ad(e,t,n,r){var i=function(e){return e(g)},a=[],o=r?r.slice():[],u={},s={},l,f,c,d,h,p,v,g;o.forEach((function(e,t){return u[e]=t+1}));for(d=0,v=e.length;d<v;++d){g=e[d];p=n(g);h=u[p]||(u[p]=o.push(p));f=(l=t?t.map(i):bd)+"";if(!(c=s[f])){c=s[f]=[];a.push(c);c.values=l}c[h-1]=g}a.domain=o;return a}function Od(e){Tc.call(this,e)}Od.Definition={type:"JoinAggregate",metadata:{modifies:true},params:[{name:"groupby",type:"field",array:true},{name:"fields",type:"field",null:true,array:true},{name:"ops",type:"enum",array:true,values:Ac},{name:"as",type:"string",null:true,array:true},{name:"key",type:"field"}]};_n(Od,Tc,{transform:function(e,t){var n=this,r=e.modified();var i;if(n.value&&(r||t.modified(n._inputs,true))){i=n.value=r?n.init(e):{};t.visit(t.SOURCE,(function(e){return n.add(e)}))}else{i=n.value=n.value||this.init(e);t.visit(t.REM,(function(e){return n.rem(e)}));t.visit(t.ADD,(function(e){return n.add(e)}))}n.changes();t.visit(t.SOURCE,(function(e){hn(e,i[n.cellkey(e)].tuple)}));return t.reflow(r).modifies(this._outputs)},changes:function(){var e=this._adds,t=this._mods;var n,r;for(n=0,r=this._alen;n<r;++n){this.celltuple(e[n]);e[n]=null}for(n=0,r=this._mlen;n<r;++n){this.celltuple(t[n]);t[n]=null}this._alen=this._mlen=0}});function Ed(e){df.call(this,null,e)}Ed.Definition={type:"KDE",metadata:{generates:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"cumulative",type:"boolean",default:false},{name:"counts",type:"boolean",default:false},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:true,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:true,default:["value","density"]}]};_n(Ed,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=nd(r,e.groupby,e.field),a=(e.groupby||[]).map(lt),o=e.bandwidth,u=e.cumulative?"cdf":"pdf",s=e.as||["value","density"],l=[];var f=e.extent,c=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;if(u!=="pdf"&&u!=="cdf"){pt("Invalid density method: "+u)}if(e.resolve==="shared"){if(!f)f=pn(r,e.field);c=d=e.steps||d}i.forEach((function(t){var n=Pf(t,o)[u],r=e.counts?t.length:1,i=f||pn(t);pc(n,i,c,d).forEach((function(e){var n={};for(var i=0;i<a.length;++i){n[a[i]]=t.dims[i]}n[s[0]]=e[0];n[s[1]]=e[1]*r;l.push(Zs(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n}});function kd(e){dl.call(this,null,Dd,e)}_n(kd,dl);function Dd(e){return this.value&&!e.modified()?this.value:Fn(e.fields,e.flat)}function Cd(e){df.call(this,[],e);this._pending=null}_n(Cd,df,{transform:function(e,t){var n=this;var r=t.dataflow;if(this._pending){return Sd(this,t,this._pending)}if(Fd(e))return t.StopPropagation;if(e.values){return Sd(this,t,r.parse(e.values,e.format))}else if(e.async){var i=r.request(e.url,e.format).then((function(e){n._pending=tn(e.data);return function(e){return e.touch(n)}}));return{async:i}}else{return r.request(e.url,e.format).then((function(e){return Sd(n,t,tn(e.data))}))}}});function Fd(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Sd(e,t,n){n.forEach(Zs);var r=t.fork(t.NO_FIELDS&t.NO_SOURCE);r.rem=e.value;e.value=r.source=r.add=n;e._pending=null;if(r.rem.length)r.clean(true);return r}function jd(e){df.call(this,{},e)}jd.Definition={type:"Lookup",metadata:{modifies:true},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:true},{name:"key",type:"field",required:true}]},{name:"values",type:"field",array:true},{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true},{name:"default",default:null}]};_n(jd,df,{transform:function(e,t){var n=e.fields,r=e.index,i=e.values,a=e.default==null?null:e.default,o=e.modified(),u=n.length;var s=o?t.SOURCE:t.ADD,l=t,f=e.as,c,d,h;if(i){d=i.length;if(u>1&&!f){pt('Multi-field lookup requires explicit "as" parameter.')}if(f&&f.length!==u*d){pt('The "as" parameter has too few output field names.')}f=f||i.map(lt);c=function(e){for(var t=0,o=0,s,l;t<u;++t){l=r.get(n[t](e));if(l==null)for(s=0;s<d;++s,++o)e[f[o]]=a;else for(s=0;s<d;++s,++o)e[f[o]]=i[s](l)}}}else{if(!f){pt("Missing output field names.")}c=function(e){for(var t=0,i;t<u;++t){i=r.get(n[t](e));e[f[t]]=i==null?a:i}}}if(o){l=t.reflow(true)}else{h=n.some((function(e){return t.modified(e.fields)}));s|=h?t.MOD:0}t.visit(s,c);return l.modifies(f)}});function Md(e){dl.call(this,null,Bd,e)}_n(Md,dl);function Bd(e){if(this.value&&!e.modified()){return this.value}var t=e.extents,n=t.length;var r=+Infinity,i=-Infinity,a,o;for(a=0;a<n;++a){o=t[a];if(o[0]<r)r=o[0];if(o[1]>i)i=o[1]}return[r,i]}function Nd(e){dl.call(this,null,Td,e)}_n(Nd,dl);function Td(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function zd(e){df.call(this,null,e)}_n(zd,df,{transform:function(e,t){this.modified(e.modified());this.value=e;return t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Pd(e){Tc.call(this,e)}Pd.Definition={type:"Pivot",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"value",type:"field",required:true},{name:"op",type:"enum",values:Ac,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};_n(Pd,Tc,{_transform:Tc.prototype.transform,transform:function(e,t){return this._transform(Rd(e,t),t)}});function Rd(e,t){var n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=ft(n).concat(ft(r)),o=Id(n,e.limit||0,t);if(t.changed())e.set("__pivot__",null,null,true);return{key:e.key,groupby:e.groupby,ops:o.map((function(){return i})),fields:o.map((function(e){return Ld(e,n,r,a)})),as:o.map((function(e){return e+""})),modified:e.modified.bind(e)}}function Ld(e,t,n,r){return st((function(r){return t(r)===e?n(r):NaN}),r,e+"")}function Id(e,t,n){var r={},i=[];n.visit(n.SOURCE,(function(t){var n=e(t);if(!r[n]){r[n]=1;i.push(n)}}));i.sort(un);return t?i.slice(0,t):i}function Ud(e){fd.call(this,e)}_n(Ud,fd,{transform:function(e,t){var n=this;var r=e.subflow,i=e.field,a=function(e){return n.subflow(Js(e),r,t,e)};if(e.modified("field")||i&&t.modified(ft(i))){pt("PreFacet does not support field modification.")}this.initTargets();if(i){t.visit(t.MOD,(function(e){var t=a(e);i(e).forEach((function(e){return t.mod(e)}))}));t.visit(t.ADD,(function(e){var t=a(e);i(e).forEach((function(e){return t.add(Zs(e))}))}));t.visit(t.REM,(function(e){var t=a(e);i(e).forEach((function(e){return t.rem(e)}))}))}else{t.visit(t.MOD,(function(e){return a(e).mod(e)}));t.visit(t.ADD,(function(e){return a(e).add(e)}));t.visit(t.REM,(function(e){return a(e).rem(e)}))}if(t.clean()){t.runAfter((function(){return n.clean()}))}return t}});function qd(e){df.call(this,null,e)}qd.Definition={type:"Project",metadata:{generates:true,changes:true},params:[{name:"fields",type:"field",array:true},{name:"as",type:"string",null:true,array:true}]};_n(qd,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=td(e.fields,e.as||[]),a=r?function(e,t){return Wd(e,t,r,i)}:el;var o;if(this.value){o=this.value}else{t=t.addAll();o=this.value={}}t.visit(t.REM,(function(e){var t=Js(e);n.rem.push(o[t]);o[t]=null}));t.visit(t.ADD,(function(e){var t=a(e,Zs({}));o[Js(e)]=t;n.add.push(t)}));t.visit(t.MOD,(function(e){n.mod.push(a(e,o[Js(e)]))}));return n}});function Wd(e,t,n,r){for(var i=0,a=n.length;i<a;++i){t[r[i]]=n[i](e)}return t}function Hd(e){df.call(this,null,e)}_n(Hd,df,{transform:function(e,t){this.value=e.value;return e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Gd(e){df.call(this,null,e)}Gd.Definition={type:"Quantile",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"probs",type:"number",array:true},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:true,default:["prob","value"]}]};var $d=1e-14;_n(Gd,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed()){n.source=this.value;return n}var i=t.materialize(t.SOURCE).source,a=nd(i,e.groupby,e.field),o=(e.groupby||[]).map(lt),u=[],s=e.step||.01,l=e.probs||Qr(s/2,1-$d,s),f=l.length;a.forEach((function(e){var t=mf(e,l);for(var n=0;n<f;++n){var i={};for(var a=0;a<o.length;++a){i[o[a]]=e.dims[a]}i[r[0]]=l[n];i[r[1]]=t[n];u.push(Zs(i))}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=u;return n}});function Vd(e){df.call(this,null,e)}_n(Vd,df,{transform:function(e,t){var n,r;if(this.value){r=this.value}else{n=t=t.addAll();r=this.value={}}if(e.derive){n=t.fork(t.NO_SOURCE);t.visit(t.REM,(function(e){var t=Js(e);n.rem.push(r[t]);r[t]=null}));t.visit(t.ADD,(function(e){var t=Ks(e);r[Js(e)]=t;n.add.push(t)}));t.visit(t.MOD,(function(e){var t=r[Js(e)];for(var i in e){t[i]=e[i];n.modifies(i)}n.mod.push(t)}))}return n}});function Yd(e){df.call(this,[],e);this.count=0}Yd.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};_n(Yd,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value.reduce((function(e,t){return e[Js(t)]=1,e}),{});var o=this.value,u=this.count,s=0;function l(e){var t,r;if(o.length<i){o.push(e)}else{r=~~((u+1)*_f());if(r<o.length&&r>=s){t=o[r];if(a[Js(t)])n.rem.push(t);o[r]=e}}++u}if(t.rem.length){t.visit(t.REM,(function(e){var t=Js(e);if(a[t]){a[t]=-1;n.rem.push(e)}--u}));o=o.filter((function(e){return a[Js(e)]!==-1}))}if((t.rem.length||r)&&o.length<i&&t.source){s=u=o.length;t.visit(t.SOURCE,(function(e){if(!a[Js(e)])l(e)}));s=-1}if(r&&o.length>i){var f=o.length-i;for(var c=0;c<f;++c){a[Js(o[c])]=-1;n.rem.push(o[c])}o=o.slice(f)}if(t.mod.length){t.visit(t.MOD,(function(e){if(a[Js(e)])n.mod.push(e)}))}if(t.add.length){t.visit(t.ADD,l)}if(t.add.length||s<0){n.add=o.filter((function(e){return!a[Js(e)]}))}this.count=u;this.value=n.source=o;return n}});function Xd(e){df.call(this,null,e)}Xd.Definition={type:"Sequence",metadata:{generates:true,changes:true},params:[{name:"start",type:"number",required:true},{name:"stop",type:"number",required:true},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};_n(Xd,df,{transform:function(e,t){if(this.value&&!e.modified())return;var n=t.materialize().fork(t.MOD),r=e.as||"data";n.rem=this.value?t.rem.concat(this.value):t.rem;this.value=Qr(e.start,e.stop,e.step||1).map((function(e){var t={};t[r]=e;return Zs(t)}));n.add=t.add.concat(this.value);return n}});function Jd(e){df.call(this,null,e);this.modified(true)}_n(Jd,df,{transform:function(e,t){this.value=t.source;return t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Qd(e){df.call(this,null,e)}var Zd=["unit0","unit1"];Qd.Definition={type:"TimeUnit",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"units",type:"enum",values:ya,array:true},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:true},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:true,length:2,default:Zd}]};_n(Qd,df,{transform:function(e,t){var n=e.field,r=e.interval!==false,i=e.timezone==="utc",a=this._floor(e,t),o=(i?Xa:Ya)(a.unit).offset,u=e.as||Zd,s=u[0],l=u[1],f=a.step;var c=a.start||Infinity,d=a.stop||-Infinity,h=t.ADD;if(e.modified()||t.changed(t.REM)||t.modified(ft(n))){t=t.reflow(true);h=t.SOURCE;c=Infinity;d=-Infinity}t.visit(h,(function(e){var t=n(e);var i,u;if(t==null){e[s]=null;if(r)e[l]=null}else{e[s]=i=u=a(t);if(r)e[l]=u=o(i,f);if(i<c)c=i;if(u>d)d=u}}));a.start=c;a.stop=d;return t.modifies(r?u:s)},_floor:function(e,t){var n=e.timezone==="utc";var r=e.units?{units:e.units,step:e.step||1}:bo({extent:e.extent||pn(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),i=r.units,a=r.step;var o=xa(i),u=this.value||{},s=(n?Ga:qa)(o,a);s.unit=zt(o);s.units=o;s.step=a;s.start=u.start;s.stop=u.stop;return this.value=s}});function Kd(e){df.call(this,bn(),e)}_n(Kd,df,{transform:function(e,t){var n=t.dataflow,r=e.field,i=this.value,a=function(e){return i.set(r(e),e)};var o=true;if(e.modified("field")||t.modified(r.fields)){i.clear();t.visit(t.SOURCE,a)}else if(t.changed()){t.visit(t.REM,(function(e){return i.delete(r(e))}));t.visit(t.ADD,a)}else{o=false}this.modified(o);if(i.empty>n.cleanThreshold)n.runAfter(i.clean);return t.fork()}});function eh(e){df.call(this,null,e)}_n(eh,df,{transform:function(e,t){var n=!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields);if(n){this.value=(e.sort?t.source.slice().sort(nl(e.sort)):t.source).map(e.field)}}});function th(e,t,n,r){var i=nh[e](t,n);return{init:i.init||bt,update:function(e,t){t[r]=i.next(e)}}}var nh={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=nh.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.data,r=t.compare;var i=t.index;if(e<i){while(i+1<n.length&&!r(n[i],n[i+1]))++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t;if(!(t>0))pt("ntile num must be greater than zero.");var n=nh.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){t=+t||1;return{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){t=+t||1;return{next:function(n){var r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){t=+t;if(!(t>0))pt("nth_value nth must be greater than zero.");return{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){var t;return{init:function(){return t=null},next:function(n){var r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){var t,n;return{init:function(){return t=null,n=-1},next:function(r){var i=r.data;return r.index<=n?t:(n=rh(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function rh(e,t,n){for(var r=t.length;n<r;++n){var i=e(t[n]);if(i!=null)return n}return-1}var ih=Object.keys(nh);function ah(e){var t=tn(e.ops),n=tn(e.fields),r=tn(e.params),i=tn(e.as),a=this.outputs=[],o=this.windows=[],u={},s={},l=[],f=[];var c=true;function d(e){tn(ft(e)).forEach((function(e){return u[e]=1}))}d(e.sort);t.forEach((function(e,t){var u=n[t],h=lt(u),p=bc(e,h,i[t]);d(u);a.push(p);if(mn(nh,e)){o.push(th(e,n[t],r[t],p))}else{if(u==null&&e!=="count"){pt("Null aggregate field specified.")}if(e==="count"){l.push(p);return}c=false;var v=s[h];if(!v){v=s[h]=[];v.field=u;f.push(v)}v.push(Ec(e,p))}}));if(l.length||f.length){this.cell=uh(f,l,c)}this.inputs=Object.keys(u)}var oh=ah.prototype;oh.init=function(){this.windows.forEach((function(e){return e.init()}));if(this.cell)this.cell.init()};oh.update=function(e,t){var n=this.cell,r=this.windows,i=e.data,a=r&&r.length;var o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(i[o]);for(o=e.p1;o<e.i1;++o)n.add(i[o]);n.set(t)}for(o=0;o<a;++o)r[o].update(e,t)};function uh(e,t,n){e=e.map((function(e){return Mc(e,e.field)}));var r={num:0,agg:null,store:false,count:t};if(!n){var i=e.length,a=r.agg=Array(i),o=0;for(;o<i;++o)a[o]=new e[o](r)}if(r.store){var u=r.data=new Bc}r.add=function(e){r.num+=1;if(n)return;if(u)u.add(e);for(var t=0;t<i;++t){a[t].add(a[t].get(e),e)}};r.rem=function(e){r.num-=1;if(n)return;if(u)u.rem(e);for(var t=0;t<i;++t){a[t].rem(a[t].get(e),e)}};r.set=function(e){var i,o;if(u)u.values();for(i=0,o=t.length;i<o;++i)e[t[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(e)};r.init=function(){r.num=0;if(u)u.reset();for(var e=0;e<i;++e)a[e].init()};return r}function sh(e){df.call(this,{},e);this._mlen=0;this._mods=[]}sh.Definition={type:"Window",metadata:{modifies:true},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:ih.concat(Ac)},{name:"params",type:"number",null:true,array:true},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"frame",type:"number",null:true,array:true,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:false}]};_n(sh,df,{transform:function(e,t){var n=this;this.stamp=t.stamp;var r=e.modified(),i=nl(e.sort),a=yc(e.groupby),o=function(e){return n.group(a(e))};var u=this.state;if(!u||r){u=this.state=new ah(e)}if(r||t.modified(u.inputs)){this.value={};t.visit(t.SOURCE,(function(e){return o(e).add(e)}))}else{t.visit(t.REM,(function(e){return o(e).remove(e)}));t.visit(t.ADD,(function(e){return o(e).add(e)}))}for(var s=0,l=this._mlen;s<l;++s){lh(this._mods[s],u,i,e)}this._mlen=0;this._mods=[];return t.reflow(r).modifies(u.outputs)},group:function(e){var t=this.value[e];if(!t){t=this.value[e]=Rc(Js);t.stamp=-1}if(t.stamp<this.stamp){t.stamp=this.stamp;this._mods[this._mlen++]=t}return t}});function lh(e,t,n,r){var i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],u=e.data(n),s=u.length,l=a?vr(i):null,f={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:i||cn(-1)};t.init();for(var c=0;c<s;++c){fh(f,o,c,s);if(a)ch(f,l);t.update(f,u[c])}}function fh(e,t,n,r){e.p0=e.i0;e.p1=e.i1;e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0]));e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1);e.index=n}function ch(e,t){var n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;if(n>0&&!i(a[n],a[n-1]))e.i0=t.left(a,a[n]);if(r<o&&!i(a[r],a[r+1]))e.i1=t.right(a,a[r])}var dh=Object.freeze({__proto__:null,aggregate:Tc,bin:Pc,collect:Lc,compare:Ic,countpattern:qc,cross:Hc,density:Qc,dotbin:id,expression:od,extent:sd,facet:fd,field:cd,filter:hd,flatten:pd,fold:vd,formula:gd,generate:md,impute:xd,joinaggregate:Od,kde:Ed,key:kd,load:Cd,lookup:jd,multiextent:Md,multivalues:Nd,params:zd,pivot:Pd,prefacet:Ud,project:qd,proxy:Hd,quantile:Gd,relay:Vd,sample:Yd,sequence:Xd,sieve:Jd,subflow:ld,timeunit:Qd,tupleindex:Kd,values:eh,window:sh});function hh(e){return e.innerRadius}function ph(e){return e.outerRadius}function vh(e){return e.startAngle}function gh(e){return e.endAngle}function mh(e){return e&&e.padAngle}function yh(e,t,n,r,i,a,o,u){var l=n-e,f=r-t,c=o-i,d=u-a,h=d*l-c*f;if(h*h<s)return;h=(c*(t-a)-d*(e-i))/h;return[e+h*l,t+h*f]}function bh(e,t,n,r,i,a,o){var u=e-n,s=t-r,l=(o?a:-a)/m(u*u+s*s),f=l*s,c=-l*u,d=e+f,h=t+c,p=n+f,v=r+c,g=(d+p)/2,b=(h+v)/2,x=p-d,_=v-h,w=x*x+_*_,A=i-a,O=d*v-p*h,E=(_<0?-1:1)*m(y(0,A*A*w-O*O)),k=(O*_-x*E)/w,D=(-O*x-_*E)/w,C=(O*_+x*E)/w,F=(-O*x+_*E)/w,S=k-g,j=D-b,M=C-g,B=F-b;if(S*S+j*j>M*M+B*B)k=C,D=F;return{cx:k,cy:D,x01:-f,y01:-c,x11:k*(i/A-1),y11:D*(i/A-1)}}function xh(){var e=hh,t=ph,n=g(0),r=null,i=vh,a=gh,y=mh,_=null,w=o(A);function A(){var o,g,A=+e.apply(this,arguments),O=+t.apply(this,arguments),E=i.apply(this,arguments)-u,k=a.apply(this,arguments)-u,D=h(k-E),C=k>E;if(!_)_=o=w();if(O<A)g=O,O=A,A=g;if(!(O>s))_.moveTo(0,0);else if(D>l-s){_.moveTo(O*f(E),O*c(E));_.arc(0,0,O,E,k,!C);if(A>s){_.moveTo(A*f(k),A*c(k));_.arc(0,0,A,k,E,C)}}else{var F=E,S=k,j=E,M=k,B=D,N=D,T=y.apply(this,arguments)/2,z=T>s&&(r?+r.apply(this,arguments):m(A*A+O*O)),P=d(h(O-A)/2,+n.apply(this,arguments)),R=P,L=P,I,U;if(z>s){var q=b(z/A*c(T)),W=b(z/O*c(T));if((B-=q*2)>s)q*=C?1:-1,j+=q,M-=q;else B=0,j=M=(E+k)/2;if((N-=W*2)>s)W*=C?1:-1,F+=W,S-=W;else N=0,F=S=(E+k)/2}var H=O*f(F),G=O*c(F),$=A*f(M),V=A*c(M);if(P>s){var Y=O*f(S),X=O*c(S),J=A*f(j),Q=A*c(j),Z;if(D<v){if(Z=yh(H,G,J,Q,Y,X,$,V)){var K=H-Z[0],ee=G-Z[1],te=Y-Z[0],ne=X-Z[1],re=1/c(x((K*te+ee*ne)/(m(K*K+ee*ee)*m(te*te+ne*ne)))/2),ie=m(Z[0]*Z[0]+Z[1]*Z[1]);R=d(P,(A-ie)/(re-1));L=d(P,(O-ie)/(re+1))}else{R=L=0}}}if(!(N>s))_.moveTo(H,G);else if(L>s){I=bh(J,Q,H,G,O,L,C);U=bh(Y,X,$,V,O,L,C);_.moveTo(I.cx+I.x01,I.cy+I.y01);if(L<P)_.arc(I.cx,I.cy,L,p(I.y01,I.x01),p(U.y01,U.x01),!C);else{_.arc(I.cx,I.cy,L,p(I.y01,I.x01),p(I.y11,I.x11),!C);_.arc(0,0,O,p(I.cy+I.y11,I.cx+I.x11),p(U.cy+U.y11,U.cx+U.x11),!C);_.arc(U.cx,U.cy,L,p(U.y11,U.x11),p(U.y01,U.x01),!C)}}else _.moveTo(H,G),_.arc(0,0,O,F,S,!C);if(!(A>s)||!(B>s))_.lineTo($,V);else if(R>s){I=bh($,V,Y,X,A,-R,C);U=bh(H,G,J,Q,A,-R,C);_.lineTo(I.cx+I.x01,I.cy+I.y01);if(R<P)_.arc(I.cx,I.cy,R,p(I.y01,I.x01),p(U.y01,U.x01),!C);else{_.arc(I.cx,I.cy,R,p(I.y01,I.x01),p(I.y11,I.x11),!C);_.arc(0,0,A,p(I.cy+I.y11,I.cx+I.x11),p(U.cy+U.y11,U.cx+U.x11),C);_.arc(U.cx,U.cy,R,p(U.y11,U.x11),p(U.y01,U.x01),!C)}}else _.arc(0,0,A,M,j,C)}_.closePath();if(o)return _=null,o+""||null}A.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-v/2;return[f(r)*n,c(r)*n]};A.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:g(+t),A):e};A.outerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:g(+e),A):t};A.cornerRadius=function(e){return arguments.length?(n=typeof e==="function"?e:g(+e),A):n};A.padRadius=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:g(+e),A):r};A.startAngle=function(e){return arguments.length?(i=typeof e==="function"?e:g(+e),A):i};A.endAngle=function(e){return arguments.length?(a=typeof e==="function"?e:g(+e),A):a};A.padAngle=function(e){return arguments.length?(y=typeof e==="function"?e:g(+e),A):y};A.context=function(e){return arguments.length?(_=e==null?null:e,A):_};return A}function _h(e,t,n){var r=null,i=g(true),a=null,u=A,s=null,l=o(f);e=typeof e==="function"?e:e===undefined?O:g(+e);t=typeof t==="function"?t:t===undefined?g(0):g(+t);n=typeof n==="function"?n:n===undefined?E:g(+n);function f(o){var f,c,d,h=(o=_(o)).length,p,v=false,g,m=new Array(h),y=new Array(h);if(a==null)s=u(g=l());for(f=0;f<=h;++f){if(!(f<h&&i(p=o[f],f,o))===v){if(v=!v){c=f;s.areaStart();s.lineStart()}else{s.lineEnd();s.lineStart();for(d=f-1;d>=c;--d){s.point(m[d],y[d])}s.lineEnd();s.areaEnd()}}if(v){m[f]=+e(p,f,o),y[f]=+t(p,f,o);s.point(r?+r(p,f,o):m[f],n?+n(p,f,o):y[f])}}if(g)return s=null,g+""||null}function c(){return w().defined(i).curve(u).context(a)}f.x=function(t){return arguments.length?(e=typeof t==="function"?t:g(+t),r=null,f):e};f.x0=function(t){return arguments.length?(e=typeof t==="function"?t:g(+t),f):e};f.x1=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:g(+e),f):r};f.y=function(e){return arguments.length?(t=typeof e==="function"?e:g(+e),n=null,f):t};f.y0=function(e){return arguments.length?(t=typeof e==="function"?e:g(+e),f):t};f.y1=function(e){return arguments.length?(n=e==null?null:typeof e==="function"?e:g(+e),f):n};f.lineX0=f.lineY0=function(){return c().x(e).y(t)};f.lineY1=function(){return c().x(e).y(n)};f.lineX1=function(){return c().x(r).y(t)};f.defined=function(e){return arguments.length?(i=typeof e==="function"?e:g(!!e),f):i};f.curve=function(e){return arguments.length?(u=e,a!=null&&(s=u(a)),f):u};f.context=function(e){return arguments.length?(e==null?a=s=null:s=u(a=e),f):a};return f}function wh(e){this._context=e}wh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:k(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Ah(e){return new wh(e)}function Oh(e,t){this._basis=new D(e);this._beta=t}Oh.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0){var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,u=-1,s;while(++u<=n){s=u/n;this._basis.point(this._beta*e[u]+(1-this._beta)*(r+s*a),this._beta*t[u]+(1-this._beta)*(i+s*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var Eh=function e(t){function n(e){return t===1?new D(e):new Oh(e,t)}n.beta=function(t){return e(+t)};return n}(.85);function kh(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Dh(e,t){this._context=e;this._k=(1-t)/6}Dh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:kh(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:kh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ch=function e(t){function n(e){return new Dh(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Fh(e,t){this._context=e;this._k=(1-t)/6}Fh.prototype={areaStart:C,areaEnd:C,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:kh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Sh=function e(t){function n(e){return new Fh(e,t)}n.tension=function(t){return e(+t)};return n}(0);function jh(e,t){this._context=e;this._k=(1-t)/6}jh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:kh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Mh=function e(t){function n(e){return new jh(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Bh(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>s){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/l;i=(i*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>s){var f=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*f+e._x1*e._l23_2a-t*e._l12_2a)/c;o=(o*f+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function Nh(e,t){this._context=e;this._alpha=t}Nh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Bh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Th=function e(t){function n(e){return t?new Nh(e,t):new Dh(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function zh(e,t){this._context=e;this._alpha=t}zh.prototype={areaStart:C,areaEnd:C,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Bh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ph=function e(t){function n(e){return t?new zh(e,t):new Fh(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function Rh(e,t){this._context=e;this._alpha=t}Rh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Bh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Lh=function e(t){function n(e){return t?new Rh(e,t):new jh(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function Ih(e){this._context=e}Ih.prototype={areaStart:C,areaEnd:C,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};function Uh(e){return new Ih(e)}function qh(e){return e<0?-1:1}function Wh(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(qh(a)+qh(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function Hh(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Gh(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,u=(a-r)/3;e._context.bezierCurveTo(r+u,i+u*t,a-u,o-u*n,a,o)}function $h(e){this._context=e}$h.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Gh(this,this._t0,Hh(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var n=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;Gh(this,Hh(this,n=Wh(this,e,t)),n);break;default:Gh(this,this._t0,n=Wh(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=n}};function Vh(e){this._context=new Yh(e)}(Vh.prototype=Object.create($h.prototype)).point=function(e,t){$h.prototype.point.call(this,t,e)};function Yh(e){this._context=e}Yh.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function Xh(e){return new $h(e)}function Jh(e){return new Vh(e)}function Qh(e){this._context=e}Qh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(n===2){this._context.lineTo(e[1],t[1])}else{var r=Zh(e),i=Zh(t);for(var a=0,o=1;o<n;++a,++o){this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function Zh(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);i[0]=0,a[0]=2,o[0]=e[0]+2*e[1];for(t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n];for(t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];i[n-1]=o[n-1]/a[n-1];for(t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];a[n-1]=(e[n]+i[n-1])/2;for(t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function Kh(e){return new Qh(e)}function ep(e,t){this._context=e;this._t=t}ep.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function tp(e){return new ep(e,.5)}function np(e){return new ep(e,0)}function rp(e){return new ep(e,1)}function ip(e,t){if(typeof document!=="undefined"&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext){n.width=e;n.height=t;return n}}return null}var ap=function(){return typeof Image!=="undefined"?Image:null};function op(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function up(e,t){switch(arguments.length){case 0:break;case 1:{if(typeof e==="function")this.interpolator(e);else this.range(e);break}default:{this.domain(e);if(typeof t==="function")this.interpolator(t);else this.range(t);break}}return this}var sp=Symbol("implicit");function lp(){var e=new Er,t=[],n=[],r=sp;function i(i){var a=e.get(i);if(a===undefined){if(r!==sp)return r;e.set(i,a=t.push(i)-1)}return n[a%n.length]}i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Er;for(var r=0,a=n;r<a.length;r++){var o=a[r];if(e.has(o))continue;e.set(o,t.push(o)-1)}return i};i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()};i.unknown=function(e){return arguments.length?(r=e,i):r};i.copy=function(){return lp(t,n).unknown(r)};op.apply(i,arguments);return i}var fp=Math.PI/180;var cp=180/Math.PI;var dp=18,hp=.96422,pp=1,vp=.82521,gp=4/29,mp=6/29,yp=3*mp*mp,bp=mp*mp*mp;function xp(e){if(e instanceof wp)return new wp(e.l,e.a,e.b,e.opacity);if(e instanceof Fp)return Sp(e);if(!(e instanceof F))e=S(e);var t=kp(e.r),n=kp(e.g),r=kp(e.b),i=Ap((.2225045*t+.7168786*n+.0606169*r)/pp),a,o;if(t===n&&n===r)a=o=i;else{a=Ap((.4360747*t+.3850649*n+.1430804*r)/hp);o=Ap((.0139322*t+.0971045*n+.7141733*r)/vp)}return new wp(116*i-16,500*(a-i),200*(i-o),e.opacity)}function _p(e,t,n,r){return arguments.length===1?xp(e):new wp(e,t,n,r==null?1:r)}function wp(e,t,n,r){this.l=+e;this.a=+t;this.b=+n;this.opacity=+r}j(wp,_p,M(B,{brighter:function(e){return new wp(this.l+dp*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new wp(this.l-dp*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;t=hp*Op(t);e=pp*Op(e);n=vp*Op(n);return new F(Ep(3.1338561*t-1.6168667*e-.4906146*n),Ep(-.9787684*t+1.9161415*e+.033454*n),Ep(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Ap(e){return e>bp?Math.pow(e,1/3):e/yp+gp}function Op(e){return e>mp?e*e*e:yp*(e-gp)}function Ep(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function kp(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Dp(e){if(e instanceof Fp)return new Fp(e.h,e.c,e.l,e.opacity);if(!(e instanceof wp))e=xp(e);if(e.a===0&&e.b===0)return new Fp(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*cp;return new Fp(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Cp(e,t,n,r){return arguments.length===1?Dp(e):new Fp(e,t,n,r==null?1:r)}function Fp(e,t,n,r){this.h=+e;this.c=+t;this.l=+n;this.opacity=+r}function Sp(e){if(isNaN(e.h))return new wp(e.l,0,0,e.opacity);var t=e.h*fp;return new wp(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}j(Fp,Cp,M(B,{brighter:function(e){return new Fp(this.h,this.c,this.l+dp*(e==null?1:e),this.opacity)},darker:function(e){return new Fp(this.h,this.c,this.l-dp*(e==null?1:e),this.opacity)},rgb:function(){return Sp(this).rgb()}}));var jp=-.14861,Mp=+1.78277,Bp=-.29227,Np=-.90649,Tp=+1.97294,zp=Tp*Np,Pp=Tp*Mp,Rp=Mp*Bp-Np*jp;function Lp(e){if(e instanceof Up)return new Up(e.h,e.s,e.l,e.opacity);if(!(e instanceof F))e=S(e);var t=e.r/255,n=e.g/255,r=e.b/255,i=(Rp*r+zp*t-Pp*n)/(Rp+zp-Pp),a=r-i,o=(Tp*(n-i)-Bp*a)/Np,u=Math.sqrt(o*o+a*a)/(Tp*i*(1-i)),s=u?Math.atan2(o,a)*cp-120:NaN;return new Up(s<0?s+360:s,u,i,e.opacity)}function Ip(e,t,n,r){return arguments.length===1?Lp(e):new Up(e,t,n,r==null?1:r)}function Up(e,t,n,r){this.h=+e;this.s=+t;this.l=+n;this.opacity=+r}j(Up,Ip,M(B,{brighter:function(e){e=e==null?N:Math.pow(N,e);return new Up(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?T:Math.pow(T,e);return new Up(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*fp,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new F(255*(t+n*(jp*r+Mp*i)),255*(t+n*(Bp*r+Np*i)),255*(t+n*(Tp*r)),this.opacity)}}));function qp(e,t){if(!t)t=[];var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function Wp(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Hp(e,t){return(Wp(t)?qp:Gp)(e,t)}function Gp(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=Yp(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function $p(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Vp(e,t){var n={},r={},i;if(e===null||typeof e!=="object")e={};if(t===null||typeof t!=="object")t={};for(i in t){if(i in e){n[i]=Yp(e[i],t[i])}else{r[i]=t[i]}}return function(e){for(i in n)r[i]=n[i](e);return r}}function Yp(e,t){var n=typeof t,r;return t==null||n==="boolean"?z(t):(n==="number"?P:n==="string"?(r=R(t))?(t=r,L):I:t instanceof R?L:t instanceof Date?$p:Wp(t)?qp:Array.isArray(t)?Gp:typeof t.valueOf!=="function"&&typeof t.toString!=="function"||isNaN(t)?Vp:P)(e,t)}function Xp(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Jp(e,t){var n=U(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function Qp(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Zp(e){return function(t,n){var r=e((t=q(t)).h,(n=q(n)).h),i=W(t.s,n.s),a=W(t.l,n.l),o=W(t.opacity,n.opacity);return function(e){t.h=r(e);t.s=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var Kp=Zp(U);var ev=Zp(W);function tv(e,t){var n=W((e=_p(e)).l,(t=_p(t)).l),r=W(e.a,t.a),i=W(e.b,t.b),a=W(e.opacity,t.opacity);return function(t){e.l=n(t);e.a=r(t);e.b=i(t);e.opacity=a(t);return e+""}}function nv(e){return function(t,n){var r=e((t=Cp(t)).h,(n=Cp(n)).h),i=W(t.c,n.c),a=W(t.l,n.l),o=W(t.opacity,n.opacity);return function(e){t.h=r(e);t.c=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var rv=nv(U);var iv=nv(W);function av(e){return function t(n){n=+n;function r(t,r){var i=e((t=Ip(t)).h,(r=Ip(r)).h),a=W(t.s,r.s),o=W(t.l,r.l),u=W(t.opacity,r.opacity);return function(e){t.h=i(e);t.s=a(e);t.l=o(Math.pow(e,n));t.opacity=u(e);return t+""}}r.gamma=t;return r}(1)}var ov=av(U);var uv=av(W);function sv(e,t){if(t===undefined)t=e,e=Yp;var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);while(n<r)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}function lv(e,t){var n=new Array(t);for(var r=0;r<t;++r)n[r]=e(r/(t-1));return n}var fv=Object.freeze({__proto__:null,interpolate:Yp,interpolateArray:Hp,interpolateBasis:H,interpolateBasisClosed:G,interpolateDate:$p,interpolateDiscrete:Xp,interpolateHue:Jp,interpolateNumber:P,interpolateNumberArray:qp,interpolateObject:Vp,interpolateRound:Qp,interpolateString:I,interpolateTransformCss:$,interpolateTransformSvg:V,interpolateZoom:Y,interpolateRgb:L,interpolateRgbBasis:X,interpolateRgbBasisClosed:J,interpolateHsl:Kp,interpolateHslLong:ev,interpolateLab:tv,interpolateHcl:rv,interpolateHclLong:iv,interpolateCubehelix:ov,interpolateCubehelixLong:uv,piecewise:sv,quantize:lv});function cv(e){return function(){return e}}function dv(e){return+e}var hv=[0,1];function pv(e){return e}function vv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:cv(isNaN(t)?NaN:.5)}function gv(e,t){var n;if(e>t)n=e,e=t,t=n;return function(n){return Math.max(e,Math.min(t,n))}}function mv(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];if(i<r)r=vv(i,r),a=n(o,a);else r=vv(r,i),a=n(a,o);return function(e){return a(r(e))}}function yv(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;if(e[r]<e[0]){e=e.slice().reverse();t=t.slice().reverse()}while(++o<r){i[o]=vv(e[o],e[o+1]);a[o]=n(t[o],t[o+1])}return function(t){var n=xr(e,t,1,r)-1;return a[n](i[n](t))}}function bv(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function xv(){var e=hv,t=hv,n=Yp,r,i,a,o=pv,u,s,l;function f(){var n=Math.min(e.length,t.length);if(o!==pv)o=gv(e[0],e[n-1]);u=n>2?yv:mv;s=l=null;return c}function c(i){return i==null||isNaN(i=+i)?a:(s||(s=u(e.map(r),t,n)))(r(o(i)))}c.invert=function(n){return o(i((l||(l=u(t,e.map(r),P)))(n)))};c.domain=function(t){return arguments.length?(e=Array.from(t,dv),f()):e.slice()};c.range=function(e){return arguments.length?(t=Array.from(e),f()):t.slice()};c.rangeRound=function(e){return t=Array.from(e),n=Qp,f()};c.clamp=function(e){return arguments.length?(o=e?true:pv,f()):o!==pv};c.interpolate=function(e){return arguments.length?(n=e,f()):n};c.unknown=function(e){return arguments.length?(a=e,c):a};return function(e,t){r=e,i=t;return f()}}function _v(){return xv()(pv,pv)}function wv(e,t,n,r){var i=Ir(e,t,n),a;r=ai(r==null?",f":r);switch(r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));if(r.precision==null&&!isNaN(a=_i(i,o)))r.precision=a;return yi(r,o)}case"":case"e":case"g":case"p":case"r":{if(r.precision==null&&!isNaN(a=wi(i,Math.max(Math.abs(e),Math.abs(t)))))r.precision=a-(r.type==="e");break}case"f":case"%":{if(r.precision==null&&!isNaN(a=xi(i)))r.precision=a-(r.type==="%")*2;break}}return mi(r)}function Av(e){var t=e.domain;e.ticks=function(e){var n=t();return Rr(n[0],n[n.length-1],e==null?10:e)};e.tickFormat=function(e,n){var r=t();return wv(r[0],r[r.length-1],e==null?10:e,n)};e.nice=function(n){if(n==null)n=10;var r=t();var i=0;var a=r.length-1;var o=r[i];var u=r[a];var s;var l;var f=10;if(u<o){l=o,o=u,u=l;l=i,i=a,a=l}while(f-- >0){l=Lr(o,u,n);if(l===s){r[i]=o;r[a]=u;return t(r)}else if(l>0){o=Math.floor(o/l)*l;u=Math.ceil(u/l)*l}else if(l<0){o=Math.ceil(o*l)/l;u=Math.floor(u*l)/l}else{break}s=l}return e};return e}function Ov(){var e=_v();e.copy=function(){return bv(e,Ov())};op.apply(e,arguments);return Av(e)}function Ev(e){var t;function n(e){return e==null||isNaN(e=+e)?t:e}n.invert=n;n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,dv),n):e.slice()};n.unknown=function(e){return arguments.length?(t=e,n):t};n.copy=function(){return Ev(e).unknown(t)};e=arguments.length?Array.from(e,dv):[0,1];return Av(n)}function kv(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;if(a<i){o=n,n=r,r=o;o=i,i=a,a=o}e[n]=t.floor(i);e[r]=t.ceil(a);return e}function Dv(e){return Math.log(e)}function Cv(e){return Math.exp(e)}function Fv(e){return-Math.log(-e)}function Sv(e){return-Math.exp(-e)}function jv(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Mv(e){return e===10?jv:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function Bv(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function Nv(e){return function(t,n){return-e(-t,n)}}function Tv(e){var t=e(Dv,Cv);var n=t.domain;var r=10;var i;var a;function o(){i=Bv(r),a=Mv(r);if(n()[0]<0){i=Nv(i),a=Nv(a);e(Fv,Sv)}else{e(Dv,Cv)}return t}t.base=function(e){return arguments.length?(r=+e,o()):r};t.domain=function(e){return arguments.length?(n(e),o()):n()};t.ticks=function(e){var t;var o=n();var u=o[0];var s=o[o.length-1];var l=s<u;if(l)t=[s,u],u=t[0],s=t[1];var f=i(u);var c=i(s);var d;var h;var p=e==null?10:+e;var v=[];if(!(r%1)&&c-f<p){f=Math.floor(f),c=Math.ceil(c);if(u>0)for(;f<=c;++f){for(d=1;d<r;++d){h=f<0?d/a(-f):d*a(f);if(h<u)continue;if(h>s)break;v.push(h)}}else for(;f<=c;++f){for(d=r-1;d>=1;--d){h=f>0?d/a(-f):d*a(f);if(h<u)continue;if(h>s)break;v.push(h)}}if(v.length*2<p)v=Rr(u,s,p)}else{v=Rr(f,c,Math.min(c-f,p)).map(a)}return l?v.reverse():v};t.tickFormat=function(e,n){if(e==null)e=10;if(n==null)n=r===10?"s":",";if(typeof n!=="function"){if(!(r%1)&&(n=ai(n)).precision==null)n.trim=true;n=mi(n)}if(e===Infinity)return n;var o=Math.max(1,r*e/t.ticks().length);return function(e){var t=e/a(Math.round(i(e)));if(t*r<r-.5)t*=r;return t<=o?n(e):""}};t.nice=function(){return n(kv(n(),{floor:function(e){return a(Math.floor(i(e)))},ceil:function(e){return a(Math.ceil(i(e)))}}))};return t}function zv(){var e=Tv(xv()).domain([1,10]);e.copy=function(){return bv(e,zv()).base(e.base())};op.apply(e,arguments);return e}function Pv(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Rv(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Lv(e){var t=1,n=e(Pv(t),Rv(t));n.constant=function(n){return arguments.length?e(Pv(t=+n),Rv(t)):t};return Av(n)}function Iv(){var e=Lv(xv());e.copy=function(){return bv(e,Iv()).constant(e.constant())};return op.apply(e,arguments)}function Uv(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qv(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Wv(e){return e<0?-e*e:e*e}function Hv(e){var t=e(pv,pv),n=1;function r(){return n===1?e(pv,pv):n===.5?e(qv,Wv):e(Uv(n),Uv(1/n))}t.exponent=function(e){return arguments.length?(n=+e,r()):n};return Av(t)}function Gv(){var e=Hv(xv());e.copy=function(){return bv(e,Gv()).exponent(e.exponent())};op.apply(e,arguments);return e}function $v(){return Gv.apply(null,arguments).exponent(.5)}function Vv(){var e=[],t=[],n=[],r;function i(){var r=0,i=Math.max(1,t.length);n=new Array(i-1);while(++r<i)n[r-1]=$r(e,r/i);return a}function a(e){return e==null||isNaN(e=+e)?r:t[xr(n,e)]}a.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]};a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n=0,r=t;n<r.length;n++){var a=r[n];if(a!=null&&!isNaN(a=+a))e.push(a)}e.sort(hr);return i()};a.range=function(e){return arguments.length?(t=Array.from(e),i()):t.slice()};a.unknown=function(e){return arguments.length?(r=e,a):r};a.quantiles=function(){return n.slice()};a.copy=function(){return Vv().domain(e).range(t).unknown(r)};return op.apply(a,arguments)}function Yv(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(e){return e!=null&&e<=e?i[xr(r,e,0,n)]:a}function u(){var i=-1;r=new Array(n);while(++i<n)r[i]=((i+1)*t-(i-n)*e)/(n+1);return o}o.domain=function(n){return arguments.length?(e=n[0],t=n[1],e=+e,t=+t,u()):[e,t]};o.range=function(e){return arguments.length?(n=(i=Array.from(e)).length-1,u()):i.slice()};o.invertExtent=function(a){var o=i.indexOf(a);return o<0?[NaN,NaN]:o<1?[e,r[0]]:o>=n?[r[n-1],t]:[r[o-1],r[o]]};o.unknown=function(e){return arguments.length?(a=e,o):o};o.thresholds=function(){return r.slice()};o.copy=function(){return Yv().domain([e,t]).range(i).unknown(a)};return op.apply(Av(o),arguments)}function Xv(){var e=[.5],t=[0,1],n,r=1;function i(i){return i!=null&&i<=i?t[xr(e,i,0,r)]:n}i.domain=function(n){return arguments.length?(e=Array.from(n),r=Math.min(e.length,t.length-1),i):e.slice()};i.range=function(n){return arguments.length?(t=Array.from(n),r=Math.min(e.length,t.length-1),i):t.slice()};i.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]};i.unknown=function(e){return arguments.length?(n=e,i):n};i.copy=function(){return Xv().domain(e).range(t).unknown(n)};return op.apply(i,arguments)}function Jv(e){return new Date(e)}function Qv(e){return e instanceof Date?+e:+new Date(+e)}function Zv(e,t,n,r,i,a,o,u,s,l){var f=_v(),c=f.invert,d=f.domain;var h=l(".%L"),p=l(":%S"),v=l("%I:%M"),g=l("%I %p"),m=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y");function _(e){return(s(e)<e?h:u(e)<e?p:o(e)<e?v:a(e)<e?g:r(e)<e?i(e)<e?m:y:n(e)<e?b:x)(e)}f.invert=function(e){return new Date(c(e))};f.domain=function(e){return arguments.length?d(Array.from(e,Qv)):d().map(Jv)};f.ticks=function(t){var n=d();return e(n[0],n[n.length-1],t==null?10:t)};f.tickFormat=function(e,t){return t==null?_:l(t)};f.nice=function(e){var n=d();if(!e||typeof e.range!=="function")e=t(n[0],n[n.length-1],e==null?10:e);return e?d(kv(n,e)):f};f.copy=function(){return bv(f,Zv(e,t,n,r,i,a,o,u,s,l))};return f}function Kv(){return op.apply(Zv(aa,oa,Zi,Ji,Wi,Li,Pi,Ti,Ni,qu).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eg(){return op.apply(Zv(na,ra,Ki,Qi,Vi,Ii,Ri,zi,Ni,Hu).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function tg(){var e=0,t=1,n,r,i,a,o=pv,u=false,s;function l(e){return e==null||isNaN(e=+e)?s:o(i===0?.5:(e=(a(e)-n)*i,u?Math.max(0,Math.min(1,e)):e))}l.domain=function(o){return arguments.length?(e=o[0],t=o[1],n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]};l.clamp=function(e){return arguments.length?(u=!!e,l):u};l.interpolator=function(e){return arguments.length?(o=e,l):o};function f(e){return function(t){var n,r;return arguments.length?(n=t[0],r=t[1],o=e(n,r),l):[o(0),o(1)]}}l.range=f(Yp);l.rangeRound=f(Qp);l.unknown=function(e){return arguments.length?(s=e,l):s};return function(o){a=o,n=o(e),r=o(t),i=n===r?0:1/(r-n);return l}}function ng(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function rg(){var e=Av(tg()(pv));e.copy=function(){return ng(e,rg())};return up.apply(e,arguments)}function ig(){var e=Tv(tg()).domain([1,10]);e.copy=function(){return ng(e,ig()).base(e.base())};return up.apply(e,arguments)}function ag(){var e=Lv(tg());e.copy=function(){return ng(e,ag()).constant(e.constant())};return up.apply(e,arguments)}function og(){var e=Hv(tg());e.copy=function(){return ng(e,og()).exponent(e.exponent())};return up.apply(e,arguments)}function ug(){return og.apply(null,arguments).exponent(.5)}function sg(){var e=0,t=.5,n=1,r=1,i,a,o,u,s,l=pv,f,c=false,d;function h(e){return isNaN(e=+e)?d:(e=.5+((e=+f(e))-a)*(r*e<r*a?u:s),l(c?Math.max(0,Math.min(1,e)):e))}h.domain=function(l){return arguments.length?(e=l[0],t=l[1],n=l[2],i=f(e=+e),a=f(t=+t),o=f(n=+n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]};h.clamp=function(e){return arguments.length?(c=!!e,h):c};h.interpolator=function(e){return arguments.length?(l=e,h):l};function p(e){return function(t){var n,r,i;return arguments.length?(n=t[0],r=t[1],i=t[2],l=sv(e,[n,r,i]),h):[l(0),l(.5),l(1)]}}h.range=p(Yp);h.rangeRound=p(Qp);h.unknown=function(e){return arguments.length?(d=e,h):d};return function(l){f=l,i=l(e),a=l(t),o=l(n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1;return h}}function lg(){var e=Av(sg()(pv));e.copy=function(){return ng(e,lg())};return up.apply(e,arguments)}function fg(){var e=Tv(sg()).domain([.1,1,10]);e.copy=function(){return ng(e,fg()).base(e.base())};return up.apply(e,arguments)}function cg(){var e=Lv(sg());e.copy=function(){return ng(e,cg()).constant(e.constant())};return up.apply(e,arguments)}function dg(){var e=Hv(sg());e.copy=function(){return ng(e,dg()).exponent(e.exponent())};return up.apply(e,arguments)}function hg(){return dg.apply(null,arguments).exponent(.5)}function pg(e,t,n){var r=e-t+n*2;return e?r>0?r:1:0}var vg="identity";var gg="linear";var mg="log";var yg="pow";var bg="sqrt";var xg="symlog";var _g="time";var wg="utc";var Ag="sequential";var Og="diverging";var Eg="quantile";var kg="quantize";var Dg="threshold";var Cg="ordinal";var Fg="point";var Sg="band";var jg="bin-ordinal";var Mg="continuous";var Bg="discrete";var Ng="discretizing";var Tg="interpolating";var zg="temporal";function Pg(e){return function(t){var n=t[0],r=t[1],i;if(r<n){i=n;n=r;r=i}return[e.invert(n),e.invert(r)]}}function Rg(e){return function(t){var n=e.range();var r=t[0],i=t[1],a=-1,o,u,s,l;if(i<r){u=r;r=i;i=u}for(s=0,l=n.length;s<l;++s){if(n[s]>=r&&n[s]<=i){if(a<0)a=s;o=s}}if(a<0)return undefined;r=e.invertExtent(n[a]);i=e.invertExtent(n[o]);return[r[0]===undefined?r[1]:r[0],i[1]===undefined?i[0]:i[1]]}}function Lg(){var e=lp().unknown(undefined),t=e.domain,n=e.range;var r=[0,1],i,a,o=false,u=0,s=0,l=.5;delete e.unknown;function f(){var e=t().length,f=r[1]<r[0],c=r[1-f],d=pg(e,u,s);var h=r[f-0];i=(c-h)/(d||1);if(o){i=Math.floor(i)}h+=(c-h-i*(e-u))*l;a=i*(1-u);if(o){h=Math.round(h);a=Math.round(a)}var p=Qr(e).map((function(e){return h+i*e}));return n(f?p.reverse():p)}e.domain=function(e){if(arguments.length){t(e);return f()}else{return t()}};e.range=function(e){if(arguments.length){r=[+e[0],+e[1]];return f()}else{return r.slice()}};e.rangeRound=function(e){r=[+e[0],+e[1]];o=true;return f()};e.bandwidth=function(){return a};e.step=function(){return i};e.round=function(e){if(arguments.length){o=!!e;return f()}else{return o}};e.padding=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));u=s;return f()}else{return u}};e.paddingInner=function(e){if(arguments.length){u=Math.max(0,Math.min(1,e));return f()}else{return u}};e.paddingOuter=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));return f()}else{return s}};e.align=function(e){if(arguments.length){l=Math.max(0,Math.min(1,e));return f()}else{return l}};e.invertRange=function(e){if(e[0]==null||e[1]==null)return;var i=r[1]<r[0],o=i?n().reverse():n(),u=o.length-1;var s=+e[0],l=+e[1],f,c,d;if(s!==s||l!==l)return;if(l<s){d=s;s=l;l=d}if(l<o[0]||s>r[1-i])return;f=Math.max(0,xr(o,s)-1);c=s===l?f:xr(o,l)-1;if(s-o[f]>a+1e-10)++f;if(i){d=f;f=u-c;c=u-d}return f>c?undefined:t().slice(f,c+1)};e.invert=function(t){var n=e.invertRange([t,t]);return n?n[0]:n};e.copy=function(){return Lg().domain(t()).range(r).round(o).paddingInner(u).paddingOuter(s).align(l)};return f()}function Ig(e){var t=e.copy;e.padding=e.paddingOuter;delete e.paddingInner;e.copy=function(){return Ig(t())};return e}function Ug(){return Ig(Lg().paddingInner(1))}var qg=Array.prototype.map;function Wg(e){return qg.call(e,Pt)}var Hg=Array.prototype.slice;function Gg(){var e=[],t=[];function n(n){return n==null||n!==n?undefined:t[(xr(e,n)-1)%t.length]}n.domain=function(t){if(arguments.length){e=Wg(t);return n}else{return e.slice()}};n.range=function(e){if(arguments.length){t=Hg.call(e);return n}else{return t.slice()}};n.tickFormat=function(t,n){return wv(e[0],zt(e),t==null?10:t,n)};n.copy=function(){return Gg().domain(n.domain()).range(n.range())};return n}var $g=new Map;var Vg=Symbol("vega_scale");function Yg(e){e[Vg]=true;return e}function Xg(e){return e&&e[Vg]===true}function Jg(e,t,n){var r=function n(){var r=t();if(!r.invertRange){r.invertRange=r.invert?Pg(r):r.invertExtent?Rg(r):undefined}r.type=e;return Yg(r)};r.metadata=qn(tn(n));return r}function Qg(e,t,n){if(arguments.length>1){$g.set(e,Jg(e,t,n));return this}else{return Zg(e)?$g.get(e):undefined}}Qg(vg,Ev);Qg(gg,Ov,Mg);Qg(mg,zv,[Mg,mg]);Qg(yg,Gv,Mg);Qg(bg,$v,Mg);Qg(xg,Iv,Mg);Qg(_g,Kv,[Mg,zg]);Qg(wg,eg,[Mg,zg]);Qg(Ag,rg,[Mg,Tg]);Qg("".concat(Ag,"-").concat(gg),rg,[Mg,Tg]);Qg("".concat(Ag,"-").concat(mg),ig,[Mg,Tg,mg]);Qg("".concat(Ag,"-").concat(yg),og,[Mg,Tg]);Qg("".concat(Ag,"-").concat(bg),ug,[Mg,Tg]);Qg("".concat(Ag,"-").concat(xg),ag,[Mg,Tg]);Qg("".concat(Og,"-").concat(gg),lg,[Mg,Tg]);Qg("".concat(Og,"-").concat(mg),fg,[Mg,Tg,mg]);Qg("".concat(Og,"-").concat(yg),dg,[Mg,Tg]);Qg("".concat(Og,"-").concat(bg),hg,[Mg,Tg]);Qg("".concat(Og,"-").concat(xg),cg,[Mg,Tg]);Qg(Eg,Vv,[Ng,Eg]);Qg(kg,Yv,Ng);Qg(Dg,Xv,Ng);Qg(jg,Gg,[Bg,Ng]);Qg(Cg,lp,Bg);Qg(Sg,Lg,Bg);Qg(Fg,Ug,Bg);function Zg(e){return $g.has(e)}function Kg(e,t){var n=$g.get(e);return n&&n.metadata[t]}function em(e){return Kg(e,Mg)}function tm(e){return Kg(e,Bg)}function nm(e){return Kg(e,Ng)}function rm(e){return Kg(e,mg)}function im(e){return Kg(e,zg)}function am(e){return Kg(e,Tg)}function om(e){return Kg(e,Eg)}var um=["clamp","base","constant","exponent"];function sm(e,t){var n=t[0],r=zt(t)-n;return function(t){return e(n+t*r)}}function lm(e,t,n){return sv(dm(t||"rgb",n),e)}function fm(e,t){var n=new Array(t),r=t+1;for(var i=0;i<t;)n[i]=e(++i/r);return n}function cm(e,t,n){var r=n-t;var i,a,o;if(!r||!Number.isFinite(r)){return cn(.5)}else{i=(a=e.type).indexOf("-");a=i<0?a:a.slice(i+1);o=Qg(a)().domain([t,n]).range([0,1]);um.forEach((function(t){return e[t]?o[t](e[t]()):0}));return o}}function dm(e,t){var n=fv[hm(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function hm(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}var pm={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"};var vm={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function gm(e){var t=e.length/6|0,n=new Array(t);for(var r=0;r<t;){n[r]="#"+e.slice(r*6,++r*6)}return n}function mm(e,t){for(var n in e)bm(n,t(e[n]))}var ym={};mm(vm,gm);mm(pm,(function(e){return lm(gm(e))}));function bm(e,t){e=e&&e.toLowerCase();if(arguments.length>1){ym[e]=t;return this}else{return ym[e]}}var xm="symbol";var _m="discrete";var wm="gradient";var Am=function(e){return St(e)?e.map((function(e){return String(e)})):String(e)};var Om=function(e,t){return e[1]-t[1]};var Em=function(e,t){return t[1]-e[1]};function km(e,t,n){var r;if(kn(t)){if(e.bins){t=Math.max(t,e.bins.length)}if(n!=null){t=Math.min(t,Math.floor(zn(e.domain())/n||1))}}if(jt(t)){r=t.step;t=t.interval}if(Cn(t)){t=e.type===_g?Ya(t):e.type==wg?Xa(t):pt("Only time and utc scales accept interval strings.");if(r)t=t.every(r)}return t}function Dm(e,t,n){var r=e.range(),i=r[0],a=zt(r),o=Om;if(i>a){r=a;a=i;i=r;o=Em}i=Math.floor(i);a=Math.ceil(a);t=t.map((function(t){return[t,e(t)]})).filter((function(e){return i<=e[1]&&e[1]<=a})).sort(o).map((function(e){return e[0]}));if(n>0&&t.length>1){var u=[t[0],zt(t)];while(t.length>n&&t.length>=3){t=t.filter((function(e,t){return!(t%2)}))}if(t.length<3){t=u}}return t}function Cm(e,t){return e.bins?Dm(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Fm(e,t,n,r,i,a){var o=t.type;var u=Am;if(o===_g||i===_g){u=e.timeFormat(r)}else if(o===wg||i===wg){u=e.utcFormat(r)}else if(rm(o)){var s=e.formatFloat(r);if(a||t.bins){u=s}else{var l=Sm(t,n,false);u=function(e){return l(e)?s(e):""}}}else if(t.tickFormat){var f=t.domain();u=e.formatSpan(f[0],f[f.length-1],n,r)}else if(r){u=e.format(r)}return u}function Sm(e,t,n){var r=Cm(e,t),i=e.base(),a=Math.log(i),o=Math.max(1,i*t/r.length);var u=function(e){var t=e/Math.pow(i,Math.round(Math.log(e)/a));if(t*i<i-.5)t*=i;return t<=o};return n?r.filter(u):u}var jm=(_e={},_e[Eg]="quantiles",_e[kg]="thresholds",_e[Dg]="domain",_e);var Mm=(we={},we[Eg]="quantiles",we[kg]="domain",we);function Bm(e,t){return e.bins?zm(e.bins):e.type===mg?Sm(e,t,true):jm[e.type]?Tm(e[jm[e.type]]()):Cm(e,t)}function Nm(e,t,n){var r=t[Mm[t.type]](),i=r.length;var a=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o){a=Math.min(a,r[o]-r[o-1])}return e.formatSpan(0,a,3*10,n)}function Tm(e){var t=[-Infinity].concat(e);t.max=+Infinity;return t}function zm(e){var t=e.slice(0,-1);t.max=zt(e);return t}var Pm=function(e){return jm[e.type]||e.bins};function Rm(e,t,n,r,i,a,o){var u=Mm[t.type]&&a!==_g&&a!==wg?Nm(e,t,i):Fm(e,t,n,i,a,o);return r===xm&&Pm(t)?Lm(u):r===_m?Um(u):qm(u)}var Lm=function(e){return function(t,n,r){var i=Im(r[n+1],Im(r.max,+Infinity)),a=Wm(t,e),o=Wm(i,e);return a&&o?a+" – "+o:o?"< "+o:"≥ "+a}};var Im=function(e,t){return e!=null?e:t};var Um=function(e){return function(t,n){return n?e(t):null}};var qm=function(e){return function(t){return e(t)}};var Wm=function(e,t){return Number.isFinite(e)?t(e):null};function Hm(e){var t=e.domain(),n=t.length-1;var r=+t[0],i=+zt(t),a=i-r;if(e.type===Dg){var o=n?a/n:.1;r-=o;i+=o;a=i-r}return function(e){return(e-r)/a}}function Gm(e,t,n,r){var i=r||t.type;if(Cn(n)&&im(i)){n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")}return!n&&i===_g?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===wg?e.utcFormat("%A, %d %B %Y, %X UTC"):Rm(e,t,5,null,n,r,true)}function $m(e,t,n){n=n||{};var r=Math.max(3,n.maxlen||7),i=Gm(e,t,n.format,n.formatType);if(nm(t.type)){var a=Bm(t).slice(1).map(i),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if(tm(t.type)){var u=t.domain(),o=u.length,a=o>r?u.slice(0,r-2).map(i).join(", ")+", ending with "+u.slice(-1).map(i):u.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(a)}else{var u=t.domain();return"values from ".concat(i(u[0])," to ").concat(i(zt(u)))}}var Vm=0;function Ym(){Vm=0}var Xm="p_";function Jm(e){return e&&e.gradient}function Qm(e,t,n){var r=e.gradient;var i=e.id,a=r==="radial"?Xm:"";if(!i){i=e.id="gradient_"+Vm++;if(r==="radial"){e.x1=Zm(e.x1,.5);e.y1=Zm(e.y1,.5);e.r1=Zm(e.r1,0);e.x2=Zm(e.x2,.5);e.y2=Zm(e.y2,.5);e.r2=Zm(e.r2,.5);a=Xm}else{e.x1=Zm(e.x1,0);e.y1=Zm(e.y1,0);e.x2=Zm(e.x2,1);e.y2=Zm(e.y2,0)}}t[i]=e;return"url("+(n||"")+"#"+a+i+")"}function Zm(e,t){return e!=null?e:t}function Km(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){n.push({offset:e,color:t});return r}}}var ey={basis:{curve:K},"basis-closed":{curve:ee},"basis-open":{curve:Ah},bundle:{curve:Eh,tension:"beta",value:.85},cardinal:{curve:Ch,tension:"tension",value:0},"cardinal-open":{curve:Mh,tension:"tension",value:0},"cardinal-closed":{curve:Sh,tension:"tension",value:0},"catmull-rom":{curve:Th,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Ph,tension:"alpha",value:.5},"catmull-rom-open":{curve:Lh,tension:"alpha",value:.5},linear:{curve:A},"linear-closed":{curve:Uh},monotone:{horizontal:Jh,vertical:Xh},natural:{curve:Kh},step:{curve:tp},"step-after":{curve:rp},"step-before":{curve:np}};function ty(e,t,n){var r=mn(ey,e)&&ey[e],i=null;if(r){i=r.curve||r[t||"vertical"];if(r.tension&&n!=null){i=i[r.tension](n)}}return i}var ny={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7};var ry=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi;var iy=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/;var ay=/^((\s+,?\s*)|(,\s*))/;var oy=/^[01]/;function uy(e){var t=[];var n=e.match(ry)||[];n.forEach((function(e){var n=e[0];var r=n.toLowerCase();var i=ny[r];var a=sy(r,i,e.slice(1).trim());var o=a.length;if(o<i||o&&o%i!==0){throw Error("Invalid SVG path, incorrect parameter count")}t.push(__spreadArray([n],a.slice(0,i),true));if(o===i){return}if(r==="m"){n=n==="M"?"L":"l"}for(var u=i;u<o;u+=i){t.push(__spreadArray([n],a.slice(u,u+i),true))}}));return t}function sy(e,t,n){var r=[];for(var i=0;t&&i<n.length;){for(var a=0;a<t;++a){var o=e==="a"&&(a===3||a===4)?oy:iy;var u=n.slice(i).match(o);if(u===null){throw Error("Invalid SVG path, incorrect parameter type")}i+=u[0].length;r.push(+u[0]);var s=n.slice(i).match(ay);if(s!==null){i+=s[0].length}}}return r}var ly=Math.PI/180;var fy=1e-14;var cy=Math.PI/2;var dy=Math.PI*2;var hy=Math.sqrt(3)/2;var py={};var vy={};var gy=[].join;function my(e,t,n,r,i,a,o,u,s){var l=gy.call(arguments);if(py[l]){return py[l]}var f=o*ly;var c=Math.sin(f);var d=Math.cos(f);n=Math.abs(n);r=Math.abs(r);var h=d*(u-e)*.5+c*(s-t)*.5;var p=d*(s-t)*.5-c*(u-e)*.5;var v=h*h/(n*n)+p*p/(r*r);if(v>1){v=Math.sqrt(v);n*=v;r*=v}var g=d/n;var m=c/n;var y=-c/r;var b=d/r;var x=g*u+m*s;var _=y*u+b*s;var w=g*e+m*t;var A=y*e+b*t;var O=(w-x)*(w-x)+(A-_)*(A-_);var E=1/O-.25;if(E<0)E=0;var k=Math.sqrt(E);if(a==i)k=-k;var D=.5*(x+w)-k*(A-_);var C=.5*(_+A)+k*(w-x);var F=Math.atan2(_-C,x-D);var S=Math.atan2(A-C,w-D);var j=S-F;if(j<0&&a===1){j+=dy}else if(j>0&&a===0){j-=dy}var M=Math.ceil(Math.abs(j/(cy+.001)));var B=[];for(var N=0;N<M;++N){var T=F+N*j/M;var z=F+(N+1)*j/M;B[N]=[D,C,T,z,n,r,c,d]}return py[l]=B}function yy(e){var t=gy.call(e);if(vy[t]){return vy[t]}var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7];var f=l*o;var c=-s*u;var d=s*o;var h=l*u;var p=Math.cos(i);var v=Math.sin(i);var g=Math.cos(a);var m=Math.sin(a);var y=.5*(a-i);var b=Math.sin(y*.5);var x=8/3*b*b/Math.sin(y);var _=n+p-x*v;var w=r+v+x*p;var A=n+g;var O=r+m;var E=A+x*m;var k=O-x*g;return vy[t]=[f*_+c*w,d*_+h*w,f*E+c*k,d*E+h*k,f*A+c*O,d*A+h*O]}var by=["l",0,0,0,0,0,0,0];function xy(e,t,n){var r=by[0]=e[0];if(r==="a"||r==="A"){by[1]=t*e[1];by[2]=n*e[2];by[3]=e[3];by[4]=e[4];by[5]=e[5];by[6]=t*e[6];by[7]=n*e[7]}else if(r==="h"||r==="H"){by[1]=t*e[1]}else if(r==="v"||r==="V"){by[1]=n*e[1]}else{for(var i=1,a=e.length;i<a;++i){by[i]=(i%2==1?t:n)*e[i]}}return by}function _y(e,t,n,r,i,a){var o,u=null,s=0,l=0,f=0,c=0,d,h,p,v,g=0,m=0;if(n==null)n=0;if(r==null)r=0;if(i==null)i=1;if(a==null)a=i;if(e.beginPath)e.beginPath();for(var y=0,b=t.length;y<b;++y){o=t[y];if(i!==1||a!==1){o=xy(o,i,a)}switch(o[0]){case"l":s+=o[1];l+=o[2];e.lineTo(s+n,l+r);break;case"L":s=o[1];l=o[2];e.lineTo(s+n,l+r);break;case"h":s+=o[1];e.lineTo(s+n,l+r);break;case"H":s=o[1];e.lineTo(s+n,l+r);break;case"v":l+=o[1];e.lineTo(s+n,l+r);break;case"V":l=o[1];e.lineTo(s+n,l+r);break;case"m":s+=o[1];l+=o[2];g=s;m=l;e.moveTo(s+n,l+r);break;case"M":s=o[1];l=o[2];g=s;m=l;e.moveTo(s+n,l+r);break;case"c":d=s+o[5];h=l+o[6];f=s+o[3];c=l+o[4];e.bezierCurveTo(s+o[1]+n,l+o[2]+r,f+n,c+r,d+n,h+r);s=d;l=h;break;case"C":s=o[5];l=o[6];f=o[3];c=o[4];e.bezierCurveTo(o[1]+n,o[2]+r,f+n,c+r,s+n,l+r);break;case"s":d=s+o[3];h=l+o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,s+o[1]+n,l+o[2]+r,d+n,h+r);f=s+o[1];c=l+o[2];s=d;l=h;break;case"S":d=o[3];h=o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,o[1]+n,o[2]+r,d+n,h+r);s=d;l=h;f=o[1];c=o[2];break;case"q":d=s+o[3];h=l+o[4];f=s+o[1];c=l+o[2];e.quadraticCurveTo(f+n,c+r,d+n,h+r);s=d;l=h;break;case"Q":d=o[3];h=o[4];e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r);s=d;l=h;f=o[1];c=o[2];break;case"t":d=s+o[1];h=l+o[2];if(u[0].match(/[QqTt]/)===null){f=s;c=l}else if(u[0]==="t"){f=2*s-p;c=2*l-v}else if(u[0]==="q"){f=2*s-f;c=2*l-c}p=f;v=c;e.quadraticCurveTo(f+n,c+r,d+n,h+r);s=d;l=h;f=s+o[1];c=l+o[2];break;case"T":d=o[1];h=o[2];f=2*s-f;c=2*l-c;e.quadraticCurveTo(f+n,c+r,d+n,h+r);s=d;l=h;break;case"a":wy(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+r]);s+=o[6];l+=o[7];break;case"A":wy(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]);s=o[6];l=o[7];break;case"z":case"Z":s=g;l=m;e.closePath();break}u=o}}function wy(e,t,n,r){var i=my(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(var a=0;a<i.length;++a){var o=yy(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var Ay=.5773502691896257;var Oy={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0);e.arc(0,0,n,0,dy)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r);e.lineTo(-n,r);e.lineTo(-r,r);e.lineTo(-r,n);e.lineTo(r,n);e.lineTo(r,r);e.lineTo(n,r);e.lineTo(n,-r);e.lineTo(r,-r);e.lineTo(r,-n);e.lineTo(-r,-n);e.lineTo(-r,-r);e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(0,-n);e.lineTo(n,0);e.lineTo(0,n);e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n);e.lineTo(r,n);e.lineTo(r,-a);e.lineTo(i,-a);e.lineTo(0,-n);e.lineTo(-i,-a);e.lineTo(-r,-a);e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=hy*n,i=r-n*Ay,a=n/4;e.moveTo(0,-r-i);e.lineTo(-a,r-i);e.lineTo(a,r-i);e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=hy*n,i=r-n*Ay;e.moveTo(0,-r-i);e.lineTo(-n,r-i);e.lineTo(n,r-i);e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=hy*n;e.moveTo(0,-r);e.lineTo(-n,r);e.lineTo(n,r);e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=hy*n;e.moveTo(0,r);e.lineTo(-n,-r);e.lineTo(n,-r);e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=hy*n;e.moveTo(r,0);e.lineTo(-r,-n);e.lineTo(-r,n);e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=hy*n;e.moveTo(-r,0);e.lineTo(r,-n);e.lineTo(r,n);e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(n,0)}}};function Ey(e){return mn(Oy,e)?Oy[e]:Dy(e)}var ky={};function Dy(e){if(!mn(ky,e)){var t=uy(e);ky[e]={draw:function(e,n){_y(e,t,0,0,Math.sqrt(n)/2)}}}return ky[e]}var Cy=.448084975506;function Fy(e){return e.x}function Sy(e){return e.y}function jy(e){return e.width}function My(e){return e.height}function By(e){return typeof e==="function"?e:function(){return+e}}function Ny(e,t,n){return Math.max(t,Math.min(e,n))}function Ty(){var e=Fy,t=Sy,n=jy,r=My,i=By(0),a=i,o=i,u=i,s=null;function l(l,f,c){var d,h=f!=null?f:+e.call(this,l),p=c!=null?c:+t.call(this,l),v=+n.call(this,l),g=+r.call(this,l),m=Math.min(v,g)/2,y=Ny(+i.call(this,l),0,m),b=Ny(+a.call(this,l),0,m),x=Ny(+o.call(this,l),0,m),_=Ny(+u.call(this,l),0,m);if(!s)s=d=Z();if(y<=0&&b<=0&&x<=0&&_<=0){s.rect(h,p,v,g)}else{var w=h+v,A=p+g;s.moveTo(h+y,p);s.lineTo(w-b,p);s.bezierCurveTo(w-Cy*b,p,w,p+Cy*b,w,p+b);s.lineTo(w,A-_);s.bezierCurveTo(w,A-Cy*_,w-Cy*_,A,w-_,A);s.lineTo(h+x,A);s.bezierCurveTo(h+Cy*x,A,h,A-Cy*x,h,A-x);s.lineTo(h,p+y);s.bezierCurveTo(h,p+Cy*y,h+Cy*y,p,h+y,p);s.closePath()}if(d){s=null;return d+""||null}}l.x=function(t){if(arguments.length){e=By(t);return l}else{return e}};l.y=function(e){if(arguments.length){t=By(e);return l}else{return t}};l.width=function(e){if(arguments.length){n=By(e);return l}else{return n}};l.height=function(e){if(arguments.length){r=By(e);return l}else{return r}};l.cornerRadius=function(e,t,n,r){if(arguments.length){i=By(e);a=t!=null?By(t):i;u=n!=null?By(n):i;o=r!=null?By(r):a;return l}else{return i}};l.context=function(e){if(arguments.length){s=e==null?null:e;return l}else{return s}};return l}function zy(){var e,t,n,r,i=null,a,o,u,s;function l(e,t,n){var r=n/2;if(a){var l=u-t,f=e-o;if(l||f){var c=Math.sqrt(l*l+f*f),d=(l/=c)*s,h=(f/=c)*s,p=Math.atan2(f,l);i.moveTo(o-d,u-h);i.lineTo(e-l*r,t-f*r);i.arc(e,t,r,p-Math.PI,p);i.lineTo(o+d,u+h);i.arc(o,u,s,p,p+Math.PI)}else{i.arc(e,t,r,0,dy)}i.closePath()}else{a=1}o=e;u=t;s=r}function f(o){var u,s=o.length,f,c=false,d;if(i==null)i=d=Z();for(u=0;u<=s;++u){if(!(u<s&&r(f=o[u],u,o))===c){if(c=!c)a=0}if(c)l(+e(f,u,o),+t(f,u,o),+n(f,u,o))}if(d){i=null;return d+""||null}}f.x=function(t){if(arguments.length){e=t;return f}else{return e}};f.y=function(e){if(arguments.length){t=e;return f}else{return t}};f.size=function(e){if(arguments.length){n=e;return f}else{return n}};f.defined=function(e){if(arguments.length){r=e;return f}else{return r}};f.context=function(e){if(arguments.length){if(e==null){i=null}else{i=e}return f}else{return i}};return f}function Py(e,t){return e!=null?e:t}var Ry=function(e){return e.x||0},Ly=function(e){return e.y||0},Iy=function(e){return e.width||0},Uy=function(e){return e.height||0},qy=function(e){return(e.x||0)+(e.width||0)},Wy=function(e){return(e.y||0)+(e.height||0)},Hy=function(e){return e.startAngle||0},Gy=function(e){return e.endAngle||0},$y=function(e){return e.padAngle||0},Vy=function(e){return e.innerRadius||0},Yy=function(e){return e.outerRadius||0},Xy=function(e){return e.cornerRadius||0},Jy=function(e){return Py(e.cornerRadiusTopLeft,e.cornerRadius)||0},Qy=function(e){return Py(e.cornerRadiusTopRight,e.cornerRadius)||0},Zy=function(e){return Py(e.cornerRadiusBottomRight,e.cornerRadius)||0},Ky=function(e){return Py(e.cornerRadiusBottomLeft,e.cornerRadius)||0},eb=function(e){return Py(e.size,64)},tb=function(e){return e.size||1},nb=function(e){return!(e.defined===false)},rb=function(e){return Ey(e.shape||"circle")};var ib=xh().startAngle(Hy).endAngle(Gy).padAngle($y).innerRadius(Vy).outerRadius(Yy).cornerRadius(Xy),ab=_h().x(Ry).y1(Ly).y0(Wy).defined(nb),ob=_h().y(Ly).x1(Ry).x0(qy).defined(nb),ub=w().x(Ry).y(Ly).defined(nb),sb=Ty().x(Ry).y(Ly).width(Iy).height(Uy).cornerRadius(Jy,Qy,Zy,Ky),lb=Q().type(rb).size(eb),fb=zy().x(Ry).y(Ly).defined(nb).size(tb);function cb(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function db(e,t){return ib.context(e)(t)}function hb(e,t){var n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?ob:ab).curve(ty(r,n.orient,n.tension)).context(e)(t)}function pb(e,t){var n=t[0],r=n.interpolate||"linear";return ub.curve(ty(r,n.orient,n.tension)).context(e)(t)}function vb(e,t,n,r){return sb.context(e)(t,n,r)}function gb(e,t){return(t.mark.shape||t.shape).context(e)(t)}function mb(e,t){return lb.context(e)(t)}function yb(e,t){return fb.context(e)(t)}var bb=1;function xb(){bb=1}function _b(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+bb++),o=i.clipping[a]||(i.clipping[a]={id:a});if(rn(r)){o.path=r(null)}else if(cb(n)){o.path=vb(null,n,0,0)}else{o.width=n.width||0;o.height=n.height||0}return"url(#"+a+")"}function wb(e){this.clear();if(e)this.union(e)}wb.prototype={clone:function(){return new wb(this)},clear:function(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){if(n<e){this.x2=e;this.x1=n}else{this.x1=e;this.x2=n}if(r<t){this.y2=t;this.y1=r}else{this.y1=t;this.y2=r}return this},add:function(e,t){if(e<this.x1)this.x1=e;if(t<this.y1)this.y1=t;if(e>this.x2)this.x2=e;if(t>this.y2)this.y2=t;return this},expand:function(e){this.x1-=e;this.y1-=e;this.x2+=e;this.y2+=e;return this},round:function(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this},scale:function(e){this.x1*=e;this.y1*=e;this.x2*=e;this.y2*=e;return this},translate:function(e,t){this.x1+=e;this.x2+=e;this.y1+=t;this.y2+=t;return this},rotate:function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var r=this,i=r.x1,a=r.y1,o=r.x2,u=r.y2,s=Math.cos(e),l=Math.sin(e),f=t-t*s+n*l,c=n-t*l-n*s;return[s*i-l*a+f,l*i+s*a+c,s*i-l*u+f,l*i+s*u+c,s*o-l*a+f,l*o+s*a+c,s*o-l*u+f,l*o+s*u+c]},union:function(e){if(e.x1<this.x1)this.x1=e.x1;if(e.y1<this.y1)this.y1=e.y1;if(e.x2>this.x2)this.x2=e.x2;if(e.y2>this.y2)this.y2=e.y2;return this},intersect:function(e){if(e.x1>this.x1)this.x1=e.x1;if(e.y1>this.y1)this.y1=e.y1;if(e.x2<this.x2)this.x2=e.x2;if(e.y2<this.y2)this.y2=e.y2;return this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}};function Ab(e){this.mark=e;this.bounds=this.bounds||new wb}function Ob(e){Ab.call(this,e);this.items=this.items||[]}_n(Ob,Ab);function Eb(e){this._pending=0;this._loader=e||Hs()}function kb(e){e._pending+=1}function Db(e){e._pending-=1}Eb.prototype={pending:function(){return this._pending},sanitizeURL:function(e){var t=this;kb(t);return t._loader.sanitize(e,{context:"href"}).then((function(e){Db(t);return e})).catch((function(){Db(t);return null}))},loadImage:function(e){var t=this,n=ap();kb(t);return t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var i=new n;var a=mn(e,"crossOrigin")?e.crossOrigin:"anonymous";if(a!=null)i.crossOrigin=a;i.onload=function(){return Db(t)};i.onerror=function(){return Db(t)};i.src=r;return i})).catch((function(e){Db(t);return{complete:false,width:0,height:0,src:e&&e.url||""}}))},ready:function(){var e=this;return new Promise((function(t){function n(r){if(!e.pending())t(r);else setTimeout((function(){n(true)}),10)}n(false)}))}};function Cb(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){var r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Fb(t,r):0))}return e}function Fb(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}var Sb=dy-1e-8;var jb,Mb,Bb,Nb,Tb,zb,Pb,Rb;var Lb=function(e,t){return jb.add(e,t)};var Ib=function(e,t){return Lb(Mb=e,Bb=t)};var Ub=function(e){return Lb(e,jb.y1)};var qb=function(e){return Lb(jb.x1,e)};var Wb=function(e,t){return Tb*e+Pb*t};var Hb=function(e,t){return zb*e+Rb*t};var Gb=function(e,t){return Lb(Wb(e,t),Hb(e,t))};var $b=function(e,t){return Ib(Wb(e,t),Hb(e,t))};function Vb(e,t){jb=e;if(t){Nb=t*ly;Tb=Rb=Math.cos(Nb);zb=Math.sin(Nb);Pb=-zb}else{Tb=Rb=1;Nb=zb=Pb=0}return Yb}var Yb={beginPath:function(){},closePath:function(){},moveTo:$b,lineTo:$b,rect:function(e,t,n,r){if(Nb){Gb(e+n,t);Gb(e+n,t+r);Gb(e,t+r);$b(e,t)}else{Lb(e+n,t+r);Ib(e,t)}},quadraticCurveTo:function(e,t,n,r){var i=Wb(e,t),a=Hb(e,t),o=Wb(n,r),u=Hb(n,r);Xb(Mb,i,o,Ub);Xb(Bb,a,u,qb);Ib(o,u)},bezierCurveTo:function(e,t,n,r,i,a){var o=Wb(e,t),u=Hb(e,t),s=Wb(n,r),l=Hb(n,r),f=Wb(i,a),c=Hb(i,a);Jb(Mb,o,s,f,Ub);Jb(Bb,u,l,c,qb);Ib(f,c)},arc:function(e,t,n,r,i,a){r+=Nb;i+=Nb;Mb=n*Math.cos(i)+e;Bb=n*Math.sin(i)+t;if(Math.abs(i-r)>Sb){Lb(e-n,t-n);Lb(e+n,t+n)}else{var o=function(r){return Lb(n*Math.cos(r)+e,n*Math.sin(r)+t)};var u=void 0,s=void 0;o(r);o(i);if(i!==r){r=r%dy;if(r<0)r+=dy;i=i%dy;if(i<0)i+=dy;if(i<r){a=!a;u=r;r=i;i=u}if(a){i-=dy;u=r-r%cy;for(s=0;s<4&&u>i;++s,u-=cy)o(u)}else{u=r-r%cy+cy;for(s=0;s<4&&u<i;++s,u=u+cy)o(u)}}}}};function Xb(e,t,n,r){var i=(e-t)/(e+n-2*t);if(0<i&&i<1)r(e+(t-e)*i)}function Jb(e,t,n,r,i){var a=r-e+3*t-3*n,o=e+n-2*t,u=e-t;var s=0,l=0,f;if(Math.abs(a)>fy){f=o*o+u*a;if(f>=0){f=Math.sqrt(f);s=(-o+f)/a;l=(-o-f)/a}}else{s=.5*u/o}if(0<s&&s<1)i(Qb(s,e,t,n,r));if(0<l&&l<1)i(Qb(l,e,t,n,r))}function Qb(e,t,n,r,i){var a=1-e,o=a*a,u=e*e;return o*a*t+3*o*e*n+3*a*u*r+u*e*i}var Zb=(Zb=ip(1,1))?Zb.getContext("2d"):null;var Kb=new wb;function ex(e){return function(t,n){if(!Zb)return true;e(Zb,t);Kb.clear().union(t.bounds).intersect(n).round();var r=Kb.x1,i=Kb.y1,a=Kb.x2,o=Kb.y2;for(var u=i;u<=o;++u){for(var s=r;s<=a;++s){if(Zb.isPointInPath(s,u)){return true}}}return false}}function tx(e,t){return t.contains(e.x||0,e.y||0)}function nx(e,t){var n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(Kb.set(n,r,n+i,r+a))}function rx(e,t){var n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return ix(t,n,r,i,a)}function ix(e,t,n,r,i){var a=e.x1,o=e.y1,u=e.x2,s=e.y2,l=r-t,f=i-n;var c=0,d=1,h,p,v,g;for(g=0;g<4;++g){if(g===0){h=-l;p=-(a-t)}if(g===1){h=l;p=u-t}if(g===2){h=-f;p=-(o-n)}if(g===3){h=f;p=s-n}if(Math.abs(h)<1e-10&&p<0)return false;v=p/h;if(h<0){if(v>d)return false;else if(v>c)c=v}else if(h>0){if(v<c)return false;else if(v<d)d=v}}return true}function ax(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ox(e,t){return e==null?t:e}function ux(e,t){var n=t.length;for(var r=0;r<n;++r){e.addColorStop(t[r].offset,t[r].color)}return e}function sx(e,t,n){var r=n.width(),i=n.height();var a;if(t.gradient==="radial"){a=e.createRadialGradient(n.x1+ox(t.x1,.5)*r,n.y1+ox(t.y1,.5)*i,Math.max(r,i)*ox(t.r1,0),n.x1+ox(t.x2,.5)*r,n.y1+ox(t.y2,.5)*i,Math.max(r,i)*ox(t.r2,.5))}else{var o=ox(t.x1,0),u=ox(t.y1,0),s=ox(t.x2,1),l=ox(t.y2,0);if(o===s||u===l||r===i){a=e.createLinearGradient(n.x1+o*r,n.y1+u*i,n.x1+s*r,n.y1+l*i)}else{var f=ip(Math.ceil(r),Math.ceil(i)),c=f.getContext("2d");c.scale(r,i);c.fillStyle=ux(c.createLinearGradient(o,u,s,l),t.stops);c.fillRect(0,0,r,i);return e.createPattern(f,"no-repeat")}}return ux(a,t.stops)}function lx(e,t,n){return Jm(n)?sx(e,n,t.bounds):n}function fx(e,t,n){n*=t.fillOpacity==null?1:t.fillOpacity;if(n>0){e.globalAlpha=n;e.fillStyle=lx(e,t,t.fill);return true}else{return false}}var cx=[];function dx(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;if(r<=0)return false;n*=t.strokeOpacity==null?1:t.strokeOpacity;if(n>0){e.globalAlpha=n;e.strokeStyle=lx(e,t,t.stroke);e.lineWidth=r;e.lineCap=t.strokeCap||"butt";e.lineJoin=t.strokeJoin||"miter";e.miterLimit=t.strokeMiterLimit||10;if(e.setLineDash){e.setLineDash(t.strokeDash||cx);e.lineDashOffset=t.strokeDashOffset||0}return true}else{return false}}function hx(e,t){return e.zindex-t.zindex||e.index-t.index}function px(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i){r=t[i];r.index=i;if(r.zindex)n.push(r)}e.zdirty=false;return e.zitems=n.sort(hx)}function vx(e,t){var n=e.items,r,i;if(!n||!n.length)return;var a=px(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r){if(!n[r].zindex)t(n[r])}n=a}for(r=0,i=n.length;r<i;++r){t(n[r])}}function gx(e,t){var n=e.items,r,i;if(!n||!n.length)return null;var a=px(e);if(a&&a.length)n=a;for(i=n.length;--i>=0;){if(r=t(n[i]))return r}if(n===a){for(n=e.items,i=n.length;--i>=0;){if(!n[i].zindex){if(r=t(n[i]))return r}}}return null}function mx(e){return function(t,n,r){vx(n,(function(n){if(!r||r.intersects(n.bounds)){bx(e,t,n,n)}}))}}function yx(e){return function(t,n,r){if(n.items.length&&(!r||r.intersects(n.bounds))){bx(e,t,n.items[0],n.items)}}}function bx(e,t,n,r){var i=n.opacity==null?1:n.opacity;if(i===0)return;if(e(t,r))return;ax(t,n);if(n.fill&&fx(t,n,i)){t.fill()}if(n.stroke&&dx(t,n,i)){t.stroke()}}function xx(e){e=e||_t;return function(t,n,r,i,a,o){r*=t.pixelRatio;i*=t.pixelRatio;return gx(n,(function(n){var u=n.bounds;if(u&&!u.contains(a,o)||!u)return;if(e(t,n,r,i,a,o))return n}))}}function _x(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,u=t==null?o.fill:t,s=o.stroke&&n.isPointInStroke,l,f;if(s){l=o.strokeWidth;f=o.strokeCap;n.lineWidth=l!=null?l:1;n.lineCap=f!=null?f:"butt"}return e(n,r)?false:u&&n.isPointInPath(i,a)||s&&n.isPointInStroke(i,a)}}function wx(e){return xx(_x(e))}function Ax(e,t){return"translate("+e+","+t+")"}function Ox(e){return"rotate("+e+")"}function Ex(e,t){return"scale("+e+","+t+")"}function kx(e){return Ax(e.x||0,e.y||0)}function Dx(e){return Ax(e.x||0,e.y||0)+(e.angle?" "+Ox(e.angle):"")}function Cx(e){return Ax(e.x||0,e.y||0)+(e.angle?" "+Ox(e.angle):"")+(e.scaleX||e.scaleY?" "+Ex(e.scaleX||1,e.scaleY||1):"")}function Fx(e,t,n){function r(e,n){e("transform",Dx(n));e("d",t(null,n))}function i(e,n){t(Vb(e,n.angle),n);return Cb(e,n).translate(n.x||0,n.y||0)}function a(e,n){var r=n.x||0,i=n.y||0,a=n.angle||0;e.translate(r,i);if(a)e.rotate(a*=ly);e.beginPath();t(e,n);if(a)e.rotate(-a);e.translate(-r,-i)}return{type:e,tag:"path",nested:false,attr:r,bound:i,draw:mx(a),pick:wx(a),isect:n||ex(a)}}var Sx=Fx("arc",db);function jx(e,t){var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=+Infinity,o,u;while(--i>=0){if(e[i].defined===false)continue;u=Math.abs(e[i][r]-n);if(u<a){a=u;o=e[i]}}return o}function Mx(e,t){var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;while(--r>=0){if(e[r].defined===false)continue;i=e[r].x-t[0];a=e[r].y-t[1];o=i*i+a*a;if(o<n)return e[r]}return null}function Bx(e,t){var n=e.length,r,i,a;while(--n>=0){if(e[n].defined===false)continue;r=e[n].x-t[0];i=e[n].y-t[1];a=r*r+i*i;r=e[n].size||1;if(a<r*r)return e[n]}return null}function Nx(e,t,n){function r(e,n){var r=n.mark.items;if(r.length)e("d",t(null,r))}function i(e,n){var r=n.items;if(r.length===0){return e}else{t(Vb(e),r);return Cb(e,r[0])}}function a(e,n){e.beginPath();t(e,n)}var o=_x(a);function u(e,t,n,r,i,a){var u=t.items,s=t.bounds;if(!u||!u.length||s&&!s.contains(i,a)){return null}n*=e.pixelRatio;r*=e.pixelRatio;return o(e,u,n,r)?u[0]:null}return{type:e,tag:"path",nested:true,attr:r,bound:i,draw:yx(a),pick:u,isect:tx,tip:n}}var Tx=Nx("area",hb,jx);function zx(e,t){var n=t.clip;e.save();if(rn(n)){e.beginPath();n(e);e.clip()}else{Px(e,t.group)}}function Px(e,t){e.beginPath();cb(t)?vb(e,t,0,0):e.rect(0,0,t.width||0,t.height||0);e.clip()}function Rx(e){var t=ox(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Lx(e,t){e("transform",kx(t))}function Ix(e,t){var n=Rx(t);e("d",vb(null,t,n,n))}function Ux(e,t){e("class","background");e("aria-hidden",true);Ix(e,t)}function qx(e,t){e("class","foreground");e("aria-hidden",true);if(t.strokeForeground){Ix(e,t)}else{e("d","")}}function Wx(e,t,n){var r=t.clip?_b(n,t,t):null;e("clip-path",r)}function Hx(e,t){if(!t.clip&&t.items){var n=t.items,r=n.length;for(var i=0;i<r;++i){e.union(n[i].bounds)}}if((t.clip||t.width||t.height)&&!t.noBound){e.add(0,0).add(t.width||0,t.height||0)}Cb(e,t);return e.translate(t.x||0,t.y||0)}function Gx(e,t,n,r){var i=Rx(t);e.beginPath();vb(e,t,(n||0)+i,(r||0)+i)}var $x=_x(Gx);var Vx=_x(Gx,false);var Yx=_x(Gx,true);function Xx(e,t,n){var r=this;vx(t,(function(t){var i=t.x||0,a=t.y||0,o=t.strokeForeground,u=t.opacity==null?1:t.opacity;if((t.stroke||t.fill)&&u){Gx(e,t,i,a);ax(e,t);if(t.fill&&fx(e,t,u)){e.fill()}if(t.stroke&&!o&&dx(e,t,u)){e.stroke()}}e.save();e.translate(i,a);if(t.clip)Px(e,t);if(n)n.translate(-i,-a);vx(t,(function(t){r.draw(e,t,n)}));if(n)n.translate(i,a);e.restore();if(o&&t.stroke&&u){Gx(e,t,i,a);ax(e,t);if(dx(e,t,u)){e.stroke()}}}))}function Jx(e,t,n,r,i,a){var o=this;if(t.bounds&&!t.bounds.contains(i,a)||!t.items){return null}var u=n*e.pixelRatio,s=r*e.pixelRatio;return gx(t,(function(l){var f,c,d;var h=l.bounds;if(h&&!h.contains(i,a))return;c=l.x||0;d=l.y||0;var p=c+(l.width||0),v=d+(l.height||0),g=l.clip;if(g&&(i<c||i>p||a<d||a>v))return;e.save();e.translate(c,d);c=i-c;d=a-d;if(g&&cb(l)&&!Yx(e,l,u,s)){e.restore();return null}var m=l.strokeForeground,y=t.interactive!==false;if(y&&m&&l.stroke&&Vx(e,l,u,s)){e.restore();return l}f=gx(l,(function(e){return Qx(e,c,d)?o.pick(e,n,r,c,d):null}));if(!f&&y&&(l.fill||!m&&l.stroke)&&$x(e,l,u,s)){f=l}e.restore();return f||null}))}function Qx(e,t,n){return(e.interactive!==false||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Zx={type:"group",tag:"g",nested:false,attr:Lx,bound:Hx,draw:Xx,pick:Jx,isect:nx,content:Wx,background:Ux,foreground:qx};var Kx={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function e_(e,t){var n=e.image;if(!n||e.url&&e.url!==n.url){n={complete:false,width:0,height:0};t.loadImage(e.url).then((function(t){e.image=t;e.image.url=e.url}))}return n}function t_(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==false&&e.height?e.height*t.width/t.height:t.width}function n_(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==false&&e.width?e.width*t.height/t.width:t.height}function r_(e,t){return e==="center"?t/2:e==="right"?t:0}function i_(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function a_(e,t,n){var r=e_(t,n),i=t_(t,r),a=n_(t,r),o=(t.x||0)-r_(t.align,i),u=(t.y||0)-i_(t.baseline,a),s=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",s,Kx["xmlns:xlink"],"xlink:href");e("transform",Ax(o,u));e("width",i);e("height",a);e("preserveAspectRatio",t.aspect===false?"none":"xMidYMid")}function o_(e,t){var n=t.image,r=t_(t,n),i=n_(t,n),a=(t.x||0)-r_(t.align,r),o=(t.y||0)-i_(t.baseline,i);return e.set(a,o,a+r,o+i)}function u_(e,t,n){var r=this;vx(t,(function(t){if(n&&!n.intersects(t.bounds))return;var i=e_(t,r);var a=t_(t,i);var o=n_(t,i);if(a===0||o===0)return;var u=(t.x||0)-r_(t.align,a),s=(t.y||0)-i_(t.baseline,o),l,f,c,d;if(t.aspect!==false){f=i.width/i.height;c=t.width/t.height;if(f===f&&c===c&&f!==c){if(c<f){d=a/f;s+=(o-d)/2;o=d}else{d=o*f;u+=(a-d)/2;a=d}}}if(i.complete||i.toDataURL){ax(e,t);e.globalAlpha=(l=t.opacity)!=null?l:1;e.imageSmoothingEnabled=t.smooth!==false;e.drawImage(i,u,s,a,o)}}))}var s_={type:"image",tag:"image",nested:false,attr:a_,bound:o_,draw:u_,pick:xx(),isect:_t,get:e_,xOffset:r_,yOffset:i_};var l_=Nx("line",pb,Mx);function f_(e,t){var n=t.scaleX||1,r=t.scaleY||1;if(n!==1||r!==1){e("vector-effect","non-scaling-stroke")}e("transform",Cx(t));e("d",t.path)}function c_(e,t){var n=t.path;if(n==null)return true;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*ly,s=t.pathCache;if(!s||s.path!==n){(t.pathCache=s=uy(n)).path=n}if(u&&e.rotate&&e.translate){e.translate(r,i);e.rotate(u);_y(e,s,0,0,a,o);e.rotate(-u);e.translate(-r,-i)}else{_y(e,s,r,i,a,o)}}function d_(e,t){return c_(Vb(e,t.angle),t)?e.set(0,0,0,0):Cb(e,t,true)}var h_={type:"path",tag:"path",nested:false,attr:f_,bound:d_,draw:mx(c_),pick:wx(c_),isect:ex(c_)};function p_(e,t){e("d",vb(null,t))}function v_(e,t){var n,r;return Cb(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function g_(e,t){e.beginPath();vb(e,t)}var m_={type:"rect",tag:"path",nested:false,attr:p_,bound:v_,draw:mx(g_),pick:wx(g_),isect:nx};function y_(e,t){e("transform",kx(t));e("x2",t.x2!=null?t.x2-(t.x||0):0);e("y2",t.y2!=null?t.y2-(t.y||0):0)}function b_(e,t){var n,r;return Cb(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function x_(e,t,n){var r,i,a,o;if(t.stroke&&dx(e,t,n)){r=t.x||0;i=t.y||0;a=t.x2!=null?t.x2:r;o=t.y2!=null?t.y2:i;e.beginPath();e.moveTo(r,i);e.lineTo(a,o);return true}return false}function __(e,t,n){vx(t,(function(t){if(n&&!n.intersects(t.bounds))return;var r=t.opacity==null?1:t.opacity;if(r&&x_(e,t,r)){ax(e,t);e.stroke()}}))}function w_(e,t,n,r){if(!e.isPointInStroke)return false;return x_(e,t,1)&&e.isPointInStroke(n,r)}var A_={type:"rule",tag:"line",nested:false,attr:y_,bound:b_,draw:__,pick:xx(w_),isect:rx};var O_=Fx("shape",gb);var E_=Fx("symbol",mb,tx);var k_=Mn();var D_={height:B_,measureWidth:j_,estimateWidth:F_,width:F_,canvas:C_};C_(true);function C_(e){D_.width=e&&Zb?j_:F_}function F_(e,t){return S_(R_(e,t),B_(e))}function S_(e,t){return~~(.8*e.length*t)}function j_(e,t){return B_(e)<=0||!(t=R_(e,t))?0:M_(t,q_(e))}function M_(e,t){var n="(".concat(t,") ").concat(e);var r=k_.get(n);if(r===undefined){Zb.font=t;r=Zb.measureText(e).width;k_.set(n,r)}return r}function B_(e){return e.fontSize!=null?+e.fontSize||0:11}function N_(e){return e.lineHeight!=null?e.lineHeight:B_(e)+2}function T_(e){return St(e)?e.length>1?e:e[0]:e}function z_(e){return T_(e.lineBreak&&e.text&&!St(e.text)?e.text.split(e.lineBreak):e.text)}function P_(e){var t=z_(e);return(St(t)?t.length-1:0)*N_(e)}function R_(e,t){var n=t==null?"":(t+"").trim();return e.limit>0&&n.length?I_(e,n):n}function L_(e){if(D_.width===j_){var t=q_(e);return function(e){return M_(e,t)}}else{var n=B_(e);return function(e){return S_(e,n)}}}function I_(e,t){var n=+e.limit,r=L_(e);if(r(t)<n)return t;var i=e.ellipsis||"…",a=e.dir==="rtl",o=0,u=t.length,s;n-=r(i);if(a){while(o<u){s=o+u>>>1;if(r(t.slice(s))>n)o=s+1;else u=s}return i+t.slice(o)}else{while(o<u){s=1+(o+u>>>1);if(r(t.slice(0,s))<n)o=s;else u=s-1}return t.slice(0,o)+i}}function U_(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function q_(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+B_(e)+"px "+U_(e,t)}function W_(e){var t=e.baseline,n=B_(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*N_(e):t==="line-bottom"?.29*n-.5*N_(e):0)}var H_={left:"start",center:"middle",right:"end"};var G_=new wb;function $_(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;if(r){i=(e.theta||0)-cy;t+=r*Math.cos(i);n+=r*Math.sin(i)}G_.x1=t;G_.y1=n;return G_}function V_(e,t){var n=t.dx||0,r=(t.dy||0)+W_(t),i=$_(t),a=i.x1,o=i.y1,u=t.angle||0,s;e("text-anchor",H_[t.align]||"start");if(u){s=Ax(a,o)+" "+Ox(u);if(n||r)s+=" "+Ax(n,r)}else{s=Ax(a+n,o+r)}e("transform",s)}function Y_(e,t,n){var r=D_.height(t),i=t.align,a=$_(t),o=a.x1,u=a.y1,s=t.dx||0,l=(t.dy||0)+W_(t)-Math.round(.8*r),f=z_(t),c;if(St(f)){r+=N_(t)*(f.length-1);c=f.reduce((function(e,n){return Math.max(e,D_.width(t,n))}),0)}else{c=D_.width(t,f)}if(i==="center"){s-=c/2}else if(i==="right"){s-=c}else;e.set(s+=o,l+=u,s+c,l+r);if(t.angle&&!n){e.rotate(t.angle*ly,o,u)}else if(n===2){return e.rotatedPoints(t.angle*ly,o,u)}return e}function X_(e,t,n){vx(t,(function(t){var r=t.opacity==null?1:t.opacity,i,a,o,u,s,l,f;if(n&&!n.intersects(t.bounds)||r===0||t.fontSize<=0||t.text==null||t.text.length===0)return;e.font=q_(t);e.textAlign=t.align||"left";i=$_(t);a=i.x1,o=i.y1;if(t.angle){e.save();e.translate(a,o);e.rotate(t.angle*ly);a=o=0}a+=t.dx||0;o+=(t.dy||0)+W_(t);l=z_(t);ax(e,t);if(St(l)){s=N_(t);for(u=0;u<l.length;++u){f=R_(t,l[u]);if(t.fill&&fx(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&dx(e,t,r)){e.strokeText(f,a,o)}o+=s}}else{f=R_(t,l);if(t.fill&&fx(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&dx(e,t,r)){e.strokeText(f,a,o)}}if(t.angle)e.restore()}))}function J_(e,t,n,r,i,a){if(t.fontSize<=0)return false;if(!t.angle)return true;var o=$_(t),u=o.x1,s=o.y1,l=Y_(G_,t,1),f=-t.angle*ly,c=Math.cos(f),d=Math.sin(f),h=c*i-d*a+(u-c*u+d*s),p=d*i+c*a+(s-d*u-c*s);return l.contains(h,p)}function Q_(e,t){var n=Y_(G_,e,2);return ix(t,n[0],n[1],n[2],n[3])||ix(t,n[0],n[1],n[4],n[5])||ix(t,n[4],n[5],n[6],n[7])||ix(t,n[2],n[3],n[6],n[7])}var Z_={type:"text",tag:"text",nested:false,attr:V_,bound:Y_,draw:X_,pick:xx(J_),isect:Q_};var K_=Nx("trail",yb,Bx);var ew={arc:Sx,area:Tx,group:Zx,image:s_,line:l_,path:h_,rect:m_,rule:A_,shape:O_,symbol:E_,text:Z_,trail:K_};function tw(e,t,n){var r=ew[e.mark.marktype],i=t||r.bound;if(r.nested)e=e.mark;return i(e.bounds||(e.bounds=new wb),e,n)}var nw={mark:null};function rw(e,t,n){var r=ew[e.marktype],i=r.bound,a=e.items,o=a&&a.length,u,s,l,f;if(r.nested){if(o){l=a[0]}else{nw.mark=e;l=nw}f=tw(l,i,n);t=t&&t.union(f)||f;return t}t=t||e.bounds&&e.bounds.clear()||new wb;if(o){for(u=0,s=a.length;u<s;++u){t.union(tw(a[u],i,n))}}return e.bounds=t}var iw=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function aw(e,t){return JSON.stringify(e,iw,t)}function ow(e){var t=typeof e==="string"?JSON.parse(e):e;return uw(t)}function uw(e){var t=e.marktype,n=e.items,r,i,a;if(n){for(i=0,a=n.length;i<a;++i){r=t?"mark":"group";n[i][r]=e;if(n[i].zindex)n[i][r].zdirty=true;if("group"===(t||r))uw(n[i])}}if(t)rw(e);return e}function sw(e){if(arguments.length){this.root=ow(e)}else{this.root=lw({marktype:"group",name:"root",role:"frame"});this.root.items=[new Ob(this.root)]}}sw.prototype={toJSON:function(e){return aw(this.root,e||0)},mark:function(e,t,n){t=t||this.root.items[0];var r=lw(e,t);t.items[n]=r;if(r.zindex)r.group.zdirty=true;return r}};function lw(e,t){var n={bounds:new wb,clip:!!e.clip,group:t,interactive:e.interactive===false?false:true,items:[],marktype:e.marktype,name:e.name||undefined,role:e.role||undefined,zindex:e.zindex||0};if(e.aria!=null){n.aria=e.aria}if(e.description){n.description=e.description}return n}function fw(e,t,n){if(!e&&typeof document!=="undefined"&&document.createElement){e=document}return e?n?e.createElementNS(n,t):e.createElement(t):null}function cw(e,t){t=t.toLowerCase();var n=e.childNodes,r=0,i=n.length;for(;r<i;++r)if(n[r].tagName.toLowerCase()===t){return n[r]}}function dw(e,t,n,r){var i=e.childNodes[t],a;if(!i||i.tagName.toLowerCase()!==n.toLowerCase()){a=i||null;i=fw(e.ownerDocument,n,r);e.insertBefore(i,a)}return i}function hw(e,t){var n=e.childNodes,r=n.length;while(r>t)e.removeChild(n[--r]);return e}function pw(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function vw(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function gw(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=ew[i.marktype]).tip){o=vw(t,n);o[0]-=r[0];o[1]-=r[1];while(e=e.mark.group){o[0]-=e.x||0;o[1]-=e.y||0}e=a.tip(i.items,o)}return e}function mw(e,t){this._active=null;this._handlers={};this._loader=e||Hs();this._tooltip=t||yw}function yw(e,t,n,r){e.element().setAttribute("title",r||"")}mw.prototype={initialize:function(e,t,n){this._el=e;this._obj=n||null;return this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){if(arguments.length){this._origin=e||[0,0];return this}else{return this._origin.slice()}},scene:function(e){if(!arguments.length)return this._scene;this._scene=e;return this},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(var r=e?e.length:0;--r>=0;){if(e[r].type===t&&(!n||e[r].handler===n)){return r}}return-1},handlers:function(e){var t=this._handlers,n=[];if(e){n.push.apply(n,t[this.eventName(e)])}else{for(var r in t){n.push.apply(n,t[r])}}return n},eventName:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=fw(null,"a");for(var i in t)r.setAttribute(i,t[i]);r.dispatchEvent(n)})).catch((function(){}))},handleTooltip:function(e,t,n){if(t&&t.tooltip!=null){t=gw(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){var t=this.canvas();if(!t)return;var n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.width(),o=i.height();var u=i.x1+r[0]+n.left,s=i.y1+r[1]+n.top;while(e.mark&&(e=e.mark.group)){u+=e.x||0;s+=e.y||0}return{x:u,y:s,width:a,height:o,left:u,top:s,right:u+a,bottom:s+o}}};function bw(e){this._el=null;this._bgcolor=null;this._loader=new Eb(e)}bw.prototype={initialize:function(e,t,n,r,i){this._el=e;return this.resize(t,n,r,i)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){if(arguments.length===0)return this._bgcolor;this._bgcolor=e;return this},resize:function(e,t,n,r){this._width=e;this._height=t;this._origin=n||[0,0];this._scale=r||1;return this},dirty:function(){},render:function(e){var t=this;t._call=function(){t._render(e)};t._call();t._call=null;return t},_render:function(){},renderAsync:function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(e){if(e)i();n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};var xw="keydown";var _w="keypress";var ww="keyup";var Aw="dragenter";var Ow="dragleave";var Ew="dragover";var kw="mousedown";var Dw="mouseup";var Cw="mousemove";var Fw="mouseout";var Sw="mouseover";var jw="click";var Mw="dblclick";var Bw="wheel";var Nw="mousewheel";var Tw="touchstart";var zw="touchmove";var Pw="touchend";var Rw=[xw,_w,ww,Aw,Ow,Ew,kw,Dw,Cw,Fw,Sw,jw,Mw,Bw,Nw,Tw,zw,Pw];var Lw=Cw;var Iw=Fw;var Uw=jw;function qw(e,t){mw.call(this,e,t);this._down=null;this._touch=null;this._first=true;this._events={}}var Ww=function(e){return e===Tw||e===zw||e===Pw?[Tw,zw,Pw]:[e]};function Hw(e,t){Ww(t).forEach((function(t){return Gw(e,t)}))}function Gw(e,t){var n=e.canvas();if(n&&!e._events[t]){e._events[t]=1;n.addEventListener(t,e[t]?function(n){return e[t](n)}:function(n){return e.fire(t,n)})}}function $w(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);if(a===i){this.fire(e,r)}else{if(!i||!i.exit){this.fire(n,r)}this._active=a;this.fire(t,r);this.fire(e,r)}}}function Vw(e){return function(t){this.fire(e,t);this._active=null}}_n(qw,mw,{initialize:function(e,t,n){var r=this;this._canvas=e&&cw(e,"canvas");[jw,kw,Cw,Fw,Ow].forEach((function(e){return Hw(r,e)}));return mw.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:Rw,DOMMouseScroll:function(e){this.fire(Nw,e)},mousemove:$w(Cw,Sw,Fw),dragover:$w(Ew,Aw,Ow),mouseout:Vw(Fw),dragleave:Vw(Ow),mousedown:function(e){this._down=this._active;this.fire(kw,e)},click:function(e){if(this._down===this._active){this.fire(jw,e);this._down=null}},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire(Tw,e,true)},touchmove:function(e){this.fire(zw,e,true)},touchend:function(e){this.fire(Pw,e,true);this._touch=null},fire:function(e,t,n){var r=n?this._touch:this._active,i=this._handlers[e];t.vegaType=e;if(e===Uw&&r&&r.href){this.handleHref(t,r,r.href)}else if(e===Lw||e===Iw){this.handleTooltip(t,r,e!==Iw)}if(i){for(var a=0,o=i.length;a<o;++a){i[a].handler.call(this._obj,t,r)}}},on:function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){Hw(this,e);(r[n]||(r[n]=[])).push({type:e,handler:t})}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){r.splice(i,1)}return this},pickEvent:function(e){var t=vw(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,i){var a=this.context(),o=ew[e.marktype];return o.pick.call(this,a,e,t,n,r,i)}});function Yw(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var Xw=Yw();function Jw(e,t,n,r,i,a){var o=typeof HTMLElement!=="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,u=e.getContext("2d"),s=o?Xw:i;e.width=t*s;e.height=n*s;for(var l in a){u[l]=a[l]}if(o&&s!==1){e.style.width=t+"px";e.style.height=n+"px"}u.pixelRatio=s;u.setTransform(s,0,0,s,s*r[0],s*r[1]);return e}function Qw(e){bw.call(this,e);this._options={};this._redraw=false;this._dirty=new wb;this._tempb=new wb}var Zw=bw.prototype;var Kw=function(e,t,n){return(new wb).set(0,0,t,n).translate(-e[0],-e[1])};function eA(e,t,n){t.expand(1).round();if(e.pixelRatio%1){t.scale(e.pixelRatio).round().scale(1/e.pixelRatio)}t.translate(-(n[0]%1),-(n[1]%1));e.beginPath();e.rect(t.x1,t.y1,t.width(),t.height());e.clip();return t}_n(Qw,bw,{initialize:function(e,t,n,r,i,a){this._options=a||{};this._canvas=this._options.externalContext?null:ip(1,1);if(e&&this._canvas){hw(e,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return Zw.initialize.call(this,e,t,n,r,i)},resize:function(e,t,n,r){Zw.resize.call(this,e,t,n,r);if(this._canvas){Jw(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context)}else{var i=this._options.externalContext;if(!i)pt("CanvasRenderer is missing a valid canvas or context");i.scale(this._scale,this._scale);i.translate(this._origin[0],this._origin[1])}this._redraw=true;return this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){var t=this._tempb.clear().union(e.bounds);var n=e.mark.group;while(n){t.translate(n.x||0,n.y||0);n=n.mark.group}this._dirty.union(t)},_render:function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=Kw(n,r,i);t.save();var u=this._redraw||a.empty()?(this._redraw=false,o.expand(1)):eA(t,o.intersect(a),n);this.clear(-n[0],-n[1],r,i);this.draw(t,e,u);t.restore();a.clear();return this},draw:function(e,t,n){var r=ew[t.marktype];if(t.clip)zx(e,t);r.draw.call(this,e,t,n);if(t.clip)e.restore()},clear:function(e,t,n,r){var i=this._options,a=this.context();if(i.type!=="pdf"&&!i.externalContext){a.clearRect(e,t,n,r)}if(this._bgcolor!=null){a.fillStyle=this._bgcolor;a.fillRect(e,t,n,r)}}});function tA(e,t){mw.call(this,e,t);var n=this;n._hrefHandler=nA(n,(function(e,t){if(t&&t.href)n.handleHref(e,t,t.href)}));n._tooltipHandler=nA(n,(function(e,t){n.handleTooltip(e,t,e.type!==Iw)}))}var nA=function(e,t){return function(n){var r=n.target.__data__;r=Array.isArray(r)?r[0]:r;n.vegaType=n.type;t.call(e._obj,n,r)}};_n(tA,mw,{initialize:function(e,t,n){var r=this._svg;if(r){r.removeEventListener(Uw,this._hrefHandler);r.removeEventListener(Lw,this._tooltipHandler);r.removeEventListener(Iw,this._tooltipHandler)}this._svg=r=e&&cw(e,"svg");if(r){r.addEventListener(Uw,this._hrefHandler);r.addEventListener(Lw,this._tooltipHandler);r.addEventListener(Iw,this._tooltipHandler)}return mw.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){var a={type:e,handler:t,listener:nA(this,t)};(r[n]||(r[n]=[])).push(a);if(this._svg){this._svg.addEventListener(n,a.listener)}}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){if(this._svg){this._svg.removeEventListener(n,r[i].listener)}r.splice(i,1)}return this}});var rA="aria-hidden";var iA="aria-label";var aA="role";var oA="aria-roledescription";var uA="graphics-object";var sA="graphics-symbol";var lA=function(e,t,n){var r;return r={},r[aA]=e,r[oA]=t,r[iA]=n||undefined,r};var fA=qn(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]);var cA={axis:{desc:"axis",caption:yA},legend:{desc:"legend",caption:bA},"title-text":{desc:"title",caption:function(e){return"Title text '".concat(mA(e),"'")}},"title-subtitle":{desc:"subtitle",caption:function(e){return"Subtitle text '".concat(mA(e),"'")}}};var dA={ariaRole:aA,ariaRoleDescription:oA,description:iA};function hA(e,t){var n=t.aria===false;e(rA,n||undefined);if(n||t.description==null){for(var r in dA){e(dA[r],undefined)}}else{var i=t.mark.marktype;e(iA,t.description);e(aA,t.ariaRole||(i==="group"?uA:sA));e(oA,t.ariaRoleDescription||"".concat(i," mark"))}}function pA(e){var t;return e.aria===false?(t={},t[rA]=true,t):fA[e.role]?null:cA[e.role]?gA(e,cA[e.role]):vA(e)}function vA(e){var t=e.marktype;var n=t==="group"||t==="text"||e.items.some((function(e){return e.description!=null&&e.aria!==false}));return lA(n?uA:sA,"".concat(t," mark container"),e.description)}function gA(e,t){try{var n=e.items[0],r=t.caption||function(){return""};return lA(t.role||sA,t.desc,n.description||r(n))}catch(i){return null}}function mA(e){return tn(e.text).join(" ")}function yA(e){var t=e.datum,n=e.orient,r=t.title?xA(e):null,i=e.context,a=i.scales[t.scale].value,o=i.dataflow.locale(),u=a.type,s=n==="left"||n==="right"?"Y":"X";return"".concat(s,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(tm(u)?"discrete":u," scale")+" with ".concat($m(o,a,e))}function bA(e){var t=e.datum,n=t.title?xA(e):null,r="".concat(t.type||""," legend").trim(),i=t.scales,a=Object.keys(i),o=e.context,u=o.scales[i[a[0]]].value,s=o.dataflow.locale();return wA(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(_A(a))+" with ".concat($m(s,u,e))}function xA(e){try{return tn(zt(e.items).items[0].text).join(" ")}catch(t){return null}}function _A(e){e=e.map((function(e){return e+(e==="fill"||e==="stroke"?" color":"")}));return e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+zt(e)}function wA(e){return e.length?e[0].toUpperCase()+e.slice(1):e}var AA=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};var OA=function(e){return AA(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")};function EA(){var e="",t="",n="";var r=[],i=function(){return t=n=""},a=function(a){if(t){e+="".concat(t,">").concat(n);i()}r.push(a)},o=function(e,n){if(n!=null)t+=" ".concat(e,'="').concat(OA(n),'"');return u},u={open:function(e){a(e);t="<"+e;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}for(var s=0,l=r;s<l.length;s++){var f=l[s];for(var c in f)o(c,f[c])}return u},close:function(){var a=r.pop();if(t){e+=t+(n?">".concat(n,"</").concat(a,">"):"/>")}else{e+="</".concat(a,">")}i();return u},attr:o,text:function(e){return n+=AA(e),u},toString:function(){return e}};return u}var kA=function(e){return DA(EA(),e)+""};function DA(e,t){e.open(t.tagName);if(t.hasAttributes()){var n=t.attributes,r=n.length;for(var i=0;i<r;++i){e.attr(n[i].name,n[i].value)}}if(t.hasChildNodes()){var a=t.childNodes;for(var o=0,u=a;o<u.length;o++){var s=u[o];s.nodeType===3?e.text(s.nodeValue):DA(e,s)}}return e.close()}var CA={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"};var FA={blend:"mix-blend-mode"};var SA={fill:"none","stroke-miterlimit":10};var jA=0,MA="http://www.w3.org/2000/xmlns/",BA=Kx.xmlns;function NA(e){bw.call(this,e);this._dirtyID=0;this._dirty=[];this._svg=null;this._root=null;this._defs=null}var TA=bw.prototype;_n(NA,bw,{initialize:function(e,t,n,r,i){this._defs={};this._clearDefs();if(e){this._svg=dw(e,0,"svg",BA);this._svg.setAttributeNS(MA,"xmlns",BA);this._svg.setAttributeNS(MA,"xmlns:xlink",Kx["xmlns:xlink"]);this._svg.setAttribute("version",Kx["version"]);this._svg.setAttribute("class","marks");hw(e,1);this._root=dw(this._svg,jA,"g",BA);VA(this._root,SA);hw(this._svg,jA+1)}this.background(this._bgcolor);return TA.initialize.call(this,e,t,n,r,i)},background:function(e){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",e)}return TA.background.apply(this,arguments)},resize:function(e,t,n,r){TA.resize.call(this,e,t,n,r);if(this._svg){VA(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)});this._root.setAttribute("transform","translate(".concat(this._origin,")"))}this._dirty=[];return this},canvas:function(){return this._svg},svg:function(){var e=this._svg,t=this._bgcolor;if(!e)return null;var n;if(t){e.removeAttribute("style");n=dw(e,jA,"rect",BA);VA(n,{width:this._width,height:this._height,fill:t})}var r=kA(e);if(t){e.removeChild(n);this._svg.style.setProperty("background-color",t)}return r},_render:function(e){if(this._dirtyCheck()){if(this._dirtyAll)this._clearDefs();this.mark(this._root,e);hw(this._root,1)}this.defs();this._dirty=[];++this._dirtyID;return this},dirty:function(e){if(e.dirty!==this._dirtyID){e.dirty=this._dirtyID;this._dirty.push(e)}},isDirty:function(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=true;var e=this._dirty;if(!e.length||!this._dirtyID)return true;var t=++this._dirtyID;var n,r,i,a,o,u,s;for(o=0,u=e.length;o<u;++o){n=e[o];r=n.mark;if(r.marktype!==i){i=r.marktype;a=ew[i]}if(r.zdirty&&r.dirty!==t){this._dirtyAll=false;zA(n,t);r.items.forEach((function(e){e.dirty=t}))}if(r.zdirty)continue;if(n.exit){if(a.nested&&r.items.length){s=r.items[0];if(s._svg)this._update(a,s._svg,s)}else if(n._svg){s=n._svg.parentNode;if(s)s.removeChild(n._svg)}n._svg=null;continue}n=a.nested?r.items[0]:n;if(n._update===t)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;zA(n,t)}else{this._update(a,n._svg,n)}n._update=t}return!this._dirtyAll},mark:function(e,t,n){var r=this;if(!this.isDirty(t)){return t._svg}var i=this._svg,a=ew[t.marktype],o=t.interactive===false?"none":null,u=a.tag==="g";var s=IA(t,e,n,"g",i);s.setAttribute("class",pw(t));var l=pA(t);for(var f in l)YA(s,f,l[f]);if(!u){YA(s,"pointer-events",o)}YA(s,"clip-path",t.clip?_b(this,t,t.group):null);var c=null,d=0;var h=function(e){var t=r.isDirty(e),n=IA(e,s,c,a.tag,i);if(t){r._update(a,n,e);if(u)LA(r,n,e)}c=n;++d};if(a.nested){if(t.items.length)h(t.items[0])}else{vx(t,h)}hw(s,d);return s},_update:function(e,t,n){qA=t;WA=t.__values__;hA(GA,n);e.attr(GA,n,this);var r=HA[e.type];if(r)r.call(this,e,t,n);if(qA)this.style(qA,n)},style:function(e,t){if(t==null)return;for(var n in CA){var r=n==="font"?U_(t):t[n];if(r===WA[n])continue;var i=CA[n];if(r==null){e.removeAttribute(i)}else{if(Jm(r)){r=Qm(r,this._defs.gradient,JA())}e.setAttribute(i,r+"")}WA[n]=r}for(var n in FA){$A(e,FA[n],t[n])}},defs:function(){var e=this._svg,t=this._defs;var n=t.el,r=0;for(var i in t.gradient){if(!n)t.el=n=dw(e,jA+1,"defs",BA);r=PA(n,t.gradient[i],r)}for(var a in t.clipping){if(!n)t.el=n=dw(e,jA+1,"defs",BA);r=RA(n,t.clipping[a],r)}if(n){r===0?(e.removeChild(n),t.el=null):hw(n,r)}},_clearDefs:function(){var e=this._defs;e.gradient={};e.clipping={}}});function zA(e,t){for(;e&&e.dirty!==t;e=e.mark.group){e.dirty=t;if(e.mark&&e.mark.dirty!==t){e.mark.dirty=t}else return}}function PA(e,t,n){var r,i,a;if(t.gradient==="radial"){var o=dw(e,n++,"pattern",BA);VA(o,{id:Xm+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});o=dw(o,0,"rect",BA);VA(o,{width:1,height:1,fill:"url(".concat(JA(),"#").concat(t.id,")")});e=dw(e,n++,"radialGradient",BA);VA(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else{e=dw(e,n++,"linearGradient",BA);VA(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2})}for(r=0,i=t.stops.length;r<i;++r){a=dw(e,r,"stop",BA);a.setAttribute("offset",t.stops[r].offset);a.setAttribute("stop-color",t.stops[r].color)}hw(e,r);return n}function RA(e,t,n){var r;e=dw(e,n,"clipPath",BA);e.setAttribute("id",t.id);if(t.path){r=dw(e,0,"path",BA);r.setAttribute("d",t.path)}else{r=dw(e,0,"rect",BA);VA(r,{x:0,y:0,width:t.width,height:t.height})}hw(e,1);return n+1}function LA(e,t,n){t=t.lastChild.previousSibling;var r,i=0;vx(n,(function(n){r=e.mark(t,n,r);++i}));hw(t,1+i)}function IA(e,t,n,r,i){var a=e._svg,o;if(!a){o=t.ownerDocument;a=fw(o,r,BA);e._svg=a;if(e.mark){a.__data__=e;a.__values__={fill:"default"};if(r==="g"){var u=fw(o,"path",BA);a.appendChild(u);u.__data__=e;var s=fw(o,"g",BA);a.appendChild(s);s.__data__=e;var l=fw(o,"path",BA);a.appendChild(l);l.__data__=e;l.__values__={fill:"default"}}}}if(a.ownerSVGElement!==i||UA(a,n)){t.insertBefore(a,n?n.nextSibling:t.firstChild)}return a}function UA(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}var qA=null,WA=null;var HA={group:function(e,t,n){var r=qA=t.childNodes[2];WA=r.__values__;e.foreground(GA,n,this);WA=t.__values__;qA=t.childNodes[1];e.content(GA,n,this);var i=qA=t.childNodes[0];e.background(GA,n,this);var a=n.mark.interactive===false?"none":null;if(a!==WA.events){YA(r,"pointer-events",a);YA(i,"pointer-events",a);WA.events=a}if(n.strokeForeground&&n.stroke){var o=n.fill;YA(r,"display",null);this.style(i,n);YA(i,"stroke",null);if(o)n.fill=null;WA=r.__values__;this.style(r,n);if(o)n.fill=o;qA=null}else{YA(r,"display","none")}},image:function(e,t,n){if(n.smooth===false){$A(t,"image-rendering","optimizeSpeed");$A(t,"image-rendering","pixelated")}else{$A(t,"image-rendering",null)}},text:function(e,t,n){var r=z_(n);var i,a,o,u;if(St(r)){a=r.map((function(e){return R_(n,e)}));i=a.join("\n");if(i!==WA.text){hw(t,0);o=t.ownerDocument;u=N_(n);a.forEach((function(e,r){var i=fw(o,"tspan",BA);i.__data__=n;i.textContent=e;if(r){i.setAttribute("x",0);i.setAttribute("dy",u)}t.appendChild(i)}));WA.text=i}}else{a=R_(n,r);if(a!==WA.text){t.textContent=a;WA.text=a}}YA(t,"font-family",U_(n));YA(t,"font-size",B_(n)+"px");YA(t,"font-style",n.fontStyle);YA(t,"font-variant",n.fontVariant);YA(t,"font-weight",n.fontWeight)}};function GA(e,t,n){if(t===WA[e])return;if(n){XA(qA,e,t,n)}else{YA(qA,e,t)}WA[e]=t}function $A(e,t,n){if(n!==WA[t]){if(n==null){e.style.removeProperty(t)}else{e.style.setProperty(t,n+"")}WA[t]=n}}function VA(e,t){for(var n in t){YA(e,n,t[n])}}function YA(e,t,n){if(n!=null){e.setAttribute(t,n)}else{e.removeAttribute(t)}}function XA(e,t,n,r){if(n!=null){e.setAttributeNS(r,t,n)}else{e.removeAttributeNS(r,t)}}function JA(){var e;return typeof window==="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function QA(e){bw.call(this,e);this._text=null;this._defs={gradient:{},clipping:{}}}_n(QA,bw,{svg:function(){return this._text},_render:function(e){var t=EA();t.open("svg",hn({},Kx,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));var n=this._bgcolor;if(n&&n!=="transparent"&&n!=="none"){t.open("rect",{width:this._width,height:this._height,fill:n}).close()}t.open("g",SA,{transform:"translate("+this._origin+")"});this.mark(t,e);t.close();this.defs(t);this._text=t.close()+"";return this},mark:function(e,t){var n=this;var r=ew[t.marktype],i=r.tag,a=[hA,r.attr];e.open("g",{class:pw(t),"clip-path":t.clip?_b(this,t,t.group):null},pA(t),{"pointer-events":i!=="g"&&t.interactive===false?"none":null});var o=function(o){var u=n.href(o);if(u)e.open("a",u);e.open(i,n.attr(t,o,a,i!=="g"?i:null));if(i==="text"){var s=z_(o);if(St(s)){var l={x:0,dy:N_(o)};for(var f=0;f<s.length;++f){e.open("tspan",f?l:null).text(R_(o,s[f])).close()}}else{e.text(R_(o,s))}}else if(i==="g"){var c=o.strokeForeground,d=o.fill,h=o.stroke;if(c&&h){o.stroke=null}e.open("path",n.attr(t,o,r.background,"bgrect")).close();e.open("g",n.attr(t,o,r.content));vx(o,(function(t){return n.mark(e,t)}));e.close();if(c&&h){if(d)o.fill=null;o.stroke=h;e.open("path",n.attr(t,o,r.foreground,"bgrect")).close();if(d)o.fill=d}else{e.open("path",n.attr(t,o,r.foreground,"bgfore")).close()}}e.close();if(u)e.close()};if(r.nested){if(t.items&&t.items.length)o(t.items[0])}else{vx(t,o)}return e.close()},href:function(e){var t=this;var n=e.href;var r;if(n){if(r=this._hrefs&&this._hrefs[n]){return r}else{this.sanitizeURL(n).then((function(e){e["xlink:href"]=e.href;e.href=null;(t._hrefs||(t._hrefs={}))[n]=e}))}}return null},attr:function(e,t,n,r){var i=this;var a={},o=function(e,t,n,r){a[r||e]=t};if(Array.isArray(n)){n.forEach((function(e){return e(o,t,i)}))}else{n(o,t,this)}if(r){ZA(a,t,e,r,this._defs)}return a},defs:function(e){var t=this._defs.gradient,n=this._defs.clipping,r=Object.keys(t).length+Object.keys(n).length;if(r===0)return;e.open("defs");for(var i in t){var a=t[i],o=a.stops;if(a.gradient==="radial"){e.open("pattern",{id:Xm+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close();e.close();e.open("radialGradient",{id:i,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})}else{e.open("linearGradient",{id:i,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2})}for(var u=0;u<o.length;++u){e.open("stop",{offset:o[u].offset,"stop-color":o[u].color}).close()}e.close()}for(var s in n){var l=n[s];e.open("clipPath",{id:s});if(l.path){e.open("path",{d:l.path}).close()}else{e.open("rect",{x:0,y:0,width:l.width,height:l.height}).close()}e.close()}e.close()}});function ZA(e,t,n,r,i){var a;if(t==null)return e;if(r==="bgrect"&&n.interactive===false){e["pointer-events"]="none"}if(r==="bgfore"){if(n.interactive===false){e["pointer-events"]="none"}e.display="none";if(t.fill!==null)return e}if(r==="image"&&t.smooth===false){a=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]}if(r==="text"){e["font-family"]=U_(t);e["font-size"]=B_(t)+"px";e["font-style"]=t.fontStyle;e["font-variant"]=t.fontVariant;e["font-weight"]=t.fontWeight}for(var o in CA){var u=t[o];var s=CA[o];if(u==="transparent"&&(s==="fill"||s==="stroke"));else if(u!=null){if(Jm(u)){u=Qm(u,i.gradient,"")}e[s]=u}}for(var o in FA){var l=t[o];if(l!=null){a=a||[];a.push("".concat(FA[o],": ").concat(l,";"))}}if(a){e.style=a.join(" ")}return e}var KA="canvas";var eO="png";var tO="svg";var nO="none";var rO={Canvas:KA,PNG:eO,SVG:tO,None:nO};var iO={};iO[KA]=iO[eO]={renderer:Qw,headless:Qw,handler:qw};iO[tO]={renderer:NA,headless:QA,handler:tA};iO[nO]={};function aO(e,t){e=String(e||"").toLowerCase();if(arguments.length>1){iO[e]=t;return this}else{return iO[e]}}function oO(e,t,n){var r=[],i=(new wb).union(t),a=e.marktype;return a?uO(e,i,n,r):a==="group"?lO(e,i,n,r):pt("Intersect scene must be mark node or group item.")}function uO(e,t,n,r){if(sO(e,t,n)){var i=e.items,a=e.marktype,o=i.length;var u=0;if(a==="group"){for(;u<o;++u){lO(i[u],t,n,r)}}else{for(var s=ew[a].isect;u<o;++u){var l=i[u];if(fO(l,t,s))r.push(l)}}}return r}function sO(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==false&&(!n||n(e)))}function lO(e,t,n,r){if(n&&n(e.mark)&&fO(e,t,ew.group.isect)){r.push(e)}var i=e.items,a=i&&i.length;if(a){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<a;++s){uO(i[s],t,n,r)}t.translate(o,u)}return r}function fO(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}var cO=new wb;function dO(e){var t=e.clip;if(rn(t)){t(Vb(cO.clear()))}else if(t){cO.set(0,0,e.group.width,e.group.height)}else return;e.bounds.intersect(cO)}var hO=1e-9;function pO(e,t,n){return e===t?true:n==="path"?vO(e,t):e instanceof Date&&t instanceof Date?+e===+t:kn(e)&&kn(t)?Math.abs(e-t)<=hO:!e||!t||!jt(e)&&!jt(t)?e==t:gO(e,t)}function vO(e,t){return pO(uy(e),uy(t))}function gO(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return false;n.sort();r.sort();for(a=n.length-1;a>=0;a--){if(n[a]!=r[a])return false}for(a=n.length-1;a>=0;a--){i=n[a];if(!pO(e[i],t[i],i))return false}return typeof e===typeof t}function mO(){xb();Ym()}var yO="top";var bO="left";var xO="right";var _O="bottom";var wO="top-left";var AO="top-right";var OO="bottom-left";var EO="bottom-right";var kO="start";var DO="middle";var CO="end";var FO="x";var SO="y";var jO="group";var MO="axis";var BO="title";var NO="frame";var TO="scope";var zO="legend";var PO="row-header";var RO="row-footer";var LO="row-title";var IO="column-header";var UO="column-footer";var qO="column-title";var WO="padding";var HO="symbol";var GO="fit";var $O="fit-x";var VO="fit-y";var YO="pad";var XO="none";var JO="all";var QO="each";var ZO="flush";var KO="column";var eE="row";function tE(e){df.call(this,null,e)}_n(tE,df,{transform:function(e,t){var n=t.dataflow,r=e.mark,i=r.marktype,a=ew[i],o=a.bound;var u=r.bounds,s;if(a.nested){if(r.items.length)n.dirty(r.items[0]);u=nE(r,o);r.items.forEach((function(e){e.bounds.clear().union(u)}))}else if(i===jO||e.modified()){t.visit(t.MOD,(function(e){return n.dirty(e)}));u.clear();r.items.forEach((function(e){return u.union(nE(e,o))}));switch(r.role){case MO:case zO:case BO:t.reflow()}}else{s=t.changed(t.REM);t.visit(t.ADD,(function(e){u.union(nE(e,o))}));t.visit(t.MOD,(function(e){s=s||u.alignsWith(e.bounds);n.dirty(e);u.union(nE(e,o))}));if(s){u.clear();r.items.forEach((function(e){return u.union(e.bounds)}))}}dO(r);return t.modifies("bounds")}});function nE(e,t,n){return t(e.bounds.clear(),e,n)}var rE=":vega_identifier:";function iE(e){df.call(this,0,e)}iE.Definition={type:"Identifier",metadata:{modifies:true},params:[{name:"as",type:"string",required:true}]};_n(iE,df,{transform:function(e,t){var n=aE(t.dataflow),r=e.as;var i=n.value;t.visit(t.ADD,(function(e){return e[r]=e[r]||++i}));n.set(this.value=i);return t}});function aE(e){return e._signals[rE]||(e._signals[rE]=e.add(0))}function oE(e){df.call(this,null,e)}_n(oE,df,{transform:function(e,t){var n=this.value;if(!n){n=t.dataflow.scenegraph().mark(e.markdef,uE(e),e.index);n.group.context=e.context;if(!e.context.group)e.context.group=n.group;n.source=this.source;n.clip=e.clip;n.interactive=e.interactive;this.value=n}var r=n.marktype===jO?Ob:Ab;t.visit(t.ADD,(function(e){return r.call(e,n)}));if(e.modified("clip")||e.modified("interactive")){n.clip=e.clip;n.interactive=!!e.interactive;n.zdirty=true;t.reflow()}n.items=t.source;return t}});function uE(e){var t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function sE(e){df.call(this,null,e)}var lE={parity:function(e){return e.filter((function(e,t){return t%2?e.opacity=0:1}))},greedy:function(e,t){var n;return e.filter((function(e,r){return!r||!fE(n.bounds,e.bounds,t)?(n=e,1):e.opacity=0}))}};var fE=function(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)};var cE=function(e,t){for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n){if(fE(i,a=e[n].bounds,t))return true}};var dE=function(e){var t=e.bounds;return t.width()>1&&t.height()>1};var hE=function(e,t,n){var r=e.range(),i=new wb;if(t===yO||t===_O){i.set(r[0],-Infinity,r[1],+Infinity)}else{i.set(-Infinity,r[0],+Infinity,r[1])}i.expand(n||1);return function(e){return i.encloses(e.bounds)}};var pE=function(e){e.forEach((function(e){return e.opacity=1}));return e};var vE=function(e,t){return e.reflow(t.modified()).modifies("opacity")};_n(sE,df,{transform:function(e,t){var n=lE[e.method]||lE.parity,r=e.separation||0;var i=t.materialize(t.SOURCE).source,a,o;if(!i||!i.length)return;if(!e.method){if(e.modified("method")){pE(i);t=vE(t,e)}return t}i=i.filter(dE);if(!i.length)return;if(e.sort){i=i.slice().sort(e.sort)}a=pE(i);t=vE(t,e);if(a.length>=3&&cE(a,r)){do{a=n(a,r)}while(a.length>=3&&cE(a,r));if(a.length<3&&!zt(i).opacity){if(a.length>1)zt(a).opacity=0;zt(i).opacity=1}}if(e.boundScale&&e.boundTolerance>=0){o=hE(e.boundScale,e.boundOrient,+e.boundTolerance);i.forEach((function(e){if(!o(e))e.opacity=0}))}var u=a[0].mark.bounds.clear();i.forEach((function(e){if(e.opacity)u.union(e.bounds)}));return t}});function gE(e){df.call(this,null,e)}_n(gE,df,{transform:function(e,t){var n=t.dataflow;t.visit(t.ALL,(function(e){return n.dirty(e)}));if(t.fields&&t.fields["zindex"]){var r=t.source&&t.source[0];if(r)r.mark.zdirty=true}}});var mE=new wb;function yE(e,t,n){return e[t]===n?0:(e[t]=n,1)}function bE(e){var t=e.items[0].orient;return t===bO||t===xO}function xE(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function _E(e,t,n,r){var i=t.items[0],a=i.datum,o=i.translate!=null?i.translate:.5,u=i.orient,s=xE(a),l=i.range,f=i.offset,c=i.position,d=i.minExtent,h=i.maxExtent,p=a.title&&i.items[s[2]].items[0],v=i.titlePadding,g=i.bounds,m=p&&P_(p),y=0,b=0,x,_;mE.clear().union(g);g.clear();if((x=s[0])>-1)g.union(i.items[x].bounds);if((x=s[1])>-1)g.union(i.items[x].bounds);switch(u){case yO:y=c||0;b=-f;_=Math.max(d,Math.min(h,-g.y1));g.add(0,-_).add(l,0);if(p)wE(e,p,_,v,m,0,-1,g);break;case bO:y=-f;b=c||0;_=Math.max(d,Math.min(h,-g.x1));g.add(-_,0).add(0,l);if(p)wE(e,p,_,v,m,1,-1,g);break;case xO:y=n+f;b=c||0;_=Math.max(d,Math.min(h,g.x2));g.add(0,0).add(_,l);if(p)wE(e,p,_,v,m,1,1,g);break;case _O:y=c||0;b=r+f;_=Math.max(d,Math.min(h,g.y2));g.add(0,0).add(l,_);if(p)wE(e,p,_,v,0,0,1,g);break;default:y=i.x;b=i.y}Cb(g.translate(y,b),i);if(yE(i,"x",y+o)|yE(i,"y",b+o)){i.bounds=mE;e.dirty(i);i.bounds=g;e.dirty(i)}return i.mark.bounds.clear().union(g)}function wE(e,t,n,r,i,a,o,u){var s=t.bounds;if(t.auto){var l=o*(n+i+r);var f=0,c=0;e.dirty(t);a?f=(t.x||0)-(t.x=l):c=(t.y||0)-(t.y=l);t.mark.bounds.clear().union(s.translate(-f,-c));e.dirty(t)}u.union(s)}var AE=function(e,t){return Math.floor(Math.min(e,t))};var OE=function(e,t){return Math.ceil(Math.max(e,t))};function EE(e){var t,n,r,i,a;var o=e.items,u=o.length,s=0,l,f;var c={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;s<u;++s){l=o[s];f=l.items;if(l.marktype===jO){switch(l.role){case MO:case zO:case BO:break;case PO:(t=c.rowheaders).push.apply(t,f);break;case RO:(n=c.rowfooters).push.apply(n,f);break;case IO:(r=c.colheaders).push.apply(r,f);break;case UO:(i=c.colfooters).push.apply(i,f);break;case LO:c.rowtitle=f[0];break;case qO:c.coltitle=f[0];break;default:(a=c.marks).push.apply(a,f)}}}return c}function kE(e){return(new wb).set(0,0,e.width||0,e.height||0)}function DE(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function CE(e,t,n){var r=jt(e)?e[t]:e;return r!=null?r:n!==undefined?n:0}function FE(e){return e<0?Math.ceil(-e):0}function SE(e,t,n){var r=!n.nodirty,i=n.bounds===ZO?kE:DE,a=mE.set(0,0,0,0),o=CE(n.align,KO),u=CE(n.align,eE),s=CE(n.padding,KO),l=CE(n.padding,eE),f=n.columns||t.length,c=f<=0?1:Math.ceil(t.length/f),d=t.length,h=Array(d),p=Array(f),v=0,g=Array(d),m=Array(c),y=0,b=Array(d),x=Array(d),_=Array(d),w,A,O,E,k,D,C,F,S,j,M;for(A=0;A<f;++A)p[A]=0;for(A=0;A<c;++A)m[A]=0;for(A=0;A<d;++A){D=t[A];k=_[A]=i(D);D.x=D.x||0;b[A]=0;D.y=D.y||0;x[A]=0;O=A%f;E=~~(A/f);v=Math.max(v,C=Math.ceil(k.x2));y=Math.max(y,F=Math.ceil(k.y2));p[O]=Math.max(p[O],C);m[E]=Math.max(m[E],F);h[A]=s+FE(k.x1);g[A]=l+FE(k.y1);if(r)e.dirty(t[A])}for(A=0;A<d;++A){if(A%f===0)h[A]=0;if(A<f)g[A]=0}if(o===QO){for(O=1;O<f;++O){for(M=0,A=O;A<d;A+=f){if(M<h[A])M=h[A]}for(A=O;A<d;A+=f){h[A]=M+p[O-1]}}}else if(o===JO){for(M=0,A=0;A<d;++A){if(A%f&&M<h[A])M=h[A]}for(A=0;A<d;++A){if(A%f)h[A]=M+v}}else{for(o=false,O=1;O<f;++O){for(A=O;A<d;A+=f){h[A]+=p[O-1]}}}if(u===QO){for(E=1;E<c;++E){for(M=0,A=E*f,w=A+f;A<w;++A){if(M<g[A])M=g[A]}for(A=E*f;A<w;++A){g[A]=M+m[E-1]}}}else if(u===JO){for(M=0,A=f;A<d;++A){if(M<g[A])M=g[A]}for(A=f;A<d;++A){g[A]=M+y}}else{for(u=false,E=1;E<c;++E){for(A=E*f,w=A+f;A<w;++A){g[A]+=m[E-1]}}}for(S=0,A=0;A<d;++A){S=h[A]+(A%f?S:0);b[A]+=S-t[A].x}for(O=0;O<f;++O){for(j=0,A=O;A<d;A+=f){j+=g[A];x[A]+=j-t[A].y}}if(o&&CE(n.center,KO)&&c>1){for(A=0;A<d;++A){k=o===JO?v:p[A%f];S=k-_[A].x2-t[A].x-b[A];if(S>0)b[A]+=S/2}}if(u&&CE(n.center,eE)&&f!==1){for(A=0;A<d;++A){k=u===JO?y:m[~~(A/f)];j=k-_[A].y2-t[A].y-x[A];if(j>0)x[A]+=j/2}}for(A=0;A<d;++A){a.union(_[A].translate(b[A],x[A]))}S=CE(n.anchor,FO);j=CE(n.anchor,SO);switch(CE(n.anchor,KO)){case CO:S-=a.width();break;case DO:S-=a.width()/2}switch(CE(n.anchor,eE)){case CO:j-=a.height();break;case DO:j-=a.height()/2}S=Math.round(S);j=Math.round(j);a.clear();for(A=0;A<d;++A){t[A].mark.bounds.clear()}for(A=0;A<d;++A){D=t[A];D.x+=b[A]+=S;D.y+=x[A]+=j;a.union(D.mark.bounds.union(D.bounds.translate(b[A],x[A])));if(r)e.dirty(D)}return a}function jE(e,t,n){var r=EE(t),i=r.marks,a=n.bounds===ZO?ME:BE,o=n.offset,u=n.columns||i.length,s=u<=0?1:Math.ceil(i.length/u),l=s*u,f,c,d,h,p,v,g;var m=SE(e,i,n);if(m.empty())m.set(0,0,0,0);if(r.rowheaders){v=CE(n.headerBand,eE,null);f=NE(e,r.rowheaders,i,u,s,-CE(o,"rowHeader"),AE,0,a,"x1",0,u,1,v)}if(r.colheaders){v=CE(n.headerBand,KO,null);c=NE(e,r.colheaders,i,u,u,-CE(o,"columnHeader"),AE,1,a,"y1",0,1,u,v)}if(r.rowfooters){v=CE(n.footerBand,eE,null);d=NE(e,r.rowfooters,i,u,s,CE(o,"rowFooter"),OE,0,a,"x2",u-1,u,1,v)}if(r.colfooters){v=CE(n.footerBand,KO,null);h=NE(e,r.colfooters,i,u,u,CE(o,"columnFooter"),OE,1,a,"y2",l-u,1,u,v)}if(r.rowtitle){p=CE(n.titleAnchor,eE);g=CE(o,"rowTitle");g=p===CO?d+g:f-g;v=CE(n.titleBand,eE,.5);TE(e,r.rowtitle,g,0,m,v)}if(r.coltitle){p=CE(n.titleAnchor,KO);g=CE(o,"columnTitle");g=p===CO?h+g:c-g;v=CE(n.titleBand,KO,.5);TE(e,r.coltitle,g,1,m,v)}}function ME(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):undefined}function BE(e,t){return e.bounds[t]}function NE(e,t,n,r,i,a,o,u,s,l,f,c,d,h){var p=n.length,v=0,g=0,m,y,b,x,_,w,A,O,E;if(!p)return v;for(m=f;m<p;m+=c){if(n[m])v=o(v,s(n[m],l))}if(!t.length)return v;if(t.length>i){e.warn("Grid headers exceed limit: "+i);t=t.slice(0,i)}v+=a;for(y=0,x=t.length;y<x;++y){e.dirty(t[y]);t[y].mark.bounds.clear()}for(m=f,y=0,x=t.length;y<x;++y,m+=c){w=t[y];_=w.mark.bounds;for(b=m;b>=0&&(A=n[b])==null;b-=d);if(u){O=h==null?A.x:Math.round(A.bounds.x1+h*A.bounds.width());E=v}else{O=v;E=h==null?A.y:Math.round(A.bounds.y1+h*A.bounds.height())}_.union(w.bounds.translate(O-(w.x||0),E-(w.y||0)));w.x=O;w.y=E;e.dirty(w);g=o(g,_[l])}return g}function TE(e,t,n,r,i,a){if(!t)return;e.dirty(t);var o=n,u=n;r?o=Math.round(i.x1+a*i.width()):u=Math.round(i.y1+a*i.height());t.bounds.translate(o-(t.x||0),u-(t.y||0));t.mark.bounds.clear().union(t.bounds);t.x=o;t.y=u;e.dirty(t)}function zE(e,t){var n=e[t]||{};return function(t,r){return n[t]!=null?n[t]:e[t]!=null?e[t]:r}}function PE(e,t){var n=-Infinity;e.forEach((function(e){if(e.offset!=null)n=Math.max(n,e.offset)}));return n>-Infinity?n:t}function RE(e,t,n,r,i,a,o){var u=zE(n,t),s=PE(e,u("offset",0)),l=u("anchor",kO),f=l===CO?1:l===DO?.5:0;var c={align:QO,bounds:u("bounds",ZO),columns:u("direction")==="vertical"?1:e.length,padding:u("margin",8),center:u("center"),nodirty:true};switch(t){case bO:c.anchor={x:Math.floor(r.x1)-s,column:CO,y:f*(o||r.height()+2*r.y1),row:l};break;case xO:c.anchor={x:Math.ceil(r.x2)+s,y:f*(o||r.height()+2*r.y1),row:l};break;case yO:c.anchor={y:Math.floor(i.y1)-s,row:CO,x:f*(a||i.width()+2*i.x1),column:l};break;case _O:c.anchor={y:Math.ceil(i.y2)+s,x:f*(a||i.width()+2*i.x1),column:l};break;case wO:c.anchor={x:s,y:s};break;case AO:c.anchor={x:a-s,y:s,column:CO};break;case OO:c.anchor={x:s,y:o-s,row:CO};break;case EO:c.anchor={x:a-s,y:o-s,column:CO,row:CO};break}return c}function LE(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,u=n.y,s,l;n._bounds?n._bounds.clear().union(a):n._bounds=a.clone();a.clear();UE(e,n,n.items[0].items[0]);a=IE(n,a);s=2*n.padding;l=2*n.padding;if(!a.empty()){s=Math.ceil(a.width()+s);l=Math.ceil(a.height()+l)}if(r.type===HO){HE(n.items[0].items[0].items[0].items)}if(i!==XO){n.x=o=0;n.y=u=0}n.width=s;n.height=l;Cb(a.set(o,u,o+s,u+l),n);n.mark.bounds.clear().union(a);return n}function IE(e,t){e.items.forEach((function(e){return t.union(e.bounds)}));t.x1=e.padding;t.y1=e.padding;return t}function UE(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title){if(i||a)WE(e,n,i,a)}else{var o=t.items[1].items[0],u=o.anchor,s=t.titlePadding||0,l=r-o.x,f=r-o.y;switch(o.orient){case bO:i+=Math.ceil(o.bounds.width())+s;break;case xO:case _O:break;default:a+=o.bounds.height()+s}if(i||a)WE(e,n,i,a);switch(o.orient){case bO:f+=qE(t,n,o,u,1,1);break;case xO:l+=qE(t,n,o,CO,0,0)+s;f+=qE(t,n,o,u,1,1);break;case _O:l+=qE(t,n,o,u,0,0);f+=qE(t,n,o,CO,-1,0,1)+s;break;default:l+=qE(t,n,o,u,0,0)}if(l||f)WE(e,o,l,f);if((l=Math.round(o.bounds.x1-r))<0){WE(e,n,-l,0);WE(e,o,-l,0)}}}function qE(e,t,n,r,i,a,o){var u=e.datum.type!=="symbol",s=n.datum.vgrad,l=u&&(a||!s)&&!o?t.items[0]:t,f=l.bounds[i?"y2":"x2"]-e.padding,c=s&&a?f:0,d=s&&a?0:f,h=i<=0?0:P_(n);return Math.round(r===kO?c:r===CO?d-h:.5*(f-h))}function WE(e,t,n,r){t.x+=n;t.y+=r;t.bounds.translate(n,r);t.mark.bounds.translate(n,r);e.dirty(t)}function HE(e){var t=e.reduce((function(e,t){e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0);return e}),{});e.forEach((function(e){e.width=t[e.column];e.height=e.bounds.y2-e.y}))}function GE(e,t,n,r,i){var a=t.items[0],o=a.frame,u=a.orient,s=a.anchor,l=a.offset,f=a.padding,c=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],h=u===bO||u===xO?r:n,p=0,v=0,g=0,m=0,y=0,b;if(o!==jO){u===bO?(p=i.y2,h=i.y1):u===xO?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2)}else if(u===bO){p=r,h=0}b=s===kO?p:s===CO?h:(p+h)/2;if(d&&d.text){switch(u){case yO:case _O:y=c.bounds.height()+f;break;case bO:m=c.bounds.width()+f;break;case xO:m=-c.bounds.width()-f;break}mE.clear().union(d.bounds);mE.translate(m-(d.x||0),y-(d.y||0));if(yE(d,"x",m)|yE(d,"y",y)){e.dirty(d);d.bounds.clear().union(mE);d.mark.bounds.clear().union(mE);e.dirty(d)}mE.clear().union(d.bounds)}else{mE.clear()}mE.union(c.bounds);switch(u){case yO:v=b;g=i.y1-mE.height()-l;break;case bO:v=i.x1-mE.width()-l;g=b;break;case xO:v=i.x2+mE.width()+l;g=b;break;case _O:v=b;g=i.y2+l;break;default:v=a.x;g=a.y}if(yE(a,"x",v)|yE(a,"y",g)){mE.translate(v,g);e.dirty(a);a.bounds.clear().union(mE);t.bounds.clear().union(mE);e.dirty(a)}return a.bounds}function $E(e){df.call(this,null,e)}_n($E,df,{transform:function(e,t){var n=t.dataflow;e.mark.items.forEach((function(t){if(e.layout)jE(n,t,e.layout);YE(n,t,e)}));return VE(e.mark.group)?t.reflow():t}});function VE(e){return e&&e.mark.role!=="legend-entry"}function YE(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=(new wb).set(0,0,i,a),u=o.clone(),s=o.clone(),l=[],f,c,d,h,p,v;for(p=0,v=r.length;p<v;++p){c=r[p];switch(c.role){case MO:h=bE(c)?u:s;h.union(_E(e,c,i,a));break;case BO:f=c;break;case zO:l.push(LE(e,c));break;case NO:case TO:case PO:case RO:case LO:case IO:case UO:case qO:u.union(c.bounds);s.union(c.bounds);break;default:o.union(c.bounds)}}if(l.length){var g={};l.forEach((function(e){d=e.orient||xO;if(d!==XO)(g[d]||(g[d]=[])).push(e)}));for(var m in g){var y=g[m];SE(e,y,RE(y,m,n.legends,u,s,i,a))}l.forEach((function(t){var r=t.bounds;if(!r.equals(t._bounds)){t.bounds=t._bounds;e.dirty(t);t.bounds=r;e.dirty(t)}if(n.autosize&&(n.autosize.type===GO||n.autosize.type===$O||n.autosize.type===VO)){switch(t.orient){case bO:case xO:o.add(r.x1,0).add(r.x2,0);break;case yO:case _O:o.add(0,r.y1).add(0,r.y2)}}else{o.union(r)}}))}o.union(u).union(s);if(f){o.union(GE(e,f,i,a,o))}if(t.clip){o.set(0,0,t.width||0,t.height||0)}XE(e,t,o,n)}function XE(e,t,n,r){var i=r.autosize||{},a=i.type;if(e._autosize<1||!a)return;var o=e._width,u=e._height,s=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,t.height||0),c=Math.max(0,Math.ceil(-n.y1));var d=Math.max(0,Math.ceil(n.x2-s)),h=Math.max(0,Math.ceil(n.y2-f));if(i.contains===WO){var p=e.padding();o-=p.left+p.right;u-=p.top+p.bottom}if(a===XO){l=0;c=0;s=o;f=u}else if(a===GO){s=Math.max(0,o-l-d);f=Math.max(0,u-c-h)}else if(a===$O){s=Math.max(0,o-l-d);u=f+c+h}else if(a===VO){o=s+l+d;f=Math.max(0,u-c-h)}else if(a===YO){o=s+l+d;u=f+c+h}e._resizeView(o,u,s,f,[l,c],i.resize)}var JE=Object.freeze({__proto__:null,bound:tE,identifier:iE,mark:oE,overlap:sE,render:gE,viewlayout:$E});function QE(e){df.call(this,null,e)}_n(QE,df,{transform:function(e,t){if(this.value&&!e.modified()){return t.StopPropagation}var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,u=km(a,o,e.minstep),s=e.format||Fm(n,a,u,e.formatSpecifier,e.formatType,!!e.values),l=e.values?Dm(a,e.values,u):Cm(a,u);if(i)r.rem=i;i=l.map((function(e,t){return Zs({index:t/(l.length-1||1),value:e,label:s(e)})}));if(e.extra&&i.length){i.push(Zs({index:-1,extra:{value:i[0].value},label:""}))}r.source=i;r.add=i;this.value=i;return r}});function ZE(e){df.call(this,null,e)}function KE(){return Zs({})}function ek(e){var t=bn().test((function(e){return e.exit}));t.lookup=function(n){return t.get(e(n))};return t}_n(ZE,df,{transform:function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||KE,a=e.key||Js,o=this.value;if(St(r.encode)){r.encode=null}if(o&&(e.modified("key")||t.modified(a))){pt("DataJoin does not support modified key function or fields.")}if(!o){t=t.addAll();this.value=o=ek(a)}t.visit(t.ADD,(function(e){var t=a(e);var n=o.get(t);if(n){if(n.exit){o.empty--;r.add.push(n)}else{r.mod.push(n)}}else{n=i(e);o.set(t,n);r.add.push(n)}n.datum=e;n.exit=false}));t.visit(t.MOD,(function(e){var t=a(e),n=o.get(t);if(n){n.datum=e;r.mod.push(n)}}));t.visit(t.REM,(function(e){var t=a(e),n=o.get(t);if(e===n.datum&&!n.exit){r.rem.push(n);n.exit=true;++o.empty}}));if(t.changed(t.ADD_MOD))r.modifies("datum");if(t.clean()||e.clean&&o.empty>n.cleanThreshold){n.runAfter(o.clean)}return r}});function tk(e){df.call(this,null,e)}_n(tk,df,{transform:function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||false,i=e.encoders,a=t.encode;if(St(a)){if(n.changed()||a.every((function(e){return i[e]}))){a=a[0];n.encode=null}else{return t.StopPropagation}}var o=a==="enter",u=i.update||wt,s=i.enter||wt,l=i.exit||wt,f=(a&&!o?i[a]:u)||wt;if(t.changed(t.ADD)){t.visit(t.ADD,(function(t){s(t,e);u(t,e)}));n.modifies(s.output);n.modifies(u.output);if(f!==wt&&f!==u){t.visit(t.ADD,(function(t){f(t,e)}));n.modifies(f.output)}}if(t.changed(t.REM)&&l!==wt){t.visit(t.REM,(function(t){l(t,e)}));n.modifies(l.output)}if(o||f!==wt){var c=t.MOD|(e.modified()?t.REFLOW:0);if(o){t.visit(c,(function(t){var i=s(t,e)||r;if(f(t,e)||i)n.mod.push(t)}));if(n.mod.length)n.modifies(s.output)}else{t.visit(c,(function(t){if(f(t,e)||r)n.mod.push(t)}))}if(n.mod.length)n.modifies(f.output)}return n.changed()?n:t.StopPropagation}});function nk(e){df.call(this,[],e)}_n(nk,df,{transform:function(e,t){if(this.value!=null&&!e.modified()){return t.StopPropagation}var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.type||xm,o=e.scale,u=+e.limit,s=km(o,e.count==null?5:e.count,e.minstep),l=!!e.values||a===xm,f=e.format||Rm(n,o,s,a,e.formatSpecifier,e.formatType,l),c=e.values||Bm(o,s),d,h,p,v,g;if(i)r.rem=i;if(a===xm){if(u&&c.length>u){t.dataflow.warn("Symbol legend count exceeds limit, filtering items.");i=c.slice(0,u-1);g=true}else{i=c}if(rn(p=e.size)){if(!e.values&&o(i[0])===0){i=i.slice(1)}v=i.reduce((function(t,n){return Math.max(t,p(n,e))}),0)}else{p=cn(v=p||8)}i=i.map((function(t,n){return Zs({index:n,label:f(t,n,i),value:t,offset:v,size:p(t,e)})}));if(g){g=c[i.length];i.push(Zs({index:i.length,label:"…".concat(c.length-i.length," entries"),value:g,offset:v,size:p(g,e)}))}}else if(a===wm){d=o.domain(),h=cm(o,d[0],zt(d));if(c.length<3&&!e.values&&d[0]!==zt(d)){c=[d[0],zt(d)]}i=c.map((function(e,t){return Zs({index:t,label:f(e,t,c),value:e,perc:h(e)})}))}else{p=c.length-1;h=Hm(o);i=c.map((function(e,t){return Zs({index:t,label:f(e,t,c),value:e,perc:t?h(e):0,perc2:t===p?1:h(c[t+1])})}))}r.source=i;r.add=i;this.value=i;return r}});var rk=function(e){return e.source.x};var ik=function(e){return e.source.y};var ak=function(e){return e.target.x};var ok=function(e){return e.target.y};function uk(e){df.call(this,{},e)}uk.Definition={type:"LinkPath",metadata:{modifies:true},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};_n(uk,df,{transform:function(e,t){var n=e.sourceX||rk,r=e.sourceY||ik,i=e.targetX||ak,a=e.targetY||ok,o=e.as||"path",u=e.orient||"vertical",s=e.shape||"line",l=xk.get(s+"-"+u)||xk.get(s);if(!l){pt("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:""))}t.visit(t.SOURCE,(function(e){e[o]=l(n(e),r(e),i(e),a(e))}));return t.reflow(e.modified()).modifies(o)}});var sk=function(e,t,n,r){return"M"+e+","+t+"L"+n+","+r};var lk=function(e,t,n,r){return sk(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))};var fk=function(e,t,n,r){var i=n-e,a=r-t,o=Math.hypot(i,a)/2,u=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+u+" 0 1"+" "+n+","+r};var ck=function(e,t,n,r){return fk(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))};var dk=function(e,t,n,r){var i=n-e,a=r-t,o=.2*(i+a),u=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r};var hk=function(e,t,n,r){return dk(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))};var pk=function(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n};var vk=function(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r};var gk=function(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(s?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u};var mk=function(e,t,n,r){var i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r};var yk=function(e,t,n,r){var i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r};var bk=function(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=(t+r)/2;return"M"+t*i+","+t*a+"C"+s*i+","+s*a+" "+s*o+","+s*u+" "+r*o+","+r*u};var xk=bn({line:sk,"line-radial":lk,arc:fk,"arc-radial":ck,curve:dk,"curve-radial":hk,"orthogonal-horizontal":pk,"orthogonal-vertical":vk,"orthogonal-radial":gk,"diagonal-horizontal":mk,"diagonal-vertical":yk,"diagonal-radial":bk});function _k(e){df.call(this,null,e)}_k.Definition={type:"Pie",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:false},{name:"as",type:"string",array:true,length:2,default:["startAngle","endAngle"]}]};_n(_k,df,{transform:function(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||xt,o=e.startAngle||0,u=e.endAngle!=null?e.endAngle:2*Math.PI,s=t.source,l=s.map(a),f=l.length,c=o,d=(u-o)/Zr(l),h=Qr(f),p,v,g;if(e.sort){h.sort((function(e,t){return l[e]-l[t]}))}for(p=0;p<f;++p){g=l[h[p]];v=s[h[p]];v[r]=c;v[i]=c+=g*d}this.value=l;return t.reflow(e.modified()).modifies(n)}});var wk=5;function Ak(e){var t=e.type;return!e.bins&&(t===gg||t===yg||t===bg)}function Ok(e){return em(e)&&e!==Ag}var Ek=qn(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function kk(e){df.call(this,null,e);this.modified(true)}_n(kk,df,{transform:function(e,t){var n=t.dataflow,r=this.value,i=Dk(e);if(!r||i!==r.type){this.value=r=Qg(i)()}for(i in e)if(!Ek[i]){if(i==="padding"&&Ok(r.type))continue;rn(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}Nk(r,e,Bk(r,e,Fk(r,e,n)));return t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Dk(e){var t=e.type,n="",r;if(t===Ag)return Ag+"-"+gg;if(Ck(e)){r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0;n=r===2?Ag+"-":r===3?Og+"-":""}return(n+t||gg).toLowerCase()}function Ck(e){var t=e.type;return em(t)&&t!==_g&&t!==wg&&(e.scheme||e.range&&e.range.length&&e.range.every(Cn))}function Fk(e,t,n){var r=Sk(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===undefined&&Ak(e),u,s;if(!i)return 0;if(Ok(a)&&t.padding&&i[0]!==zt(i)){i=jk(a,i,t.range,t.padding,t.exponent,t.constant)}if(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null){u=(i=i.slice()).length-1||1;if(o){if(i[0]>0)i[0]=0;if(i[u]<0)i[u]=0}if(t.domainMin!=null)i[0]=t.domainMin;if(t.domainMax!=null)i[u]=t.domainMax;if(t.domainMid!=null){s=t.domainMid;var l=s>i[u]?u+1:s<i[0]?0:u;if(l!==u)n.warn("Scale domainMid exceeds domain min or max.",s);i.splice(l,0,s)}}e.domain(Mk(a,i,n));if(a===Cg){e.unknown(t.domainImplicit?sp:undefined)}if(t.nice&&e.nice){e.nice(t.nice!==true&&km(e,t.nice)||null)}return i.length}function Sk(e,t,n){if(t){e.domain(Mk(e.type,t,n));return t.length}else{return-1}}function jk(e,t,n,r,i,a){var o=Math.abs(zt(n)-n[0]),u=o/(o-2*r),s=e===mg?Jt(t,null,u):e===bg?Qt(t,null,u,.5):e===yg?Qt(t,null,u,i||1):e===xg?Zt(t,null,u,a||1):Xt(t,null,u);t=t.slice();t[0]=s[0];t[t.length-1]=s[1];return t}function Mk(e,t,n){if(rm(e)){var r=Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0));if(r!==t.length){n.warn("Log scale domain includes zero: "+Pn(t))}}return t}function Bk(e,t,n){var r=t.bins;if(r&&!St(r)){var i=e.domain(),a=i[0],o=zt(i),u=r.step;var s=r.start==null?a:r.start,l=r.stop==null?o:r.stop;if(!u)pt("Scale bins parameter missing step property.");if(s<a)s=u*Math.ceil(a/u);if(l>o)l=u*Math.floor(o/u);r=Qr(s,l+u/2,u)}if(r){e.bins=r}else if(e.bins){delete e.bins}if(e.type===jg){if(!r){e.bins=e.domain()}else if(!t.domain&&!t.domainRaw){e.domain(r);n=r.length}}return n}function Nk(e,t,n){var r=e.type,i=t.round||false,a=t.range;if(t.rangeStep!=null){a=Tk(r,t,n)}else if(t.scheme){a=zk(r,t,n);if(rn(a)){if(e.interpolator){return e.interpolator(a)}else{pt("Scale type ".concat(r," does not support interpolating color schemes."))}}}if(a&&am(r)){return e.interpolator(lm(Rk(a,t.reverse),t.interpolate,t.interpolateGamma))}if(a&&t.interpolate&&e.interpolate){e.interpolate(dm(t.interpolate,t.interpolateGamma))}else if(rn(e.round)){e.round(i)}else if(rn(e.rangeRound)){e.interpolate(i?Qp:Yp)}if(a)e.range(Rk(a,t.reverse))}function Tk(e,t,n){if(e!==Sg&&e!==Fg){pt("Only band and point scales support rangeStep.")}var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===Fg?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*pg(n,i,r)]}function zk(e,t,n){var r=t.schemeExtent,i,a;if(St(t.scheme)){a=lm(t.scheme,t.interpolate,t.interpolateGamma)}else{i=t.scheme.toLowerCase();a=bm(i);if(!a)pt("Unrecognized scheme name: ".concat(t.scheme))}n=e===Dg?n+1:e===jg?n-1:e===Eg||e===kg?+t.schemeCount||wk:n;return am(e)?Pk(a,r,t.reverse):rn(a)?fm(Pk(a,r),n):e===Cg?a:a.slice(0,n)}function Pk(e,t,n){return rn(e)&&(t||n)?sm(e,Rk(t||[0,1],n)):e}function Rk(e,t){return t?e.slice().reverse():e}function Lk(e){df.call(this,null,e)}_n(Lk,df,{transform:function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");if(n)t.source.sort(nl(e.sort));this.modified(n);return t}});var Ik="zero",Uk="center",qk="normalize",Wk=["y0","y1"];function Hk(e){df.call(this,null,e)}Hk.Definition={type:"Stack",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:true},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Ik,values:[Ik,Uk,qk]},{name:"as",type:"string",array:true,length:2,default:Wk}]};_n(Hk,df,{transform:function(e,t){var n=e.as||Wk,r=n[0],i=n[1],a=nl(e.sort),o=e.field||xt,u=e.offset===Uk?Gk:e.offset===qk?$k:Vk,s,l,f,c;s=Yk(t.source,e.groupby,a,o);for(l=0,f=s.length,c=s.max;l<f;++l){u(s[l],c,o,r,i)}return t.reflow(e.modified()).modifies(n)}});function Gk(e,t,n,r,i){var a=(t-e.sum)/2,o=e.length,u=0,s;for(;u<o;++u){s=e[u];s[r]=a;s[i]=a+=Math.abs(n(s))}}function $k(e,t,n,r,i){var a=1/e.sum,o=0,u=e.length,s=0,l=0,f;for(;s<u;++s){f=e[s];f[r]=o;f[i]=o=a*(l+=Math.abs(n(f)))}}function Vk(e,t,n,r,i){var a=0,o=0,u=e.length,s=0,l,f;for(;s<u;++s){f=e[s];l=+n(f);if(l<0){f[r]=o;f[i]=o+=l}else{f[r]=a;f[i]=a+=l}}}function Yk(e,t,n,r){var i=[],a=function(e){return e(f)},o,u,s,l,f,c,d,h,p;if(t==null){i.push(e.slice())}else{for(o={},u=0,s=e.length;u<s;++u){f=e[u];c=t.map(a);d=o[c];if(!d){o[c]=d=[];i.push(d)}d.push(f)}}for(c=0,p=0,l=i.length;c<l;++c){d=i[c];for(u=0,h=0,s=d.length;u<s;++u){h+=Math.abs(r(d[u]))}d.sum=h;if(h>p)p=h;if(n)d.sort(n)}i.max=p;return i}var Xk=Object.freeze({__proto__:null,axisticks:QE,datajoin:ZE,encode:tk,legendentries:nk,linkpath:uk,pie:_k,scale:kk,sortitems:Lk,stack:Hk});var Jk=1e-6;var Qk=1e-12;var Zk=Math.PI;var Kk=Zk/2;var eD=Zk/4;var tD=Zk*2;var nD=180/Zk;var rD=Zk/180;var iD=Math.abs;var aD=Math.atan;var oD=Math.atan2;var uD=Math.cos;var sD=Math.ceil;var lD=Math.exp;var fD=Math.hypot;var cD=Math.log;var dD=Math.pow;var hD=Math.sin;var pD=Math.sign||function(e){return e>0?1:e<0?-1:0};var vD=Math.sqrt;var gD=Math.tan;function mD(e){return e>1?0:e<-1?Zk:Math.acos(e)}function yD(e){return e>1?Kk:e<-1?-Kk:Math.asin(e)}function bD(){}function xD(e,t){if(e&&wD.hasOwnProperty(e.type)){wD[e.type](e,t)}}var _D={Feature:function(e,t){xD(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)xD(n[r].geometry,t)}};var wD={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){AD(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)AD(n[r],t,0)},Polygon:function(e,t){OD(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)OD(n[r],t)},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)xD(n[r],t)}};function AD(e,t,n){var r=-1,i=e.length-n,a;t.lineStart();while(++r<i)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function OD(e,t){var n=-1,r=e.length;t.polygonStart();while(++n<r)AD(e[n],t,1);t.polygonEnd()}function ED(e,t){if(e&&_D.hasOwnProperty(e.type)){_D[e.type](e,t)}else{xD(e,t)}}var kD=new Or;var DD=new Or,CD,FD,SD,jD,MD;var BD={point:bD,lineStart:bD,lineEnd:bD,polygonStart:function(){kD=new Or;BD.lineStart=ND;BD.lineEnd=TD},polygonEnd:function(){var e=+kD;DD.add(e<0?tD+e:e);this.lineStart=this.lineEnd=this.point=bD},sphere:function(){DD.add(tD)}};function ND(){BD.point=zD}function TD(){PD(CD,FD)}function zD(e,t){BD.point=PD;CD=e,FD=t;e*=rD,t*=rD;SD=e,jD=uD(t=t/2+eD),MD=hD(t)}function PD(e,t){e*=rD,t*=rD;t=t/2+eD;var n=e-SD,r=n>=0?1:-1,i=r*n,a=uD(t),o=hD(t),u=MD*o,s=jD*a+u*uD(i),l=u*r*hD(i);kD.add(oD(l,s));SD=e,jD=a,MD=o}function RD(e){DD=new Or;ED(e,BD);return DD*2}function LD(e){return[oD(e[1],e[0]),yD(e[2])]}function ID(e){var t=e[0],n=e[1],r=uD(n);return[r*uD(t),r*hD(t),hD(n)]}function UD(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function qD(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function WD(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function HD(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function GD(e){var t=vD(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var $D,VD,YD,XD,JD,QD,ZD,KD,eC,tC,nC;var rC={point:iC,lineStart:oC,lineEnd:uC,polygonStart:function(){rC.point=sC;rC.lineStart=lC;rC.lineEnd=fC;eC=new Or;BD.polygonStart()},polygonEnd:function(){BD.polygonEnd();rC.point=iC;rC.lineStart=oC;rC.lineEnd=uC;if(kD<0)$D=-(YD=180),VD=-(XD=90);else if(eC>Jk)XD=90;else if(eC<-Jk)VD=-90;nC[0]=$D,nC[1]=YD},sphere:function(){$D=-(YD=180),VD=-(XD=90)}};function iC(e,t){tC.push(nC=[$D=e,YD=e]);if(t<VD)VD=t;if(t>XD)XD=t}function aC(e,t){var n=ID([e*rD,t*rD]);if(KD){var r=qD(KD,n),i=[r[1],-r[0],0],a=qD(i,r);GD(a);a=LD(a);var o=e-JD,u=o>0?1:-1,s=a[0]*nD*u,l,f=iD(o)>180;if(f^(u*JD<s&&s<u*e)){l=a[1]*nD;if(l>XD)XD=l}else if(s=(s+360)%360-180,f^(u*JD<s&&s<u*e)){l=-a[1]*nD;if(l<VD)VD=l}else{if(t<VD)VD=t;if(t>XD)XD=t}if(f){if(e<JD){if(cC($D,e)>cC($D,YD))YD=e}else{if(cC(e,YD)>cC($D,YD))$D=e}}else{if(YD>=$D){if(e<$D)$D=e;if(e>YD)YD=e}else{if(e>JD){if(cC($D,e)>cC($D,YD))YD=e}else{if(cC(e,YD)>cC($D,YD))$D=e}}}}else{tC.push(nC=[$D=e,YD=e])}if(t<VD)VD=t;if(t>XD)XD=t;KD=n,JD=e}function oC(){rC.point=aC}function uC(){nC[0]=$D,nC[1]=YD;rC.point=iC;KD=null}function sC(e,t){if(KD){var n=e-JD;eC.add(iD(n)>180?n+(n>0?360:-360):n)}else{QD=e,ZD=t}BD.point(e,t);aC(e,t)}function lC(){BD.lineStart()}function fC(){sC(QD,ZD);BD.lineEnd();if(iD(eC)>Jk)$D=-(YD=180);nC[0]=$D,nC[1]=YD;KD=null}function cC(e,t){return(t-=e)<0?t+360:t}function dC(e,t){return e[0]-t[0]}function hC(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function pC(e){var t,n,r,i,a,o,u;XD=YD=-($D=VD=Infinity);tC=[];ED(e,rC);if(n=tC.length){tC.sort(dC);for(t=1,r=tC[0],a=[r];t<n;++t){i=tC[t];if(hC(r,i[0])||hC(r,i[1])){if(cC(r[0],i[1])>cC(r[0],r[1]))r[1]=i[1];if(cC(i[0],r[1])>cC(r[0],r[1]))r[0]=i[0]}else{a.push(r=i)}}for(o=-Infinity,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t){i=a[t];if((u=cC(r[1],i[0]))>o)o=u,$D=i[0],YD=r[1]}}tC=nC=null;return $D===Infinity||VD===Infinity?[[NaN,NaN],[NaN,NaN]]:[[$D,VD],[YD,XD]]}var vC,gC,mC,yC,bC,xC,_C,wC,AC,OC,EC,kC,DC,CC,FC,SC;var jC={sphere:bD,point:MC,lineStart:NC,lineEnd:PC,polygonStart:function(){jC.lineStart=RC;jC.lineEnd=LC},polygonEnd:function(){jC.lineStart=NC;jC.lineEnd=PC}};function MC(e,t){e*=rD,t*=rD;var n=uD(t);BC(n*uD(e),n*hD(e),hD(t))}function BC(e,t,n){++vC;mC+=(e-mC)/vC;yC+=(t-yC)/vC;bC+=(n-bC)/vC}function NC(){jC.point=TC}function TC(e,t){e*=rD,t*=rD;var n=uD(t);CC=n*uD(e);FC=n*hD(e);SC=hD(t);jC.point=zC;BC(CC,FC,SC)}function zC(e,t){e*=rD,t*=rD;var n=uD(t),r=n*uD(e),i=n*hD(e),a=hD(t),o=oD(vD((o=FC*a-SC*i)*o+(o=SC*r-CC*a)*o+(o=CC*i-FC*r)*o),CC*r+FC*i+SC*a);gC+=o;xC+=o*(CC+(CC=r));_C+=o*(FC+(FC=i));wC+=o*(SC+(SC=a));BC(CC,FC,SC)}function PC(){jC.point=MC}function RC(){jC.point=IC}function LC(){UC(kC,DC);jC.point=MC}function IC(e,t){kC=e,DC=t;e*=rD,t*=rD;jC.point=UC;var n=uD(t);CC=n*uD(e);FC=n*hD(e);SC=hD(t);BC(CC,FC,SC)}function UC(e,t){e*=rD,t*=rD;var n=uD(t),r=n*uD(e),i=n*hD(e),a=hD(t),o=FC*a-SC*i,u=SC*r-CC*a,s=CC*i-FC*r,l=fD(o,u,s),f=yD(l),c=l&&-f/l;AC.add(c*o);OC.add(c*u);EC.add(c*s);gC+=f;xC+=f*(CC+(CC=r));_C+=f*(FC+(FC=i));wC+=f*(SC+(SC=a));BC(CC,FC,SC)}function qC(e){vC=gC=mC=yC=bC=xC=_C=wC=0;AC=new Or;OC=new Or;EC=new Or;ED(e,jC);var t=+AC,n=+OC,r=+EC,i=fD(t,n,r);if(i<Qk){t=xC,n=_C,r=wC;if(gC<Jk)t=mC,n=yC,r=bC;i=fD(t,n,r);if(i<Qk)return[NaN,NaN]}return[oD(n,t)*nD,yD(r/i)*nD]}function WC(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}if(e.invert&&t.invert)n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])};return n}function HC(e,t){if(iD(e)>Zk)e-=Math.round(e/tD)*tD;return[e,t]}HC.invert=HC;function GC(e,t,n){return(e%=tD)?t||n?WC(VC(e),YC(t,n)):VC(e):t||n?YC(t,n):HC}function $C(e){return function(t,n){t+=e;if(iD(t)>Zk)t-=Math.round(t/tD)*tD;return[t,n]}}function VC(e){var t=$C(e);t.invert=$C(-e);return t}function YC(e,t){var n=uD(e),r=hD(e),i=uD(t),a=hD(t);function o(e,t){var o=uD(t),u=uD(e)*o,s=hD(e)*o,l=hD(t),f=l*n+u*r;return[oD(s*i-f*a,u*n-l*r),yD(f*i+s*a)]}o.invert=function(e,t){var o=uD(t),u=uD(e)*o,s=hD(e)*o,l=hD(t),f=l*i-s*a;return[oD(s*i+l*a,u*n+f*r),yD(f*n-u*r)]};return o}function XC(e){e=GC(e[0]*rD,e[1]*rD,e.length>2?e[2]*rD:0);function t(t){t=e(t[0]*rD,t[1]*rD);return t[0]*=nD,t[1]*=nD,t}t.invert=function(t){t=e.invert(t[0]*rD,t[1]*rD);return t[0]*=nD,t[1]*=nD,t};return t}function JC(e,t,n,r,i,a){if(!n)return;var o=uD(t),u=hD(t),s=r*n;if(i==null){i=t+r*tD;a=t-s/2}else{i=QC(o,i);a=QC(o,a);if(r>0?i<a:i>a)i+=r*tD}for(var l,f=i;r>0?f>a:f<a;f-=s){l=LD([o,-u*uD(f),-u*hD(f)]);e.point(l[0],l[1])}}function QC(e,t){t=ID(t),t[0]-=e;GD(t);var n=mD(-t[1]);return((-t[2]<0?-n:n)+tD-Jk)%tD}function ZC(){var e=[],t;return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:bD,rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))},result:function(){var n=e;e=[];t=null;return n}}}function KC(e,t){return iD(e[0]-t[0])<Jk&&iD(e[1]-t[1])<Jk}function eF(e,t,n,r){this.x=e;this.z=t;this.o=n;this.e=r;this.v=false;this.n=this.p=null}function tF(e,t,n,r,i){var a=[],o=[],u,s;e.forEach((function(e){if((t=e.length-1)<=0)return;var t,n=e[0],r=e[t],s;if(KC(n,r)){if(!n[2]&&!r[2]){i.lineStart();for(u=0;u<t;++u)i.point((n=e[u])[0],n[1]);i.lineEnd();return}r[0]+=2*Jk}a.push(s=new eF(n,e,null,true));o.push(s.o=new eF(n,null,s,false));a.push(s=new eF(r,e,null,false));o.push(s.o=new eF(r,null,s,true))}));if(!a.length)return;o.sort(t);nF(a);nF(o);for(u=0,s=o.length;u<s;++u){o[u].e=n=!n}var l=a[0],f,c;while(1){var d=l,h=true;while(d.v)if((d=d.n)===l)return;f=d.z;i.lineStart();do{d.v=d.o.v=true;if(d.e){if(h){for(u=0,s=f.length;u<s;++u)i.point((c=f[u])[0],c[1])}else{r(d.x,d.n.x,1,i)}d=d.n}else{if(h){f=d.p.z;for(u=f.length-1;u>=0;--u)i.point((c=f[u])[0],c[1])}else{r(d.x,d.p.x,-1,i)}d=d.p}d=d.o;f=d.z;h=!h}while(!d.v);i.lineEnd()}}function nF(e){if(!(t=e.length))return;var t,n=0,r=e[0],i;while(++n<t){r.n=i=e[n];i.p=r;r=i}r.n=i=e[0];i.p=r}function rF(e){return iD(e[0])<=Zk?e[0]:pD(e[0])*((iD(e[0])+Zk)%tD-Zk)}function iF(e,t){var n=rF(t),r=t[1],i=hD(r),a=[hD(n),-uD(n),0],o=0,u=0;var s=new Or;if(i===1)r=Kk+Jk;else if(i===-1)r=-Kk-Jk;for(var l=0,f=e.length;l<f;++l){if(!(d=(c=e[l]).length))continue;var c,d,h=c[d-1],p=rF(h),v=h[1]/2+eD,g=hD(v),m=uD(v);for(var y=0;y<d;++y,p=x,g=w,m=A,h=b){var b=c[y],x=rF(b),_=b[1]/2+eD,w=hD(_),A=uD(_),O=x-p,E=O>=0?1:-1,k=E*O,D=k>Zk,C=g*w;s.add(oD(C*E*hD(k),m*A+C*uD(k)));o+=D?O+E*tD:O;if(D^p>=n^x>=n){var F=qD(ID(h),ID(b));GD(F);var S=qD(a,F);GD(S);var j=(D^O>=0?-1:1)*yD(S[2]);if(r>j||r===j&&(F[0]||F[1])){u+=D^O>=0?1:-1}}}}return(o<-Jk||o<Jk&&s<-Qk)^u&1}function aF(e,t,n,r){return function(i){var a=t(i),o=ZC(),u=t(o),s=false,l,f,c;var d={point:h,lineStart:v,lineEnd:g,polygonStart:function(){d.point=m;d.lineStart=y;d.lineEnd=b;f=[];l=[]},polygonEnd:function(){d.point=h;d.lineStart=v;d.lineEnd=g;f=Jr(f);var e=iF(l,r);if(f.length){if(!s)i.polygonStart(),s=true;tF(f,uF,e,n,i)}else if(e){if(!s)i.polygonStart(),s=true;i.lineStart();n(null,null,1,i);i.lineEnd()}if(s)i.polygonEnd(),s=false;f=l=null},sphere:function(){i.polygonStart();i.lineStart();n(null,null,1,i);i.lineEnd();i.polygonEnd()}};function h(t,n){if(e(t,n))i.point(t,n)}function p(e,t){a.point(e,t)}function v(){d.point=p;a.lineStart()}function g(){d.point=h;a.lineEnd()}function m(e,t){c.push([e,t]);u.point(e,t)}function y(){u.lineStart();c=[]}function b(){m(c[0][0],c[0][1]);u.lineEnd();var e=u.clean(),t=o.result(),n,r=t.length,a,d,h;c.pop();l.push(c);c=null;if(!r)return;if(e&1){d=t[0];if((a=d.length-1)>0){if(!s)i.polygonStart(),s=true;i.lineStart();for(n=0;n<a;++n)i.point((h=d[n])[0],h[1]);i.lineEnd()}return}if(r>1&&e&2)t.push(t.pop().concat(t.shift()));f.push(t.filter(oF))}return d}}function oF(e){return e.length>1}function uF(e,t){return((e=e.x)[0]<0?e[1]-Kk-Jk:Kk-e[1])-((t=t.x)[0]<0?t[1]-Kk-Jk:Kk-t[1])}var sF=aF((function(){return true}),lF,cF,[-Zk,-Kk]);function lF(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart();i=1},point:function(a,o){var u=a>0?Zk:-Zk,s=iD(a-t);if(iD(s-Zk)<Jk){e.point(t,n=(n+o)/2>0?Kk:-Kk);e.point(r,n);e.lineEnd();e.lineStart();e.point(u,n);e.point(a,n);i=0}else if(r!==u&&s>=Zk){if(iD(t-r)<Jk)t-=r*Jk;if(iD(a-u)<Jk)a-=u*Jk;n=fF(t,n,a,o);e.point(r,n);e.lineEnd();e.lineStart();e.point(u,n);i=0}e.point(t=a,n=o);r=u},lineEnd:function(){e.lineEnd();t=n=NaN},clean:function(){return 2-i}}}function fF(e,t,n,r){var i,a,o=hD(e-n);return iD(o)>Jk?aD((hD(t)*(a=uD(r))*hD(n)-hD(r)*(i=uD(t))*hD(e))/(i*a*o)):(t+r)/2}function cF(e,t,n,r){var i;if(e==null){i=n*Kk;r.point(-Zk,i);r.point(0,i);r.point(Zk,i);r.point(Zk,0);r.point(Zk,-i);r.point(0,-i);r.point(-Zk,-i);r.point(-Zk,0);r.point(-Zk,i)}else if(iD(e[0]-t[0])>Jk){var a=e[0]<t[0]?Zk:-Zk;i=n*a/2;r.point(-a,i);r.point(0,i);r.point(a,i)}else{r.point(t[0],t[1])}}function dF(e){var t=uD(e),n=6*rD,r=t>0,i=iD(t)>Jk;function a(t,r,i,a){JC(a,e,n,i,t,r)}function o(e,n){return uD(e)*uD(n)>t}function u(e){var t,n,a,u,f;return{lineStart:function(){u=a=false;f=1},point:function(c,d){var h=[c,d],p,v=o(c,d),g=r?v?0:l(c,d):v?l(c+(c<0?Zk:-Zk),d):0;if(!t&&(u=a=v))e.lineStart();if(v!==a){p=s(t,h);if(!p||KC(t,p)||KC(h,p))h[2]=1}if(v!==a){f=0;if(v){e.lineStart();p=s(h,t);e.point(p[0],p[1])}else{p=s(t,h);e.point(p[0],p[1],2);e.lineEnd()}t=p}else if(i&&t&&r^v){var m;if(!(g&n)&&(m=s(h,t,true))){f=0;if(r){e.lineStart();e.point(m[0][0],m[0][1]);e.point(m[1][0],m[1][1]);e.lineEnd()}else{e.point(m[1][0],m[1][1]);e.lineEnd();e.lineStart();e.point(m[0][0],m[0][1],3)}}}if(v&&(!t||!KC(t,h))){e.point(h[0],h[1])}t=h,a=v,n=g},lineEnd:function(){if(a)e.lineEnd();t=null},clean:function(){return f|(u&&a)<<1}}}function s(e,n,r){var i=ID(e),a=ID(n);var o=[1,0,0],u=qD(i,a),s=UD(u,u),l=u[0],f=s-l*l;if(!f)return!r&&e;var c=t*s/f,d=-t*l/f,h=qD(o,u),p=HD(o,c),v=HD(u,d);WD(p,v);var g=h,m=UD(p,g),y=UD(g,g),b=m*m-y*(UD(p,p)-1);if(b<0)return;var x=vD(b),_=HD(g,(-m-x)/y);WD(_,p);_=LD(_);if(!r)return _;var w=e[0],A=n[0],O=e[1],E=n[1],k;if(A<w)k=w,w=A,A=k;var D=A-w,C=iD(D-Zk)<Jk,F=C||D<Jk;if(!C&&E<O)k=O,O=E,E=k;if(F?C?O+E>0^_[1]<(iD(_[0]-w)<Jk?O:E):O<=_[1]&&_[1]<=E:D>Zk^(w<=_[0]&&_[0]<=A)){var S=HD(g,(-m+x)/y);WD(S,p);return[_,LD(S)]}}function l(t,n){var i=r?e:Zk-e,a=0;if(t<-i)a|=1;else if(t>i)a|=2;if(n<-i)a|=4;else if(n>i)a|=8;return a}return aF(o,u,a,r?[0,-e]:[-Zk,e-Zk])}function hF(e,t,n,r,i,a){var o=e[0],u=e[1],s=t[0],l=t[1],f=0,c=1,d=s-o,h=l-u,p;p=n-o;if(!d&&p>0)return;p/=d;if(d<0){if(p<f)return;if(p<c)c=p}else if(d>0){if(p>c)return;if(p>f)f=p}p=i-o;if(!d&&p<0)return;p/=d;if(d<0){if(p>c)return;if(p>f)f=p}else if(d>0){if(p<f)return;if(p<c)c=p}p=r-u;if(!h&&p>0)return;p/=h;if(h<0){if(p<f)return;if(p<c)c=p}else if(h>0){if(p>c)return;if(p>f)f=p}p=a-u;if(!h&&p<0)return;p/=h;if(h<0){if(p>c)return;if(p>f)f=p}else if(h>0){if(p<f)return;if(p<c)c=p}if(f>0)e[0]=o+f*d,e[1]=u+f*h;if(c<1)t[0]=o+c*d,t[1]=u+c*h;return true}var pF=1e9,vF=-pF;function gF(e,t,n,r){function i(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function a(i,a,u,l){var f=0,c=0;if(i==null||(f=o(i,u))!==(c=o(a,u))||s(i,a)<0^u>0){do{l.point(f===0||f===3?e:n,f>1?r:t)}while((f=(f+u+4)%4)!==c)}else{l.point(a[0],a[1])}}function o(r,i){return iD(r[0]-e)<Jk?i>0?0:3:iD(r[0]-n)<Jk?i>0?2:1:iD(r[1]-t)<Jk?i>0?1:0:i>0?3:2}function u(e,t){return s(e.x,t.x)}function s(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:n===0?t[1]-e[1]:n===1?e[0]-t[0]:n===2?e[1]-t[1]:t[0]-e[0]}return function(o){var s=o,l=ZC(),f,c,d,h,p,v,g,m,y,b,x;var _={point:w,lineStart:k,lineEnd:D,polygonStart:O,polygonEnd:E};function w(e,t){if(i(e,t))s.point(e,t)}function A(){var t=0;for(var n=0,i=c.length;n<i;++n){for(var a=c[n],o=1,u=a.length,s=a[0],l,f,d=s[0],h=s[1];o<u;++o){l=d,f=h,s=a[o],d=s[0],h=s[1];if(f<=r){if(h>r&&(d-l)*(r-f)>(h-f)*(e-l))++t}else{if(h<=r&&(d-l)*(r-f)<(h-f)*(e-l))--t}}}return t}function O(){s=l,f=[],c=[],x=true}function E(){var e=A(),t=x&&e,n=(f=Jr(f)).length;if(t||n){o.polygonStart();if(t){o.lineStart();a(null,null,1,o);o.lineEnd()}if(n){tF(f,u,e,a,o)}o.polygonEnd()}s=o,f=c=d=null}function k(){_.point=C;if(c)c.push(d=[]);b=true;y=false;g=m=NaN}function D(){if(f){C(h,p);if(v&&y)l.rejoin();f.push(l.result())}_.point=w;if(y)s.lineEnd()}function C(a,o){var u=i(a,o);if(c)d.push([a,o]);if(b){h=a,p=o,v=u;b=false;if(u){s.lineStart();s.point(a,o)}}else{if(u&&y)s.point(a,o);else{var l=[g=Math.max(vF,Math.min(pF,g)),m=Math.max(vF,Math.min(pF,m))],f=[a=Math.max(vF,Math.min(pF,a)),o=Math.max(vF,Math.min(pF,o))];if(hF(l,f,e,t,n,r)){if(!y){s.lineStart();s.point(l[0],l[1])}s.point(f[0],f[1]);if(!u)s.lineEnd();x=false}else if(u){s.lineStart();s.point(a,o);x=false}}}g=a,m=o,y=u}return _}}function mF(e,t,n){var r=Qr(e,t-Jk,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function yF(e,t,n){var r=Qr(e,t-Jk,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function bF(){var e,t,n,r,i,a,o,u,s=10,l=s,f=90,c=360,d,h,p,v,g=2.5;function m(){return{type:"MultiLineString",coordinates:y()}}function y(){return Qr(sD(r/f)*f,n,f).map(p).concat(Qr(sD(u/c)*c,o,c).map(v)).concat(Qr(sD(t/s)*s,e,s).filter((function(e){return iD(e%f)>Jk})).map(d)).concat(Qr(sD(a/l)*l,i,l).filter((function(e){return iD(e%c)>Jk})).map(h))}m.lines=function(){return y().map((function(e){return{type:"LineString",coordinates:e}}))};m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(v(o).slice(1),p(n).reverse().slice(1),v(u).reverse().slice(1))]}};m.extent=function(e){if(!arguments.length)return m.extentMinor();return m.extentMajor(e).extentMinor(e)};m.extentMajor=function(e){if(!arguments.length)return[[r,u],[n,o]];r=+e[0][0],n=+e[1][0];u=+e[0][1],o=+e[1][1];if(r>n)e=r,r=n,n=e;if(u>o)e=u,u=o,o=e;return m.precision(g)};m.extentMinor=function(n){if(!arguments.length)return[[t,a],[e,i]];t=+n[0][0],e=+n[1][0];a=+n[0][1],i=+n[1][1];if(t>e)n=t,t=e,e=n;if(a>i)n=a,a=i,i=n;return m.precision(g)};m.step=function(e){if(!arguments.length)return m.stepMinor();return m.stepMajor(e).stepMinor(e)};m.stepMajor=function(e){if(!arguments.length)return[f,c];f=+e[0],c=+e[1];return m};m.stepMinor=function(e){if(!arguments.length)return[s,l];s=+e[0],l=+e[1];return m};m.precision=function(s){if(!arguments.length)return g;g=+s;d=mF(a,i,90);h=yF(t,e,g);p=mF(u,o,90);v=yF(r,n,g);return m};return m.extentMajor([[-180,-90+Jk],[180,90-Jk]]).extentMinor([[-180,-80-Jk],[180,80+Jk]])}var xF=function(e){return e};var _F=new Or,wF=new Or,AF,OF,EF,kF;var DF={point:bD,lineStart:bD,lineEnd:bD,polygonStart:function(){DF.lineStart=CF;DF.lineEnd=jF},polygonEnd:function(){DF.lineStart=DF.lineEnd=DF.point=bD;_F.add(iD(wF));wF=new Or},result:function(){var e=_F/2;_F=new Or;return e}};function CF(){DF.point=FF}function FF(e,t){DF.point=SF;AF=EF=e,OF=kF=t}function SF(e,t){wF.add(kF*e-EF*t);EF=e,kF=t}function jF(){SF(AF,OF)}var MF=Infinity,BF=MF,NF=-MF,TF=NF;var zF={point:PF,lineStart:bD,lineEnd:bD,polygonStart:bD,polygonEnd:bD,result:function(){var e=[[MF,BF],[NF,TF]];NF=TF=-(BF=MF=Infinity);return e}};function PF(e,t){if(e<MF)MF=e;if(e>NF)NF=e;if(t<BF)BF=t;if(t>TF)TF=t}var RF=0,LF=0,IF=0,UF=0,qF=0,WF=0,HF=0,GF=0,$F=0,VF,YF,XF,JF;var QF={point:ZF,lineStart:KF,lineEnd:nS,polygonStart:function(){QF.lineStart=rS;QF.lineEnd=iS},polygonEnd:function(){QF.point=ZF;QF.lineStart=KF;QF.lineEnd=nS},result:function(){var e=$F?[HF/$F,GF/$F]:WF?[UF/WF,qF/WF]:IF?[RF/IF,LF/IF]:[NaN,NaN];RF=LF=IF=UF=qF=WF=HF=GF=$F=0;return e}};function ZF(e,t){RF+=e;LF+=t;++IF}function KF(){QF.point=eS}function eS(e,t){QF.point=tS;ZF(XF=e,JF=t)}function tS(e,t){var n=e-XF,r=t-JF,i=vD(n*n+r*r);UF+=i*(XF+e)/2;qF+=i*(JF+t)/2;WF+=i;ZF(XF=e,JF=t)}function nS(){QF.point=ZF}function rS(){QF.point=aS}function iS(){oS(VF,YF)}function aS(e,t){QF.point=oS;ZF(VF=XF=e,YF=JF=t)}function oS(e,t){var n=e-XF,r=t-JF,i=vD(n*n+r*r);UF+=i*(XF+e)/2;qF+=i*(JF+t)/2;WF+=i;i=JF*e-XF*t;HF+=i*(XF+e);GF+=i*(JF+t);$F+=i*3;ZF(XF=e,JF=t)}function uS(e){this._context=e}uS.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._context.closePath();this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t);this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t);this._context.arc(e,t,this._radius,0,tD);break}}},result:bD};var sS=new Or,lS,fS,cS,dS,hS;var pS={point:bD,lineStart:function(){pS.point=vS},lineEnd:function(){if(lS)gS(fS,cS);pS.point=bD},polygonStart:function(){lS=true},polygonEnd:function(){lS=null},result:function(){var e=+sS;sS=new Or;return e}};function vS(e,t){pS.point=gS;fS=dS=e,cS=hS=t}function gS(e,t){dS-=e,hS-=t;sS.add(vD(dS*dS+hS*hS));dS=e,hS=t}var mS,yS,bS,xS;var _S=function(){function e(e){this._append=e==null?wS:AS(e);this._radius=4.5;this._=""}e.prototype.pointRadius=function(e){this._radius=+e;return this};e.prototype.polygonStart=function(){this._line=0};e.prototype.polygonEnd=function(){this._line=NaN};e.prototype.lineStart=function(){this._point=0};e.prototype.lineEnd=function(){if(this._line===0)this._+="Z";this._point=NaN};e.prototype.point=function(e,t){switch(this._point){case 0:{this._append(__makeTemplateObject(["M",",",""],["M",",",""]),e,t);this._point=1;break}case 1:{this._append(__makeTemplateObject(["L",",",""],["L",",",""]),e,t);break}default:{this._append(__makeTemplateObject(["M",",",""],["M",",",""]),e,t);if(this._radius!==bS||this._append!==yS){var n=this._radius;var r=this._;this._="";this._append(__makeTemplateObject(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"],["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"]),n,n,n,-2*n,n,n,2*n);bS=n;yS=this._append;xS=this._;this._=r}this._+=xS;break}}};e.prototype.result=function(){var e=this._;this._="";return e.length?e:null};return e}();function wS(e){var t=1;this._+=e[0];for(var n=e.length;t<n;++t){this._+=arguments[t]+e[t]}}function AS(e){var t=Math.floor(e);if(!(t>=0))throw new RangeError("invalid digits: ".concat(e));if(t>15)return wS;if(t!==mS){var n=Math.pow(10,t);mS=t;yS=function e(t){var r=1;this._+=t[0];for(var i=t.length;r<i;++r){this._+=Math.round(arguments[r]*n)/n+t[r]}}}return yS}function OS(e,t){var n=3,r=4.5,i,a;function o(e){if(e){if(typeof r==="function")a.pointRadius(+r.apply(this,arguments));ED(e,i(a))}return a.result()}o.area=function(e){ED(e,i(DF));return DF.result()};o.measure=function(e){ED(e,i(pS));return pS.result()};o.bounds=function(e){ED(e,i(zF));return zF.result()};o.centroid=function(e){ED(e,i(QF));return QF.result()};o.projection=function(t){if(!arguments.length)return e;i=t==null?(e=null,xF):(e=t).stream;return o};o.context=function(e){if(!arguments.length)return t;a=e==null?(t=null,new _S(n)):new uS(t=e);if(typeof r!=="function")a.pointRadius(r);return o};o.pointRadius=function(e){if(!arguments.length)return r;r=typeof e==="function"?e:(a.pointRadius(+e),+e);return o};o.digits=function(e){if(!arguments.length)return n;if(e==null)n=null;else{var r=Math.floor(e);if(!(r>=0))throw new RangeError("invalid digits: ".concat(e));n=r}if(t===null)a=new _S(n);return o};return o.projection(e).digits(n).context(t)}function ES(e){return function(t){var n=new kS;for(var r in e)n[r]=e[r];n.stream=t;return n}}function kS(){}kS.prototype={constructor:kS,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function DS(e,t,n){var r=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]);if(r!=null)e.clipExtent(null);ED(n,e.stream(zF));t(zF.result());if(r!=null)e.clipExtent(r);return e}function CS(e,t,n){return DS(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+t[0][0]+(r-a*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([o,u])}),n)}function FS(e,t,n){return CS(e,[[0,0],t],n)}function SS(e,t,n){return DS(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];e.scale(150*i).translate([a,o])}),n)}function jS(e,t,n){return DS(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,o])}),n)}var MS=16,BS=uD(30*rD);function NS(e,t){return+t?zS(e,t):TS(e)}function TS(e){return ES({point:function(t,n){t=e(t,n);this.stream.point(t[0],t[1])}})}function zS(e,t){function n(r,i,a,o,u,s,l,f,c,d,h,p,v,g){var m=l-r,y=f-i,b=m*m+y*y;if(b>4*t&&v--){var x=o+d,_=u+h,w=s+p,A=vD(x*x+_*_+w*w),O=yD(w/=A),E=iD(iD(w)-1)<Jk||iD(a-c)<Jk?(a+c)/2:oD(_,x),k=e(E,O),D=k[0],C=k[1],F=D-r,S=C-i,j=y*F-m*S;if(j*j/b>t||iD((m*F+y*S)/b-.5)>.3||o*d+u*h+s*p<BS){n(r,i,a,o,u,s,D,C,E,x/=A,_/=A,w,v,g);g.point(D,C);n(D,C,E,x,_,w,l,f,c,d,h,p,v,g)}}}return function(t){var r,i,a,o,u,s,l,f,c,d,h,p;var v={point:g,lineStart:m,lineEnd:b,polygonStart:function(){t.polygonStart();v.lineStart=x},polygonEnd:function(){t.polygonEnd();v.lineStart=m}};function g(n,r){n=e(n,r);t.point(n[0],n[1])}function m(){f=NaN;v.point=y;t.lineStart()}function y(r,i){var a=ID([r,i]),o=e(r,i);n(f,c,l,d,h,p,f=o[0],c=o[1],l=r,d=a[0],h=a[1],p=a[2],MS,t);t.point(f,c)}function b(){v.point=g;t.lineEnd()}function x(){m();v.point=_;v.lineEnd=w}function _(e,t){y(r=e,t),i=f,a=c,o=d,u=h,s=p;v.point=y}function w(){n(f,c,l,d,h,p,i,a,r,o,u,s,MS,t);v.lineEnd=b;b()}return v}}var PS=ES({point:function(e,t){this.stream.point(e*rD,t*rD)}});function RS(e){return ES({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function LS(e,t,n,r,i){function a(a,o){a*=r;o*=i;return[t+e*a,n-e*o]}a.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]};return a}function IS(e,t,n,r,i,a){if(!a)return LS(e,t,n,r,i);var o=uD(a),u=hD(a),s=o*e,l=u*e,f=o/e,c=u/e,d=(u*n-o*t)/e,h=(u*t+o*n)/e;function p(e,a){e*=r;a*=i;return[s*e-l*a+t,n-l*e-s*a]}p.invert=function(e,t){return[r*(f*e-c*t+d),i*(h-c*e-f*t)]};return p}function US(e){return qS((function(){return e}))()}function qS(e){var t,n=150,r=480,i=250,a=0,o=0,u=0,s=0,l=0,f,c=0,d=1,h=1,p=null,v=sF,g=null,m,y,b,x=xF,_=.5,w,A,O,E,k;function D(e){return O(e[0]*rD,e[1]*rD)}function C(e){e=O.invert(e[0],e[1]);return e&&[e[0]*nD,e[1]*nD]}D.stream=function(e){return E&&k===e?E:E=PS(RS(f)(v(w(x(k=e)))))};D.preclip=function(e){return arguments.length?(v=e,p=undefined,S()):v};D.postclip=function(e){return arguments.length?(x=e,g=m=y=b=null,S()):x};D.clipAngle=function(e){return arguments.length?(v=+e?dF(p=e*rD):(p=null,sF),S()):p*nD};D.clipExtent=function(e){return arguments.length?(x=e==null?(g=m=y=b=null,xF):gF(g=+e[0][0],m=+e[0][1],y=+e[1][0],b=+e[1][1]),S()):g==null?null:[[g,m],[y,b]]};D.scale=function(e){return arguments.length?(n=+e,F()):n};D.translate=function(e){return arguments.length?(r=+e[0],i=+e[1],F()):[r,i]};D.center=function(e){return arguments.length?(a=e[0]%360*rD,o=e[1]%360*rD,F()):[a*nD,o*nD]};D.rotate=function(e){return arguments.length?(u=e[0]%360*rD,s=e[1]%360*rD,l=e.length>2?e[2]%360*rD:0,F()):[u*nD,s*nD,l*nD]};D.angle=function(e){return arguments.length?(c=e%360*rD,F()):c*nD};D.reflectX=function(e){return arguments.length?(d=e?-1:1,F()):d<0};D.reflectY=function(e){return arguments.length?(h=e?-1:1,F()):h<0};D.precision=function(e){return arguments.length?(w=NS(A,_=e*e),S()):vD(_)};D.fitExtent=function(e,t){return CS(D,e,t)};D.fitSize=function(e,t){return FS(D,e,t)};D.fitWidth=function(e,t){return SS(D,e,t)};D.fitHeight=function(e,t){return jS(D,e,t)};function F(){var e=IS(n,0,0,d,h,c).apply(null,t(a,o)),p=IS(n,r-e[0],i-e[1],d,h,c);f=GC(u,s,l);A=WC(t,p);O=WC(f,A);w=NS(A,_);return S()}function S(){E=k=null;return D}return function(){t=e.apply(this,arguments);D.invert=t.invert&&C;return F()}}function WS(e){var t=0,n=Zk/3,r=qS(e),i=r(t,n);i.parallels=function(e){return arguments.length?r(t=e[0]*rD,n=e[1]*rD):[t*nD,n*nD]};return i}function HS(e){var t=uD(e);function n(e,n){return[e*t,hD(n)/t]}n.invert=function(e,n){return[e/t,yD(n*t)]};return n}function GS(e,t){var n=hD(e),r=(n+hD(t))/2;if(iD(r)<Jk)return HS(e);var i=1+n*(2*r-n),a=vD(i)/r;function o(e,t){var n=vD(i-2*r*hD(t))/r;return[n*hD(e*=r),a-n*uD(e)]}o.invert=function(e,t){var n=a-t,o=oD(e,iD(n))*pD(n);if(n*r<0)o-=Zk*pD(e)*pD(n);return[o/r,yD((i-(e*e+n*n)*r*r)/(2*r))]};return o}function $S(){return WS(GS).scale(155.424).center([0,33.6442])}function VS(){return $S().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function YS(e){var t=e.length;return{point:function(n,r){var i=-1;while(++i<t)e[i].point(n,r)},sphere:function(){var n=-1;while(++n<t)e[n].sphere()},lineStart:function(){var n=-1;while(++n<t)e[n].lineStart()},lineEnd:function(){var n=-1;while(++n<t)e[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<t)e[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<t)e[n].polygonEnd()}}}function XS(){var e,t,n=VS(),r,i=$S().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=$S().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,s,l={point:function(e,t){s=[e,t]}};function f(e){var t=e[0],n=e[1];return s=null,(r.point(t,n),s)||(a.point(t,n),s)||(u.point(t,n),s)}f.invert=function(e){var t=n.scale(),r=n.translate(),a=(e[0]-r[0])/t,u=(e[1]-r[1])/t;return(u>=.12&&u<.234&&a>=-.425&&a<-.214?i:u>=.166&&u<.234&&a>=-.214&&a<-.115?o:n).invert(e)};f.stream=function(r){return e&&t===r?e:e=YS([n.stream(t=r),i.stream(r),o.stream(r)])};f.precision=function(e){if(!arguments.length)return n.precision();n.precision(e),i.precision(e),o.precision(e);return c()};f.scale=function(e){if(!arguments.length)return n.scale();n.scale(e),i.scale(e*.35),o.scale(e);return f.translate(n.translate())};f.translate=function(e){if(!arguments.length)return n.translate();var t=n.scale(),s=+e[0],f=+e[1];r=n.translate(e).clipExtent([[s-.455*t,f-.238*t],[s+.455*t,f+.238*t]]).stream(l);a=i.translate([s-.307*t,f+.201*t]).clipExtent([[s-.425*t+Jk,f+.12*t+Jk],[s-.214*t-Jk,f+.234*t-Jk]]).stream(l);u=o.translate([s-.205*t,f+.212*t]).clipExtent([[s-.214*t+Jk,f+.166*t+Jk],[s-.115*t-Jk,f+.234*t-Jk]]).stream(l);return c()};f.fitExtent=function(e,t){return CS(f,e,t)};f.fitSize=function(e,t){return FS(f,e,t)};f.fitWidth=function(e,t){return SS(f,e,t)};f.fitHeight=function(e,t){return jS(f,e,t)};function c(){e=t=null;return f}return f.scale(1070)}function JS(e){return function(t,n){var r=uD(t),i=uD(n),a=e(r*i);if(a===Infinity)return[2,0];return[a*i*hD(t),a*hD(n)]}}function QS(e){return function(t,n){var r=vD(t*t+n*n),i=e(r),a=hD(i),o=uD(i);return[oD(t*a,r*o),yD(r&&n*a/r)]}}var ZS=JS((function(e){return vD(2/(1+e))}));ZS.invert=QS((function(e){return 2*yD(e/2)}));function KS(){return US(ZS).scale(124.75).clipAngle(180-.001)}var ej=JS((function(e){return(e=mD(e))&&e/hD(e)}));ej.invert=QS((function(e){return e}));function tj(){return US(ej).scale(79.4188).clipAngle(180-.001)}function nj(e,t){return[e,cD(gD((Kk+t)/2))]}nj.invert=function(e,t){return[e,2*aD(lD(t))-Kk]};function rj(){return ij(nj).scale(961/tD)}function ij(e){var t=US(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,u,s,l;t.scale=function(e){return arguments.length?(r(e),f()):r()};t.translate=function(e){return arguments.length?(i(e),f()):i()};t.center=function(e){return arguments.length?(n(e),f()):n()};t.clipExtent=function(e){return arguments.length?(e==null?o=u=s=l=null:(o=+e[0][0],u=+e[0][1],s=+e[1][0],l=+e[1][1]),f()):o==null?null:[[o,u],[s,l]]};function f(){var n=Zk*r(),i=t(XC(t.rotate()).invert([0,0]));return a(o==null?[[i[0]-n,i[1]-n],[i[0]+n,i[1]+n]]:e===nj?[[Math.max(i[0]-n,o),u],[Math.min(i[0]+n,s),l]]:[[o,Math.max(i[1]-n,u)],[s,Math.min(i[1]+n,l)]])}return f()}function aj(e){return gD((Kk+e)/2)}function oj(e,t){var n=uD(e),r=e===t?hD(e):cD(n/uD(t))/cD(aj(t)/aj(e)),i=n*dD(aj(e),r)/r;if(!r)return nj;function a(e,t){if(i>0){if(t<-Kk+Jk)t=-Kk+Jk}else{if(t>Kk-Jk)t=Kk-Jk}var n=i/dD(aj(t),r);return[n*hD(r*e),i-n*uD(r*e)]}a.invert=function(e,t){var n=i-t,a=pD(r)*vD(e*e+n*n),o=oD(e,iD(n))*pD(n);if(n*r<0)o-=Zk*pD(e)*pD(n);return[o/r,2*aD(dD(i/a,1/r))-Kk]};return a}function uj(){return WS(oj).scale(109.5).parallels([30,30])}function sj(e,t){return[e,t]}sj.invert=sj;function lj(){return US(sj).scale(152.63)}function fj(e,t){var n=uD(e),r=e===t?hD(e):(n-uD(t))/(t-e),i=n/r+e;if(iD(r)<Jk)return sj;function a(e,t){var n=i-t,a=r*e;return[n*hD(a),i-n*uD(a)]}a.invert=function(e,t){var n=i-t,a=oD(e,iD(n))*pD(n);if(n*r<0)a-=Zk*pD(e)*pD(n);return[a/r,i-pD(r)*vD(e*e+n*n)]};return a}function cj(){return WS(fj).scale(131.154).center([0,13.9389])}var dj=1.340264,hj=-.081106,pj=893e-6,vj=.003796,gj=vD(3)/2,mj=12;function yj(e,t){var n=yD(gj*hD(t)),r=n*n,i=r*r*r;return[e*uD(n)/(gj*(dj+3*hj*r+i*(7*pj+9*vj*r))),n*(dj+hj*r+i*(pj+vj*r))]}yj.invert=function(e,t){var n=t,r=n*n,i=r*r*r;for(var a=0,o,u,s;a<mj;++a){u=n*(dj+hj*r+i*(pj+vj*r))-t;s=dj+3*hj*r+i*(7*pj+9*vj*r);n-=o=u/s,r=n*n,i=r*r*r;if(iD(o)<Qk)break}return[gj*e*(dj+3*hj*r+i*(7*pj+9*vj*r))/uD(n),yD(hD(n)/gj)]};function bj(){return US(yj).scale(177.158)}function xj(e,t){var n=uD(t),r=uD(e)*n;return[n*hD(e)/r,hD(t)/r]}xj.invert=QS(aD);function _j(){return US(xj).scale(144.049).clipAngle(60)}function wj(){var e=1,t=0,n=0,r=1,i=1,a=0,o,u,s=null,l,f,c,d=1,h=1,p=ES({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),v=xF,g,m;function y(){d=e*r;h=e*i;g=m=null;return b}function b(e){var r=e[0]*d,i=e[1]*h;if(a){var s=i*o-r*u;r=r*o+i*u;i=s}return[r+t,i+n]}b.invert=function(e){var r=e[0]-t,i=e[1]-n;if(a){var s=i*o+r*u;r=r*o-i*u;i=s}return[r/d,i/h]};b.stream=function(e){return g&&m===e?g:g=p(v(m=e))};b.postclip=function(e){return arguments.length?(v=e,s=l=f=c=null,y()):v};b.clipExtent=function(e){return arguments.length?(v=e==null?(s=l=f=c=null,xF):gF(s=+e[0][0],l=+e[0][1],f=+e[1][0],c=+e[1][1]),y()):s==null?null:[[s,l],[f,c]]};b.scale=function(t){return arguments.length?(e=+t,y()):e};b.translate=function(e){return arguments.length?(t=+e[0],n=+e[1],y()):[t,n]};b.angle=function(e){return arguments.length?(a=e%360*rD,u=hD(a),o=uD(a),y()):a*nD};b.reflectX=function(e){return arguments.length?(r=e?-1:1,y()):r<0};b.reflectY=function(e){return arguments.length?(i=e?-1:1,y()):i<0};b.fitExtent=function(e,t){return CS(b,e,t)};b.fitSize=function(e,t){return FS(b,e,t)};b.fitWidth=function(e,t){return SS(b,e,t)};b.fitHeight=function(e,t){return jS(b,e,t)};return b}function Aj(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Aj.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(iD(i)>Jk&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function Oj(){return US(Aj).scale(175.295)}function Ej(e,t){return[uD(t)*hD(e),hD(t)]}Ej.invert=QS(yD);function kj(){return US(Ej).scale(249.5).clipAngle(90+Jk)}function Dj(e,t){var n=uD(t),r=1+uD(e)*n;return[n*hD(e)/r,hD(t)/r]}Dj.invert=QS((function(e){return 2*aD(e)}));function Cj(){return US(Dj).scale(250).clipAngle(142)}function Fj(e,t){return[cD(gD((Kk+t)/2)),-e]}Fj.invert=function(e,t){return[-t,2*aD(lD(e))-Kk]};function Sj(){var e=ij(Fj),t=e.center,n=e.rotate;e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])};return n([0,0,90]).scale(159.155)}var jj=Math.abs;var Mj=Math.cos;var Bj=Math.sin;var Nj=1e-6;var Tj=Math.PI;var zj=Tj/2;var Pj=Lj(2);function Rj(e){return e>1?zj:e<-1?-zj:Math.asin(e)}function Lj(e){return e>0?Math.sqrt(e):0}function Ij(e,t){var n=e*Bj(t),r=30,i;do{t-=i=(t+Bj(t)-n)/(1+Mj(t))}while(jj(i)>Nj&&--r>0);return t/2}function Uj(e,t,n){function r(r,i){return[e*r*Mj(i=Ij(n,i)),t*Bj(i)]}r.invert=function(r,i){return i=Rj(i/t),[r/(e*Mj(i)),Rj((2*i+Bj(2*i))/n)]};return r}var qj=Uj(Pj/zj,Pj,Tj);function Wj(){return US(qj).scale(169.529)}var Hj=OS();var Gj=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function $j(e,t){return function n(){var r=t();r.type=e;r.path=OS().projection(r);r.copy=r.copy||function(){var e=n();Gj.forEach((function(t){if(r[t])e[t](r[t]())}));e.path.pointRadius(r.path.pointRadius());return e};return Yg(r)}}function Vj(e,t){if(!e||typeof e!=="string"){throw new Error("Projection type must be a name string.")}e=e.toLowerCase();if(arguments.length>1){Xj[e]=$j(e,t);return this}else{return Xj[e]||null}}function Yj(e){return e&&e.path||Hj}var Xj={albers:VS,albersusa:XS,azimuthalequalarea:KS,azimuthalequidistant:tj,conicconformal:uj,conicequalarea:$S,conicequidistant:cj,equalEarth:bj,equirectangular:lj,gnomonic:_j,identity:wj,mercator:rj,mollweide:Wj,naturalEarth1:Oj,orthographic:kj,stereographic:Cj,transversemercator:Sj};for(var Jj in Xj){Vj(Jj,Xj[Jj])}function Qj(){}var Zj=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Kj(){var e=1,t=1,n=u;function r(e,t){return t.map((function(t){return i(e,t)}))}function i(e,t){var r=[],i=[];a(e,t,(function(a){n(a,e,t);if(eM(a)>0)r.push([a]);else i.push(a)}));i.forEach((function(e){for(var t=0,n=r.length,i;t<n;++t){if(tM((i=r[t])[0],e)!==-1){i.push(e);return}}}));return{type:"MultiPolygon",value:t,coordinates:r}}function a(n,r,i){var a=new Array,u=new Array,s,l,f,c,d,h;s=l=-1;c=n[0]>=r;Zj[c<<1].forEach(p);while(++s<e-1){f=c,c=n[s+1]>=r;Zj[f|c<<1].forEach(p)}Zj[c<<0].forEach(p);while(++l<t-1){s=-1;c=n[l*e+e]>=r;d=n[l*e]>=r;Zj[c<<1|d<<2].forEach(p);while(++s<e-1){f=c,c=n[l*e+e+s+1]>=r;h=d,d=n[l*e+s+1]>=r;Zj[f|c<<1|d<<2|h<<3].forEach(p)}Zj[c|d<<3].forEach(p)}s=-1;d=n[l*e]>=r;Zj[d<<2].forEach(p);while(++s<e-1){h=d,d=n[l*e+s+1]>=r;Zj[d<<2|h<<3].forEach(p)}Zj[d<<3].forEach(p);function p(e){var t=[e[0][0]+s,e[0][1]+l],n=[e[1][0]+s,e[1][1]+l],r=o(t),f=o(n),c,d;if(c=u[r]){if(d=a[f]){delete u[c.end];delete a[d.start];if(c===d){c.ring.push(n);i(c.ring)}else{a[c.start]=u[d.end]={start:c.start,end:d.end,ring:c.ring.concat(d.ring)}}}else{delete u[c.end];c.ring.push(n);u[c.end=f]=c}}else if(c=a[f]){if(d=u[r]){delete a[c.start];delete u[d.end];if(c===d){c.ring.push(n);i(c.ring)}else{a[d.start]=u[c.end]={start:d.start,end:c.end,ring:d.ring.concat(c.ring)}}}else{delete a[c.start];c.ring.unshift(t);a[c.start=r]=c}}else{a[r]=u[f]={start:r,end:f,ring:[t,n]}}}}function o(t){return t[0]*2+t[1]*(e+1)*4}function u(n,r,i){n.forEach((function(n){var a=n[0],o=n[1],u=a|0,s=o|0,l,f=r[s*e+u];if(a>0&&a<e&&u===a){l=r[s*e+u-1];n[0]=a+(i-l)/(f-l)-.5}if(o>0&&o<t&&s===o){l=r[(s-1)*e+u];n[1]=o+(i-l)/(f-l)-.5}}))}r.contour=i;r.size=function(n){if(!arguments.length)return[e,t];var i=Math.floor(n[0]),a=Math.floor(n[1]);if(!(i>=0&&a>=0))pt("invalid size");return e=i,t=a,r};r.smooth=function(e){return arguments.length?(n=e?u:Qj,r):n===u};return r}function eM(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];while(++t<n)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function tM(e,t){var n=-1,r=t.length,i;while(++n<r)if(i=nM(e,t[n]))return i;return 0}function nM(e,t){var n=t[0],r=t[1],i=-1;for(var a=0,o=e.length,u=o-1;a<o;u=a++){var s=e[a],l=s[0],f=s[1],c=e[u],d=c[0],h=c[1];if(rM(s,c,t))return 0;if(f>r!==h>r&&n<(d-l)*(r-f)/(h-f)+l)i=-i}return i}function rM(e,t,n){var r;return iM(e,t,n)&&aM(e[r=+(e[0]===t[0])],n[r],t[r])}function iM(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function aM(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function oM(e,t,n){return function(r){var i=pn(r),a=n?Math.min(i[0],0):i[0],o=i[1],u=o-a,s=t?Ir(a,o,e):u/(e+1);return Qr(a+s,o,s)}}function uM(e){df.call(this,null,e)}uM.Definition={type:"Isocontour",metadata:{generates:true},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:true},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:false},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:true},{name:"smooth",type:"boolean",default:true},{name:"scale",type:"number",expr:true},{name:"translate",type:"number",array:true,expr:true},{name:"as",type:"string",null:true,default:"contour"}]};_n(uM,df,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||yt,a=Kj().smooth(e.smooth!==false),o=e.thresholds||sM(r,i,e),u=e.as===null?null:e.as||"contour",s=[];r.forEach((function(t){var n=i(t);var r=a.size([n.width,n.height])(n.values,St(o)?o:o(n.values));lM(r,n,t,e);r.forEach((function(e){var n;s.push(el(t,Zs(u!=null?(n={},n[u]=e,n):e)))}))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n}});function sM(e,t,n){var r=oM(n.levels||10,n.nice,n.zero!==false);return n.resolve!=="shared"?r:r(e.map((function(e){return Ur(t(e).values)})))}function lM(e,t,n,r){var i=r.scale||t.scale,a=r.translate||t.translate;if(rn(i))i=i(n,r);if(rn(a))a=a(n,r);if((i===1||i==null)&&!a)return;var o=(kn(i)?i:i[0])||1,u=(kn(i)?i:i[1])||1,s=a&&a[0]||0,l=a&&a[1]||0;e.forEach(fM(t,o,u,s,l))}function fM(e,t,n,r,i){var a=e.x1||0,o=e.y1||0,u=t*n<0;function s(e){e.forEach(l)}function l(e){if(u)e.reverse();e.forEach(f)}function f(e){e[0]=(e[0]-a)*t+r;e[1]=(e[1]-o)*n+i}return function(e){e.coordinates.forEach(s);return e}}function cM(e,t,n){var r=e>=0?e:bf(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function dM(e){return rn(e)?e:cn(+e)}function hM(){var e=function(e){return e[0]},t=function(e){return e[1]},n=xt,r=[-1,-1],i=960,a=500,o=2;function u(u,s){var l=cM(r[0],u,e)>>o,f=cM(r[1],u,t)>>o,c=l?l+2:0,d=f?f+2:0,h=2*c+(i>>o),p=2*d+(a>>o),v=new Float32Array(h*p),g=new Float32Array(h*p);var m=v;u.forEach((function(r){var i=c+(+e(r)>>o),a=d+(+t(r)>>o);if(i>=0&&i<h&&a>=0&&a<p){v[i+a*h]+=+n(r)}}));if(l>0&&f>0){pM(h,p,v,g,l);vM(h,p,g,v,f);pM(h,p,v,g,l);vM(h,p,g,v,f);pM(h,p,v,g,l);vM(h,p,g,v,f)}else if(l>0){pM(h,p,v,g,l);pM(h,p,g,v,l);pM(h,p,v,g,l);m=g}else if(f>0){vM(h,p,v,g,f);vM(h,p,g,v,f);vM(h,p,v,g,f);m=g}var y=s?Math.pow(2,-2*o):1/Zr(m);for(var b=0,x=h*p;b<x;++b)m[b]*=y;return{values:m,scale:1<<o,width:h,height:p,x1:c,y1:d,x2:c+(i>>o),y2:d+(a>>o)}}u.x=function(t){return arguments.length?(e=dM(t),u):e};u.y=function(e){return arguments.length?(t=dM(e),u):t};u.weight=function(e){return arguments.length?(n=dM(e),u):n};u.size=function(e){if(!arguments.length)return[i,a];var t=+e[0],n=+e[1];if(!(t>=0&&n>=0))pt("invalid size");return i=t,a=n,u};u.cellSize=function(e){if(!arguments.length)return 1<<o;if(!((e=+e)>=1))pt("invalid cell size");o=Math.floor(Math.log(e)/Math.LN2);return u};u.bandwidth=function(e){if(!arguments.length)return r;e=tn(e);if(e.length===1)e=[+e[0],+e[0]];if(e.length!==2)pt("invalid bandwidth");return r=e,u};return u}function pM(e,t,n,r,i){var a=(i<<1)+1;for(var o=0;o<t;++o){for(var u=0,s=0;u<e+i;++u){if(u<e){s+=n[u+o*e]}if(u>=i){if(u>=a){s-=n[u-a+o*e]}r[u-i+o*e]=s/Math.min(u+1,e-1+a-u,a)}}}}function vM(e,t,n,r,i){var a=(i<<1)+1;for(var o=0;o<e;++o){for(var u=0,s=0;u<t+i;++u){if(u<t){s+=n[o+u*e]}if(u>=i){if(u>=a){s-=n[o+(u-a)*e]}r[o+(u-i)*e]=s/Math.min(u+1,t-1+a-u,a)}}}}function gM(e){df.call(this,null,e)}gM.Definition={type:"KDE2D",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"weight",type:"field"},{name:"groupby",type:"field",array:true},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:true,length:2},{name:"counts",type:"boolean",default:false},{name:"as",type:"string",default:"grid"}]};var mM=["x","y","weight","size","cellSize","bandwidth"];function yM(e,t){mM.forEach((function(n){return t[n]!=null?e[n](t[n]):0}));return e}_n(gM,df,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=bM(r,e.groupby),a=(e.groupby||[]).map(lt),o=yM(hM(),e),u=e.as||"grid",s=[];function l(e,t){for(var n=0;n<a.length;++n)e[a[n]]=t[n];return e}s=i.map((function(t){var n;return Zs(l((n={},n[u]=o(t,e.counts),n),t.dims))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n}});function bM(e,t){var n=[],r=function(e){return e(u)},i,a,o,u,s,l;if(t==null){n.push(e)}else{for(i={},a=0,o=e.length;a<o;++a){u=e[a];s=t.map(r);l=i[s];if(!l){i[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function xM(e){df.call(this,null,e)}xM.Definition={type:"Contour",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"values",type:"number",array:true},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:false},{name:"thresholds",type:"number",array:true},{name:"smooth",type:"boolean",default:true}]};_n(xM,df,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Kj().smooth(e.smooth!==false),i=e.values,a=e.thresholds||oM(e.count||10,e.nice,!!i),o=e.size,u,s;if(!i){i=t.materialize(t.SOURCE).source;u=yM(hM(),e)(i,true);s=fM(u,u.scale||1,u.scale||1,0,0);o=[u.width,u.height];i=u.values}a=St(a)?a:a(i);i=r.size(o)(i,a);if(s)i.forEach(s);if(this.value)n.rem=this.value;this.value=n.source=n.add=(i||[]).map(Zs);return n}});var _M="Feature";var wM="FeatureCollection";var AM="MultiPoint";function OM(e){df.call(this,null,e)}OM.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:true,length:2},{name:"geojson",type:"field"}]};_n(OM,df,{transform:function(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],u=e.geojson||!i&&yt,s=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(ft(u))||a&&t.modified(ft(a))||o&&t.modified(ft(o));if(!this.value||l){s=t.SOURCE;this._features=n=[];this._points=r=[]}if(u){t.visit(s,(function(e){return n.push(u(e))}))}if(a&&o){t.visit(s,(function(e){var t=a(e),n=o(e);if(t!=null&&n!=null&&(t=+t)===t&&(n=+n)===n){r.push([t,n])}}));n=n.concat({type:_M,geometry:{type:AM,coordinates:r}})}this.value={type:wM,features:n}}});function EM(e){df.call(this,null,e)}EM.Definition={type:"GeoPath",metadata:{modifies:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"path"}]};_n(EM,df,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||yt,a=e.as||"path",o=n.SOURCE;if(!r||e.modified()){this.value=r=Yj(e.projection);n.materialize().reflow()}else{o=i===yt||t.modified(i.fields)?n.ADD_MOD:n.ADD}var u=kM(r,e.pointRadius);n.visit(o,(function(e){return e[a]=r(i(e))}));r.pointRadius(u);return n.modifies(a)}});function kM(e,t){var n=e.pointRadius();e.context(null);if(t!=null){e.pointRadius(t)}return n}function DM(e){df.call(this,null,e)}DM.Definition={type:"GeoPoint",metadata:{modifies:true},params:[{name:"projection",type:"projection",required:true},{name:"fields",type:"field",array:true,required:true,length:2},{name:"as",type:"string",array:true,length:2,default:["x","y"]}]};_n(DM,df,{transform:function(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],u=a[1],s;function l(e){var t=n([r(e),i(e)]);if(t){e[o]=t[0];e[u]=t[1]}else{e[o]=undefined;e[u]=undefined}}if(e.modified()){t=t.materialize().reflow(true).visit(t.SOURCE,l)}else{s=t.modified(r.fields)||t.modified(i.fields);t.visit(s?t.ADD_MOD:t.ADD,l)}return t.modifies(a)}});function CM(e){df.call(this,null,e)}CM.Definition={type:"GeoShape",metadata:{modifies:true,nomod:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"shape"}]};_n(CM,df,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;if(!r||e.modified()){this.value=r=FM(Yj(e.projection),e.field||gt("datum"),e.pointRadius);n.materialize().reflow();a=n.SOURCE}n.visit(a,(function(e){return e[i]=r}));return n.modifies(i)}});function FM(e,t,n){var r=n==null?function(n){return e(t(n))}:function(r){var i=e.pointRadius(),a=e.pointRadius(n)(t(r));e.pointRadius(i);return a};r.context=function(t){e.context(t);return r};return r}function SM(e){df.call(this,[],e);this.generator=bF()}SM.Definition={type:"Graticule",metadata:{changes:true,generates:true},params:[{name:"extent",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMajor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMinor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"step",type:"number",array:true,length:2},{name:"stepMajor",type:"number",array:true,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:true,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};_n(SM,df,{transform:function(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified()){for(var a in e){if(rn(r[a])){r[a](e[a])}}}i=r();if(n.length){t.mod.push(tl(n[0],i))}else{t.add.push(Zs(i))}n[0]=i;return t}});function jM(e){df.call(this,null,e)}jM.Definition={type:"heatmap",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:true},{name:"opacity",type:"number",expr:true},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};_n(jM,df,{transform:function(e,t){if(!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||yt,a=BM(e.opacity,e),o=MM(e.color,e),u=e.as||"image",s={$x:0,$y:0,$value:0,$max:r?Ur(n.map((function(e){return Ur(i(e).values)}))):0};n.forEach((function(e){var t=i(e);var n=hn({},e,s);if(!r)n.$max=Ur(t.values||[]);e[u]=TM(t,n,o.dep?o:cn(o(n)),a.dep?a:cn(a(n)))}));return t.reflow(true).modifies(u)}});function MM(e,t){var n;if(rn(e)){n=function(n){return te(e(n,t))};n.dep=NM(e)}else{n=cn(te(e||"#888"))}return n}function BM(e,t){var n;if(rn(e)){n=function(n){return e(n,t)};n.dep=NM(e)}else if(e){n=cn(e)}else{n=function(e){return e.$value/e.$max||0};n.dep=true}return n}function NM(e){if(!rn(e))return false;var t=qn(ft(e));return t.$x||t.$y||t.$value||t.$max}function TM(e,t,n,r){var i=e.width,a=e.height,o=e.x1||0,u=e.y1||0,s=e.x2||i,l=e.y2||a,f=e.values,c=f?function(e){return f[e]}:bt,d=ip(s-o,l-u),h=d.getContext("2d"),p=h.getImageData(0,0,s-o,l-u),v=p.data;for(var g=u,m=0;g<l;++g){t.$y=g-u;for(var y=o,b=g*i;y<s;++y,m+=4){t.$x=y-o;t.$value=c(y+b);var x=n(t);v[m+0]=x.r;v[m+1]=x.g;v[m+2]=x.b;v[m+3]=~~(255*r(t))}}h.putImageData(p,0,0);return d}function zM(e){df.call(this,null,e);this.modified(true)}_n(zM,df,{transform:function(e,t){var n=this.value;if(!n||e.modified("type")){this.value=n=RM(e.type);Gj.forEach((function(t){if(e[t]!=null)LM(n,t,e[t])}))}else{Gj.forEach((function(t){if(e.modified(t))LM(n,t,e[t])}))}if(e.pointRadius!=null)n.path.pointRadius(e.pointRadius);if(e.fit)PM(n,e);return t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function PM(e,t){var n=IM(t.fit);t.extent?e.fitExtent(t.extent,n):t.size?e.fitSize(t.size,n):0}function RM(e){var t=Vj((e||"mercator").toLowerCase());if(!t)pt("Unrecognized projection type: "+e);return t()}function LM(e,t,n){if(rn(e[t]))e[t](n)}function IM(e){e=tn(e);return e.length===1?e[0]:{type:wM,features:e.reduce((function(e,t){return e.concat(UM(t))}),[])}}function UM(e){return e.type===wM?e.features:tn(e).filter((function(e){return e!=null})).map((function(e){return e.type===_M?e:{type:_M,geometry:e}}))}var qM=Object.freeze({__proto__:null,contour:xM,geojson:OM,geopath:EM,geopoint:DM,geoshape:CM,graticule:SM,heatmap:jM,isocontour:uM,kde2d:gM,projection:zM});function WM(e,t,n){var r=new re,i=t;if(t==null)return r.restart(e,t,n),r;r._restart=r.restart;r.restart=function(e,t,n){t=+t,n=n==null?ne():+n;r._restart((function a(o){o+=i;r._restart(a,i+=t,n);e(o)}),t,n)};r.restart(e,t,n);return r}var HM={center:ae,collide:oe,nbody:ue,link:se,x:le,y:fe};var GM="forces",$M=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],VM=["static","iterations"],YM=["x","y","vx","vy"];function XM(e){df.call(this,null,e)}XM.Definition={type:"Force",metadata:{modifies:true},params:[{name:"static",type:"boolean",default:false},{name:"restart",type:"boolean",default:false},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:true,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:true},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:true},{name:"strength",type:"number",expr:true},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:true,modify:false,default:YM}]};_n(XM,df,{transform:function(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified($M),a=e.iterations||300;if(!n){this.value=n=QM(t.source,e);n.on("tick",JM(t.dataflow,this));if(!e.static){r=true;n.tick()}t.modifies("index")}else{if(r){t.modifies("index");n.nodes(t.source)}if(i||t.changed(t.MOD)){ZM(n,e,0,t)}}if(i||r||e.modified(VM)||t.changed()&&e.restart){n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a));if(e.static){for(n.stop();--a>=0;)n.tick()}else{if(n.stopped())n.restart();if(!r)return t.StopPropagation}}return this.finish(e,t)},finish:function(e,t){var n=t.dataflow;for(var r=this._argops,i=0,a=r.length,o=void 0;i<a;++i){o=r[i];if(o.name!==GM||o.op._argval.force!=="link"){continue}for(var u=o.op._argops,s=0,l=u.length,f;s<l;++s){if(u[s].name==="links"&&(f=u[s].op.source)){n.pulse(f,n.changeset().reflow());break}}}return t.reflow(e.modified()).modifies(YM)}});function JM(e,t){return function(){return e.touch(t).run()}}function QM(e,t){var n=ie(e),r=n.stop,i=n.restart;var a=false;n.stopped=function(){return a};n.restart=function(){return a=false,i()};n.stop=function(){return a=true,r()};return ZM(n,t,true).on("end",(function(){return a=true}))}function ZM(e,t,n,r){var i=tn(t.forces),a,o,u,s;for(a=0,o=$M.length;a<o;++a){u=$M[a];if(u!==GM&&t.modified(u))e[u](t[u])}for(a=0,o=i.length;a<o;++a){s=GM+a;u=n||t.modified(GM,a)?eB(i[a]):r&&KM(i[a],r)?e.force(s):null;if(u)e.force(s,u)}for(o=e.numForces||0;a<o;++a){e.force(GM+a,null)}e.numForces=i.length;return e}function KM(e,t){var n,r;for(n in e){if(rn(r=e[n])&&t.modified(ft(r)))return 1}return 0}function eB(e){var t,n;if(!mn(HM,e.force)){pt("Unrecognized force: "+e.force)}t=HM[e.force]();for(n in e){if(rn(t[n]))tB(t[n],e[n],e)}return t}function tB(e,t,n){e(rn(t)?function(e){return t(e,n)}:t)}var nB=Object.freeze({__proto__:null,force:XM});function rB(e,t){return e.parent===t.parent?1:2}function iB(e){return e.reduce(aB,0)/e.length}function aB(e,t){return e+t.x}function oB(e){return 1+e.reduce(uB,0)}function uB(e,t){return Math.max(e,t.y)}function sB(e){var t;while(t=e.children)e=t[0];return e}function lB(e){var t;while(t=e.children)e=t[t.length-1];return e}function fB(){var e=rB,t=1,n=1,r=false;function i(i){var a,o=0;i.eachAfter((function(t){var n=t.children;if(n){t.x=iB(n);t.y=oB(n)}else{t.x=a?o+=e(t,a):0;t.y=0;a=t}}));var u=sB(i),s=lB(i),l=u.x-e(u,s)/2,f=s.x+e(s,u)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t;e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-l)/(f-l)*t;e.y=(1-(i.y?e.y/i.y:1))*n})}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i}function cB(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else while(--r>=0)t+=n[r].value;e.value=t}function dB(){return this.eachAfter(cB)}function hB(e,t){var n=-1;for(var r=0,i=this;r<i.length;r++){var a=i[r];e.call(t,a,++n,this)}return this}function pB(e,t){var n=this,r=[n],i,a,o=-1;while(n=r.pop()){e.call(t,n,++o,this);if(i=n.children){for(a=i.length-1;a>=0;--a){r.push(i[a])}}}return this}function vB(e,t){var n=this,r=[n],i=[],a,o,u,s=-1;while(n=r.pop()){i.push(n);if(a=n.children){for(o=0,u=a.length;o<u;++o){r.push(a[o])}}}while(n=i.pop()){e.call(t,n,++s,this)}return this}function gB(e,t){var n=-1;for(var r=0,i=this;r<i.length;r++){var a=i[r];if(e.call(t,a,++n,this)){return a}}}function mB(e){return this.eachAfter((function(t){var n=+e(t.data)||0,r=t.children,i=r&&r.length;while(--i>=0)n+=r[i].value;t.value=n}))}function yB(e){return this.eachBefore((function(t){if(t.children){t.children.sort(e)}}))}function bB(e){var t=this,n=xB(t,e),r=[t];while(t!==n){t=t.parent;r.push(t)}var i=r.length;while(e!==n){r.splice(i,0,e);e=e.parent}return r}function xB(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop();t=r.pop();while(e===t){i=e;e=n.pop();t=r.pop()}return i}function _B(){var e=this,t=[e];while(e=e.parent){t.push(e)}return t}function wB(){return Array.from(this)}function AB(){var e=[];this.eachBefore((function(t){if(!t.children){e.push(t)}}));return e}function OB(){var e=this,t=[];e.each((function(n){if(n!==e){t.push({source:n.parent,target:n})}}));return t}function EB(){var e,t,n,r,i,a;return __generator(this,(function(o){switch(o.label){case 0:e=this,n=[e];o.label=1;case 1:t=n.reverse(),n=[];o.label=2;case 2:if(!(e=t.pop()))return[3,4];return[4,e];case 3:o.sent();if(r=e.children){for(i=0,a=r.length;i<a;++i){n.push(r[i])}}return[3,2];case 4:if(n.length)return[3,1];o.label=5;case 5:return[2]}}))}function kB(e,t){if(e instanceof Map){e=[undefined,e];if(t===undefined)t=FB}else if(t===undefined){t=CB}var n=new MB(e),r,i=[n],a,o,u,s;while(r=i.pop()){if((o=t(r.data))&&(s=(o=Array.from(o)).length)){r.children=o;for(u=s-1;u>=0;--u){i.push(a=o[u]=new MB(o[u]));a.parent=r;a.depth=r.depth+1}}}return n.eachBefore(jB)}function DB(){return kB(this).eachBefore(SB)}function CB(e){return e.children}function FB(e){return Array.isArray(e)?e[1]:null}function SB(e){if(e.data.value!==undefined)e.value=e.data.value;e.data=e.data.data}function jB(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function MB(e){this.data=e;this.depth=this.height=0;this.parent=null}MB.prototype=kB.prototype=(Ae={constructor:MB,count:dB,each:hB,eachAfter:vB,eachBefore:pB,find:gB,sum:mB,sort:yB,path:bB,ancestors:_B,descendants:wB,leaves:AB,links:OB,copy:DB},Ae[Symbol.iterator]=EB,Ae);function BB(e){return e==null?null:NB(e)}function NB(e){if(typeof e!=="function")throw new Error;return e}function TB(){return 0}function zB(e){return function(){return e}}var PB=1664525;var RB=1013904223;var LB=4294967296;function IB(){var e=1;return function(){return(e=(PB*e+RB)%LB)/LB}}function UB(e){return typeof e==="object"&&"length"in e?e:Array.from(e)}function qB(e,t){var n=e.length,r,i;while(n){i=t()*n--|0;r=e[n];e[n]=e[i];e[i]=r}return e}function WB(e,t){var n=0,r=(e=qB(Array.from(e),t)).length,i=[],a,o;while(n<r){a=e[n];if(o&&$B(o,a))++n;else o=YB(i=HB(i,a)),n=0}return o}function HB(e,t){var n,r;if(VB(t,e))return[t];for(n=0;n<e.length;++n){if(GB(t,e[n])&&VB(JB(e[n],t),e)){return[e[n],t]}}for(n=0;n<e.length-1;++n){for(r=n+1;r<e.length;++r){if(GB(JB(e[n],e[r]),t)&&GB(JB(e[n],t),e[r])&&GB(JB(e[r],t),e[n])&&VB(QB(e[n],e[r],t),e)){return[e[n],e[r],t]}}}throw new Error}function GB(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function $B(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function VB(e,t){for(var n=0;n<t.length;++n){if(!$B(e,t[n])){return false}}return true}function YB(e){switch(e.length){case 1:return XB(e[0]);case 2:return JB(e[0],e[1]);case 3:return QB(e[0],e[1],e[2])}}function XB(e){return{x:e.x,y:e.y,r:e.r}}function JB(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,u=t.r,s=a-n,l=o-r,f=u-i,c=Math.sqrt(s*s+l*l);return{x:(n+a+s/c*f)/2,y:(r+o+l/c*f)/2,r:(c+i+u)/2}}function QB(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,u=t.y,s=t.r,l=n.x,f=n.y,c=n.r,d=r-o,h=r-l,p=i-u,v=i-f,g=s-a,m=c-a,y=r*r+i*i-a*a,b=y-o*o-u*u+s*s,x=y-l*l-f*f+c*c,_=h*p-d*v,w=(p*x-v*b)/(_*2)-r,A=(v*g-p*m)/_,O=(h*b-d*x)/(_*2)-i,E=(d*m-h*g)/_,k=A*A+E*E-1,D=2*(a+w*A+O*E),C=w*w+O*O-a*a,F=-(Math.abs(k)>1e-6?(D+Math.sqrt(D*D-4*k*C))/(2*k):C/D);return{x:r+w+A*F,y:i+O+E*F,r:F}}function ZB(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,u,s,l=r*r+o*o;if(l){a=t.r+n.r,a*=a;s=e.r+n.r,s*=s;if(a>s){i=(l+s-a)/(2*l);u=Math.sqrt(Math.max(0,s/l-i*i));n.x=e.x-i*r-u*o;n.y=e.y-i*o+u*r}else{i=(l+a-s)/(2*l);u=Math.sqrt(Math.max(0,a/l-i*i));n.x=t.x+i*r-u*o;n.y=t.y+i*o+u*r}}else{n.x=t.x+n.r;n.y=t.y}}function KB(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function eN(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function tN(e){this._=e;this.next=null;this.previous=null}function nN(e,t){if(!(a=(e=UB(e)).length))return 0;var n,r,i,a,o,u,s,l,f,c,d;n=e[0],n.x=0,n.y=0;if(!(a>1))return n.r;r=e[1],n.x=-r.r,r.x=n.r,r.y=0;if(!(a>2))return n.r+r.r;ZB(r,n,i=e[2]);n=new tN(n),r=new tN(r),i=new tN(i);n.next=i.previous=r;r.next=n.previous=i;i.next=r.previous=n;e:for(s=3;s<a;++s){ZB(n._,r._,i=e[s]),i=new tN(i);l=r.next,f=n.previous,c=r._.r,d=n._.r;do{if(c<=d){if(KB(l._,i._)){r=l,n.next=r,r.previous=n,--s;continue e}c+=l._.r,l=l.next}else{if(KB(f._,i._)){n=f,n.next=r,r.previous=n,--s;continue e}d+=f._.r,f=f.previous}}while(l!==f.next);i.previous=n,i.next=r,n.next=r.previous=r=i;o=eN(n);while((i=i.next)!==r){if((u=eN(i))<o){n=i,o=u}}r=n.next}n=[r._],i=r;while((i=i.next)!==r)n.push(i._);i=WB(n,t);for(s=0;s<a;++s)n=e[s],n.x-=i.x,n.y-=i.y;return i.r}function rN(e){return Math.sqrt(e.value)}function iN(){var e=null,t=1,n=1,r=TB;function i(i){var a=IB();i.x=t/2,i.y=n/2;if(e){i.eachBefore(aN(e)).eachAfter(oN(r,.5,a)).eachBefore(uN(1))}else{i.eachBefore(aN(rN)).eachAfter(oN(TB,1,a)).eachAfter(oN(r,i.r/Math.min(t,n),a)).eachBefore(uN(Math.min(t,n)/(2*i.r)))}return i}i.radius=function(t){return arguments.length?(e=BB(t),i):e};i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]};i.padding=function(e){return arguments.length?(r=typeof e==="function"?e:zB(+e),i):r};return i}function aN(e){return function(t){if(!t.children){t.r=Math.max(0,+e(t)||0)}}}function oN(e,t,n){return function(r){if(i=r.children){var i,a,o=i.length,u=e(r)*t||0,s;if(u)for(a=0;a<o;++a)i[a].r+=u;s=nN(i,n);if(u)for(a=0;a<o;++a)i[a].r-=u;r.r=s+u}}}function uN(e){return function(t){var n=t.parent;t.r*=e;if(n){t.x=n.x+e*t.x;t.y=n.y+e*t.y}}}function sN(e){e.x0=Math.round(e.x0);e.y0=Math.round(e.y0);e.x1=Math.round(e.x1);e.y1=Math.round(e.y1)}function lN(e,t,n,r,i){var a=e.children,o,u=-1,s=a.length,l=e.value&&(r-t)/e.value;while(++u<s){o=a[u],o.y0=n,o.y1=i;o.x0=t,o.x1=t+=o.value*l}}function fN(){var e=1,t=1,n=0,r=false;function i(i){var o=i.height+1;i.x0=i.y0=n;i.x1=e;i.y1=t/o;i.eachBefore(a(t,o));if(r)i.eachBefore(sN);return i}function a(e,t){return function(r){if(r.children){lN(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t)}var i=r.x0,a=r.y0,o=r.x1-n,u=r.y1-n;if(o<i)i=o=(i+o)/2;if(u<a)a=u=(a+u)/2;r.x0=i;r.y0=a;r.x1=o;r.y1=u}}i.round=function(e){return arguments.length?(r=!!e,i):r};i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]};i.padding=function(e){return arguments.length?(n=+e,i):n};return i}var cN={depth:-1},dN={},hN={};function pN(e){return e.id}function vN(e){return e.parentId}function gN(){var e=pN,t=vN,n;function r(r){var i=Array.from(r),a=e,o=t,u,s,l,f,c,d,h,p,v=new Map;if(n!=null){var g=i.map((function(e,t){return mN(n(e,t,r))}));var m=g.map(yN);var y=new Set(g).add("");for(var b=0,x=m;b<x.length;b++){var _=x[b];if(!y.has(_)){y.add(_);g.push(_);m.push(yN(_));i.push(hN)}}a=function(e,t){return g[t]};o=function(e,t){return m[t]}}for(l=0,u=i.length;l<u;++l){s=i[l],d=i[l]=new MB(s);if((h=a(s,l,r))!=null&&(h+="")){p=d.id=h;v.set(p,v.has(p)?dN:d)}if((h=o(s,l,r))!=null&&(h+="")){d.parent=h}}for(l=0;l<u;++l){d=i[l];if(h=d.parent){c=v.get(h);if(!c)throw new Error("missing: "+h);if(c===dN)throw new Error("ambiguous: "+h);if(c.children)c.children.push(d);else c.children=[d];d.parent=c}else{if(f)throw new Error("multiple roots");f=d}}if(!f)throw new Error("no root");if(n!=null){while(f.data===hN&&f.children.length===1){f=f.children[0],--u}for(var w=i.length-1;w>=0;--w){d=i[w];if(d.data!==hN)break;d.data=null}}f.parent=cN;f.eachBefore((function(e){e.depth=e.parent.depth+1;--u})).eachBefore(jB);f.parent=null;if(u>0)throw new Error("cycle");return f}r.id=function(t){return arguments.length?(e=BB(t),r):e};r.parentId=function(e){return arguments.length?(t=BB(e),r):t};r.path=function(e){return arguments.length?(n=BB(e),r):n};return r}function mN(e){e="".concat(e);var t=e.length;if(bN(e,t-1)&&!bN(e,t-2))e=e.slice(0,-1);return e[0]==="/"?e:"/".concat(e)}function yN(e){var t=e.length;if(t<2)return"";while(--t>1)if(bN(e,t))break;return e.slice(0,t)}function bN(e,t){if(e[t]==="/"){var n=0;while(t>0&&e[--t]==="\\")++n;if((n&1)===0)return true}return false}function xN(e,t){return e.parent===t.parent?1:2}function _N(e){var t=e.children;return t?t[0]:e.t}function wN(e){var t=e.children;return t?t[t.length-1]:e.t}function AN(e,t,n){var r=n/(t.i-e.i);t.c-=r;t.s+=n;e.c+=r;t.z+=n;t.m+=n}function ON(e){var t=0,n=0,r=e.children,i=r.length,a;while(--i>=0){a=r[i];a.z+=t;a.m+=t;t+=a.s+(n+=a.c)}}function EN(e,t,n){return e.a.parent===t.parent?e.a:n}function kN(e,t){this._=e;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=t}kN.prototype=Object.create(MB.prototype);function DN(e){var t=new kN(e,0),n,r=[t],i,a,o,u;while(n=r.pop()){if(a=n._.children){n.children=new Array(u=a.length);for(o=u-1;o>=0;--o){r.push(i=n.children[o]=new kN(a[o],o));i.parent=n}}}(t.parent=new kN(null,0)).children=[t];return t}function CN(){var e=xN,t=1,n=1,r=null;function i(i){var u=DN(i);u.eachAfter(a),u.parent.m=-u.z;u.eachBefore(o);if(r)i.eachBefore(s);else{var l=i,f=i,c=i;i.eachBefore((function(e){if(e.x<l.x)l=e;if(e.x>f.x)f=e;if(e.depth>c.depth)c=e}));var d=l===f?1:e(l,f)/2,h=d-l.x,p=t/(f.x+d+h),v=n/(c.depth||1);i.eachBefore((function(e){e.x=(e.x+h)*p;e.y=e.depth*v}))}return i}function a(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){ON(t);var a=(n[0].z+n[n.length-1].z)/2;if(i){t.z=i.z+e(t._,i._);t.m=t.z-a}else{t.z=a}}else if(i){t.z=i.z+e(t._,i._)}t.parent.A=u(t,i,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function u(t,n,r){if(n){var i=t,a=t,o=n,u=i.parent.children[0],s=i.m,l=a.m,f=o.m,c=u.m,d;while(o=wN(o),i=_N(i),o&&i){u=_N(u);a=wN(a);a.a=t;d=o.z+f-i.z-s+e(o._,i._);if(d>0){AN(EN(o,t,r),t,d);s+=d;l+=d}f+=o.m;s+=i.m;c+=u.m;l+=a.m}if(o&&!wN(a)){a.t=o;a.m+=f-l}if(i&&!_N(u)){u.t=i;u.m+=s-c;r=t}}return r}function s(e){e.x*=t;e.y=e.depth*n}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i}function FN(e,t,n,r,i){var a=e.children,o,u=-1,s=a.length,l=e.value&&(i-n)/e.value;while(++u<s){o=a[u],o.x0=t,o.x1=r;o.y0=n,o.y1=n+=o.value*l}}var SN=(1+Math.sqrt(5))/2;function jN(e,t,n,r,i,a){var o=[],u=t.children,s,l,f=0,c=0,d=u.length,h,p,v=t.value,g,m,y,b,x,_,w;while(f<d){h=i-n,p=a-r;do{g=u[c++].value}while(!g&&c<d);m=y=g;_=Math.max(p/h,h/p)/(v*e);w=g*g*_;x=Math.max(y/w,w/m);for(;c<d;++c){g+=l=u[c].value;if(l<m)m=l;if(l>y)y=l;w=g*g*_;b=Math.max(y/w,w/m);if(b>x){g-=l;break}x=b}o.push(s={value:g,dice:h<p,children:u.slice(f,c)});if(s.dice)lN(s,n,r,i,v?r+=p*g/v:a);else FN(s,n,r,v?n+=h*g/v:i,a);v-=g,f=c}return o}var MN=function e(t){function n(e,n,r,i,a){jN(t,e,n,r,i,a)}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(SN);function BN(){var e=MN,t=false,n=1,r=1,i=[0],a=TB,o=TB,u=TB,s=TB,l=TB;function f(e){e.x0=e.y0=0;e.x1=n;e.y1=r;e.eachBefore(c);i=[0];if(t)e.eachBefore(sN);return e}function c(t){var n=i[t.depth],r=t.x0+n,f=t.y0+n,c=t.x1-n,d=t.y1-n;if(c<r)r=c=(r+c)/2;if(d<f)f=d=(f+d)/2;t.x0=r;t.y0=f;t.x1=c;t.y1=d;if(t.children){n=i[t.depth+1]=a(t)/2;r+=l(t)-n;f+=o(t)-n;c-=u(t)-n;d-=s(t)-n;if(c<r)r=c=(r+c)/2;if(d<f)f=d=(f+d)/2;e(t,r,f,c,d)}}f.round=function(e){return arguments.length?(t=!!e,f):t};f.size=function(e){return arguments.length?(n=+e[0],r=+e[1],f):[n,r]};f.tile=function(t){return arguments.length?(e=NB(t),f):e};f.padding=function(e){return arguments.length?f.paddingInner(e).paddingOuter(e):f.paddingInner()};f.paddingInner=function(e){return arguments.length?(a=typeof e==="function"?e:zB(+e),f):a};f.paddingOuter=function(e){return arguments.length?f.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):f.paddingTop()};f.paddingTop=function(e){return arguments.length?(o=typeof e==="function"?e:zB(+e),f):o};f.paddingRight=function(e){return arguments.length?(u=typeof e==="function"?e:zB(+e),f):u};f.paddingBottom=function(e){return arguments.length?(s=typeof e==="function"?e:zB(+e),f):s};f.paddingLeft=function(e){return arguments.length?(l=typeof e==="function"?e:zB(+e),f):l};return f}function NN(e,t,n,r,i){var a=e.children,o,u=a.length,s,l=new Array(u+1);for(l[0]=s=o=0;o<u;++o){l[o+1]=s+=a[o].value}f(0,u,e.value,t,n,r,i);function f(e,t,n,r,i,o,u){if(e>=t-1){var s=a[e];s.x0=r,s.y0=i;s.x1=o,s.y1=u;return}var c=l[e],d=n/2+c,h=e+1,p=t-1;while(h<p){var v=h+p>>>1;if(l[v]<d)h=v+1;else p=v}if(d-l[h-1]<l[h]-d&&e+1<h)--h;var g=l[h]-c,m=n-g;if(o-r>u-i){var y=n?(r*m+o*g)/n:o;f(e,h,g,r,i,y,u);f(h,t,m,y,i,o,u)}else{var b=n?(i*m+u*g)/n:u;f(e,h,g,r,i,o,b);f(h,t,m,r,b,o,u)}}}function TN(e,t,n,r,i){(e.depth&1?FN:lN)(e,t,n,r,i)}var zN=function e(t){function n(e,n,r,i,a){if((o=e._squarify)&&o.ratio===t){var o,u,s,l,f=-1,c,d=o.length,h=e.value;while(++f<d){u=o[f],s=u.children;for(l=u.value=0,c=s.length;l<c;++l)u.value+=s[l].value;if(u.dice)lN(u,n,r,i,h?r+=(a-r)*u.value/h:a);else FN(u,n,r,h?n+=(i-n)*u.value/h:i,a);h-=u.value}}else{e._squarify=o=jN(t,e,n,r,i,a);o.ratio=t}}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(SN);function PN(e,t,n){var r={};e.each((function(e){var i=e.data;if(n(i))r[t(i)]=e}));e.lookup=r;return e}function RN(e){df.call(this,null,e)}RN.Definition={type:"Nest",metadata:{treesource:true,changes:true},params:[{name:"keys",type:"field",array:true},{name:"generate",type:"boolean"}]};var LN=function(e){return e.values};_n(RN,df,{transform:function(e,t){if(!t.source){pt("Nest transform requires an upstream data source.")}var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;if(!a||r||t.changed()){if(a){a.each((function(e){if(e.children&&Xs(e.data)){i.rem.push(e.data)}}))}this.value=a=kB({values:tn(e.keys).reduce((function(e,t){e.key(t);return e}),IN()).entries(i.source)},LN);if(n){a.each((function(e){if(e.children){e=Zs(e.data);i.add.push(e);i.source.push(e)}}))}PN(a,Js,Js)}i.source.root=a;return i}});function IN(){var e=[],t={entries:function(e){return r(n(e,0),0)},key:function(n){return e.push(n),t}};function n(t,r){if(r>=e.length){return t}var i=t.length,a=e[r++],o={},u={};var s=-1,l,f,c;while(++s<i){l=a(f=t[s])+"";if(c=o[l]){c.push(f)}else{o[l]=[f]}}for(l in o){u[l]=n(o[l],r)}return u}function r(t,n){if(++n>e.length)return t;var i=[];for(var a in t){i.push({key:a,values:r(t[a],n)})}return i}return t}function UN(e){df.call(this,null,e)}var qN=function(e,t){return e.parent===t.parent?1:2};_n(UN,df,{transform:function(e,t){if(!t.source||!t.source.root){pt(this.constructor.name+" transform requires a backing tree data source.")}var n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;if(e.field)i.sum(e.field);else i.count();if(e.sort)i.sort(nl(e.sort,(function(e){return e.data})));WN(n,this.params,e);if(n.separation){n.separation(e.separation!==false?qN:xt)}try{this.value=n(i)}catch(o){pt(o)}i.each((function(e){return HN(e,r,a)}));return t.reflow(e.modified()).modifies(a).modifies("leaf")}});function WN(e,t,n){for(var r=void 0,i=0,a=t.length;i<a;++i){r=t[i];if(r in n)e[r](n[r])}}function HN(e,t,n){var r=e.data,i=t.length-1;for(var a=0;a<i;++a){r[n[a]]=e[t[a]]}r[n[i]]=e.children?e.children.length:0}var GN=["x","y","r","depth","children"];function $N(e){UN.call(this,e)}$N.Definition={type:"Pack",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:GN.length,default:GN}]};_n($N,UN,{layout:iN,params:["radius","size","padding"],fields:GN});var VN=["x0","y0","x1","y1","depth","children"];function YN(e){UN.call(this,e)}YN.Definition={type:"Partition",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:VN.length,default:VN}]};_n(YN,UN,{layout:fN,params:["size","round","padding"],fields:VN});function XN(e){df.call(this,null,e)}XN.Definition={type:"Stratify",metadata:{treesource:true},params:[{name:"key",type:"field",required:true},{name:"parentKey",type:"field",required:true}]};_n(XN,df,{transform:function(e,t){if(!t.source){pt("Stratify transform requires an upstream data source.")}var n=this.value;var r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);i.source=i.source.slice();if(a){n=i.source.length?PN(gN().id(e.key).parentId(e.parentKey)(i.source),e.key,_t):PN(gN()([{}]),e.key,e.key)}i.source.root=this.value=n;return i}});var JN={tidy:CN,cluster:fB};var QN=["x","y","depth","children"];function ZN(e){UN.call(this,e)}ZN.Definition={type:"Tree",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:true,length:2},{name:"nodeSize",type:"number",array:true,length:2},{name:"separation",type:"boolean",default:true},{name:"as",type:"string",array:true,length:QN.length,default:QN}]};_n(ZN,UN,{layout:function(e){var t=e||"tidy";if(mn(JN,t))return JN[t]();else pt("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:QN});function KN(e){df.call(this,[],e)}KN.Definition={type:"TreeLinks",metadata:{tree:true,generates:true,changes:true},params:[]};_n(KN,df,{transform:function(e,t){var n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};if(!r)pt("TreeLinks transform requires a tree data source.");if(t.changed(t.ADD_REM)){i.rem=n;t.visit(t.SOURCE,(function(e){return a[Js(e)]=1}));r.each((function(e){var t=e.data,n=e.parent&&e.parent.data;if(n&&a[Js(t)]&&a[Js(n)]){i.add.push(Zs({source:n,target:t}))}}));this.value=i.add}else if(t.changed(t.MOD)){t.visit(t.MOD,(function(e){return a[Js(e)]=1}));n.forEach((function(e){if(a[Js(e.source)]||a[Js(e.target)]){i.mod.push(e)}}))}return i}});var eT={binary:NN,dice:lN,slice:FN,slicedice:TN,squarify:MN,resquarify:zN};var tT=["x0","y0","x1","y1","depth","children"];function nT(e){UN.call(this,e)}nT.Definition={type:"Treemap",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:tT.length,default:tT}]};_n(nT,UN,{layout:function(){var e=BN();e.ratio=function(t){var n=e.tile();if(n.ratio)e.tile(n.ratio(t))};e.method=function(t){if(mn(eT,t))e.tile(eT[t]);else pt("Unrecognized Treemap layout method: "+t)};return e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:tT});var rT=Object.freeze({__proto__:null,nest:RN,pack:$N,partition:YN,stratify:XN,tree:ZN,treelinks:KN,treemap:nT});var iT=4278190080;function aT(e,t){var n=e.bitmap();(t||[]).forEach((function(t){return n.set(e(t.boundary[0]),e(t.boundary[3]))}));return[n,undefined]}function oT(e,t,n,r,i){var a=e.width,o=e.height,u=r||i,s=ip(a,o).getContext("2d"),l=ip(a,o).getContext("2d"),f=u&&ip(a,o).getContext("2d");n.forEach((function(e){return sT(s,e,false)}));sT(l,t,false);if(u){sT(f,t,true)}var c=uT(s,a,o),d=uT(l,a,o),h=u&&uT(f,a,o),p=e.bitmap(),v=u&&e.bitmap();var g,m,y,b,x,_,w,A;for(m=0;m<o;++m){for(g=0;g<a;++g){x=m*a+g;_=c[x]&iT;A=d[x]&iT;w=u&&h[x]&iT;if(_||w||A){y=e(g);b=e(m);if(!i&&(_||A))p.set(y,b);if(u&&(_||w))v.set(y,b)}}}return[p,v]}function uT(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function sT(e,t,n){if(!t.length)return;var r=t[0].mark.marktype;if(r==="group"){t.forEach((function(t){t.items.forEach((function(t){return sT(e,t.items,n)}))}))}else{ew[r].draw(e,{items:n?t.map(lT):t})}}function lT(e){var t=el(e,{});if(t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0){return __assign(__assign({},t),{strokeOpacity:1,stroke:"#000",fillOpacity:0})}return t}var fT=5,cT=31,dT=32,hT=new Uint32Array(dT+1),pT=new Uint32Array(dT+1);pT[0]=0;hT[0]=~pT[0];for(var vT=1;vT<=dT;++vT){pT[vT]=pT[vT-1]<<1|1;hT[vT]=~pT[vT]}function gT(e,t){var n=new Uint32Array(~~((e*t+dT)/dT));function r(e,t){n[e]|=t}function i(e,t){n[e]&=t}return{array:n,get:function(t,r){var i=r*e+t;return n[i>>>fT]&1<<(i&cT)},set:function(t,n){var i=n*e+t;r(i>>>fT,1<<(i&cT))},clear:function(t,n){var r=n*e+t;i(r>>>fT,~(1<<(r&cT)))},getRange:function(t,r,i,a){var o=a,u,s,l,f;for(;o>=r;--o){u=o*e+t;s=o*e+i;l=u>>>fT;f=s>>>fT;if(l===f){if(n[l]&hT[u&cT]&pT[(s&cT)+1]){return true}}else{if(n[l]&hT[u&cT])return true;if(n[f]&pT[(s&cT)+1])return true;for(var c=l+1;c<f;++c){if(n[c])return true}}}return false},setRange:function(t,n,i,a){var o,u,s,l,f;for(;n<=a;++n){o=n*e+t;u=n*e+i;s=o>>>fT;l=u>>>fT;if(s===l){r(s,hT[o&cT]&pT[(u&cT)+1])}else{r(s,hT[o&cT]);r(l,pT[(u&cT)+1]);for(f=s+1;f<l;++f)r(f,4294967295)}}},clearRange:function(t,n,r,a){var o,u,s,l,f;for(;n<=a;++n){o=n*e+t;u=n*e+r;s=o>>>fT;l=u>>>fT;if(s===l){i(s,pT[o&cT]|hT[(u&cT)+1])}else{i(s,pT[o&cT]);i(l,hT[(u&cT)+1]);for(f=s+1;f<l;++f)i(f,0)}}},outOfBounds:function(n,r,i,a){return n<0||r<0||a>=t||i>=e}}}function mT(e,t,n){var r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),a=~~((t+2*n+r)/r),o=function(e){return~~((e+n)/r)};o.invert=function(e){return e*r-n};o.bitmap=function(){return gT(i,a)};o.ratio=r;o.padding=n;o.width=e;o.height=t;return o}function yT(e,t,n,r){var i=e.width,a=e.height;return function(e){var t=e.datum.datum.items[r].items,n=t.length,o=e.datum.fontSize,u=D_.width(e.datum,e.datum.text);var s=0,l,f,c,d,h,p,v;for(var g=0;g<n;++g){l=t[g].x;c=t[g].y;f=t[g].x2===undefined?l:t[g].x2;d=t[g].y2===undefined?c:t[g].y2;h=(l+f)/2;p=(c+d)/2;v=Math.abs(f-l+d-c);if(v>=s){s=v;e.x=h;e.y=p}}h=u/2;p=o/2;l=e.x-h;f=e.x+h;c=e.y-p;d=e.y+p;e.align="center";if(l<0&&f<=i){e.align="left"}else if(0<=l&&i<f){e.align="right"}e.baseline="middle";if(c<0&&d<=a){e.baseline="top"}else if(0<=c&&a<d){e.baseline="bottom"}return true}}function bT(e,t,n,r,i,a){var o=n/2;return e-o<0||e+o>i||t-(o=r/2)<0||t+o>a}function xT(e,t,n,r,i,a,o,u){var s=i*a/(r*2),l=e(t-s),f=e(t+s),c=e(n-(a=a/2)),d=e(n+a);return o.outOfBounds(l,c,f,d)||o.getRange(l,c,f,d)||u&&u.getRange(l,c,f,d)}function _T(e,t,n,r){var i=e.width,a=e.height,o=t[0],u=t[1];function s(t,n,r,s,l){var f=e.invert(t),c=e.invert(n);var d=r,h=a,p;if(!bT(f,c,s,l,i,a)&&!xT(e,f,c,l,s,d,o,u)&&!xT(e,f,c,l,s,l,o,null)){while(h-d>=1){p=(d+h)/2;if(xT(e,f,c,l,s,p,o,u)){h=p}else{d=p}}if(d>r){return[f,c,d,true]}}}return function(t){var u=t.datum.datum.items[r].items,l=u.length,f=t.datum.fontSize,c=D_.width(t.datum,t.datum.text);var d=n?f:0,h=false,p=false,v=0,g,m,y,b,x,_,w,A,O,E,k,D,C,F,S,j,M;for(var B=0;B<l;++B){g=u[B].x;y=u[B].y;m=u[B].x2===undefined?g:u[B].x2;b=u[B].y2===undefined?y:u[B].y2;if(g>m){M=g;g=m;m=M}if(y>b){M=y;y=b;b=M}O=e(g);k=e(m);E=~~((O+k)/2);D=e(y);F=e(b);C=~~((D+F)/2);for(w=E;w>=O;--w){for(A=C;A>=D;--A){j=s(w,A,d,c,f);if(j){t.x=j[0],t.y=j[1],d=j[2],h=j[3]}}}for(w=E;w<=k;++w){for(A=C;A<=F;++A){j=s(w,A,d,c,f);if(j){t.x=j[0],t.y=j[1],d=j[2],h=j[3]}}}if(!h&&!n){S=Math.abs(m-g+b-y);x=(g+m)/2;_=(y+b)/2;if(S>=v&&!bT(x,_,c,f,i,a)&&!xT(e,x,_,f,c,f,o,null)){v=S;t.x=x;t.y=_;p=true}}}if(h||p){x=c/2;_=f/2;o.setRange(e(t.x-x),e(t.y-_),e(t.x+x),e(t.y+_));t.align="center";t.baseline="middle";return true}else{return false}}}var wT=[-1,-1,1,1];var AT=[-1,1,-1,1];function OT(e,t,n,r){var i=e.width,a=e.height,o=t[0],u=t[1],s=e.bitmap();return function(t){var l;var f=t.datum.datum.items[r].items,c=f.length,d=t.datum.fontSize,h=D_.width(t.datum,t.datum.text),p=[];var v=n?d:0,g=false,m=false,y=0,b,x,_,w,A,O,E,k,D,C,F,S;for(var j=0;j<c;++j){b=f[j].x;_=f[j].y;x=f[j].x2===undefined?b:f[j].x2;w=f[j].y2===undefined?_:f[j].y2;p.push([e((b+x)/2),e((_+w)/2)]);while(p.length){l=p.pop(),E=l[0],k=l[1];if(o.get(E,k)||u.get(E,k)||s.get(E,k))continue;s.set(E,k);for(var M=0;M<4;++M){A=E+wT[M];O=k+AT[M];if(!s.outOfBounds(A,O,A,O))p.push([A,O])}A=e.invert(E);O=e.invert(k);D=v;C=a;if(!bT(A,O,h,d,i,a)&&!xT(e,A,O,d,h,D,o,u)&&!xT(e,A,O,d,h,d,o,null)){while(C-D>=1){F=(D+C)/2;if(xT(e,A,O,d,h,F,o,u)){C=F}else{D=F}}if(D>v){t.x=A;t.y=O;v=D;g=true}}}if(!g&&!n){S=Math.abs(x-b+w-_);A=(b+x)/2;O=(_+w)/2;if(S>=y&&!bT(A,O,h,d,i,a)&&!xT(e,A,O,d,h,d,o,null)){y=S;t.x=A;t.y=O;m=true}}}if(g||m){A=h/2;O=d/2;o.setRange(e(t.x-A),e(t.y-O),e(t.x+A),e(t.y+O));t.align="center";t.baseline="middle";return true}else{return false}}}var ET=["right","center","left"],kT=["bottom","middle","top"];function DT(e,t,n,r){var i=e.width,a=e.height,o=t[0],u=t[1],s=r.length;return function(t){var l;var f=t.boundary,c=t.datum.fontSize;if(f[2]<0||f[5]<0||f[0]>i||f[3]>a){return false}var d=(l=t.textWidth)!==null&&l!==void 0?l:0,h,p,v,g,m,y,b,x,_,w,A,O,E,k,D;for(var C=0;C<s;++C){h=(n[C]&3)-1;p=(n[C]>>>2&3)-1;v=h===0&&p===0||r[C]<0;g=h&&p?Math.SQRT1_2:1;m=r[C]<0?-1:1;y=f[1+h]+r[C]*h*g;A=f[4+p]+m*c*p/2+r[C]*p*g;x=A-c/2;_=A+c/2;O=e(y);k=e(x);D=e(_);if(!d){if(!CT(O,O,k,D,o,u,y,y,x,_,f,v)){continue}else{d=D_.width(t.datum,t.datum.text)}}w=y+m*d*h/2;y=w-d/2;b=w+d/2;O=e(y);E=e(b);if(CT(O,E,k,D,o,u,y,b,x,_,f,v)){t.x=!h?w:h*m<0?b:y;t.y=!p?A:p*m<0?_:x;t.align=ET[h*m+1];t.baseline=kT[p*m+1];o.setRange(O,k,E,D);return true}}return false}}function CT(e,t,n,r,i,a,o,u,s,l,f,c){return!(i.outOfBounds(e,n,t,r)||(c&&a||i).getRange(e,n,t,r))}var FT=0,ST=4,jT=8,MT=0,BT=1,NT=2;var TT={"top-left":FT+MT,top:FT+BT,"top-right":FT+NT,left:ST+MT,middle:ST+BT,right:ST+NT,"bottom-left":jT+MT,bottom:jT+BT,"bottom-right":jT+NT};var zT={naive:yT,"reduced-search":_T,floodfill:OT};function PT(e,t,n,r,i,a,o,u,s,l,f){if(!e.length)return e;var c=Math.max(r.length,i.length),d=RT(r,c),h=LT(i,c),p=IT(e[0].datum),v=p==="group"&&e[0].datum.items[s].marktype,g=v==="area",m=UT(p,v,u,s),y=l===null||l===Infinity,b=g&&f==="naive";var x=-1,_=-1;var w=e.map((function(e){var t=y?D_.width(e,e.text):undefined;x=Math.max(x,t);_=Math.max(_,e.fontSize);return{datum:e,opacity:0,x:undefined,y:undefined,align:undefined,baseline:undefined,boundary:m(e),textWidth:t}}));l=l===null||l===Infinity?Math.max(x,_)+Math.max.apply(Math,r):l;var A=mT(t[0],t[1],l);var O;if(!b){if(n){w.sort((function(e,t){return n(e.datum,t.datum)}))}var E=false;for(var k=0;k<h.length&&!E;++k){E=h[k]===5||d[k]<0}var D=(p&&o||g)&&e.map((function(e){return e.datum}));O=a.length||D?oT(A,D||[],a,E,g):aT(A,o&&w)}var C=g?zT[f](A,O,o,s):DT(A,O,h,d);w.forEach((function(e){return e.opacity=+C(e)}));return w}function RT(e,t){var n=new Float64Array(t),r=e.length;for(var i=0;i<r;++i)n[i]=e[i]||0;for(var i=r;i<t;++i)n[i]=n[r-1];return n}function LT(e,t){var n=new Int8Array(t),r=e.length;for(var i=0;i<r;++i)n[i]|=TT[e[i]];for(var i=r;i<t;++i)n[i]=n[r-1];return n}function IT(e){return e&&e.mark&&e.mark.marktype}function UT(e,t,n,r){var i=function(e){return[e.x,e.x,e.x,e.y,e.y,e.y]};if(!e){return i}else if(e==="line"||e==="area"){return function(e){return i(e.datum)}}else if(t==="line"){return function(e){var t=e.datum.items[r].items;return i(t.length?t[n==="start"?0:t.length-1]:{x:NaN,y:NaN})}}else{return function(e){var t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}}}var qT=["x","y","opacity","align","baseline"];var WT=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function HT(e){df.call(this,null,e)}HT.Definition={type:"Label",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:true,default:WT},{name:"offset",type:"number",array:true,default:[1]},{name:"padding",type:"number",default:0,null:true},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:true},{name:"avoidMarks",type:"data",array:true},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:true,length:qT.length,default:qT}]};_n(HT,df,{transform:function(e,t){function n(n){var r=e[n];return rn(r)&&t.modified(r.fields)}var r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;if(!e.size||e.size.length!==2){pt("Size parameter should be specified as a [width, height] array.")}var i=e.as||qT;PT(t.materialize(t.SOURCE).source||[],e.size,e.sort,tn(e.offset==null?1:e.offset),tn(e.anchor||WT),e.avoidMarks||[],e.avoidBaseMark!==false,e.lineAnchor||"end",e.markIndex||0,e.padding===undefined?0:e.padding,e.method||"naive").forEach((function(e){var t=e.datum;t[i[0]]=e.x;t[i[1]]=e.y;t[i[2]]=e.opacity;t[i[3]]=e.align;t[i[4]]=e.baseline}));return t.reflow(r).modifies(i)}});var GT=Object.freeze({__proto__:null,label:HT});function $T(e,t){var n=[],r=function(e){return e(u)},i,a,o,u,s,l;if(t==null){n.push(e)}else{for(i={},a=0,o=e.length;a<o;++a){u=e[a];s=t.map(r);l=i[s];if(!l){i[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function VT(e){df.call(this,null,e)}VT.Definition={type:"Loess",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:true}]};_n(VT,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=$T(r,e.groupby),a=(e.groupby||[]).map(lt),o=a.length,u=e.as||[lt(e.x),lt(e.y)],s=[];i.forEach((function(t){lc(t,e.x,e.y,e.bandwidth||.3).forEach((function(e){var n={};for(var r=0;r<o;++r){n[a[r]]=t.dims[r]}n[u[0]]=e[0];n[u[1]]=e[1];s.push(Zs(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=s}return n}});var YT={linear:Kf,log:ec,exp:tc,pow:nc,quad:rc,poly:ic};var XT=function(e,t){return e==="poly"?t:e==="quad"?2:1};function JT(e){df.call(this,null,e)}JT.Definition={type:"Regression",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"method",type:"string",default:"linear",values:Object.keys(YT)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:true,length:2},{name:"params",type:"boolean",default:false},{name:"as",type:"string",array:true}]};_n(JT,df,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=$T(r,e.groupby),a=(e.groupby||[]).map(lt),o=e.method||"linear",u=e.order||3,s=XT(o,u),l=e.as||[lt(e.x),lt(e.y)],f=YT[o],c=[];var d=e.extent;if(!mn(YT,o)){pt("Invalid regression method: "+o)}if(d!=null){if(o==="log"&&d[0]<=0){t.dataflow.warn("Ignoring extent with values <= 0 for log regression.");d=null}}i.forEach((function(n){var r=n.length;if(r<=s){t.dataflow.warn("Skipping regression with more parameters than data points.");return}var i=f(n,e.x,e.y,u);if(e.params){c.push(Zs({keys:n.dims,coef:i.coef,rSquared:i.rSquared}));return}var h=d||pn(n,e.x),p=function(e){var t={};for(var r=0;r<a.length;++r){t[a[r]]=n.dims[r]}t[l[0]]=e[0];t[l[1]]=e[1];c.push(Zs(t))};if(o==="linear"){h.forEach((function(e){return p([e,i.predict(e)])}))}else{pc(i.predict,h,25,200).forEach(p)}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=c}return n}});var QT=Object.freeze({__proto__:null,loess:VT,regression:JT});var ZT=11102230246251565e-32;var KT=134217729;var ez=(3+8*ZT)*ZT;function tz(e,t,n,r,i){var a,o,u,s;var l=t[0];var f=r[0];var c=0;var d=0;if(f>l===f>-l){a=l;l=t[++c]}else{a=f;f=r[++d]}var h=0;if(c<e&&d<n){if(f>l===f>-l){o=l+a;u=a-(o-l);l=t[++c]}else{o=f+a;u=a-(o-f);f=r[++d]}a=o;if(u!==0){i[h++]=u}while(c<e&&d<n){if(f>l===f>-l){o=a+l;s=o-a;u=a-(o-s)+(l-s);l=t[++c]}else{o=a+f;s=o-a;u=a-(o-s)+(f-s);f=r[++d]}a=o;if(u!==0){i[h++]=u}}}while(c<e){o=a+l;s=o-a;u=a-(o-s)+(l-s);l=t[++c];a=o;if(u!==0){i[h++]=u}}while(d<n){o=a+f;s=o-a;u=a-(o-s)+(f-s);f=r[++d];a=o;if(u!==0){i[h++]=u}}if(a!==0||h===0){i[h++]=a}return h}function nz(e,t){var n=t[0];for(var r=1;r<e;r++)n+=t[r];return n}function rz(e){return new Float64Array(e)}var iz=(3+16*ZT)*ZT;var az=(2+12*ZT)*ZT;var oz=(9+64*ZT)*ZT*ZT;var uz=rz(4);var sz=rz(8);var lz=rz(12);var fz=rz(16);var cz=rz(4);function dz(e,t,n,r,i,a,o){var u,s,l,f;var c,d,h,p,v,g,m,y,b,x,_,w,A,O;var E=e-i;var k=n-i;var D=t-a;var C=r-a;x=E*C;d=KT*E;h=d-(d-E);p=E-h;d=KT*C;v=d-(d-C);g=C-v;_=p*g-(x-h*v-p*v-h*g);w=D*k;d=KT*D;h=d-(d-D);p=D-h;d=KT*k;v=d-(d-k);g=k-v;A=p*g-(w-h*v-p*v-h*g);m=_-A;c=_-m;uz[0]=_-(m+c)+(c-A);y=x+m;c=y-x;b=x-(y-c)+(m-c);m=b-w;c=b-m;uz[1]=b-(m+c)+(c-w);O=y+m;c=O-y;uz[2]=y-(O-c)+(m-c);uz[3]=O;var F=nz(4,uz);var S=az*o;if(F>=S||-F>=S){return F}c=e-E;u=e-(E+c)+(c-i);c=n-k;l=n-(k+c)+(c-i);c=t-D;s=t-(D+c)+(c-a);c=r-C;f=r-(C+c)+(c-a);if(u===0&&s===0&&l===0&&f===0){return F}S=oz*o+ez*Math.abs(F);F+=E*f+C*u-(D*l+k*s);if(F>=S||-F>=S)return F;x=u*C;d=KT*u;h=d-(d-u);p=u-h;d=KT*C;v=d-(d-C);g=C-v;_=p*g-(x-h*v-p*v-h*g);w=s*k;d=KT*s;h=d-(d-s);p=s-h;d=KT*k;v=d-(d-k);g=k-v;A=p*g-(w-h*v-p*v-h*g);m=_-A;c=_-m;cz[0]=_-(m+c)+(c-A);y=x+m;c=y-x;b=x-(y-c)+(m-c);m=b-w;c=b-m;cz[1]=b-(m+c)+(c-w);O=y+m;c=O-y;cz[2]=y-(O-c)+(m-c);cz[3]=O;var j=tz(4,uz,4,cz,sz);x=E*f;d=KT*E;h=d-(d-E);p=E-h;d=KT*f;v=d-(d-f);g=f-v;_=p*g-(x-h*v-p*v-h*g);w=D*l;d=KT*D;h=d-(d-D);p=D-h;d=KT*l;v=d-(d-l);g=l-v;A=p*g-(w-h*v-p*v-h*g);m=_-A;c=_-m;cz[0]=_-(m+c)+(c-A);y=x+m;c=y-x;b=x-(y-c)+(m-c);m=b-w;c=b-m;cz[1]=b-(m+c)+(c-w);O=y+m;c=O-y;cz[2]=y-(O-c)+(m-c);cz[3]=O;var M=tz(j,sz,4,cz,lz);x=u*f;d=KT*u;h=d-(d-u);p=u-h;d=KT*f;v=d-(d-f);g=f-v;_=p*g-(x-h*v-p*v-h*g);w=s*l;d=KT*s;h=d-(d-s);p=s-h;d=KT*l;v=d-(d-l);g=l-v;A=p*g-(w-h*v-p*v-h*g);m=_-A;c=_-m;cz[0]=_-(m+c)+(c-A);y=x+m;c=y-x;b=x-(y-c)+(m-c);m=b-w;c=b-m;cz[1]=b-(m+c)+(c-w);O=y+m;c=O-y;cz[2]=y-(O-c)+(m-c);cz[3]=O;var B=tz(M,lz,4,cz,fz);return fz[B-1]}function hz(e,t,n,r,i,a){var o=(t-a)*(n-i);var u=(e-i)*(r-a);var s=o-u;if(o===0||u===0||o>0!==u>0)return s;var l=Math.abs(o+u);if(Math.abs(s)>=iz*l)return s;return-dz(e,t,n,r,i,a,l)}var pz=Math.pow(2,-52);var vz=new Uint32Array(512);var gz=function(){function e(e){var t=e.length>>1;if(t>0&&typeof e[0]!=="number")throw new Error("Expected coords to contain numbers.");this.coords=e;var n=Math.max(2*t-5,0);this._triangles=new Uint32Array(n*3);this._halfedges=new Int32Array(n*3);this._hashSize=Math.ceil(Math.sqrt(t));this._hullPrev=new Uint32Array(t);this._hullNext=new Uint32Array(t);this._hullTri=new Uint32Array(t);this._hullHash=new Int32Array(this._hashSize).fill(-1);this._ids=new Uint32Array(t);this._dists=new Float64Array(t);this.update()}e.from=function(t,n,r){if(n===void 0){n=Oz}if(r===void 0){r=Ez}var i=t.length;var a=new Float64Array(i*2);for(var o=0;o<i;o++){var u=t[o];a[2*o]=n(u);a[2*o+1]=r(u)}return new e(a)};e.prototype.update=function(){var e=this,t=e.coords,n=e._hullPrev,r=e._hullNext,i=e._hullTri,a=e._hullHash;var o=t.length>>1;var u=Infinity;var s=Infinity;var l=-Infinity;var f=-Infinity;for(var c=0;c<o;c++){var d=t[2*c];var h=t[2*c+1];if(d<u)u=d;if(h<s)s=h;if(d>l)l=d;if(h>f)f=h;this._ids[c]=c}var p=(u+l)/2;var v=(s+f)/2;var g=Infinity;var m,y,b;for(var c=0;c<o;c++){var x=yz(p,v,t[2*c],t[2*c+1]);if(x<g){m=c;g=x}}var _=t[2*m];var w=t[2*m+1];g=Infinity;for(var c=0;c<o;c++){if(c===m)continue;var x=yz(_,w,t[2*c],t[2*c+1]);if(x<g&&x>0){y=c;g=x}}var A=t[2*y];var O=t[2*y+1];var E=Infinity;for(var c=0;c<o;c++){if(c===m||c===y)continue;var k=xz(_,w,A,O,t[2*c],t[2*c+1]);if(k<E){b=c;E=k}}var D=t[2*b];var C=t[2*b+1];if(E===Infinity){for(var c=0;c<o;c++){this._dists[c]=t[2*c]-t[0]||t[2*c+1]-t[1]}wz(this._ids,this._dists,0,o-1);var F=new Uint32Array(o);var S=0;for(var c=0,j=-Infinity;c<o;c++){var M=this._ids[c];if(this._dists[M]>j){F[S++]=M;j=this._dists[M]}}this.hull=F.subarray(0,S);this.triangles=new Uint32Array(0);this.halfedges=new Uint32Array(0);return}if(hz(_,w,A,O,D,C)<0){var c=y;var B=A;var N=O;y=b;A=D;O=C;b=c;D=B;C=N}var T=_z(_,w,A,O,D,C);this._cx=T.x;this._cy=T.y;for(var c=0;c<o;c++){this._dists[c]=yz(t[2*c],t[2*c+1],T.x,T.y)}wz(this._ids,this._dists,0,o-1);this._hullStart=m;var z=3;r[m]=n[b]=y;r[y]=n[m]=b;r[b]=n[y]=m;i[m]=0;i[y]=1;i[b]=2;a.fill(-1);a[this._hashKey(_,w)]=m;a[this._hashKey(A,O)]=y;a[this._hashKey(D,C)]=b;this.trianglesLen=0;this._addTriangle(m,y,b,-1,-1,-1);for(var P=0,R=void 0,L=void 0;P<this._ids.length;P++){var c=this._ids[P];var I=t[2*c];var U=t[2*c+1];if(P>0&&Math.abs(I-R)<=pz&&Math.abs(U-L)<=pz)continue;R=I;L=U;if(c===m||c===y||c===b)continue;var q=0;for(var S=0,W=this._hashKey(I,U);S<this._hashSize;S++){q=a[(W+S)%this._hashSize];if(q!==-1&&q!==r[q])break}q=n[q];var H=q,G=void 0;while(G=r[H],hz(I,U,t[2*H],t[2*H+1],t[2*G],t[2*G+1])>=0){H=G;if(H===q){H=-1;break}}if(H===-1)continue;var $=this._addTriangle(H,c,r[H],-1,-1,i[H]);i[c]=this._legalize($+2);i[H]=$;z++;var V=r[H];while(G=r[V],hz(I,U,t[2*V],t[2*V+1],t[2*G],t[2*G+1])<0){$=this._addTriangle(V,c,G,i[c],-1,i[V]);i[c]=this._legalize($+2);r[V]=V;z--;V=G}if(H===q){while(G=n[H],hz(I,U,t[2*G],t[2*G+1],t[2*H],t[2*H+1])<0){$=this._addTriangle(G,c,H,-1,i[H],i[G]);this._legalize($+2);i[G]=$;r[H]=H;z--;H=G}}this._hullStart=n[c]=H;r[H]=n[V]=c;r[c]=V;a[this._hashKey(I,U)]=c;a[this._hashKey(t[2*H],t[2*H+1])]=H}this.hull=new Uint32Array(z);for(var c=0,Y=this._hullStart;c<z;c++){this.hull[c]=Y;Y=r[Y]}this.triangles=this._triangles.subarray(0,this.trianglesLen);this.halfedges=this._halfedges.subarray(0,this.trianglesLen)};e.prototype._hashKey=function(e,t){return Math.floor(mz(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize};e.prototype._legalize=function(e){var t=this,n=t._triangles,r=t._halfedges,i=t.coords;var a=0;var o=0;while(true){var u=r[e];var s=e-e%3;o=s+(e+2)%3;if(u===-1){if(a===0)break;e=vz[--a];continue}var l=u-u%3;var f=s+(e+1)%3;var c=l+(u+2)%3;var d=n[o];var h=n[e];var p=n[f];var v=n[c];var g=bz(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*v],i[2*v+1]);if(g){n[e]=v;n[u]=d;var m=r[c];if(m===-1){var y=this._hullStart;do{if(this._hullTri[y]===c){this._hullTri[y]=e;break}y=this._hullPrev[y]}while(y!==this._hullStart)}this._link(e,m);this._link(u,r[o]);this._link(o,c);var b=l+(u+1)%3;if(a<vz.length){vz[a++]=b}}else{if(a===0)break;e=vz[--a]}}return o};e.prototype._link=function(e,t){this._halfedges[e]=t;if(t!==-1)this._halfedges[t]=e};e.prototype._addTriangle=function(e,t,n,r,i,a){var o=this.trianglesLen;this._triangles[o]=e;this._triangles[o+1]=t;this._triangles[o+2]=n;this._link(o,r);this._link(o+1,i);this._link(o+2,a);this.trianglesLen+=3;return o};return e}();function mz(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function yz(e,t,n,r){var i=e-n;var a=t-r;return i*i+a*a}function bz(e,t,n,r,i,a,o,u){var s=e-o;var l=t-u;var f=n-o;var c=r-u;var d=i-o;var h=a-u;var p=s*s+l*l;var v=f*f+c*c;var g=d*d+h*h;return s*(c*g-v*h)-l*(f*g-v*d)+p*(f*h-c*d)<0}function xz(e,t,n,r,i,a){var o=n-e;var u=r-t;var s=i-e;var l=a-t;var f=o*o+u*u;var c=s*s+l*l;var d=.5/(o*l-u*s);var h=(l*f-u*c)*d;var p=(o*c-s*f)*d;return h*h+p*p}function _z(e,t,n,r,i,a){var o=n-e;var u=r-t;var s=i-e;var l=a-t;var f=o*o+u*u;var c=s*s+l*l;var d=.5/(o*l-u*s);var h=e+(l*f-u*c)*d;var p=t+(o*c-s*f)*d;return{x:h,y:p}}function wz(e,t,n,r){if(r-n<=20){for(var i=n+1;i<=r;i++){var a=e[i];var o=t[a];var u=i-1;while(u>=n&&t[e[u]]>o)e[u+1]=e[u--];e[u+1]=a}}else{var s=n+r>>1;var i=n+1;var u=r;Az(e,s,i);if(t[e[n]]>t[e[r]])Az(e,n,r);if(t[e[i]]>t[e[r]])Az(e,i,r);if(t[e[n]]>t[e[i]])Az(e,n,i);var l=e[i];var o=t[l];while(true){do{i++}while(t[e[i]]<o);do{u--}while(t[e[u]]>o);if(u<i)break;Az(e,i,u)}e[n+1]=e[u];e[u]=l;if(r-i+1>=u-n){wz(e,t,i,r);wz(e,t,n,u-1)}else{wz(e,t,n,u-1);wz(e,t,i,r)}}}function Az(e,t,n){var r=e[t];e[t]=e[n];e[n]=r}function Oz(e){return e[0]}function Ez(e){return e[1]}var kz=1e-6;var Dz=function(){function e(){this._x0=this._y0=this._x1=this._y1=null;this._=""}e.prototype.moveTo=function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)};e.prototype.closePath=function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}};e.prototype.lineTo=function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)};e.prototype.arc=function(e,t,n){e=+e,t=+t,n=+n;var r=e+n;var i=t;if(n<0)throw new Error("negative radius");if(this._x1===null)this._+="M".concat(r,",").concat(i);else if(Math.abs(this._x1-r)>kz||Math.abs(this._y1-i)>kz)this._+="L"+r+","+i;if(!n)return;this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i)};e.prototype.rect=function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")};e.prototype.value=function(){return this._||null};return e}();var Cz=function(){function e(){this._=[]}e.prototype.moveTo=function(e,t){this._.push([e,t])};e.prototype.closePath=function(){this._.push(this._[0].slice())};e.prototype.lineTo=function(e,t){this._.push([e,t])};e.prototype.value=function(){return this._.length?this._:null};return e}();var Fz=function(){function e(e,t){var n=t===void 0?[0,0,960,500]:t,r=n[0],i=n[1],a=n[2],o=n[3];if(!((a=+a)>=(r=+r))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e;this._circumcenters=new Float64Array(e.points.length*2);this.vectors=new Float64Array(e.points.length*2);this.xmax=a,this.xmin=r;this.ymax=o,this.ymin=i;this._init()}e.prototype.update=function(){this.delaunay.update();this._init();return this};e.prototype._init=function(){var e=this,t=e.delaunay,n=t.points,r=t.hull,i=t.triangles,a=e.vectors;var o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(var u=0,s=0,l=i.length,f,c;u<l;u+=3,s+=2){var d=i[u]*2;var h=i[u+1]*2;var p=i[u+2]*2;var v=n[d];var g=n[d+1];var m=n[h];var y=n[h+1];var b=n[p];var x=n[p+1];var _=m-v;var w=y-g;var A=b-v;var O=x-g;var E=(_*O-w*A)*2;if(Math.abs(E)<1e-9){var k=1e9;var D=i[0]*2;k*=Math.sign((n[D]-v)*O-(n[D+1]-g)*A);f=(v+b)/2-k*O;c=(g+x)/2+k*A}else{var C=1/E;var F=_*_+w*w;var S=A*A+O*O;f=v+(O*F-w*S)*C;c=g+(_*S-A*F)*C}o[s]=f;o[s+1]=c}var j=r[r.length-1];var M,B=j*4;var N,T=n[2*j];var z,P=n[2*j+1];a.fill(0);for(var u=0;u<r.length;++u){j=r[u];M=B,N=T,z=P;B=j*4,T=n[2*j],P=n[2*j+1];a[M+2]=a[B]=z-P;a[M+3]=a[B+1]=T-N}};e.prototype.render=function(e){var t=e==null?e=new Dz:undefined;var n=this,r=n.delaunay,i=r.halfedges,a=r.inedges,o=r.hull,u=n.circumcenters,s=n.vectors;if(o.length<=1)return null;for(var l=0,f=i.length;l<f;++l){var c=i[l];if(c<l)continue;var d=Math.floor(l/3)*2;var h=Math.floor(c/3)*2;var p=u[d];var v=u[d+1];var g=u[h];var m=u[h+1];this._renderSegment(p,v,g,m,e)}var y,b=o[o.length-1];for(var l=0;l<o.length;++l){y=b,b=o[l];var x=Math.floor(a[b]/3)*2;var _=u[x];var w=u[x+1];var A=y*4;var O=this._project(_,w,s[A+2],s[A+3]);if(O)this._renderSegment(_,w,O[0],O[1],e)}return t&&t.value()};e.prototype.renderBounds=function(e){var t=e==null?e=new Dz:undefined;e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin);return t&&t.value()};e.prototype.renderCell=function(e,t){var n=t==null?t=new Dz:undefined;var r=this._clip(e);if(r===null||!r.length)return;t.moveTo(r[0],r[1]);var i=r.length;while(r[0]===r[i-2]&&r[1]===r[i-1]&&i>1)i-=2;for(var a=2;a<i;a+=2){if(r[a]!==r[a-2]||r[a+1]!==r[a-1])t.lineTo(r[a],r[a+1])}t.closePath();return n&&n.value()};e.prototype.cellPolygons=function(){var e,t,n,r;return __generator(this,(function(i){switch(i.label){case 0:e=this.delaunay.points;t=0,n=e.length/2;i.label=1;case 1:if(!(t<n))return[3,4];r=this.cellPolygon(t);if(!r)return[3,3];r.index=t;return[4,r];case 2:i.sent();i.label=3;case 3:++t;return[3,1];case 4:return[2]}}))};e.prototype.cellPolygon=function(e){var t=new Cz;this.renderCell(e,t);return t.value()};e.prototype._renderSegment=function(e,t,n,r,i){var a;var o=this._regioncode(e,t);var u=this._regioncode(n,r);if(o===0&&u===0){i.moveTo(e,t);i.lineTo(n,r)}else if(a=this._clipSegment(e,t,n,r,o,u)){i.moveTo(a[0],a[1]);i.lineTo(a[2],a[3])}};e.prototype.contains=function(e,t,n){if((t=+t,t!==t)||(n=+n,n!==n))return false;return this.delaunay._step(e,t,n)===e};e.prototype.neighbors=function(e){var t,n,r,i,a,o,u,s,l;return __generator(this,(function(f){switch(f.label){case 0:t=this._clip(e);if(!t)return[3,8];n=0,r=this.delaunay.neighbors(e);f.label=1;case 1:if(!(n<r.length))return[3,8];i=r[n];a=this._clip(i);if(!a)return[3,7];o=0,u=t.length;f.label=2;case 2:if(!(o<u))return[3,7];s=0,l=a.length;f.label=3;case 3:if(!(s<l))return[3,6];if(!(t[o]==a[s]&&t[o+1]==a[s+1]&&t[(o+2)%u]==a[(s+l-2)%l]&&t[(o+3)%u]==a[(s+l-1)%l]))return[3,5];return[4,i];case 4:f.sent();return[3,7];case 5:s+=2;return[3,3];case 6:o+=2;return[3,2];case 7:n++;return[3,1];case 8:return[2]}}))};e.prototype._cell=function(e){var t=this,n=t.circumcenters,r=t.delaunay,i=r.inedges,a=r.halfedges,o=r.triangles;var u=i[e];if(u===-1)return null;var s=[];var l=u;do{var f=Math.floor(l/3);s.push(n[f*2],n[f*2+1]);l=l%3===2?l-2:l+1;if(o[l]!==e)break;l=a[l]}while(l!==u&&l!==-1);return s};e.prototype._clip=function(e){if(e===0&&this.delaunay.hull.length===1){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}var t=this._cell(e);if(t===null)return null;var n=this.vectors;var r=e*4;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)};e.prototype._clipFinite=function(e,t){var n=t.length;var r=null;var i,a,o=t[n-2],u=t[n-1];var s,l=this._regioncode(o,u);var f,c=0;for(var d=0;d<n;d+=2){i=o,a=u,o=t[d],u=t[d+1];s=l,l=this._regioncode(o,u);if(s===0&&l===0){f=c,c=0;if(r)r.push(o,u);else r=[o,u]}else{var h=void 0,p=void 0,v=void 0,g=void 0,m=void 0;if(s===0){if((h=this._clipSegment(i,a,o,u,s,l))===null)continue;p=h[0],v=h[1],g=h[2],m=h[3]}else{if((h=this._clipSegment(o,u,i,a,l,s))===null)continue;g=h[0],m=h[1],p=h[2],v=h[3];f=c,c=this._edgecode(p,v);if(f&&c)this._edge(e,f,c,r,r.length);if(r)r.push(p,v);else r=[p,v]}f=c,c=this._edgecode(g,m);if(f&&c)this._edge(e,f,c,r,r.length);if(r)r.push(g,m);else r=[g,m]}}if(r){f=c,c=this._edgecode(r[0],r[1]);if(f&&c)this._edge(e,f,c,r,r.length)}else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}return r};e.prototype._clipSegment=function(e,t,n,r,i,a){while(true){if(i===0&&a===0)return[e,t,n,r];if(i&a)return null;var o=void 0,u=void 0,s=i||a;if(s&8)o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax;else if(s&4)o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin;else if(s&2)u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax;else u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin;if(i)e=o,t=u,i=this._regioncode(e,t);else n=o,r=u,a=this._regioncode(n,r)}};e.prototype._clipInfinite=function(e,t,n,r,i,a){var o=Array.from(t),u;if(u=this._project(o[0],o[1],n,r))o.unshift(u[0],u[1]);if(u=this._project(o[o.length-2],o[o.length-1],i,a))o.push(u[0],u[1]);if(o=this._clipFinite(e,o)){for(var s=0,l=o.length,f=void 0,c=this._edgecode(o[l-2],o[l-1]);s<l;s+=2){f=c,c=this._edgecode(o[s],o[s+1]);if(f&&c)s=this._edge(e,f,c,o,s),l=o.length}}else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]}return o};e.prototype._edge=function(e,t,n,r,i){while(t!==n){var a=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,a=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,a=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,a=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,a=this.xmin,o=this.ymin;break}if((r[i]!==a||r[i+1]!==o)&&this.contains(e,a,o)){r.splice(i,0,a,o),i+=2}}if(r.length>4){for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,l=(u+4)%r.length;if(r[u]===r[s]&&r[s]===r[l]||r[u+1]===r[s+1]&&r[s+1]===r[l+1])r.splice(s,2),u-=2}}return i};e.prototype._project=function(e,t,n,r){var i=Infinity,a,o,u;if(r<0){if(t<=this.ymin)return null;if((a=(this.ymin-t)/r)<i)u=this.ymin,o=e+(i=a)*n}else if(r>0){if(t>=this.ymax)return null;if((a=(this.ymax-t)/r)<i)u=this.ymax,o=e+(i=a)*n}if(n>0){if(e>=this.xmax)return null;if((a=(this.xmax-e)/n)<i)o=this.xmax,u=t+(i=a)*r}else if(n<0){if(e<=this.xmin)return null;if((a=(this.xmin-e)/n)<i)o=this.xmin,u=t+(i=a)*r}return[o,u]};e.prototype._edgecode=function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)};e.prototype._regioncode=function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)};return e}();var Sz=2*Math.PI,jz=Math.pow;function Mz(e){return e[0]}function Bz(e){return e[1]}function Nz(e){var t=e.triangles,n=e.coords;for(var r=0;r<t.length;r+=3){var i=2*t[r],a=2*t[r+1],o=2*t[r+2],u=(n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1]);if(u>1e-10)return false}return true}function Tz(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var zz=function(){function e(e){this._delaunator=new gz(e);this.inedges=new Int32Array(e.length/2);this._hullIndex=new Int32Array(e.length/2);this.points=this._delaunator.coords;this._init()}e.from=function(t,n,r,i){if(n===void 0){n=Mz}if(r===void 0){r=Bz}return new e("length"in t?Pz(t,n,r,i):Float64Array.from(Rz(t,n,r,i)))};e.prototype.update=function(){this._delaunator.update();this._init();return this};e.prototype._init=function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&Nz(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));var n=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],a=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(var o=0,u=t.length/2;o<u;++o){var s=Tz(t[2*o],t[2*o+1],a);t[2*o]=s[0];t[2*o+1]=s[1]}this._delaunator=new gz(t)}else{delete this.collinear}var l=this.halfedges=this._delaunator.halfedges;var f=this.hull=this._delaunator.hull;var c=this.triangles=this._delaunator.triangles;var d=this.inedges.fill(-1);var h=this._hullIndex.fill(-1);for(var p=0,u=l.length;p<u;++p){var s=c[p%3===2?p-2:p+1];if(l[p]===-1||d[s]===-1)d[s]=p}for(var o=0,u=f.length;o<u;++o){h[f[o]]=o}if(f.length<=2&&f.length>0){this.triangles=new Int32Array(3).fill(-1);this.halfedges=new Int32Array(3).fill(-1);this.triangles[0]=f[0];d[f[0]]=1;if(f.length===2){d[f[1]]=0;this.triangles[1]=f[1];this.triangles[2]=f[1]}}};e.prototype.voronoi=function(e){return new Fz(this,e)};e.prototype.neighbors=function(e){var t,n,r,i,a,o,u,s,l,f,c,d;return __generator(this,(function(h){switch(h.label){case 0:t=this,n=t.inedges,r=t.hull,i=t._hullIndex,a=t.halfedges,o=t.triangles,u=t.collinear;if(!u)return[3,5];s=u.indexOf(e);if(!(s>0))return[3,2];return[4,u[s-1]];case 1:h.sent();h.label=2;case 2:if(!(s<u.length-1))return[3,4];return[4,u[s+1]];case 3:h.sent();h.label=4;case 4:return[2];case 5:l=n[e];if(l===-1)return[2];f=l,c=-1;h.label=6;case 6:return[4,c=o[f]];case 7:h.sent();f=f%3===2?f-2:f+1;if(o[f]!==e)return[2];f=a[f];if(!(f===-1))return[3,10];d=r[(i[e]+1)%r.length];if(!(d!==c))return[3,9];return[4,d];case 8:h.sent();h.label=9;case 9:return[2];case 10:if(f!==l)return[3,6];h.label=11;case 11:return[2]}}))};e.prototype.find=function(e,t,n){if(n===void 0){n=0}if((e=+e,e!==e)||(t=+t,t!==t))return-1;var r=n;var i;while((i=this._step(n,e,t))>=0&&i!==n&&i!==r)n=i;return i};e.prototype._step=function(e,t,n){var r=this,i=r.inedges,a=r.hull,o=r._hullIndex,u=r.halfedges,s=r.triangles,l=r.points;if(i[e]===-1||!l.length)return(e+1)%(l.length>>1);var f=e;var c=jz(t-l[e*2],2)+jz(n-l[e*2+1],2);var d=i[e];var h=d;do{var p=s[h];var v=jz(t-l[p*2],2)+jz(n-l[p*2+1],2);if(v<c)c=v,f=p;h=h%3===2?h-2:h+1;if(s[h]!==e)break;h=u[h];if(h===-1){h=a[(o[e]+1)%a.length];if(h!==p){if(jz(t-l[h*2],2)+jz(n-l[h*2+1],2)<c)return h}break}}while(h!==d);return f};e.prototype.render=function(e){var t=e==null?e=new Dz:undefined;var n=this,r=n.points,i=n.halfedges,a=n.triangles;for(var o=0,u=i.length;o<u;++o){var s=i[o];if(s<o)continue;var l=a[o]*2;var f=a[s]*2;e.moveTo(r[l],r[l+1]);e.lineTo(r[f],r[f+1])}this.renderHull(e);return t&&t.value()};e.prototype.renderPoints=function(e,t){if(t===undefined&&(!e||typeof e.moveTo!=="function"))t=e,e=null;t=t==undefined?2:+t;var n=e==null?e=new Dz:undefined;var r=this.points;for(var i=0,a=r.length;i<a;i+=2){var o=r[i],u=r[i+1];e.moveTo(o+t,u);e.arc(o,u,t,0,Sz)}return n&&n.value()};e.prototype.renderHull=function(e){var t=e==null?e=new Dz:undefined;var n=this,r=n.hull,i=n.points;var a=r[0]*2,o=r.length;e.moveTo(i[a],i[a+1]);for(var u=1;u<o;++u){var s=2*r[u];e.lineTo(i[s],i[s+1])}e.closePath();return t&&t.value()};e.prototype.hullPolygon=function(){var e=new Cz;this.renderHull(e);return e.value()};e.prototype.renderTriangle=function(e,t){var n=t==null?t=new Dz:undefined;var r=this,i=r.points,a=r.triangles;var o=a[e*=3]*2;var u=a[e+1]*2;var s=a[e+2]*2;t.moveTo(i[o],i[o+1]);t.lineTo(i[u],i[u+1]);t.lineTo(i[s],i[s+1]);t.closePath();return n&&n.value()};e.prototype.trianglePolygons=function(){var e,t,n;return __generator(this,(function(r){switch(r.label){case 0:e=this.triangles;t=0,n=e.length/3;r.label=1;case 1:if(!(t<n))return[3,4];return[4,this.trianglePolygon(t)];case 2:r.sent();r.label=3;case 3:++t;return[3,1];case 4:return[2]}}))};e.prototype.trianglePolygon=function(e){var t=new Cz;this.renderTriangle(e,t);return t.value()};return e}();function Pz(e,t,n,r){var i=e.length;var a=new Float64Array(i*2);for(var o=0;o<i;++o){var u=e[o];a[o*2]=t.call(r,u,o,e);a[o*2+1]=n.call(r,u,o,e)}return a}function Rz(e,t,n,r){var i,a,o,u;return __generator(this,(function(s){switch(s.label){case 0:i=0;a=0,o=e;s.label=1;case 1:if(!(a<o.length))return[3,5];u=o[a];return[4,t.call(r,u,i,e)];case 2:s.sent();return[4,n.call(r,u,i,e)];case 3:s.sent();++i;s.label=4;case 4:a++;return[3,1];case 5:return[2]}}))}function Lz(e){df.call(this,null,e)}Lz.Definition={type:"Voronoi",metadata:{modifies:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"size",type:"number",array:true,length:2},{name:"extent",type:"array",array:true,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:true,length:2}},{name:"as",type:"string",default:"path"}]};var Iz=[-1e5,-1e5,1e5,1e5];_n(Lz,df,{transform:function(e,t){var n=e.as||"path",r=t.source;if(!r||!r.length)return t;var i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Iz;var a=this.value=zz.from(r,e.x,e.y).voronoi(i);for(var o=0,u=r.length;o<u;++o){var s=a.cellPolygon(o);r[o][n]=s?Uz(s):null}return t.reflow(e.modified()).modifies(n)}});function Uz(e){var t=e[0][0],n=e[0][1];var r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var qz=Object.freeze({__proto__:null,voronoi:Lz});var Wz=Math.PI/180,Hz=1<<11>>5,Gz=1<<11;function $z(){var e=[256,256],t,n,r,i,a,o,u,s=Qz,l=[],f=Math.random,c={};c.layout=function(){var s=d(ip()),c=Kz((e[0]>>5)*e[1]),p=null,v=l.length,g=-1,m=[],y=l.map((function(e){return{text:t(e),font:n(e),style:i(e),weight:a(e),rotate:o(e),size:~~(r(e)+1e-14),padding:u(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:false,sprite:null,datum:e}})).sort((function(e,t){return t.size-e.size}));while(++g<v){var b=y[g];b.x=e[0]*(f()+.5)>>1;b.y=e[1]*(f()+.5)>>1;Vz(s,b,y,g);if(b.hasText&&h(c,b,p)){m.push(b);if(p)Xz(p,b);else p=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}];b.x-=e[0]>>1;b.y-=e[1]>>1}}return m};function d(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(Hz<<5)/t;e.height=Gz/t;var n=e.getContext("2d");n.fillStyle=n.strokeStyle="red";n.textAlign="center";return{context:n,ratio:t}}function h(t,n,r){var i=n.x,a=n.y,o=Math.sqrt(e[0]*e[0]+e[1]*e[1]),u=s(e),l=f()<.5?1:-1,c=-l,d,h,p;while(d=u(c+=l)){h=~~d[0];p=~~d[1];if(Math.min(Math.abs(h),Math.abs(p))>=o)break;n.x=i+h;n.y=a+p;if(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>e[0]||n.y+n.y1>e[1])continue;if(!r||!Yz(n,t,e[0])){if(!r||Jz(n,r)){var v=n.sprite,g=n.width>>5,m=e[0]>>5,y=n.x-(g<<4),b=y&127,x=32-b,_=n.y1-n.y0,w=(n.y+n.y0)*m+(y>>5),A;for(var O=0;O<_;O++){A=0;for(var E=0;E<=g;E++){t[w+E]|=A<<x|(E<g?(A=v[O*g+E])>>>b:0)}w+=m}n.sprite=null;return true}}}return false}c.words=function(e){if(arguments.length){l=e;return c}else{return l}};c.size=function(t){if(arguments.length){e=[+t[0],+t[1]];return c}else{return e}};c.font=function(e){if(arguments.length){n=eP(e);return c}else{return n}};c.fontStyle=function(e){if(arguments.length){i=eP(e);return c}else{return i}};c.fontWeight=function(e){if(arguments.length){a=eP(e);return c}else{return a}};c.rotate=function(e){if(arguments.length){o=eP(e);return c}else{return o}};c.text=function(e){if(arguments.length){t=eP(e);return c}else{return t}};c.spiral=function(e){if(arguments.length){s=tP[e]||e;return c}else{return s}};c.fontSize=function(e){if(arguments.length){r=eP(e);return c}else{return r}};c.padding=function(e){if(arguments.length){u=eP(e);return c}else{return u}};c.random=function(e){if(arguments.length){f=e;return c}else{return f}};return c}function Vz(e,t,n,r){if(t.sprite)return;var i=e.context,a=e.ratio;i.clearRect(0,0,(Hz<<5)/a,Gz/a);var o=0,u=0,s=0,l=n.length,f,c,d,h,p;--r;while(++r<l){t=n[r];i.save();i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font;f=i.measureText(t.text+"m").width*a;d=t.size<<1;if(t.rotate){var v=Math.sin(t.rotate*Wz),g=Math.cos(t.rotate*Wz),m=f*g,y=f*v,b=d*g,x=d*v;f=Math.max(Math.abs(m+x),Math.abs(m-x))+31>>5<<5;d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else{f=f+31>>5<<5}if(d>s)s=d;if(o+f>=Hz<<5){o=0;u+=s;s=0}if(u+d>=Gz)break;i.translate((o+(f>>1))/a,(u+(d>>1))/a);if(t.rotate)i.rotate(t.rotate*Wz);i.fillText(t.text,0,0);if(t.padding){i.lineWidth=2*t.padding;i.strokeText(t.text,0,0)}i.restore();t.width=f;t.height=d;t.xoff=o;t.yoff=u;t.x1=f>>1;t.y1=d>>1;t.x0=-t.x1;t.y0=-t.y1;t.hasText=true;o+=f}var _=i.getImageData(0,0,(Hz<<5)/a,Gz/a).data,w=[];while(--r>=0){t=n[r];if(!t.hasText)continue;f=t.width;c=f>>5;d=t.y1-t.y0;for(h=0;h<d*c;h++)w[h]=0;o=t.xoff;if(o==null)return;u=t.yoff;var A=0,O=-1;for(p=0;p<d;p++){for(h=0;h<f;h++){var E=c*p+(h>>5),k=_[(u+p)*(Hz<<5)+(o+h)<<2]?1<<31-h%32:0;w[E]|=k;A|=k}if(A)O=p;else{t.y0++;d--;p--;u++}}t.y1=t.y0+O;t.sprite=w.slice(0,(t.y1-t.y0)*c)}}function Yz(e,t,n){n>>=5;var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,u=32-o,s=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),f;for(var c=0;c<s;c++){f=0;for(var d=0;d<=i;d++){if((f<<u|(d<i?(f=r[c*i+d])>>>o:0))&t[l+d])return true}l+=n}return false}function Xz(e,t){var n=e[0],r=e[1];if(t.x+t.x0<n.x)n.x=t.x+t.x0;if(t.y+t.y0<n.y)n.y=t.y+t.y0;if(t.x+t.x1>r.x)r.x=t.x+t.x1;if(t.y+t.y1>r.y)r.y=t.y+t.y1}function Jz(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Qz(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function Zz(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Kz(e){var t=[],n=-1;while(++n<e)t[n]=0;return t}function eP(e){return typeof e==="function"?e:function(){return e}}var tP={archimedean:Qz,rectangular:Zz};var nP=["x","y","font","fontSize","fontStyle","fontWeight","angle"];var rP=["text","font","rotate","fontSize","fontStyle","fontWeight"];function iP(e){df.call(this,$z(),e)}iP.Definition={type:"Wordcloud",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2},{name:"font",type:"string",expr:true,default:"sans-serif"},{name:"fontStyle",type:"string",expr:true,default:"normal"},{name:"fontWeight",type:"string",expr:true,default:"normal"},{name:"fontSize",type:"number",expr:true,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:true,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:true},{name:"as",type:"string",array:true,length:7,default:nP}]};_n(iP,df,{transform:function(e,t){if(e.size&&!(e.size[0]&&e.size[1])){pt("Wordcloud size dimensions must be non-zero.")}function n(n){var r=e[n];return rn(r)&&t.modified(r.fields)}var r=e.modified();if(!(r||t.changed(t.ADD_REM)||rP.some(n)))return;var i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||nP;var u=e.fontSize||14,s;rn(u)?s=e.fontSizeRange:u=cn(u);if(s){var l=u,f=Qg("sqrt")().domain(pn(i,l)).range(s);u=function(e){return f(l(e))}}i.forEach((function(e){e[o[0]]=NaN;e[o[1]]=NaN;e[o[3]]=0}));var c=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(_f).layout();var d=a.size(),h=d[0]>>1,p=d[1]>>1,v=c.length;for(var g=0,m,y;g<v;++g){m=c[g];y=m.datum;y[o[0]]=m.x+h;y[o[1]]=m.y+p;y[o[2]]=m.font;y[o[3]]=m.size;y[o[4]]=m.style;y[o[5]]=m.weight;y[o[6]]=m.rotate}return t.reflow(r).modifies(o)}});var aP=Object.freeze({__proto__:null,wordcloud:iP});var oP=function(e){return new Uint8Array(e)};var uP=function(e){return new Uint16Array(e)};var sP=function(e){return new Uint32Array(e)};function lP(){var e=8,t=[],n=sP(0),r=cP(0,e),i=cP(0,e);return{data:function(){return t},seen:function(){return n=fP(n,t.length)},add:function(e){for(var n=0,r=t.length,i=e.length,a;n<i;++n){a=e[n];a._index=r++;t.push(a)}},remove:function(e,n){var a=t.length,o=Array(a-e),u=t;var s,l,f;for(l=0;!n[l]&&l<a;++l){o[l]=t[l];u[l]=l}for(f=l;l<a;++l){s=t[l];if(!n[l]){u[l]=f;r[f]=r[l];i[f]=i[l];o[f]=s;s._index=f++}else{u[l]=-1}r[l]=0}t=o;return u},size:function(){return t.length},curr:function(){return r},prev:function(){return i},reset:function(e){return i[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){var a=r.length;if(t>a||n>e){e=Math.max(n,e);r=cP(t,e,r);i=cP(t,e)}}}}function fP(e,t,n){if(e.length>=t)return e;n=n||new e.constructor(t);n.set(e);return n}function cP(e,t,n){var r=(t<257?oP:t<65537?uP:sP)(e);if(n)r.set(n);return r}function dP(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n=this,i=n.bisect(n.range,e.value),a=e.index,o=i[0],u=i[1],s=a.length;var l;for(l=0;l<o;++l)t[a[l]]|=r;for(l=u;l<s;++l)t[a[l]]|=r;return n}}}function hP(){var e=sP(0),t=[],n=0;function r(r,i,a){if(!i.length)return[];var o=n,u=i.length,s=sP(u);var l=Array(u),f,c,d;for(d=0;d<u;++d){l[d]=r(i[d]);s[d]=d}l=pP(l,s);if(o){f=t;c=e;t=Array(o+u);e=sP(o+u);vP(a,f,c,o,l,s,u,t,e)}else{if(a>0)for(d=0;d<u;++d){s[d]+=a}t=l;e=s}n=o+u;return{index:s,value:l}}function i(r,i){var a=n;var o,u,s;for(u=0;!i[e[u]]&&u<a;++u);for(s=u;u<a;++u){if(!i[o=e[u]]){e[s]=o;t[s]=t[u];++s}}n=a-r}function a(t){for(var r=0,i=n;r<i;++r){e[r]=t[e[r]]}}function o(e,r){var i;if(r){i=r.length}else{r=t;i=n}return[_r(r,e[0],0,i),xr(r,e[1],0,i)]}return{insert:r,remove:i,bisect:o,reindex:a,index:function(){return e},size:function(){return n}}}function pP(e,t){e.sort.call(t,(function(t,n){var r=e[t],i=e[n];return r<i?-1:r>i?1:0}));return jr(e,t)}function vP(e,t,n,r,i,a,o,u,s){var l=0,f=0,c;for(c=0;l<r&&f<o;++c){if(t[l]<i[f]){u[c]=t[l];s[c]=n[l++]}else{u[c]=i[f];s[c]=a[f++]+e}}for(;l<r;++l,++c){u[c]=t[l];s[c]=n[l]}for(;f<o;++f,++c){u[c]=i[f];s[c]=a[f]+e}}function gP(e){df.call(this,lP(),e);this._indices=null;this._dims=null}gP.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:true,required:true},{name:"query",type:"array",array:true,required:true,content:{type:"number",array:true,length:2}}]};_n(gP,df,{transform:function(e,t){if(!this._dims){return this.init(e,t)}else{var n=e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}));return n?this.reinit(e,t):this.eval(e,t)}},init:function(e,t){var n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length;var u=0,s,l;for(;u<o;++u){s=n[u].fname;l=i[s]||(i[s]=hP());a.push(dP(l,u,r[u]))}return this.eval(e,t)},reinit:function(e,t){var n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,u=this.value,s=u.curr(),l=u.prev(),f=u.all(),c=n.rem=n.add,d=n.mod,h=i.length,p={};var v,g,m,y,b,x,_,w,A;l.set(s);if(t.rem.length){b=this.remove(e,t,n)}if(t.add.length){u.add(t.add)}if(t.mod.length){x={};for(y=t.mod,_=0,w=y.length;_<w;++_){x[y[_]._index]=1}}for(_=0;_<h;++_){A=r[_];if(!o[_]||e.modified("fields",_)||t.modified(A.fields)){m=A.fname;if(!(v=p[m])){a[m]=g=hP();p[m]=v=g.insert(A,t.source,0)}o[_]=dP(g,_,i[_]).onAdd(v,s)}}for(_=0,w=u.data().length;_<w;++_){if(b[_]){continue}else if(l[_]!==s[_]){c.push(_)}else if(x[_]&&s[_]!==f){d.push(_)}}u.mask=(1<<h)-1;return n},eval:function(e,t){var n=t.materialize().fork(),r=this._dims.length;var i=0;if(t.rem.length){this.remove(e,t,n);i|=(1<<r)-1}if(e.modified("query")&&!e.modified("fields")){i|=this.update(e,t,n)}if(t.add.length){this.insert(e,t,n);i|=(1<<r)-1}if(t.mod.length){this.modify(t,n);i|=(1<<r)-1}this.value.mask=i;return n},insert:function(e,t,n){var r=t.add,i=this.value,a=this._dims,o=this._indices,u=e.fields,s={},l=n.add,f=i.size()+r.length,c=a.length;var d=i.size(),h,p,v;i.resize(f,c);i.add(r);var g=i.curr(),m=i.prev(),y=i.all();for(h=0;h<c;++h){p=u[h].fname;v=s[p]||(s[p]=o[p].insert(u[h],r,d));a[h].onAdd(v,g)}for(;d<f;++d){m[d]=y;if(g[d]!==y)l.push(d)}},modify:function(e,t){var n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod;var u,s,l;for(u=0,s=o.length;u<s;++u){l=o[u]._index;if(i[l]!==a)n.push(l)}},remove:function(e,t,n){var r=this._indices,i=this.value,a=i.curr(),o=i.prev(),u=i.all(),s={},l=n.rem,f=t.rem;var c,d,h,p;for(c=0,d=f.length;c<d;++c){h=f[c]._index;s[h]=1;o[h]=p=a[h];a[h]=u;if(p!==u)l.push(h)}for(h in r){r[h].remove(d,s)}this.reindex(t,d,s);return s},reindex:function(e,t,n){var r=this._indices,i=this.value;e.runAfter((function(){var e=i.remove(t,n);for(var a in r)r[a].reindex(e)}))},update:function(e,t,n){var r=this._dims,i=e.query,a=t.stamp,o=r.length;var u=0,s,l;n.filters=0;for(l=0;l<o;++l){if(e.modified("query",l)){s=l;++u}}if(u===1){u=r[s].one;this.incrementOne(r[s],i[s],n.add,n.rem)}else{for(l=0,u=0;l<o;++l){if(!e.modified("query",l))continue;u|=r[l].one;this.incrementAll(r[l],i[l],a,n.add);n.rem=n.add}}return u},incrementAll:function(e,t,n,r){var i=this.value,a=i.seen(),o=i.curr(),u=i.prev(),s=e.index(),l=e.bisect(e.range),f=e.bisect(t),c=f[0],d=f[1],h=l[0],p=l[1],v=e.one;var g,m,y;if(c<h){for(g=c,m=Math.min(h,d);g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}else if(c>h){for(g=h,m=Math.min(c,p);g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}if(d>p){for(g=Math.max(c,p),m=d;g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}else if(d<p){for(g=Math.max(h,d),m=p;g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}e.range=t.slice()},incrementOne:function(e,t,n,r){var i=this.value,a=i.curr(),o=e.index(),u=e.bisect(e.range),s=e.bisect(t),l=s[0],f=s[1],c=u[0],d=u[1],h=e.one;var p,v,g;if(l<c){for(p=l,v=Math.min(c,f);p<v;++p){g=o[p];a[g]^=h;n.push(g)}}else if(l>c){for(p=c,v=Math.min(l,d);p<v;++p){g=o[p];a[g]^=h;r.push(g)}}if(f>d){for(p=Math.max(l,d),v=f;p<v;++p){g=o[p];a[g]^=h;n.push(g)}}else if(f<d){for(p=Math.max(c,f),v=d;p<v;++p){g=o[p];a[g]^=h;r.push(g)}}e.range=t.slice()}});function mP(e){df.call(this,null,e)}mP.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:true,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:true,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};_n(mP,df,{transform:function(e,t){var n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)===0)return t.StopPropagation;var a=t.fork(t.ALL),o=r.data(),u=r.curr(),s=r.prev(),l=function(e){return!(u[e]&n)?o[e]:null};a.filter(a.MOD,l);if(!(i&i-1)){a.filter(a.ADD,l);a.filter(a.REM,(function(e){return(u[e]&n)===i?o[e]:null}))}else{a.filter(a.ADD,(function(e){var t=u[e]&n,r=!t&&t^s[e]&n;return r?o[e]:null}));a.filter(a.REM,(function(e){var t=u[e]&n,r=t&&!(t^(t^s[e]&n));return r?o[e]:null}))}return a.filter(a.SOURCE,(function(e){return l(e._index)}))}});var yP=Object.freeze({__proto__:null,crossfilter:gP,resolvefilter:mP});var bP="RawCode";var xP="Literal";var _P="Property";var wP="Identifier";var AP="ArrayExpression";var OP="BinaryExpression";var EP="CallExpression";var kP="ConditionalExpression";var DP="LogicalExpression";var CP="MemberExpression";var FP="ObjectExpression";var SP="UnaryExpression";function jP(e){this.type=e}jP.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(t=MP(this),n=0,r=t.length;n<r;++n){if(t[n].visit(e))return 1}};function MP(e){switch(e.type){case AP:return e.elements;case OP:case DP:return[e.left,e.right];case EP:return[e.callee].concat(e.arguments);case kP:return[e.test,e.consequent,e.alternate];case CP:return[e.object,e.property];case FP:return e.properties;case _P:return[e.key,e.value];case SP:return[e.argument];case wP:case xP:case bP:default:return[]}}var BP,NP,TP,zP,PP;var RP=1,LP=2,IP=3,UP=4,qP=5,WP=6,HP=7,GP=8,$P=9;BP={};BP[RP]="Boolean";BP[LP]="<end>";BP[IP]="Identifier";BP[UP]="Keyword";BP[qP]="Null";BP[WP]="Numeric";BP[HP]="Punctuator";BP[GP]="String";BP[$P]="RegularExpression";var VP="ArrayExpression",YP="BinaryExpression",XP="CallExpression",JP="ConditionalExpression",QP="Identifier",ZP="Literal",KP="LogicalExpression",eR="MemberExpression",tR="ObjectExpression",nR="Property",rR="UnaryExpression";var iR="Unexpected token %0",aR="Unexpected number",oR="Unexpected string",uR="Unexpected identifier",sR="Unexpected reserved word",lR="Unexpected end of input",fR="Invalid regular expression",cR="Invalid regular expression: missing /",dR="Octal literals are not allowed in strict mode.",hR="Duplicate data property in object literal not allowed in strict mode";var pR="ILLEGAL",vR="Disabled.";var gR=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),mR=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function yR(e,t){if(!e){throw new Error("ASSERT: "+t)}}function bR(e){return e>=48&&e<=57}function xR(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function _R(e){return"01234567".indexOf(e)>=0}function wR(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function AR(e){return e===10||e===13||e===8232||e===8233}function OR(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&gR.test(String.fromCharCode(e))}function ER(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&mR.test(String.fromCharCode(e))}var kR={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function DR(){while(TP<zP){var e=NP.charCodeAt(TP);if(wR(e)||AR(e)){++TP}else{break}}}function CR(e){var t,n,r,i=0;n=e==="u"?4:2;for(t=0;t<n;++t){if(TP<zP&&xR(NP[TP])){r=NP[TP++];i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())}else{nL({},iR,pR)}}return String.fromCharCode(i)}function FR(){var e,t,n,r;e=NP[TP];t=0;if(e==="}"){nL({},iR,pR)}while(TP<zP){e=NP[TP++];if(!xR(e)){break}t=t*16+"0123456789abcdef".indexOf(e.toLowerCase())}if(t>1114111||e!=="}"){nL({},iR,pR)}if(t<=65535){return String.fromCharCode(t)}n=(t-65536>>10)+55296;r=(t-65536&1023)+56320;return String.fromCharCode(n,r)}function SR(){var e,t;e=NP.charCodeAt(TP++);t=String.fromCharCode(e);if(e===92){if(NP.charCodeAt(TP)!==117){nL({},iR,pR)}++TP;e=CR("u");if(!e||e==="\\"||!OR(e.charCodeAt(0))){nL({},iR,pR)}t=e}while(TP<zP){e=NP.charCodeAt(TP);if(!ER(e)){break}++TP;t+=String.fromCharCode(e);if(e===92){t=t.substr(0,t.length-1);if(NP.charCodeAt(TP)!==117){nL({},iR,pR)}++TP;e=CR("u");if(!e||e==="\\"||!ER(e.charCodeAt(0))){nL({},iR,pR)}t+=e}}return t}function jR(){var e,t;e=TP++;while(TP<zP){t=NP.charCodeAt(TP);if(t===92){TP=e;return SR()}if(ER(t)){++TP}else{break}}return NP.slice(e,TP)}function MR(){var e,t,n;e=TP;t=NP.charCodeAt(TP)===92?SR():jR();if(t.length===1){n=IP}else if(kR.hasOwnProperty(t)){n=UP}else if(t==="null"){n=qP}else if(t==="true"||t==="false"){n=RP}else{n=IP}return{type:n,value:t,start:e,end:TP}}function BR(){var e=TP,t=NP.charCodeAt(TP),n,r=NP[TP],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:++TP;return{type:HP,value:String.fromCharCode(t),start:e,end:TP};default:n=NP.charCodeAt(TP+1);if(n===61){switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:TP+=2;return{type:HP,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:TP};case 33:case 61:TP+=2;if(NP.charCodeAt(TP)===61){++TP}return{type:HP,value:NP.slice(e,TP),start:e,end:TP}}}}o=NP.substr(TP,4);if(o===">>>="){TP+=4;return{type:HP,value:o,start:e,end:TP}}a=o.substr(0,3);if(a===">>>"||a==="<<="||a===">>="){TP+=3;return{type:HP,value:a,start:e,end:TP}}i=a.substr(0,2);if(r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>"){TP+=2;return{type:HP,value:i,start:e,end:TP}}if(i==="//"){nL({},iR,pR)}if("<>=!+-*%&|^/".indexOf(r)>=0){++TP;return{type:HP,value:r,start:e,end:TP}}nL({},iR,pR)}function NR(e){var t="";while(TP<zP){if(!xR(NP[TP])){break}t+=NP[TP++]}if(t.length===0){nL({},iR,pR)}if(OR(NP.charCodeAt(TP))){nL({},iR,pR)}return{type:WP,value:parseInt("0x"+t,16),start:e,end:TP}}function TR(e){var t="0"+NP[TP++];while(TP<zP){if(!_R(NP[TP])){break}t+=NP[TP++]}if(OR(NP.charCodeAt(TP))||bR(NP.charCodeAt(TP))){nL({},iR,pR)}return{type:WP,value:parseInt(t,8),octal:true,start:e,end:TP}}function zR(){var e,t,n;n=NP[TP];yR(bR(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point");t=TP;e="";if(n!=="."){e=NP[TP++];n=NP[TP];if(e==="0"){if(n==="x"||n==="X"){++TP;return NR(t)}if(_R(n)){return TR(t)}if(n&&bR(n.charCodeAt(0))){nL({},iR,pR)}}while(bR(NP.charCodeAt(TP))){e+=NP[TP++]}n=NP[TP]}if(n==="."){e+=NP[TP++];while(bR(NP.charCodeAt(TP))){e+=NP[TP++]}n=NP[TP]}if(n==="e"||n==="E"){e+=NP[TP++];n=NP[TP];if(n==="+"||n==="-"){e+=NP[TP++]}if(bR(NP.charCodeAt(TP))){while(bR(NP.charCodeAt(TP))){e+=NP[TP++]}}else{nL({},iR,pR)}}if(OR(NP.charCodeAt(TP))){nL({},iR,pR)}return{type:WP,value:parseFloat(e),start:t,end:TP}}function PR(){var e="",t,n,r,i,a=false;t=NP[TP];yR(t==="'"||t==='"',"String literal must starts with a quote");n=TP;++TP;while(TP<zP){r=NP[TP++];if(r===t){t="";break}else if(r==="\\"){r=NP[TP++];if(!r||!AR(r.charCodeAt(0))){switch(r){case"u":case"x":if(NP[TP]==="{"){++TP;e+=FR()}else{e+=CR(r)}break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:if(_R(r)){i="01234567".indexOf(r);if(i!==0){a=true}if(TP<zP&&_R(NP[TP])){a=true;i=i*8+"01234567".indexOf(NP[TP++]);if("0123".indexOf(r)>=0&&TP<zP&&_R(NP[TP])){i=i*8+"01234567".indexOf(NP[TP++])}}e+=String.fromCharCode(i)}else{e+=r}break}}else{if(r==="\r"&&NP[TP]==="\n"){++TP}}}else if(AR(r.charCodeAt(0))){break}else{e+=r}}if(t!==""){nL({},iR,pR)}return{type:GP,value:e,octal:a,start:n,end:TP}}function RR(e,t){var n=e;if(t.indexOf("u")>=0){n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111){return"x"}nL({},fR)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x")}try{return new RegExp(e,t)}catch(r){return null}}function LR(){var e,t,n,r,i;e=NP[TP];yR(e==="/","Regular expression literal must start with a slash");t=NP[TP++];n=false;r=false;while(TP<zP){e=NP[TP++];t+=e;if(e==="\\"){e=NP[TP++];if(AR(e.charCodeAt(0))){nL({},cR)}t+=e}else if(AR(e.charCodeAt(0))){nL({},cR)}else if(n){if(e==="]"){n=false}}else{if(e==="/"){r=true;break}else if(e==="["){n=true}}}if(!r){nL({},cR)}i=t.substr(1,t.length-2);return{value:i,literal:t}}function IR(){var e,t,n;t="";n="";while(TP<zP){e=NP[TP];if(!ER(e.charCodeAt(0))){break}++TP;if(e==="\\"&&TP<zP){nL({},iR,pR)}else{n+=e;t+=e}}if(n.search(/[^gimuy]/g)>=0){nL({},fR,n)}return{value:n,literal:t}}function UR(){var e,t,n,r;PP=null;DR();e=TP;t=LR();n=IR();r=RR(t.value,n.value);return{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:TP}}function qR(e){return e.type===IP||e.type===UP||e.type===RP||e.type===qP}function WR(){DR();if(TP>=zP){return{type:LP,start:TP,end:TP}}var e=NP.charCodeAt(TP);if(OR(e)){return MR()}if(e===40||e===41||e===59){return BR()}if(e===39||e===34){return PR()}if(e===46){if(bR(NP.charCodeAt(TP+1))){return zR()}return BR()}if(bR(e)){return zR()}return BR()}function HR(){var e=PP;TP=e.end;PP=WR();TP=e.end;return e}function GR(){var e=TP;PP=WR();TP=e}function $R(e){var t=new jP(VP);t.elements=e;return t}function VR(e,t,n){var r=new jP(e==="||"||e==="&&"?KP:YP);r.operator=e;r.left=t;r.right=n;return r}function YR(e,t){var n=new jP(XP);n.callee=e;n.arguments=t;return n}function XR(e,t,n){var r=new jP(JP);r.test=e;r.consequent=t;r.alternate=n;return r}function JR(e){var t=new jP(QP);t.name=e;return t}function QR(e){var t=new jP(ZP);t.value=e.value;t.raw=NP.slice(e.start,e.end);if(e.regex){if(t.raw==="//"){t.raw="/(?:)/"}t.regex=e.regex}return t}function ZR(e,t,n){var r=new jP(eR);r.computed=e==="[";r.object=t;r.property=n;if(!r.computed)n.member=true;return r}function KR(e){var t=new jP(tR);t.properties=e;return t}function eL(e,t,n){var r=new jP(nR);r.key=t;r.value=n;r.kind=e;return r}function tL(e,t){var n=new jP(rR);n.operator=e;n.argument=t;n.prefix=true;return n}function nL(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(function(e,t){yR(t<r.length,"Message reference must be in range");return r[t]}));n=new Error(i);n.index=TP;n.description=i;throw n}function rL(e){if(e.type===LP){nL(e,lR)}if(e.type===WP){nL(e,aR)}if(e.type===GP){nL(e,oR)}if(e.type===IP){nL(e,uR)}if(e.type===UP){nL(e,sR)}nL(e,iR,e.value)}function iL(e){var t=HR();if(t.type!==HP||t.value!==e){rL(t)}}function aL(e){return PP.type===HP&&PP.value===e}function oL(e){return PP.type===UP&&PP.value===e}function uL(){var e=[];TP=PP.start;iL("[");while(!aL("]")){if(aL(",")){HR();e.push(null)}else{e.push(AL());if(!aL("]")){iL(",")}}}HR();return $R(e)}function sL(){TP=PP.start;var e=HR();if(e.type===GP||e.type===WP){if(e.octal){nL(e,dR)}return QR(e)}return JR(e.value)}function lL(){var e,t,n,r;TP=PP.start;e=PP;if(e.type===IP){n=sL();iL(":");r=AL();return eL("init",n,r)}if(e.type===LP||e.type===HP){rL(e)}else{t=sL();iL(":");r=AL();return eL("init",t,r)}}function fL(){var e=[],t,n,r,i={},a=String;TP=PP.start;iL("{");while(!aL("}")){t=lL();if(t.key.type===QP){n=t.key.name}else{n=a(t.key.value)}r="$"+n;if(Object.prototype.hasOwnProperty.call(i,r)){nL({},hR)}else{i[r]=true}e.push(t);if(!aL("}")){iL(",")}}iL("}");return KR(e)}function cL(){iL("(");var e=OL();iL(")");return e}var dL={if:1};function hL(){var e,t,n;if(aL("(")){return cL()}if(aL("[")){return uL()}if(aL("{")){return fL()}e=PP.type;TP=PP.start;if(e===IP||dL[PP.value]){n=JR(HR().value)}else if(e===GP||e===WP){if(PP.octal){nL(PP,dR)}n=QR(HR())}else if(e===UP){throw new Error(vR)}else if(e===RP){t=HR();t.value=t.value==="true";n=QR(t)}else if(e===qP){t=HR();t.value=null;n=QR(t)}else if(aL("/")||aL("/=")){n=QR(UR());GR()}else{rL(HR())}return n}function pL(){var e=[];iL("(");if(!aL(")")){while(TP<zP){e.push(AL());if(aL(")")){break}iL(",")}}iL(")");return e}function vL(){TP=PP.start;var e=HR();if(!qR(e)){rL(e)}return JR(e.value)}function gL(){iL(".");return vL()}function mL(){iL("[");var e=OL();iL("]");return e}function yL(){var e,t,n;e=hL();for(;;){if(aL(".")){n=gL();e=ZR(".",e,n)}else if(aL("(")){t=pL();e=YR(e,t)}else if(aL("[")){n=mL();e=ZR("[",e,n)}else{break}}return e}function bL(){var e=yL();if(PP.type===HP){if(aL("++")||aL("--")){throw new Error(vR)}}return e}function xL(){var e,t;if(PP.type!==HP&&PP.type!==UP){t=bL()}else if(aL("++")||aL("--")){throw new Error(vR)}else if(aL("+")||aL("-")||aL("~")||aL("!")){e=HR();t=xL();t=tL(e.value,t)}else if(oL("delete")||oL("void")||oL("typeof")){throw new Error(vR)}else{t=bL()}return t}function _L(e){var t=0;if(e.type!==HP&&e.type!==UP){return 0}switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function wL(){var e,t,n,r,i,a,o,u,s,l;e=PP;s=xL();r=PP;i=_L(r);if(i===0){return s}r.prec=i;HR();t=[e,PP];o=xL();a=[s,r,o];while((i=_L(PP))>0){while(a.length>2&&i<=a[a.length-2].prec){o=a.pop();u=a.pop().value;s=a.pop();t.pop();n=VR(u,s,o);a.push(n)}r=HR();r.prec=i;a.push(r);t.push(PP);n=xL();a.push(n)}l=a.length-1;n=a[l];t.pop();while(l>1){t.pop();n=VR(a[l-1].value,a[l-2],n);l-=2}return n}function AL(){var e,t,n;e=wL();if(aL("?")){HR();t=AL();iL(":");n=AL();e=XR(e,t,n)}return e}function OL(){var e=AL();if(aL(",")){throw new Error(vR)}return e}function EL(e){NP=e;TP=0;zP=NP.length;PP=null;GR();var t=OL();if(PP.type!==LP){throw new Error("Unexpect token after expression.")}return t}var kL={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function DL(e){function t(t,n,r,i){var a=e(n[0]);if(r){a=r+"("+a+")";if(r.lastIndexOf("new ",0)===0)a="("+a+")"}return a+"."+t+(i<0?"":i===0?"()":"("+n.slice(1).map(e).join(",")+")")}function n(e,n,r){return function(i){return t(e,i,n,r)}}var r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){if(t.length<3)pt("Missing arguments to clamp function.");if(t.length>3)pt("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(t){if(t.length<3)pt("Missing arguments to if function.");if(t.length>3)pt("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function CL(e){var t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function FL(e){e=e||{};var t=e.allowed?qn(e.allowed):{},n=e.forbidden?qn(e.forbidden):{},r=e.constants||kL,i=(e.functions||DL)(c),a=e.globalvar,o=e.fieldvar,u=rn(a)?a:function(e){return"".concat(a,'["').concat(e,'"]')};var s={},l={},f=0;function c(e){if(Cn(e))return e;var t=d[e.type];if(t==null)pt("Unsupported type: "+e.type);return t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var i=e.name;if(f>0){return i}else if(mn(n,i)){return pt("Illegal identifier: "+i)}else if(mn(r,i)){return r[i]}else if(mn(t,i)){return i}else{s[i]=1;return u(i)}},MemberExpression:function(e){var t=!e.computed,n=c(e.object);if(t)f+=1;var r=c(e.property);if(n===o){l[CL(r)]=1}if(t)f-=1;return n+(t?"."+r:"["+r+"]")},CallExpression:function(e){if(e.callee.type!=="Identifier"){pt("Illegal callee type: "+e.callee.type)}var t=e.callee.name,n=e.arguments,r=mn(i,t)&&i[t];if(!r)pt("Unrecognized function: "+t);return rn(r)?r(n):r+"("+n.map(c).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(c).join(",")+"]"},BinaryExpression:function(e){return"("+c(e.left)+" "+e.operator+" "+c(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+c(e.argument)+")"},ConditionalExpression:function(e){return"("+c(e.test)+"?"+c(e.consequent)+":"+c(e.alternate)+")"},LogicalExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(c).join(",")+"}"},Property:function(e){f+=1;var t=c(e.key);f-=1;return t+":"+c(e.value)}};function h(e){var t={code:c(e),globals:Object.keys(s),fields:Object.keys(l)};s={};l={};return t}h.functions=i;h.constants=r;return h}function SL(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function jL(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ML(e){var t,n,r;if(e.length!==2){t=SL;n=function(t,n){return SL(e(t),n)};r=function(t,n){return e(t)-n}}else{t=e===SL||e===jL?e:BL;n=e;r=e}function i(e,r,i,a){if(i===void 0){i=0}if(a===void 0){a=e.length}if(i<a){if(t(r,r)!==0)return a;do{var o=i+a>>>1;if(n(e[o],r)<0)i=o+1;else a=o}while(i<a)}return i}function a(e,r,i,a){if(i===void 0){i=0}if(a===void 0){a=e.length}if(i<a){if(t(r,r)!==0)return a;do{var o=i+a>>>1;if(n(e[o],r)<=0)i=o+1;else a=o}while(i<a)}return i}function o(e,t,n,a){if(n===void 0){n=0}if(a===void 0){a=e.length}var o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o}return{left:i,center:o,right:a}}function BL(){return 0}function NL(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}e=new kr(e);t=t.map(TL);e:for(var r=0,i=e;r<i.length;r++){var a=i[r];for(var o=0,u=t;o<u.length;o++){var s=u[o];if(!s.has(a)){e.delete(a);continue e}}}return e}function TL(e){return e instanceof kr?e:new kr(e)}function zL(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var n=new kr;for(var r=0,i=e;r<i.length;r++){var a=i[r];for(var o=0,u=a;o<u.length;o++){var s=u[o];n.add(s)}}return n}var PL="RawCode";var RL="Literal";var LL="Property";var IL="Identifier";var UL="ArrayExpression";var qL="BinaryExpression";var WL="CallExpression";var HL="ConditionalExpression";var GL="LogicalExpression";var $L="MemberExpression";var VL="ObjectExpression";var YL="UnaryExpression";function XL(e){this.type=e}XL.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(t=JL(this),n=0,r=t.length;n<r;++n){if(t[n].visit(e))return 1}};function JL(e){switch(e.type){case UL:return e.elements;case qL:case GL:return[e.left,e.right];case WL:return[e.callee].concat(e.arguments);case HL:return[e.test,e.consequent,e.alternate];case $L:return[e.object,e.property];case VL:return e.properties;case LL:return[e.key,e.value];case YL:return[e.argument];case IL:case RL:case PL:default:return[]}}var QL,ZL,KL,eI,tI;var nI=1,rI=2,iI=3,aI=4,oI=5,uI=6,sI=7,lI=8,fI=9;QL={};QL[nI]="Boolean";QL[rI]="<end>";QL[iI]="Identifier";QL[aI]="Keyword";QL[oI]="Null";QL[uI]="Numeric";QL[sI]="Punctuator";QL[lI]="String";QL[fI]="RegularExpression";var cI="ArrayExpression",dI="BinaryExpression",hI="CallExpression",pI="ConditionalExpression",vI="Identifier",gI="Literal",mI="LogicalExpression",yI="MemberExpression",bI="ObjectExpression",xI="Property",_I="UnaryExpression";var wI="Unexpected token %0",AI="Unexpected number",OI="Unexpected string",EI="Unexpected identifier",kI="Unexpected reserved word",DI="Unexpected end of input",CI="Invalid regular expression",FI="Invalid regular expression: missing /",SI="Octal literals are not allowed in strict mode.",jI="Duplicate data property in object literal not allowed in strict mode";var MI="ILLEGAL",BI="Disabled.";var NI=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),TI=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function zI(e,t){if(!e){throw new Error("ASSERT: "+t)}}function PI(e){return e>=48&&e<=57}function RI(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function LI(e){return"01234567".indexOf(e)>=0}function II(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function UI(e){return e===10||e===13||e===8232||e===8233}function qI(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&NI.test(String.fromCharCode(e))}function WI(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&TI.test(String.fromCharCode(e))}var HI={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function GI(){while(KL<eI){var e=ZL.charCodeAt(KL);if(II(e)||UI(e)){++KL}else{break}}}function $I(e){var t,n,r,i=0;n=e==="u"?4:2;for(t=0;t<n;++t){if(KL<eI&&RI(ZL[KL])){r=ZL[KL++];i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())}else{xU({},wI,MI)}}return String.fromCharCode(i)}function VI(){var e,t,n,r;e=ZL[KL];t=0;if(e==="}"){xU({},wI,MI)}while(KL<eI){e=ZL[KL++];if(!RI(e)){break}t=t*16+"0123456789abcdef".indexOf(e.toLowerCase())}if(t>1114111||e!=="}"){xU({},wI,MI)}if(t<=65535){return String.fromCharCode(t)}n=(t-65536>>10)+55296;r=(t-65536&1023)+56320;return String.fromCharCode(n,r)}function YI(){var e,t;e=ZL.charCodeAt(KL++);t=String.fromCharCode(e);if(e===92){if(ZL.charCodeAt(KL)!==117){xU({},wI,MI)}++KL;e=$I("u");if(!e||e==="\\"||!qI(e.charCodeAt(0))){xU({},wI,MI)}t=e}while(KL<eI){e=ZL.charCodeAt(KL);if(!WI(e)){break}++KL;t+=String.fromCharCode(e);if(e===92){t=t.substr(0,t.length-1);if(ZL.charCodeAt(KL)!==117){xU({},wI,MI)}++KL;e=$I("u");if(!e||e==="\\"||!WI(e.charCodeAt(0))){xU({},wI,MI)}t+=e}}return t}function XI(){var e,t;e=KL++;while(KL<eI){t=ZL.charCodeAt(KL);if(t===92){KL=e;return YI()}if(WI(t)){++KL}else{break}}return ZL.slice(e,KL)}function JI(){var e,t,n;e=KL;t=ZL.charCodeAt(KL)===92?YI():XI();if(t.length===1){n=iI}else if(HI.hasOwnProperty(t)){n=aI}else if(t==="null"){n=oI}else if(t==="true"||t==="false"){n=nI}else{n=iI}return{type:n,value:t,start:e,end:KL}}function QI(){var e=KL,t=ZL.charCodeAt(KL),n,r=ZL[KL],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:++KL;return{type:sI,value:String.fromCharCode(t),start:e,end:KL};default:n=ZL.charCodeAt(KL+1);if(n===61){switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:KL+=2;return{type:sI,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:KL};case 33:case 61:KL+=2;if(ZL.charCodeAt(KL)===61){++KL}return{type:sI,value:ZL.slice(e,KL),start:e,end:KL}}}}o=ZL.substr(KL,4);if(o===">>>="){KL+=4;return{type:sI,value:o,start:e,end:KL}}a=o.substr(0,3);if(a===">>>"||a==="<<="||a===">>="){KL+=3;return{type:sI,value:a,start:e,end:KL}}i=a.substr(0,2);if(r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>"){KL+=2;return{type:sI,value:i,start:e,end:KL}}if(i==="//"){xU({},wI,MI)}if("<>=!+-*%&|^/".indexOf(r)>=0){++KL;return{type:sI,value:r,start:e,end:KL}}xU({},wI,MI)}function ZI(e){var t="";while(KL<eI){if(!RI(ZL[KL])){break}t+=ZL[KL++]}if(t.length===0){xU({},wI,MI)}if(qI(ZL.charCodeAt(KL))){xU({},wI,MI)}return{type:uI,value:parseInt("0x"+t,16),start:e,end:KL}}function KI(e){var t="0"+ZL[KL++];while(KL<eI){if(!LI(ZL[KL])){break}t+=ZL[KL++]}if(qI(ZL.charCodeAt(KL))||PI(ZL.charCodeAt(KL))){xU({},wI,MI)}return{type:uI,value:parseInt(t,8),octal:true,start:e,end:KL}}function eU(){var e,t,n;n=ZL[KL];zI(PI(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point");t=KL;e="";if(n!=="."){e=ZL[KL++];n=ZL[KL];if(e==="0"){if(n==="x"||n==="X"){++KL;return ZI(t)}if(LI(n)){return KI(t)}if(n&&PI(n.charCodeAt(0))){xU({},wI,MI)}}while(PI(ZL.charCodeAt(KL))){e+=ZL[KL++]}n=ZL[KL]}if(n==="."){e+=ZL[KL++];while(PI(ZL.charCodeAt(KL))){e+=ZL[KL++]}n=ZL[KL]}if(n==="e"||n==="E"){e+=ZL[KL++];n=ZL[KL];if(n==="+"||n==="-"){e+=ZL[KL++]}if(PI(ZL.charCodeAt(KL))){while(PI(ZL.charCodeAt(KL))){e+=ZL[KL++]}}else{xU({},wI,MI)}}if(qI(ZL.charCodeAt(KL))){xU({},wI,MI)}return{type:uI,value:parseFloat(e),start:t,end:KL}}function tU(){var e="",t,n,r,i,a=false;t=ZL[KL];zI(t==="'"||t==='"',"String literal must starts with a quote");n=KL;++KL;while(KL<eI){r=ZL[KL++];if(r===t){t="";break}else if(r==="\\"){r=ZL[KL++];if(!r||!UI(r.charCodeAt(0))){switch(r){case"u":case"x":if(ZL[KL]==="{"){++KL;e+=VI()}else{e+=$I(r)}break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:if(LI(r)){i="01234567".indexOf(r);if(i!==0){a=true}if(KL<eI&&LI(ZL[KL])){a=true;i=i*8+"01234567".indexOf(ZL[KL++]);if("0123".indexOf(r)>=0&&KL<eI&&LI(ZL[KL])){i=i*8+"01234567".indexOf(ZL[KL++])}}e+=String.fromCharCode(i)}else{e+=r}break}}else{if(r==="\r"&&ZL[KL]==="\n"){++KL}}}else if(UI(r.charCodeAt(0))){break}else{e+=r}}if(t!==""){xU({},wI,MI)}return{type:lI,value:e,octal:a,start:n,end:KL}}function nU(e,t){var n=e;if(t.indexOf("u")>=0){n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111){return"x"}xU({},CI)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x")}try{return new RegExp(e,t)}catch(r){return null}}function rU(){var e,t,n,r,i;e=ZL[KL];zI(e==="/","Regular expression literal must start with a slash");t=ZL[KL++];n=false;r=false;while(KL<eI){e=ZL[KL++];t+=e;if(e==="\\"){e=ZL[KL++];if(UI(e.charCodeAt(0))){xU({},FI)}t+=e}else if(UI(e.charCodeAt(0))){xU({},FI)}else if(n){if(e==="]"){n=false}}else{if(e==="/"){r=true;break}else if(e==="["){n=true}}}if(!r){xU({},FI)}i=t.substr(1,t.length-2);return{value:i,literal:t}}function iU(){var e,t,n;t="";n="";while(KL<eI){e=ZL[KL];if(!WI(e.charCodeAt(0))){break}++KL;if(e==="\\"&&KL<eI){xU({},wI,MI)}else{n+=e;t+=e}}if(n.search(/[^gimuy]/g)>=0){xU({},CI,n)}return{value:n,literal:t}}function aU(){var e,t,n,r;tI=null;GI();e=KL;t=rU();n=iU();r=nU(t.value,n.value);return{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:KL}}function oU(e){return e.type===iI||e.type===aI||e.type===nI||e.type===oI}function uU(){GI();if(KL>=eI){return{type:rI,start:KL,end:KL}}var e=ZL.charCodeAt(KL);if(qI(e)){return JI()}if(e===40||e===41||e===59){return QI()}if(e===39||e===34){return tU()}if(e===46){if(PI(ZL.charCodeAt(KL+1))){return eU()}return QI()}if(PI(e)){return eU()}return QI()}function sU(){var e=tI;KL=e.end;tI=uU();KL=e.end;return e}function lU(){var e=KL;tI=uU();KL=e}function fU(e){var t=new XL(cI);t.elements=e;return t}function cU(e,t,n){var r=new XL(e==="||"||e==="&&"?mI:dI);r.operator=e;r.left=t;r.right=n;return r}function dU(e,t){var n=new XL(hI);n.callee=e;n.arguments=t;return n}function hU(e,t,n){var r=new XL(pI);r.test=e;r.consequent=t;r.alternate=n;return r}function pU(e){var t=new XL(vI);t.name=e;return t}function vU(e){var t=new XL(gI);t.value=e.value;t.raw=ZL.slice(e.start,e.end);if(e.regex){if(t.raw==="//"){t.raw="/(?:)/"}t.regex=e.regex}return t}function gU(e,t,n){var r=new XL(yI);r.computed=e==="[";r.object=t;r.property=n;if(!r.computed)n.member=true;return r}function mU(e){var t=new XL(bI);t.properties=e;return t}function yU(e,t,n){var r=new XL(xI);r.key=t;r.value=n;r.kind=e;return r}function bU(e,t){var n=new XL(_I);n.operator=e;n.argument=t;n.prefix=true;return n}function xU(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(function(e,t){zI(t<r.length,"Message reference must be in range");return r[t]}));n=new Error(i);n.index=KL;n.description=i;throw n}function _U(e){if(e.type===rI){xU(e,DI)}if(e.type===uI){xU(e,AI)}if(e.type===lI){xU(e,OI)}if(e.type===iI){xU(e,EI)}if(e.type===aI){xU(e,kI)}xU(e,wI,e.value)}function wU(e){var t=sU();if(t.type!==sI||t.value!==e){_U(t)}}function AU(e){return tI.type===sI&&tI.value===e}function OU(e){return tI.type===aI&&tI.value===e}function EU(){var e=[];KL=tI.start;wU("[");while(!AU("]")){if(AU(",")){sU();e.push(null)}else{e.push(UU());if(!AU("]")){wU(",")}}}sU();return fU(e)}function kU(){KL=tI.start;var e=sU();if(e.type===lI||e.type===uI){if(e.octal){xU(e,SI)}return vU(e)}return pU(e.value)}function DU(){var e,t,n,r;KL=tI.start;e=tI;if(e.type===iI){n=kU();wU(":");r=UU();return yU("init",n,r)}if(e.type===rI||e.type===sI){_U(e)}else{t=kU();wU(":");r=UU();return yU("init",t,r)}}function CU(){var e=[],t,n,r,i={},a=String;KL=tI.start;wU("{");while(!AU("}")){t=DU();if(t.key.type===vI){n=t.key.name}else{n=a(t.key.value)}r="$"+n;if(Object.prototype.hasOwnProperty.call(i,r)){xU({},jI)}else{i[r]=true}e.push(t);if(!AU("}")){wU(",")}}wU("}");return mU(e)}function FU(){wU("(");var e=qU();wU(")");return e}var SU={if:1};function jU(){var e,t,n;if(AU("(")){return FU()}if(AU("[")){return EU()}if(AU("{")){return CU()}e=tI.type;KL=tI.start;if(e===iI||SU[tI.value]){n=pU(sU().value)}else if(e===lI||e===uI){if(tI.octal){xU(tI,SI)}n=vU(sU())}else if(e===aI){throw new Error(BI)}else if(e===nI){t=sU();t.value=t.value==="true";n=vU(t)}else if(e===oI){t=sU();t.value=null;n=vU(t)}else if(AU("/")||AU("/=")){n=vU(aU());lU()}else{_U(sU())}return n}function MU(){var e=[];wU("(");if(!AU(")")){while(KL<eI){e.push(UU());if(AU(")")){break}wU(",")}}wU(")");return e}function BU(){KL=tI.start;var e=sU();if(!oU(e)){_U(e)}return pU(e.value)}function NU(){wU(".");return BU()}function TU(){wU("[");var e=qU();wU("]");return e}function zU(){var e,t,n;e=jU();for(;;){if(AU(".")){n=NU();e=gU(".",e,n)}else if(AU("(")){t=MU();e=dU(e,t)}else if(AU("[")){n=TU();e=gU("[",e,n)}else{break}}return e}function PU(){var e=zU();if(tI.type===sI){if(AU("++")||AU("--")){throw new Error(BI)}}return e}function RU(){var e,t;if(tI.type!==sI&&tI.type!==aI){t=PU()}else if(AU("++")||AU("--")){throw new Error(BI)}else if(AU("+")||AU("-")||AU("~")||AU("!")){e=sU();t=RU();t=bU(e.value,t)}else if(OU("delete")||OU("void")||OU("typeof")){throw new Error(BI)}else{t=PU()}return t}function LU(e){var t=0;if(e.type!==sI&&e.type!==aI){return 0}switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function IU(){var e,t,n,r,i,a,o,u,s,l;e=tI;s=RU();r=tI;i=LU(r);if(i===0){return s}r.prec=i;sU();t=[e,tI];o=RU();a=[s,r,o];while((i=LU(tI))>0){while(a.length>2&&i<=a[a.length-2].prec){o=a.pop();u=a.pop().value;s=a.pop();t.pop();n=cU(u,s,o);a.push(n)}r=sU();r.prec=i;a.push(r);t.push(tI);n=RU();a.push(n)}l=a.length-1;n=a[l];t.pop();while(l>1){t.pop();n=cU(a[l-1].value,a[l-2],n);l-=2}return n}function UU(){var e,t,n;e=IU();if(AU("?")){sU();t=UU();wU(":");n=UU();e=hU(e,t,n)}return e}function qU(){var e=UU();if(AU(",")){throw new Error(BI)}return e}function WU(e){ZL=e;KL=0;eI=ZL.length;tI=null;lU();var t=qU();if(tI.type!==rI){throw new Error("Unexpect token after expression.")}return t}var HU={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function GU(e){function t(t,n,r,i){var a=e(n[0]);if(r){a=r+"("+a+")";if(r.lastIndexOf("new ",0)===0)a="("+a+")"}return a+"."+t+(i<0?"":i===0?"()":"("+n.slice(1).map(e).join(",")+")")}function n(e,n,r){return function(i){return t(e,i,n,r)}}var r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){if(t.length<3)pt("Missing arguments to clamp function.");if(t.length>3)pt("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(t){if(t.length<3)pt("Missing arguments to if function.");if(t.length>3)pt("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function $U(e){var t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function VU(e){e=e||{};var t=e.allowed?qn(e.allowed):{},n=e.forbidden?qn(e.forbidden):{},r=e.constants||HU,i=(e.functions||GU)(c),a=e.globalvar,o=e.fieldvar,u=rn(a)?a:function(e){return"".concat(a,'["').concat(e,'"]')};var s={},l={},f=0;function c(e){if(Cn(e))return e;var t=d[e.type];if(t==null)pt("Unsupported type: "+e.type);return t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var i=e.name;if(f>0){return i}else if(mn(n,i)){return pt("Illegal identifier: "+i)}else if(mn(r,i)){return r[i]}else if(mn(t,i)){return i}else{s[i]=1;return u(i)}},MemberExpression:function(e){var t=!e.computed,n=c(e.object);if(t)f+=1;var r=c(e.property);if(n===o){l[$U(r)]=1}if(t)f-=1;return n+(t?"."+r:"["+r+"]")},CallExpression:function(e){if(e.callee.type!=="Identifier"){pt("Illegal callee type: "+e.callee.type)}var t=e.callee.name,n=e.arguments,r=mn(i,t)&&i[t];if(!r)pt("Unrecognized function: "+t);return rn(r)?r(n):r+"("+n.map(c).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(c).join(",")+"]"},BinaryExpression:function(e){return"("+c(e.left)+" "+e.operator+" "+c(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+c(e.argument)+")"},ConditionalExpression:function(e){return"("+c(e.test)+"?"+c(e.consequent)+":"+c(e.alternate)+")"},LogicalExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(c).join(",")+"}"},Property:function(e){f+=1;var t=c(e.key);f-=1;return t+":"+c(e.value)}};function h(e){var t={code:c(e),globals:Object.keys(s),fields:Object.keys(l)};s={};l={};return t}h.functions=i;h.constants=r;return h}var YU="intersect";var XU="union";var JU="vlMulti";var QU="vlPoint";var ZU="or";var KU="and";var eq="_vgsid_";var tq=gt(eq);var nq="E",rq="R",iq="R-E",aq="R-LE",oq="R-RE",uq="index:unit";function sq(e,t){var n=t.fields,r=t.values,i=n.length,a=0,o,u;for(;a<i;++a){u=n[a];u.getter=gt.getter||gt(u.field);o=u.getter(e);if(On(o))o=Pt(o);if(On(r[a]))r[a]=Pt(r[a]);if(On(r[a][0]))r[a]=r[a].map(Pt);if(u.type===nq){if(St(r[a])?r[a].indexOf(o)<0:o!==r[a]){return false}}else{if(u.type===rq){if(!wn(o,r[a]))return false}else if(u.type===oq){if(!wn(o,r[a],true,false))return false}else if(u.type===iq){if(!wn(o,r[a],false,false))return false}else if(u.type===aq){if(!wn(o,r[a],false,true))return false}}}return true}function lq(e,t,n){var r=this.context.data[e],i=r?r.values.value:[],a=r?r[uq]&&r[uq].value:undefined,o=n===YU,u=i.length,s=0,l,f,c,d,h;for(;s<u;++s){l=i[s];if(a&&o){f=f||{};c=f[d=l.unit]||0;if(c===-1)continue;h=sq(t,l);f[d]=h?-1:++c;if(h&&a.size===1)return true;if(!h&&c===a.get(d).count)return false}else{h=sq(t,l);if(o^h)return h}}return u&&o}var fq=ML(tq),cq=fq.left,dq=fq.right;function hq(e,t,n){var r=this.context.data[e],i=r?r.values.value:[],a=r?r[uq]&&r[uq].value:undefined,o=n===YU,u=tq(t),s=cq(i,u);if(s===i.length)return false;if(tq(i[s])!==u)return false;if(a&&o){if(a.size===1)return true;if(dq(i,u)-s<a.size)return false}return true}function pq(e,t){return e.map((function(e){var n;return hn(t.fields?{values:t.fields.map((function(t){return(t.getter||(t.getter=gt(t.field)))(e.datum)}))}:(n={},n[eq]=tq(e.datum),n),t)}))}function vq(e,t,n,r){var i,a,o;var u=this.context.data[e],s=u?u.values.value:[],l={},f={},c={},d,h,p,v,g,m,y,b,x,_,w=s.length,A=0,O,E;for(;A<w;++A){d=s[A];v=d.unit;h=d.fields;p=d.values;if(h&&p){for(O=0,E=h.length;O<E;++O){g=h[O];y=l[g.field]||(l[g.field]={});b=y[v]||(y[v]=[]);c[g.field]=x=g.type.charAt(0);_=gq["".concat(x,"_union")];y[v]=_(b,tn(p[O]))}if(n){b=f[v]||(f[v]=[]);b.push(tn(p).reduce((function(e,t,n){return e[h[n].field]=t,e}),{}))}}else{g=eq;m=tq(d);y=l[g]||(l[g]={});b=y[v]||(y[v]=[]);b.push(m);if(n){b=f[v]||(f[v]=[]);b.push((i={},i[eq]=m,i))}}}t=t||XU;if(l[eq]){l[eq]=gq["".concat(eq,"_").concat(t)].apply(gq,Object.values(l[eq]))}else{Object.keys(l).forEach((function(e){l[e]=Object.keys(l[e]).map((function(t){return l[e][t]})).reduce((function(n,r){return n===undefined?r:gq["".concat(c[e],"_").concat(t)](n,r)}))}))}s=Object.keys(f);if(n&&s.length){var k=r?QU:JU;l[k]=t===XU?(a={},a[ZU]=s.reduce((function(e,t){return e.push.apply(e,f[t]),e}),[]),a):(o={},o[KU]=s.map((function(e){var t;return t={},t[ZU]=f[e],t})),o)}return l}var gq=(Oe={},Oe["".concat(eq,"_union")]=zL,Oe["".concat(eq,"_intersect")]=NL,Oe.E_union=function(e,t){if(!e.length)return t;var n=0,r=t.length;for(;n<r;++n)if(e.indexOf(t[n])<0)e.push(t[n]);return e},Oe.E_intersect=function(e,t){return!e.length?t:e.filter((function(e){return t.indexOf(e)>=0}))},Oe.R_union=function(e,t){var n=Pt(t[0]),r=Pt(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(e[0]>n)e[0]=n;if(e[1]<r)e[1]=r;return e},Oe.R_intersect=function(e,t){var n=Pt(t[0]),r=Pt(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(r<e[0]||e[1]<n){return[]}else{if(e[0]<n)e[0]=n;if(e[1]>r)e[1]=r}return e},Oe);var mq=":",yq="@";function bq(e,t,n,r){if(t[0].type!==RL)pt("First argument to selection functions must be a string literal.");var i=t[0].value,a=t.length>=2&&zt(t).value,o="unit",u=yq+o,s=mq+i;if(a===YU&&!mn(r,u)){r[u]=n.getData(i).indataRef(n,o)}if(!mn(r,s)){r[s]=n.getData(i).tuplesRef()}}function xq(e){var t=this.context.data[e];return t?t.values.value:[]}function _q(e,t,n){var r=this.context.data[e]["index:"+t],i=r?r.value.get(n):undefined;return i?i.count:i}function wq(e,t){var n=this.context.dataflow,r=this.context.data[e],i=r.input;n.pulse(i,n.changeset().remove(_t).insert(t));return 1}function Aq(e,t,n){if(e){var r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==undefined?n:e}var Oq=function(e){return function(t,n){var r=this.context.dataflow.locale();return r[e](n)(t)}};var Eq=Oq("format");var kq=Oq("timeFormat");var Dq=Oq("utcFormat");var Cq=Oq("timeParse");var Fq=Oq("utcParse");var Sq=new Date(2e3,0,1);function jq(e,t,n){if(!Number.isInteger(e)||!Number.isInteger(t))return"";Sq.setYear(2e3);Sq.setMonth(e);Sq.setDate(t);return kq.call(this,Sq,n)}function Mq(e){return jq.call(this,e,1,"%B")}function Bq(e){return jq.call(this,e,1,"%b")}function Nq(e){return jq.call(this,0,2+e,"%A")}function Tq(e){return jq.call(this,0,2+e,"%a")}var zq=":";var Pq="@";var Rq="%";var Lq="$";function Iq(e,t,n,r){if(t[0].type!==xP){pt("First argument to data functions must be a string literal.")}var i=t[0].value,a=zq+i;if(!mn(a,r)){try{r[a]=n.getData(i).tuplesRef()}catch(o){}}}function Uq(e,t,n,r){if(t[0].type!==xP)pt("First argument to indata must be a string literal.");if(t[1].type!==xP)pt("Second argument to indata must be a string literal.");var i=t[0].value,a=t[1].value,o=Pq+a;if(!mn(o,r)){r[o]=n.getData(i).indataRef(n,a)}}function qq(e,t,n,r){if(t[0].type===xP){Wq(n,r,t[0].value)}else{for(e in n.scales){Wq(n,r,e)}}}function Wq(e,t,n){var r=Rq+n;if(!mn(t,r)){try{t[r]=e.scaleRef(n)}catch(i){}}}function Hq(e,t){if(rn(e)){return e}if(Cn(e)){var n=t.scales[e];return n&&Xg(n.value)?n.value:undefined}return undefined}function Gq(e,t,n){t.__bandwidth=function(e){return e&&e.bandwidth?e.bandwidth():0};n._bandwidth=qq;n._range=qq;n._scale=qq;var r=function(t){return"_["+(t.type===xP?Pn(Rq+t.value):Pn(Rq)+"+"+e(t))+"]"};return{_bandwidth:function(e){return"this.__bandwidth(".concat(r(e[0]),")")},_range:function(e){return"".concat(r(e[0]),".range()")},_scale:function(t){return"".concat(r(t[0]),"(").concat(e(t[1]),")")}}}function $q(e,t){return function(n,r,i){if(n){var a=Hq(n,(i||this).context);return a&&a.path[e](r)}else{return t(r)}}}var Vq=$q("area",RD);var Yq=$q("bounds",pC);var Xq=$q("centroid",qC);function Jq(e){var t=this.context.group;var n=false;if(t)while(e){if(e===t){n=true;break}e=e.mark.group}return n}function Qq(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Zq(){return Qq(this.context.dataflow,"warn",arguments)}function Kq(){return Qq(this.context.dataflow,"info",arguments)}function eW(){return Qq(this.context.dataflow,"debug",arguments)}function tW(e){var t=e/255;if(t<=.03928){return t/12.92}return Math.pow((t+.055)/1.055,2.4)}function nW(e){var t=te(e),n=tW(t.r),r=tW(t.g),i=tW(t.b);return.2126*n+.7152*r+.0722*i}function rW(e,t){var n=nW(e),r=nW(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function iW(){var e=[].slice.call(arguments);e.unshift({});return hn.apply(void 0,e)}function aW(e,t){return e===t||e!==e&&t!==t?true:St(e)?St(t)&&e.length===t.length?oW(e,t):false:jt(e)&&jt(t)?uW(e,t):false}function oW(e,t){for(var n=0,r=e.length;n<r;++n){if(!aW(e[n],t[n]))return false}return true}function uW(e,t){for(var n in e){if(!aW(e[n],t[n]))return false}return true}function sW(e){return function(t){return uW(e,t)}}function lW(e,t,n,r,i,a){var o=this.context.dataflow,u=this.context.data[e],s=u.input,l=o.stamp();var f=u.changes,c,d;if(o._trigger===false||!(s.value.length||t||r)){return 0}if(!f||f.stamp<l){u.changes=f=o.changeset();f.stamp=l;o.runAfter((function(){u.modified=true;o.pulse(s,f).run()}),true,1)}if(n){c=n===true?_t:St(n)||Xs(n)?n:sW(n);f.remove(c)}if(t){f.insert(t)}if(r){c=sW(r);if(s.value.some(c)){f.remove(c)}else{f.insert(r)}}if(i){for(d in a){f.modify(i,d,a[d])}}return 1}function fW(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function cW(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}var dW={};function hW(e,t){var n=dW[t]||(dW[t]=gt(t));return St(e)?e.map(n):n(e)}function pW(e){return St(e)||ArrayBuffer.isView(e)?e:null}function vW(e){return pW(e)||(Cn(e)?e:null)}function gW(e){var t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}return(t=pW(e)).join.apply(t,r)}function mW(e){var t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}return(t=vW(e)).indexOf.apply(t,r)}function yW(e){var t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}return(t=vW(e)).lastIndexOf.apply(t,r)}function bW(e){var t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}return(t=vW(e)).slice.apply(t,r)}function xW(e,t,n){if(rn(n))pt("Function argument passed to replace.");return String(e).replace(t,n)}function _W(e){return pW(e).slice().reverse()}function wW(e,t,n){return pg(e||0,t||0,n||0)}function AW(e,t){var n=Hq(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function OW(e,t){var n=Hq(e,(t||this).context);return n?n.copy():undefined}function EW(e,t){var n=Hq(e,(t||this).context);return n?n.domain():[]}function kW(e,t,n){var r=Hq(e,(n||this).context);return!r?undefined:St(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t)}function DW(e,t){var n=Hq(e,(t||this).context);return n&&n.range?n.range():[]}function CW(e,t,n){var r=Hq(e,(n||this).context);return r?r(t):undefined}function FW(e,t,n,r,i){e=Hq(e,(i||this).context);var a=Km(t,n);var o=e.domain(),u=o[0],s=zt(o),l=yt;if(!(s-u)){e=(e.interpolator?Qg("sequential")().interpolator(e.interpolator()):Qg("linear")().interpolate(e.interpolate()).range(e.range())).domain([u=0,s=1])}else{l=cm(e,u,s)}if(e.ticks){o=e.ticks(+r||15);if(u!==o[0])o.unshift(u);if(s!==zt(o))o.push(s)}o.forEach((function(t){return a.stop(l(t),e(t))}));return a}function SW(e,t,n){var r=Hq(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}function jW(e){var t=null;return function(n){return n?_y(n,t=t||uy(e)):e}}var MW=function(e){return e.data};function BW(e,t){var n=xq.call(t,e);return n.root&&n.root.lookup||{}}function NW(e,t,n){var r=BW(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(MW):undefined}function TW(e,t){var n=BW(e,this)[t];return n?n.ancestors().map(MW):undefined}var zW=function(){return typeof window!=="undefined"&&window||null};function PW(){var e=zW();return e?e.screen:{}}function RW(){var e=zW();return e?[e.innerWidth,e.innerHeight]:[undefined,undefined]}function LW(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[undefined,undefined]}function IW(e,t,n){if(!e)return[];var r=e[0],i=e[1],a=(new wb).set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return oO(o,a,UW(t))}function UW(e){var t=null;if(e){var n=tn(e.marktype),r=tn(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}function qW(e,t,n){var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;e=tn(e);var i=e[e.length-1];return i===undefined||Math.hypot(i[0]-t,i[1]-n)>r?__spreadArray(__spreadArray([],e,true),[[t,n]],false):e}function WW(e){return tn(e).reduce((function(t,n,r){var i=n[0],a=n[1];return t+=r==0?"M ".concat(i,",").concat(a," "):r===e.length-1?" Z":"L ".concat(i,",").concat(a," ")}),"")}function HW(e,t,n){var r=n.x,i=n.y,a=n.mark;var o=(new wb).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(var u=0,s=t;u<s.length;u++){var l=s[u],f=l[0],c=l[1];if(f<o.x1)o.x1=f;if(f>o.x2)o.x2=f;if(c<o.y1)o.y1=c;if(c>o.y2)o.y2=c}o.translate(r,i);var d=IW([[o.x1,o.y1],[o.x2,o.y2]],e,a);return d.filter((function(e){return GW(e.x,e.y,t)}))}function GW(e,t,n){var r=0;for(var i=0,a=n.length-1;i<n.length;a=i++){var o=n[a],u=o[0],s=o[1];var l=n[i],f=l[0],c=l[1];if(c>t!=s>t&&e<(u-f)*(t-c)/(s-c)+f){r++}}return r&1}var $W={random:function(){return _f()},cumulativeNormal:Bf,cumulativeLogNormal:If,cumulativeUniform:$f,densityNormal:Mf,densityLogNormal:Lf,densityUniform:Gf,quantileNormal:Nf,quantileLogNormal:Uf,quantileUniform:Vf,sampleNormal:jf,sampleLogNormal:Rf,sampleUniform:Hf,isArray:St,isBoolean:An,isDate:On,isDefined:function(e){return e!==undefined},isNumber:kn,isObject:jt,isRegExp:Dn,isString:Cn,isTuple:Xs,isValid:function(e){return e!=null&&e===e},toBoolean:Rn,toDate:function(e){return In(e)},toNumber:Pt,toString:Un,indexof:mW,join:gW,lastindexof:yW,replace:xW,reverse:_W,slice:bW,flush:xn,lerp:Sn,merge:iW,pad:Tn,peek:zt,pluck:hW,span:zn,inrange:wn,truncate:Wn,rgb:te,lab:_p,hcl:Cp,hsl:q,luminance:nW,contrast:rW,sequence:Qr,format:Eq,utcFormat:Dq,utcParse:Fq,utcOffset:Za,utcSequence:to,timeFormat:kq,timeParse:Cq,timeOffset:Qa,timeSequence:eo,timeUnitSpecifier:wa,monthFormat:Mq,monthAbbrevFormat:Bq,dayFormat:Nq,dayAbbrevFormat:Tq,quarter:Kt,utcquarter:en,week:ka,utcweek:Ma,dayofyear:Ea,utcdayofyear:ja,warn:Zq,info:Kq,debug:eW,extent:function(e){return pn(e)},inScope:Jq,intersect:IW,clampRange:nn,pinchDistance:fW,pinchAngle:cW,screen:PW,containerSize:LW,windowSize:RW,bandspace:wW,setdata:wq,pathShape:jW,panLinear:Ht,panLog:Gt,panPow:$t,panSymlog:Vt,zoomLinear:Xt,zoomLog:Jt,zoomPow:Qt,zoomSymlog:Zt,encode:Aq,modify:lW,lassoAppend:qW,lassoPath:WW,intersectLasso:HW};var VW=["view","item","group","xy","x","y"],YW="event.vega.",XW="this.",JW={};var QW={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_[".concat(Pn(Lq+e),"]")},functions:KW,constants:kL,visitors:JW};var ZW=FL(QW);function KW(e){var t=DL(e);VW.forEach((function(e){return t[e]=YW+e}));for(var n in $W){t[n]=XW+n}hn(t,Gq(e,$W,JW));return t}function eH(e,t,n){if(arguments.length===1){return $W[e]}$W[e]=t;if(n)JW[e]=n;if(ZW)ZW.functions[e]=XW+e;return this}eH("bandwidth",AW,qq);eH("copy",OW,qq);eH("domain",EW,qq);eH("range",DW,qq);eH("invert",kW,qq);eH("scale",CW,qq);eH("gradient",FW,qq);eH("geoArea",Vq,qq);eH("geoBounds",Yq,qq);eH("geoCentroid",Xq,qq);eH("geoShape",SW,qq);eH("indata",_q,Uq);eH("data",xq,Iq);eH("treePath",NW,Iq);eH("treeAncestors",TW,Iq);eH("vlSelectionTest",lq,bq);eH("vlSelectionIdTest",hq,bq);eH("vlSelectionResolve",vq,bq);eH("vlSelectionTuples",pq);function tH(e,t){var n={};var r;try{e=Cn(e)?e:Pn(e)+"";r=EL(e)}catch(a){pt("Expression parse error: "+e)}r.visit((function(e){if(e.type!==EP)return;var r=e.callee.name,i=QW.visitors[r];if(i)i(r,e.arguments,t,n)}));var i=ZW(r);i.globals.forEach((function(e){var r=Lq+e;if(!mn(n,r)&&t.getSignal(e)){n[r]=t.signalRef(e)}}));return{$expr:hn({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function nH(e){var t=this,n=e.operators||[];if(e.background){t.background=e.background}if(e.eventConfig){t.eventConfig=e.eventConfig}if(e.locale){t.locale=e.locale}n.forEach((function(e){return t.parseOperator(e)}));n.forEach((function(e){return t.parseOperatorParameters(e)}));(e.streams||[]).forEach((function(e){return t.parseStream(e)}));(e.updates||[]).forEach((function(e){return t.parseUpdate(e)}));return t.resolve()}var rH=qn(["rule"]),iH=qn(["group","image","rect"]);function aH(e,t){var n="";if(rH[t])return n;if(e.x2){if(e.x){if(iH[t]){n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"}n+="o.width=o.x2-o.x;"}else{n+="o.x=o.x2-(o.width||0);"}}if(e.xc){n+="o.x=o.xc-(o.width||0)/2;"}if(e.y2){if(e.y){if(iH[t]){n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"}n+="o.height=o.y2-o.y;"}else{n+="o.y=o.y2-(o.height||0);"}}if(e.yc){n+="o.y=o.yc-(o.height||0)/2;"}return n}function oH(e){return(e+"").toLowerCase()}function uH(e){return oH(e)==="operator"}function sH(e){return oH(e)==="collect"}function lH(e,t,n){if(!n.endsWith(";")){n="return("+n+");"}var r=Function.apply(void 0,t.concat(n));return e&&e.functions?r.bind(e.functions):r}function fH(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}var cH={operator:function(e,t){return lH(e,["_"],t.code)},parameter:function(e,t){return lH(e,["datum","_"],t.code)},event:function(e,t){return lH(e,["event"],t.code)},handler:function(e,t){var n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return lH(e,["_","event"],n)},encode:function(e,t){var n=t.marktype,r=t.channels;var i="var o=item,datum=o.datum,m=0,$;";for(var a in r){var o="o["+Pn(a)+"]";i+="$=".concat(r[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}i+=aH(r,n);i+="return m;";return lH(e,["item","_"],i)},codegen:{get:function(e){var t="[".concat(e.map(Pn).join("]["),"]");var n=Function("_","return _".concat(t,";"));n.path=t;return n},comparator:function(e,t){var n;var r=function(e,r){var i=t[r];var a,o;if(e.path){a="a".concat(e.path);o="b".concat(e.path)}else{(n=n||{})["f"+r]=e;a="this.f".concat(r,"(a)");o="this.f".concat(r,"(b)")}return fH(a,o,-i,i)};var i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function dH(e){var t=this;if(uH(e.type)||!e.type){t.operator(e,e.update?t.operatorExpression(e.update):null)}else{t.transform(e,e.type)}}function hH(e){var t=this;if(e.params){var n=t.get(e.id);if(!n)pt("Invalid operator id: "+e.id);t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function pH(e,t){t=t||{};var n=this;for(var r in e){var i=e[r];t[r]=St(i)?i.map((function(e){return vH(e,n,t)})):vH(i,n,t)}return t}function vH(e,t,n){if(!e||!jt(e))return e;for(var r=0,i=gH.length,a=void 0;r<i;++r){a=gH[r];if(mn(e,a.key)){return a.parse(e,t,n)}}return e}var gH=[{key:"$ref",parse:mH},{key:"$key",parse:bH},{key:"$expr",parse:yH},{key:"$field",parse:xH},{key:"$encode",parse:wH},{key:"$compare",parse:_H},{key:"$context",parse:AH},{key:"$subflow",parse:OH},{key:"$tupleid",parse:EH}];function mH(e,t){return t.get(e.$ref)||pt("Operator not defined: "+e.$ref)}function yH(e,t,n){if(e.$params){t.parseParameters(e.$params,n)}var r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=st(t.parameterExpression(e.$expr),e.$fields))}function bH(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Fn(e.$key,e.$flat,t.expr.codegen))}function xH(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=gt(e.$field,e.$name,t.expr.codegen))}function _H(e,t){var n="c:"+e.$compare+"_"+e.$order,r=tn(e.$compare).map((function(e){return e&&e.$tupleid?Js:e}));return t.fn[n]||(t.fn[n]=on(r,e.$order,t.expr.codegen))}function wH(e,t){var n=e.$encode,r={};for(var i in n){var a=n[i];r[i]=st(t.encodeExpression(a.$expr),a.$fields);r[i].output=a.$output}return r}function AH(e,t){return t}function OH(e,t){var n=e.$subflow;return function(e,r,i){var a=t.fork().parse(n),o=a.get(n.operators[0].id),u=a.signals.parent;if(u)u.set(i);o.detachSubflow=function(){return t.detach(a)};return o}}function EH(){return Js}function kH(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):undefined,r=e.stream!=null?t.get(e.stream):undefined,i;if(e.source){r=t.events(e.source,e.type,n)}else if(e.merge){i=e.merge.map((function(e){return t.get(e)}));r=i[0].merge.apply(i[0],i.slice(1))}if(e.between){i=e.between.map((function(e){return t.get(e)}));r=r.between(i[0],i[1])}if(e.filter){r=r.filter(n)}if(e.throttle!=null){r=r.throttle(+e.throttle)}if(e.debounce!=null){r=r.debounce(+e.debounce)}if(r==null){pt("Invalid stream definition: "+JSON.stringify(e))}if(e.consume)r.consume(true);t.stream(e,r)}function DH(e){var t=this,n=jt(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=undefined;if(!r)pt("Source not defined: "+e.source);i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target);if(a&&a.$expr){if(a.$params){o=t.parseParameters(a.$params)}a=t.handlerExpression(a.$expr)}t.update(e,r,i,a,o)}var CH={skip:true};function FH(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((function(n){var i=t.signals[n];if(e.signals(n,i)){r[n]=i.value}}))}if(e.data){var i=n.data={};Object.keys(t.data).forEach((function(n){var r=t.data[n];if(e.data(n,r)){i[n]=r.input.value}}))}if(t.subcontext&&e.recurse!==false){n.subcontext=t.subcontext.map((function(t){return t.getState(e)}))}return n}function SH(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((function(e){n.update(t.signals[e],i[e],CH)}));Object.keys(r||{}).forEach((function(e){n.pulse(t.data[e].input,n.changeset().remove(_t).insert(r[e]))}));(e.subcontext||[]).forEach((function(e,n){var r=t.subcontext[n];if(r)r.setState(e)}))}function jH(e,t,n,r){return new MH(e,t,n,r)}function MH(e,t,n,r){this.dataflow=e;this.transforms=t;this.events=e.events.bind(e);this.expr=r||cH,this.signals={};this.scales={};this.nodes={};this.data={};this.fn={};if(n){this.functions=Object.create(n);this.functions.context=this}}function BH(e){this.dataflow=e.dataflow;this.transforms=e.transforms;this.events=e.events;this.expr=e.expr;this.signals=Object.create(e.signals);this.scales=Object.create(e.scales);this.nodes=Object.create(e.nodes);this.data=Object.create(e.data);this.fn=Object.create(e.fn);if(e.functions){this.functions=Object.create(e.functions);this.functions.context=this}}MH.prototype=BH.prototype={fork:function(){var e=new BH(this);(this.subcontext||(this.subcontext=[])).push(e);return e},detach:function(e){this.subcontext=this.subcontext.filter((function(t){return t!==e}));var t=Object.keys(e.nodes);for(var n=0,r=t;n<r.length;n++){var i=r[n];e.nodes[i]._targets=null}for(var a=0,o=t;a<o.length;a++){var u=o[a];e.nodes[u].detach()}e.nodes=null},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,i=e.value;n.set(e.id,t);if(sH(e.type)&&i){if(i.$ingest){r.ingest(t,i.$ingest,i.$format)}else if(i.$request){r.preload(t,i.$request,i.$format)}else{r.pulse(t,r.changeset().insert(i))}}if(e.root){n.root=t}if(e.parent){var a=n.get(e.parent.$ref);if(a){r.connect(a,[t]);t.targets().add(a)}else{(n.unresolved=n.unresolved||[]).push((function(){a=n.get(e.parent.$ref);r.connect(a,[t]);t.targets().add(a)}))}}if(e.signal){n.signals[e.signal]=t}if(e.scale){n.scales[e.scale]=t}if(e.data){var o=function(r){var i=n.data[r]||(n.data[r]={});e.data[r].forEach((function(e){return i[e]=t}))};for(var u in e.data){o(u)}}},resolve:function(){(this.unresolved||[]).forEach((function(e){return e()}));delete this.unresolved;return this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[oH(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression:function(e){return this.expr.operator(this,e)},parameterExpression:function(e){return this.expr.parameter(this,e)},eventExpression:function(e){return this.expr.event(this,e)},handlerExpression:function(e){return this.expr.handler(this,e)},encodeExpression:function(e){return this.expr.encode(this,e)},parse:nH,parseOperator:dH,parseOperatorParameters:hH,parseParameters:pH,parseStream:kH,parseUpdate:DH,getState:FH,setState:SH};function NH(e){var t=e.container();if(t){t.setAttribute("role","graphics-document");t.setAttribute("aria-roleDescription","visualization");TH(t,e.description())}}function TH(e,t){if(e)t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t)}function zH(e){e.add(null,(function(t){e._background=t.bg;e._resize=1;return t.bg}),{bg:e._signals.background})}var PH="default";function RH(e){var t=e._signals.cursor||(e._signals.cursor=e.add({user:PH,item:null}));e.on(e.events("view","mousemove"),t,(function(e,n){var r=t.value,i=r?Cn(r)?r:r.user:PH,a=n.item&&n.item.cursor||null;return r&&i===r.user&&a==r.item?r:{user:i,item:a}}));e.add(null,(function(t){var n=t.cursor,r=this.value;if(!Cn(n)){r=n.item;n=n.user}LH(e,n&&n!==PH?n:r||n);return r}),{cursor:t})}function LH(e,t){var n=e.globalCursor()?typeof document!=="undefined"&&document.body:e.container();if(n){return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}}function IH(e,t){var n=e._runtime.data;if(!mn(n,t)){pt("Unrecognized data set: "+t)}return n[t]}function UH(e,t){return arguments.length<2?IH(this,e).values.value:qH.call(this,e,il().remove(_t).insert(t))}function qH(e,t){if(!rl(t)){pt("Second argument to changes must be a changeset.")}var n=IH(this,e);n.modified=true;return this.pulse(n.input,t)}function WH(e,t){return qH.call(this,e,il().insert(t))}function HH(e,t){return qH.call(this,e,il().remove(t))}function GH(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function $H(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function VH(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function YH(e){var t=VH(e),n=GH(e),r=$H(e);e._renderer.background(e.background());e._renderer.resize(n,r,t);e._handler.origin(t);e._resizeListeners.forEach((function(t){try{t(n,r)}catch(pt){e.error(pt)}}))}function XH(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,u;if(i){u=VH(e);o=t.changedTouches?t.changedTouches[0]:t;a=vw(o,i);a[0]-=u[0];a[1]-=u[1]}t.dataflow=e;t.item=n;t.vega=JH(e,n,a);return t}function JH(e,t,n){var r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(e){var n=r,i;if(e)for(i=t;i;i=i.mark.group){if(i.mark.name===e){n=i;break}}return n&&n.mark&&n.mark.interactive?n:{}}function a(e){if(!e)return n;if(Cn(e))e=i(e);var t=n.slice();while(e){t[0]-=e.x||0;t[1]-=e.y||0;e=e.mark&&e.mark.group}return t}return{view:cn(e),item:cn(t||{}),group:i,xy:a,x:function(e){return a(e)[0]},y:function(e){return a(e)[1]}}}var QH="view",ZH="timer",KH="window",eG={trap:false};function tG(e){var t=hn({defaults:{}},e);var n=function(e,t){t.forEach((function(t){if(St(e[t]))e[t]=qn(e[t])}))};n(t.defaults,["prevent","allow"]);n(t,["view","window","selector"]);return t}function nG(e,t,n,r){e._eventListeners.push({type:n,sources:tn(t),handler:r})}function rG(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===false||i===true?false:r===true||i===false?true:r?r[t]:i?!i[t]:e.preventDefault()}function iG(e,t,n){var r=e._eventConfig&&e._eventConfig[t];if(r===false||jt(r)&&!r[n]){e.warn("Blocked ".concat(t," ").concat(n," event listener."));return false}return true}function aG(e,t,n){var r=this,i=new ml(n),a=function(n,a){r.runAsync(null,(function(){if(e===QH&&rG(r,t)){n.preventDefault()}i.receive(XH(r,n,a))}))},o;if(e===ZH){if(iG(r,"timer",t)){r.timer(a,t)}}else if(e===QH){if(iG(r,"view",t)){r.addEventListener(t,a,eG)}}else{if(e===KH){if(iG(r,"window",t)&&typeof window!=="undefined"){o=[window]}}else if(typeof document!=="undefined"){if(iG(r,"selector",t)){o=Array.from(document.querySelectorAll(e))}}if(!o){r.warn("Can not resolve event source: "+e)}else{for(var u=0,s=o.length;u<s;++u){o[u].addEventListener(t,a)}nG(r,o,t,a)}}return i}function oG(e){return e.item}function uG(e){return e.item.mark.source}function sG(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function lG(e,t){e=[e||"hover"];t=[t||"update",e[0]];this.on(this.events("view","mouseover",oG),uG,sG(e));this.on(this.events("view","mouseout",oG),uG,sG(t));return this}function fG(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;r=t.length;while(--r>=0){t[r].stop()}r=n.length;while(--r>=0){a=n[r];i=a.sources.length;while(--i>=0){a.sources[i].removeEventListener(a.type,a.handler)}}if(e){e.call(this,this._handler,null,null,null)}return this}function cG(e,t,n){var r=document.createElement(e);for(var i in t)r.setAttribute(i,t[i]);if(n!=null)r.textContent=n;return r}var dG="vega-bind",hG="vega-bind-name",pG="vega-bind-radio";function vG(e,t,n){if(!t)return;var r=n.param;var i=n.state;if(!i){i=n.state={elements:null,active:false,set:null,update:function(t){if(t!=e.signal(r.signal)){e.runAsync(null,(function(){i.source=true;e.signal(r.signal,t)}))}}};if(r.debounce){i.update=dn(r.debounce,i.update)}}var a=r.input==null&&r.element?gG:yG;a(i,t,r,e);if(!i.active){e.on(e._signals[r.signal],null,(function(){i.source?i.source=false:i.set(e.signal(r.signal))}));i.active=true}return i}function gG(e,t,n,r){var i=n.event||"input";var a=function(){return e.update(t.value)};r.signal(n.signal,t.value);t.addEventListener(i,a);nG(r,t,i,a);e.set=function(e){t.value=e;t.dispatchEvent(mG(i))}}function mG(e){return typeof Event!=="undefined"?new Event(e):{type:e}}function yG(e,t,n,r){var i=r.signal(n.signal);var a=cG("div",{class:dG});var o=n.input==="radio"?a:a.appendChild(cG("label"));o.appendChild(cG("span",{class:hG},n.name||n.signal));t.appendChild(a);var u=bG;switch(n.input){case"checkbox":u=xG;break;case"select":u=_G;break;case"radio":u=wG;break;case"range":u=AG;break}u(e,o,n,i)}function bG(e,t,n,r){var i=cG("input");for(var a in n){if(a!=="signal"&&a!=="element"){i.setAttribute(a==="input"?"type":a,n[a])}}i.setAttribute("name",n.signal);i.value=r;t.appendChild(i);i.addEventListener("input",(function(){return e.update(i.value)}));e.elements=[i];e.set=function(e){return i.value=e}}function xG(e,t,n,r){var i={type:"checkbox",name:n.signal};if(r)i.checked=true;var a=cG("input",i);t.appendChild(a);a.addEventListener("change",(function(){return e.update(a.checked)}));e.elements=[a];e.set=function(e){return a.checked=!!e||null}}function _G(e,t,n,r){var i=cG("select",{name:n.signal}),a=n.labels||[];n.options.forEach((function(e,t){var n={value:e};if(OG(e,r))n.selected=true;i.appendChild(cG("option",n,(a[t]||e)+""))}));t.appendChild(i);i.addEventListener("change",(function(){e.update(n.options[i.selectedIndex])}));e.elements=[i];e.set=function(e){for(var t=0,r=n.options.length;t<r;++t){if(OG(n.options[t],e)){i.selectedIndex=t;return}}}}function wG(e,t,n,r){var i=cG("span",{class:pG}),a=n.labels||[];t.appendChild(i);e.elements=n.options.map((function(t,o){var u={type:"radio",name:n.signal,value:t};if(OG(t,r))u.checked=true;var s=cG("input",u);s.addEventListener("change",(function(){return e.update(t)}));var l=cG("label",{},(a[o]||t)+"");l.prepend(s);i.appendChild(l);return s}));e.set=function(t){var n=e.elements,r=n.length;for(var i=0;i<r;++i){if(OG(n[i].value,t))n[i].checked=true}}}function AG(e,t,n,r){r=r!==undefined?r:(+n.max+ +n.min)/2;var i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||Ir(a,i,100);var u=cG("input",{type:"range",name:n.signal,min:a,max:i,step:o});u.value=r;var s=cG("span",{},+r);t.appendChild(u);t.appendChild(s);var l=function(){s.textContent=u.value;e.update(+u.value)};u.addEventListener("input",l);u.addEventListener("change",l);e.elements=[u];e.set=function(e){u.value=e;s.textContent=e}}function OG(e,t){return e===t||e+""===t+""}function EG(e,t,n,r,i,a){t=t||new r(e.loader());return t.initialize(n,GH(e),$H(e),VH(e),i,a).background(e.background())}function kG(e,t){return!t?null:function(){try{t.apply(this,arguments)}catch(pt){e.error(pt)}}}function DG(e,t,n,r){var i=new r(e.loader(),kG(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,VH(e),e);if(t){t.handlers().forEach((function(e){i.on(e.type,e.handler)}))}return i}function CG(e,t){var n=this,r=n._renderType,i=n._eventConfig.bind,a=aO(r);e=n._el=e?FG(n,e,true):null;NH(n);if(!a)n.error("Unrecognized renderer type: "+r);var o=a.handler||qw,u=e?a.renderer:a.headless;n._renderer=!u?null:EG(n,n._renderer,e,u);n._handler=DG(n,n._handler,e,o);n._redraw=true;if(e&&i!=="none"){t=t?n._elBind=FG(n,t,true):e.appendChild(cG("form",{class:"vega-bindings"}));n._bind.forEach((function(e){if(e.param.element&&i!=="container"){e.element=FG(n,e.param.element,!!e.param.input)}}));n._bind.forEach((function(e){vG(n,e.element||t,e)}))}return n}function FG(e,t,n){if(typeof t==="string"){if(typeof document!=="undefined"){t=document.querySelector(t);if(!t){e.error("Signal bind element not found: "+t);return null}}else{e.error("DOM document instance not found.");return null}}if(t&&n){try{t.textContent=""}catch(Bse){t=null;e.error(Bse)}}return t}var SG=function(e){return+e||0};var jG=function(e){return{top:e,bottom:e,left:e,right:e}};function MG(e){return jt(e)?{top:SG(e.top),bottom:SG(e.bottom),left:SG(e.left),right:SG(e.right)}:jG(SG(e))}function BG(e,t,n,r){return __awaiter(this,void 0,void 0,(function(){var i,a;return __generator(this,(function(o){switch(o.label){case 0:i=aO(t),a=i&&i.headless;if(!a)pt("Unrecognized renderer type: "+t);return[4,e.runAsync()];case 1:o.sent();return[2,EG(e,null,null,a,n,r).renderAsync(e._scenegraph.root)]}}))}))}function NG(e,t){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:if(e!==rO.Canvas&&e!==rO.SVG&&e!==rO.PNG){pt("Unrecognized image type: "+e)}return[4,BG(this,e,t)];case 1:n=r.sent();return[2,e===rO.SVG?TG(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")]}}))}))}function TG(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function zG(e,t){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return[4,BG(this,rO.Canvas,e,t)];case 1:n=r.sent();return[2,n.canvas()]}}))}))}function PG(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return[4,BG(this,rO.SVG,e)];case 1:t=n.sent();return[2,t.svg()]}}))}))}function RG(e,t,n){return jH(e,hf,$W,n).parse(t)}function LG(e){var t=this._runtime.scales;if(!mn(t,e)){pt("Unrecognized scale or projection: "+e)}return t[e].value}var IG="width",UG="height",qG="padding",WG={skip:true};function HG(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===qG?r.left+r.right:0)}function GG(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===qG?r.top+r.bottom:0)}function $G(e){var t=e._signals,n=t[IG],r=t[UG],i=t[qG];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size;e._viewWidth=HG(e,t.size);a()}),{size:n});e._resizeHeight=e.add(null,(function(t){e._height=t.size;e._viewHeight=GG(e,t.size);a()}),{size:r});var o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1;e._resizeHeight.rank=r.rank+1;o.rank=i.rank+1}function VG(e,t,n,r,i,a){this.runAfter((function(o){var u=0;o._autosize=0;if(o.width()!==n){u=1;o.signal(IG,n,WG);o._resizeWidth.skip(true)}if(o.height()!==r){u=1;o.signal(UG,r,WG);o._resizeHeight.skip(true)}if(o._viewWidth!==e){o._resize=1;o._viewWidth=e}if(o._viewHeight!==t){o._resize=1;o._viewHeight=t}if(o._origin[0]!==i[0]||o._origin[1]!==i[1]){o._resize=1;o._origin=i}if(u)o.run("enter");if(a)o.runAfter((function(e){return e.resize()}))}),false,1)}function YG(e){return this._runtime.getState(e||{data:XG,signals:JG,recurse:true})}function XG(e,t){return t.modified&&St(t.input.value)&&e.indexOf("_:vega:_")}function JG(e,t){return!(e==="parent"||t instanceof hf.proxy)}function QG(e){this.runAsync(null,(function(t){t._trigger=false;t._runtime.setState(e)}),(function(e){e._trigger=true}));return this}function ZG(e,t){function n(t){e({timestamp:Date.now(),elapsed:t})}this._timers.push(WM(n,t))}function KG(e,t,n,r){var i=e.element();if(i)i.setAttribute("title",e$(r))}function e$(e){return e==null?"":St(e)?n$(e):jt(e)&&!On(e)?t$(e):e+""}function t$(e){return Object.keys(e).map((function(t){var n=e[t];return t+": "+(St(n)?n$(n):r$(n))})).join("\n")}function n$(e){return"["+e.map(r$).join(", ")+"]"}function r$(e){return St(e)?"[…]":jt(e)&&!On(e)?"{…}":e}function i$(e,t){var n=this;t=t||{};ff.call(n);if(t.loader)n.loader(t.loader);if(t.logger)n.logger(t.logger);if(t.logLevel!=null)n.logLevel(t.logLevel);if(t.locale||e.locale){var r=hn({},e.locale,t.locale);n.locale(ss(r.number,r.time))}n._el=null;n._elBind=null;n._renderType=t.renderer||rO.Canvas;n._scenegraph=new sw;var i=n._scenegraph.root;n._renderer=null;n._tooltip=t.tooltip||KG,n._redraw=true;n._handler=(new qw).scene(i);n._globalCursor=false;n._preventDefault=false;n._timers=[];n._eventListeners=[];n._resizeListeners=[];n._eventConfig=tG(e.eventConfig);n.globalCursor(n._eventConfig.globalCursor);var a=RG(n,e,t.expr);n._runtime=a;n._signals=a.signals;n._bind=(e.bindings||[]).map((function(e){return{state:null,param:hn({},e)}}));if(a.root)a.root.set(i);i.source=a.data.root.input;n.pulse(a.data.root.input,n.changeset().insert(i.items));n._width=n.width();n._height=n.height();n._viewWidth=HG(n,n._width);n._viewHeight=GG(n,n._height);n._origin=[0,0];n._resize=0;n._autosize=1;$G(n);zH(n);RH(n);n.description(e.description);if(t.hover)n.hover();if(t.container)n.initialize(t.container,t.bind)}function a$(e,t){return mn(e._signals,t)?e._signals[t]:pt("Unrecognized signal name: "+Pn(t))}function o$(e,t){var n=(e._targets||[]).filter((function(e){return e._update&&e._update.handler===t}));return n.length?n[0]:null}function u$(e,t,n,r){var i=o$(n,r);if(!i){i=kG(e,(function(){return r(t,n.value)}));i.handler=r;e.on(n,null,i)}return e}function s$(e,t,n){var r=o$(t,n);if(r)t._targets.remove(r);return e}_n(i$,ff,{evaluate:function(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:return[4,ff.prototype.evaluate.call(this,e,t)];case 1:i.sent();if(!(this._redraw||this._resize))return[3,6];i.label=2;case 2:i.trys.push([2,5,,6]);if(!this._renderer)return[3,4];if(this._resize){this._resize=0;YH(this)}return[4,this._renderer.renderAsync(this._scenegraph.root)];case 3:i.sent();i.label=4;case 4:this._redraw=false;return[3,6];case 5:r=i.sent();this.error(r);return[3,6];case 6:if(n)$s(this,n);return[2,this]}}))}))},dirty:function(e){this._redraw=true;this._renderer&&this._renderer.dirty(e)},description:function(e){if(arguments.length){var t=e!=null?e+"":null;if(t!==this._desc)TH(this._el,this._desc=t);return this}return this._desc},container:function(){return this._el},scenegraph:function(){return this._scenegraph},origin:function(){return this._origin.slice()},signal:function(e,t,n){var r=a$(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width:function(e){return arguments.length?this.signal("width",e):this.signal("width")},height:function(e){return arguments.length?this.signal("height",e):this.signal("height")},padding:function(e){return arguments.length?this.signal("padding",MG(e)):MG(this.signal("padding"))},autosize:function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background:function(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer:function(e){if(!arguments.length)return this._renderType;if(!aO(e))pt("Unrecognized renderer type: "+e);if(e!==this._renderType){this._renderType=e;this._resetRenderer()}return this},tooltip:function(e){if(!arguments.length)return this._tooltip;if(e!==this._tooltip){this._tooltip=e;this._resetRenderer()}return this},loader:function(e){if(!arguments.length)return this._loader;if(e!==this._loader){ff.prototype.loader.call(this,e);this._resetRenderer()}return this},resize:function(){this._autosize=1;return this.touch(a$(this,"autosize"))},_resetRenderer:function(){if(this._renderer){this._renderer=null;this.initialize(this._el,this._elBind)}},_resizeView:VG,addEventListener:function(e,t,n){var r=t;if(!(n&&n.trap===false)){r=kG(this,t);r.raw=t}this._handler.on(e,r);return this},removeEventListener:function(e,t){var n=this._handler.handlers(e),r=n.length,i,a;while(--r>=0){a=n[r].type;i=n[r].handler;if(e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}}return this},addResizeListener:function(e){var t=this._resizeListeners;if(t.indexOf(e)<0){t.push(e)}return this},removeResizeListener:function(e){var t=this._resizeListeners,n=t.indexOf(e);if(n>=0){t.splice(n,1)}return this},addSignalListener:function(e,t){return u$(this,e,a$(this,e),t)},removeSignalListener:function(e,t){return s$(this,a$(this,e),t)},addDataListener:function(e,t){return u$(this,e,IH(this,e).values,t)},removeDataListener:function(e,t){return s$(this,IH(this,e).values,t)},globalCursor:function(e){if(arguments.length){if(this._globalCursor!==!!e){var t=LH(this,null);this._globalCursor=!!e;if(t)LH(this,t)}return this}else{return this._globalCursor}},preventDefault:function(e){if(arguments.length){this._preventDefault=e;return this}else{return this._preventDefault}},timer:ZG,events:aG,finalize:fG,hover:lG,data:UH,change:qH,insert:WH,remove:HH,scale:LG,initialize:CG,toImageURL:NG,toCanvas:zG,toSVG:PG,getState:YG,setState:QG});var l$="view",f$="[",c$="]",d$="{",h$="}",p$=":",v$=",",g$="@",m$=">",y$=/[[\]{}]/,b$={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};var x$,_$;function w$(e,t,n){x$=t||l$;_$=n||b$;return E$(e.trim()).map(k$)}function A$(e){return _$[e]}function O$(e,t,n,r,i){var a=e.length;var o=0,u;for(;t<a;++t){u=e[t];if(!o&&u===n)return t;else if(i&&i.indexOf(u)>=0)--o;else if(r&&r.indexOf(u)>=0)++o}return t}function E$(e){var t=[],n=e.length;var r=0,i=0;while(i<n){i=O$(e,i,v$,f$+d$,c$+h$);t.push(e.substring(r,i).trim());r=++i}if(t.length===0){throw"Empty event selector: "+e}return t}function k$(e){return e[0]==="["?D$(e):C$(e)}function D$(e){var t=e.length;var n=1,r;n=O$(e,n,c$,f$,c$);if(n===t){throw"Empty between selector: "+e}r=E$(e.substring(1,n));if(r.length!==2){throw"Between selector must have two elements: "+e}e=e.slice(n+1).trim();if(e[0]!==m$){throw"Expected '>' after between selector: "+e}r=r.map(k$);var i=k$(e.slice(1).trim());if(i.between){return{between:r,stream:i}}else{i.between=r}return i}function C$(e){var t={source:x$},n=[];var r=[0,0],i=0,a=0,o=e.length,u=0,s,l;if(e[o-1]===h$){u=e.lastIndexOf(d$);if(u>=0){try{r=F$(e.substring(u+1,o-1))}catch(Bse){throw"Invalid throttle specification: "+e}e=e.slice(0,u).trim();o=e.length}else throw"Unmatched right brace: "+e;u=0}if(!o)throw e;if(e[0]===g$)i=++u;s=O$(e,u,p$);if(s<o){n.push(e.substring(a,s).trim());a=u=++s}u=O$(e,u,f$);if(u===o){n.push(e.substring(a,o).trim())}else{n.push(e.substring(a,u).trim());l=[];a=++u;if(a===o)throw"Unmatched left bracket: "+e}while(u<o){u=O$(e,u,c$);if(u===o)throw"Unmatched left bracket: "+e;l.push(e.substring(a,u).trim());if(u<o-1&&e[++u]!==f$)throw"Expected left bracket: "+e;a=++u}if(!(o=n.length)||y$.test(n[o-1])){throw"Invalid event selector: "+e}if(o>1){t.type=n[1];if(i){t.markname=n[0].slice(1)}else if(A$(n[0])){t.marktype=n[0]}else{t.source=n[0]}}else{t.type=n[0]}if(t.type.slice(-1)==="!"){t.consume=true;t.type=t.type.slice(0,-1)}if(l!=null)t.filter=l;if(r[0])t.throttle=r[0];if(r[1])t.debounce=r[1];return t}function F$(e){var t=e.split(v$);if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}function S$(e){return jt(e)?e:{type:e||"pad"}}var j$=function(e){return+e||0};var M$=function(e){return{top:e,bottom:e,left:e,right:e}};function B$(e){return!jt(e)?M$(j$(e)):e.signal?e:{top:j$(e.top),bottom:j$(e.bottom),left:j$(e.left),right:j$(e.right)}}var N$=function(e){return jt(e)&&!St(e)?hn({},e):{value:e}};function T$(e,t,n,r){if(n!=null){var i=jt(n)&&!St(n)||St(n)&&n.length&&jt(n[0]);if(i){e.update[t]=n}else{e[r||"enter"][t]={value:n}}return 1}else{return 0}}function z$(e,t,n){for(var r in t){T$(e,r,t[r])}for(var i in n){T$(e,i,n[i],"update")}}function P$(e,t,n){for(var r in t){if(n&&mn(n,r))continue;e[r]=hn(e[r]||{},t[r])}return e}function R$(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var L$="mark";var I$="frame";var U$="scope";var q$="axis";var W$="axis-domain";var H$="axis-grid";var G$="axis-label";var $$="axis-tick";var V$="axis-title";var Y$="legend";var X$="legend-band";var J$="legend-entry";var Q$="legend-gradient";var Z$="legend-label";var K$="legend-symbol";var eV="legend-title";var tV="title";var nV="title-text";var rV="title-subtitle";function iV(e,t,n,r,i){var a={},o={};var u,s,l,f;s="lineBreak";if(t==="text"&&i[s]!=null&&!R$(s,e)){aV(a,s,i[s])}if(n=="legend"||String(n).startsWith("axis")){n=null}f=n===I$?i.group:n===L$?hn({},i.mark,i[t]):null;for(s in f){l=R$(s,e)||(s==="fill"||s==="stroke")&&(R$("fill",e)||R$("stroke",e));if(!l)aV(a,s,f[s])}tn(r).forEach((function(t){var n=i.style&&i.style[t];for(var r in n){if(!R$(r,e)){aV(a,r,n[r])}}}));e=hn({},e);for(s in a){f=a[s];if(f.signal){(u=u||{})[s]=f}else{o[s]=f}}e.enter=hn(o,e.enter);if(u)e.update=hn(u,e.update);return e}function aV(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}var oV=function(e){return Cn(e)?Pn(e):e.signal?"(".concat(e.signal,")"):dV(e)};function uV(e){if(e.gradient!=null){return fV(e)}var t=e.signal?"(".concat(e.signal,")"):e.color?lV(e.color):e.field!=null?dV(e.field):e.value!==undefined?Pn(e.value):undefined;if(e.scale!=null){t=pV(e,t)}if(t===undefined){t=null}if(e.exponent!=null){t="pow(".concat(t,",").concat(cV(e.exponent),")")}if(e.mult!=null){t+="*".concat(cV(e.mult))}if(e.offset!=null){t+="+".concat(cV(e.offset))}if(e.round){t="round(".concat(t,")")}return t}var sV=function(e,t,n,r){return"(".concat(e,"(").concat([t,n,r].map(uV).join(","),")+'')")};function lV(e){return e.c?sV("hcl",e.h,e.c,e.l):e.h||e.s?sV("hsl",e.h,e.s,e.l):e.l||e.a?sV("lab",e.l,e.a,e.b):e.r||e.g||e.b?sV("rgb",e.r,e.g,e.b):null}function fV(e){var t=[e.start,e.stop,e.count].map((function(e){return e==null?null:Pn(e)}));while(t.length&&zt(t)==null)t.pop();t.unshift(oV(e.gradient));return"gradient(".concat(t.join(","),")")}function cV(e){return jt(e)?"("+uV(e)+")":e}function dV(e){return hV(jt(e)?e:{datum:e})}function hV(e){var t,n,r;if(e.signal){t="datum";r=e.signal}else if(e.group||e.parent){n=Math.max(1,e.level||1);t="item";while(n-- >0){t+=".mark.group"}if(e.parent){r=e.parent;t+=".datum"}else{r=e.group}}else if(e.datum){t="datum";r=e.datum}else{pt("Invalid field reference: "+Pn(e))}if(!e.signal){r=Cn(r)?vt(r).map(Pn).join("]["):hV(r)}return t+"["+r+"]"}function pV(e,t){var n=oV(e.scale);if(e.range!=null){t="lerp(_range(".concat(n,"), ").concat(+e.range,")")}else{if(t!==undefined)t="_scale(".concat(n,", ").concat(t,")");if(e.band){t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(+e.band===1?"":"*"+cV(e.band));if(e.extra){t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")")}}if(t==null)t="0"}return t}function vV(e){var t="";e.forEach((function(e){var n=uV(e);t+=e.test?"(".concat(e.test,")?").concat(n,":"):n}));if(zt(t)===":"){t+="null"}return t}function gV(e,t,n,r,i,a){var o={};a=a||{};a.encoders={$encode:o};e=iV(e,t,n,r,i.config);for(var u in e){o[u]=mV(e[u],t,a,i)}return a}function mV(e,t,n,r){var i={},a={};for(var o in e){if(e[o]!=null){i[o]=bV(yV(e[o]),r,n,a)}}return{$expr:{marktype:t,channels:i},$fields:Object.keys(a),$output:Object.keys(e)}}function yV(e){return St(e)?vV(e):uV(e)}function bV(e,t,n,r){var i=tH(e,t);i.$fields.forEach((function(e){return r[e]=1}));hn(n,i.$params);return i.$expr}var xV="outer",_V=["value","update","init","react","bind"];function wV(e,t){pt(e+' for "outer" push: '+Pn(t))}function AV(e,t){var n=e.name;if(e.push===xV){if(!t.signals[n])wV("No prior signal definition",n);_V.forEach((function(t){if(e[t]!==undefined)wV("Invalid property ",t)}))}else{var r=t.addSignal(n,e.value);if(e.react===false)r.react=false;if(e.bind)t.addBinding(n,e.bind)}}function OV(e,t,n,r){this.id=-1;this.type=e;this.value=t;this.params=n;if(r)this.parent=r}function EV(e,t,n,r){return new OV(e,t,n,r)}function kV(e,t){return EV("operator",e,t)}function DV(e){var t={$ref:e.id};if(e.id<0)(e.refs=e.refs||[]).push(t);return t}function CV(e,t){return t?{$field:e,$name:t}:{$field:e}}var FV=CV("key");function SV(e,t){return{$compare:e,$order:t}}function jV(e,t){var n={$key:e};if(t)n.$flat=true;return n}var MV="ascending";var BV="descending";function NV(e){return!jt(e)?"":(e.order===BV?"-":"+")+TV(e.op,e.field)}function TV(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var zV="scope";var PV="view";function RV(e){return e&&e.signal}function LV(e){return e&&e.expr}function IV(e){if(RV(e))return true;if(jt(e))for(var t in e){if(IV(e[t]))return true}return false}function UV(e,t){return e!=null?e:t}function qV(e){return e&&e.signal||e}var WV="timer";function HV(e,t){var n=e.merge?$V:e.stream?VV:e.type?YV:pt("Invalid stream specification: "+Pn(e));return n(e,t)}function GV(e){return e===zV?PV:e||PV}function $V(e,t){var n=e.merge.map((function(e){return HV(e,t)})),r=XV({merge:n},e,t);return t.addStream(r).id}function VV(e,t){var n=HV(e.stream,t),r=XV({stream:n},e,t);return t.addStream(r).id}function YV(e,t){var n;if(e.type===WV){n=t.event(WV,e.throttle);e={between:e.between,filter:e.filter}}else{n=t.event(GV(e.source),e.type)}var r=XV({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function XV(e,t,n){var r=t.between;if(r){if(r.length!==2){pt('Stream "between" parameter must have 2 entries: '+Pn(t))}e.between=[HV(r[0],n),HV(r[1],n)]}r=t.filter?[].concat(t.filter):[];if(t.marktype||t.markname||t.markrole){r.push(JV(t.marktype,t.markname,t.markrole))}if(t.source===zV){r.push("inScope(event.item)")}if(r.length){e.filter=tH("("+r.join(")&&(")+")",n).$expr}if((r=t.throttle)!=null){e.throttle=+r}if((r=t.debounce)!=null){e.debounce=+r}if(t.consume){e.consume=true}return e}function JV(e,t,n){var r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}var QV={code:"_.$value",ast:{type:"Identifier",value:"value"}};function ZV(e,t,n){var r=e.encode,i={target:n};var a=e.events,o=e.update,u=[];if(!a){pt("Signal update missing events specification.")}if(Cn(a)){a=w$(a,t.isSubscope()?zV:PV)}a=tn(a).filter((function(e){return e.signal||e.scale?(u.push(e),0):1}));if(u.length>1){u=[eY(u)]}if(a.length){u.push(a.length>1?{merge:a}:a[0])}if(r!=null){if(o)pt("Signal encode and update are mutually exclusive.");o="encode(item(),"+Pn(r)+")"}i.update=Cn(o)?tH(o,t):o.expr!=null?tH(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:QV,$params:{$value:t.signalRef(o.signal)}}:pt("Invalid signal update specification.");if(e.force){i.options={force:true}}u.forEach((function(e){return t.addUpdate(hn(KV(e,t),i))}))}function KV(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):HV(e,t)}}function eY(e){return{signal:"["+e.map((function(e){return e.scale?'scale("'+e.scale+'")':e.signal}))+"]"}}function tY(e,t){var n=t.getSignal(e.name);var r=e.update;if(e.init){if(r){pt("Signals can not include both init and update expressions.")}else{r=e.init;n.initonly=true}}if(r){r=tH(r,t);n.update=r.$expr;n.params=r.$params}if(e.on){e.on.forEach((function(e){return ZV(e,t,n.id)}))}}var nY=function(e){return function(t,n,r){return EV(e,n,t||undefined,r)}};var rY=nY("aggregate");var iY=nY("axisticks");var aY=nY("bound");var oY=nY("collect");var uY=nY("compare");var sY=nY("datajoin");var lY=nY("encode");var fY=nY("expression");var cY=nY("facet");var dY=nY("field");var hY=nY("key");var pY=nY("legendentries");var vY=nY("load");var gY=nY("mark");var mY=nY("multiextent");var yY=nY("multivalues");var bY=nY("overlap");var xY=nY("params");var _Y=nY("prefacet");var wY=nY("projection");var AY=nY("proxy");var OY=nY("relay");var EY=nY("render");var kY=nY("scale");var DY=nY("sieve");var CY=nY("sortitems");var FY=nY("viewlayout");var SY=nY("values");var jY=0;var MY={min:"min",max:"max",count:"sum"};function BY(e,t){var n=e.type||"linear";if(!Zg(n)){pt("Unrecognized scale type: "+Pn(n))}t.addScale(e.name,{type:n,domain:undefined})}function NY(e,t){var n=t.getScale(e.name).params;var r;n.domain=RY(e.domain,e,t);if(e.range!=null){n.range=JY(e,t,n)}if(e.interpolate!=null){XY(e.interpolate,n)}if(e.nice!=null){n.nice=YY(e.nice)}if(e.bins!=null){n.bins=VY(e.bins,t)}for(r in e){if(mn(n,r)||r==="name")continue;n[r]=TY(e[r],t)}}function TY(e,t){return!jt(e)?e:e.signal?t.signalRef(e.signal):pt("Unsupported object: "+Pn(e))}function zY(e,t){return e.signal?t.signalRef(e.signal):e.map((function(e){return TY(e,t)}))}function PY(e){pt("Can not find data set: "+Pn(e))}function RY(e,t,n){if(!e){if(t.domainMin!=null||t.domainMax!=null){pt("No scale domain defined for domainMin/domainMax to override.")}return}return e.signal?n.signalRef(e.signal):(St(e)?LY:e.fields?UY:IY)(e,t,n)}function LY(e,t,n){return e.map((function(e){return TY(e,n)}))}function IY(e,t,n){var r=n.getData(e.data);if(!r)PY(e.data);return tm(t.type)?r.valuesRef(n,e.field,HY(e.sort,false)):om(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function UY(e,t,n){var r=e.data,i=e.fields.reduce((function(e,t){t=Cn(t)?{data:r,field:t}:St(t)||t.signal?qY(t,n):t;e.push(t);return e}),[]);return(tm(t.type)?WY:om(t.type)?GY:$Y)(e,n,i)}function qY(e,t){var n="_:vega:_"+jY++,r=oY({});if(St(e)){r.value={$ingest:e}}else if(e.signal){var i="setdata("+Pn(n)+","+e.signal+")";r.params.input=t.signalRef(i)}t.addDataPipeline(n,[r,DY({})]);return{data:n,field:"data"}}function WY(e,t,n){var r=HY(e.sort,true);var i,a;var o=n.map((function(e){var n=t.getData(e.data);if(!n)PY(e.data);return n.countsRef(t,e.field,r)}));var u={groupby:FV,pulse:o};if(r){i=r.op||"count";a=r.field?TV(i,r.field):"count";u.ops=[MY[i]];u.fields=[t.fieldRef(a)];u.as=[a]}i=t.add(rY(u));var s=t.add(oY({pulse:DV(i)}));a=t.add(SY({field:FV,sort:t.sortRef(r),pulse:DV(s)}));return DV(a)}function HY(e,t){if(e){if(!e.field&&!e.op){if(jt(e))e.field="key";else e={field:"key"}}else if(!e.field&&e.op!=="count"){pt("No field provided for sort aggregate op: "+e.op)}else if(t&&e.field){if(e.op&&!MY[e.op]){pt("Multiple domain scales can not be sorted using "+e.op)}}}return e}function GY(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);if(!n)PY(e.data);return n.domainRef(t,e.field)}));return DV(t.add(yY({values:r})))}function $Y(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);if(!n)PY(e.data);return n.extentRef(t,e.field)}));return DV(t.add(mY({extents:r})))}function VY(e,t){return e.signal||St(e)?zY(e,t):t.objectProperty(e)}function YY(e){return jt(e)?{interval:TY(e.interval),step:TY(e.step)}:TY(e)}function XY(e,t){t.interpolate=TY(e.type||e);if(e.gamma!=null){t.interpolateGamma=TY(e.gamma)}}function JY(e,t,n){var r=t.config.range;var i=e.range;if(i.signal){return t.signalRef(i.signal)}else if(Cn(i)){if(r&&mn(r,i)){e=hn({},e,{range:r[i]});return JY(e,t,n)}else if(i==="width"){i=[0,{signal:"width"}]}else if(i==="height"){i=tm(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]}else{pt("Unrecognized scale range value: "+Pn(i))}}else if(i.scheme){n.scheme=St(i.scheme)?zY(i.scheme,t):TY(i.scheme,t);if(i.extent)n.schemeExtent=zY(i.extent,t);if(i.count)n.schemeCount=TY(i.count,t);return}else if(i.step){n.rangeStep=TY(i.step,t);return}else if(tm(e.type)&&!St(i)){return RY(i,e,t)}else if(!St(i)){pt("Unsupported range type: "+Pn(i))}return i.map((function(e){return(St(e)?zY:TY)(e,t)}))}function QY(e,t){var n=t.config.projection||{},r={};for(var i in e){if(i==="name")continue;r[i]=ZY(e[i],i,t)}for(var a in n){if(r[a]==null){r[a]=ZY(n[a],a,t)}}t.addProjection(e.name,r)}function ZY(e,t,n){return St(e)?e.map((function(e){return ZY(e,t,n)})):!jt(e)?e:e.signal?n.signalRef(e.signal):t==="fit"?e:pt("Unsupported parameter object: "+Pn(e))}var KY="top";var eX="left";var tX="right";var nX="bottom";var rX="center";var iX="vertical";var aX="start";var oX="middle";var uX="end";var sX="index";var lX="label";var fX="offset";var cX="perc";var dX="perc2";var hX="value";var pX="guide-label";var vX="guide-title";var gX="group-title";var mX="group-subtitle";var yX="symbol";var bX="gradient";var xX="discrete";var _X="size";var wX="shape";var AX="fill";var OX="stroke";var EX="strokeWidth";var kX="strokeDash";var DX="opacity";var CX=[_X,wX,AX,OX,EX,kX,DX];var FX={name:1,style:1,interactive:1};var SX={value:0};var jX={value:1};var MX="group";var BX="rect";var NX="rule";var TX="symbol";var zX="text";function PX(e){e.type=MX;e.interactive=e.interactive||false;return e}function RX(e,t){var n=function(n,r){return UV(e[n],UV(t[n],r))};n.isVertical=function(n){return iX===UV(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))};n.gradientLength=function(){return UV(e.gradientLength,t.gradientLength||t.gradientWidth)};n.gradientThickness=function(){return UV(e.gradientThickness,t.gradientThickness||t.gradientHeight)};n.entryColumns=function(){return UV(e.columns,UV(t.columns,+n.isVertical(true)))};return n}function LX(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function IX(e,t,n){var r=t.config.style[n];return r&&r[e]}function UX(e,t,n){return"item.anchor === '".concat(aX,"' ? ").concat(e," : item.anchor === '").concat(uX,"' ? ").concat(t," : ").concat(n)}var qX=UX(Pn(eX),Pn(tX),Pn(rX));function WX(e){var t=e("tickBand");var n=e("tickOffset"),r,i;if(!t){r=e("bandPosition");i=e("tickExtra")}else if(t.signal){r={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")};i={signal:"(".concat(t.signal,") === 'extent'")};if(!jt(n)){n={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(n)}}}else if(t==="extent"){r=1;i=true;n=0}else{r=.5;i=false}return{extra:i,band:r,offset:n}}function HX(e,t){return!t?e:!e?t:!jt(e)?{value:e,offset:t}:Object.assign({},e,{offset:HX(e.offset,t)})}function GX(e,t){if(t){e.name=t.name;e.style=t.style||e.style;e.interactive=!!t.interactive;e.encode=P$(e.encode,t,FX)}else{e.interactive=false}return e}function $X(e,t,n,r){var i=RX(e,n),a=i.isVertical(),o=i.gradientThickness(),u=i.gradientLength();var s,l,f,c,d;if(a){l=[0,1];f=[0,0];c=o;d=u}else{l=[0,0];f=[1,0];c=u;d=o}var h={enter:s={opacity:SX,x:SX,y:SX,width:N$(c),height:N$(d)},update:hn({},s,{opacity:jX,fill:{gradient:t,start:l,stop:f}}),exit:{opacity:SX}};z$(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")});return GX({type:BX,role:Q$,encode:h},r)}function VX(e,t,n,r,i){var a=RX(e,n),o=a.isVertical(),u=a.gradientThickness(),s=a.gradientLength();var l,f,c,d,h="";o?(l="y",c="y2",f="x",d="width",h="1-"):(l="x",c="x2",f="y",d="height");var p={opacity:SX,fill:{scale:t,field:hX}};p[l]={signal:h+"datum."+cX,mult:s};p[f]=SX;p[c]={signal:h+"datum."+dX,mult:s};p[d]=N$(u);var v={enter:p,update:hn({},p,{opacity:jX}),exit:{opacity:SX}};z$(v,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")});return GX({type:BX,role:X$,key:hX,from:i,encode:v},r)}var YX="datum.".concat(cX,'<=0?"').concat(eX,'":datum.').concat(cX,'>=1?"').concat(tX,'":"').concat(rX,'"'),XX="datum.".concat(cX,'<=0?"').concat(nX,'":datum.').concat(cX,'>=1?"').concat(KY,'":"').concat(oX,'"');function JX(e,t,n,r){var i=RX(e,t),a=i.isVertical(),o=N$(i.gradientThickness()),u=i.gradientLength();var s=i("labelOverlap"),l,f,c,d,h="";var p={enter:l={opacity:SX},update:f={opacity:jX,text:{field:lX}},exit:{opacity:SX}};z$(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:UV(e.labelLimit,t.gradientLabelLimit)});if(a){l.align={value:"left"};l.baseline=f.baseline={signal:XX};c="y";d="x";h="1-"}else{l.align=f.align={signal:YX};l.baseline={value:"top"};c="x";d="y"}l[c]=f[c]={signal:h+"datum."+cX,mult:u};l[d]=f[d]=o;o.offset=UV(e.labelOffset,t.gradientLabelOffset)||0;s=s?{separation:i("labelSeparation"),method:s,order:"datum."+sX}:undefined;return GX({type:zX,role:Z$,style:pX,key:hX,from:r,encode:p,overlap:s},n)}function QX(e,t,n,r,i){var a=RX(e,t),o=n.entries,u=!!(o&&o.interactive),s=o?o.name:undefined,l=a("clipHeight"),f=a("symbolOffset"),c={data:"value"},d="(".concat(i,") ? datum.").concat(fX," : datum.").concat(_X),h=l?N$(l):{field:_X},p="datum.".concat(sX),v="max(1, ".concat(i,")");var g,m,y,b,x;h.mult=.5;g={enter:m={opacity:SX,x:{signal:d,mult:.5,offset:f},y:h},update:y={opacity:jX,x:m.x,y:m.y},exit:{opacity:SX}};var _=null,w=null;if(!e.fill){_=t.symbolBaseFillColor;w=t.symbolBaseStrokeColor}z$(g,{fill:a("symbolFillColor",_),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",w),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")});CX.forEach((function(t){if(e[t]){y[t]=m[t]={scale:e[t],field:hX}}}));var A=GX({type:TX,role:K$,key:hX,from:c,clip:l?true:undefined,encode:g},n.symbols);var O=N$(f);O.offset=a("labelOffset");g={enter:m={opacity:SX,x:{signal:d,offset:O},y:h},update:y={opacity:jX,text:{field:lX},x:m.x,y:m.y},exit:{opacity:SX}};z$(g,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});var E=GX({type:zX,role:Z$,style:pX,key:hX,from:c,encode:g},n.labels);g={enter:{noBound:{value:!l},width:SX,height:l?N$(l):SX,opacity:SX},exit:{opacity:SX},update:y={opacity:jX,row:{signal:null},column:{signal:null}}};if(a.isVertical(true)){b="ceil(item.mark.items.length / ".concat(v,")");y.row.signal="".concat(p,"%").concat(b);y.column.signal="floor(".concat(p," / ").concat(b,")");x={field:["row",p]}}else{y.row.signal="floor(".concat(p," / ").concat(v,")");y.column.signal="".concat(p," % ").concat(v);x={field:p}}y.column.signal="(".concat(i,")?").concat(y.column.signal,":").concat(p);r={facet:{data:r,name:"value",groupby:sX}};return PX({role:U$,from:r,encode:P$(g,o,FX),marks:[A,E],name:s,interactive:u,sort:x})}function ZX(e,t){var n=RX(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:true,column:false},padding:{row:n("rowPadding"),column:n("columnPadding")}}}var KX='item.orient === "left"',eJ='item.orient === "right"',tJ="(".concat(KX," || ").concat(eJ,")"),nJ="datum.vgrad && ".concat(tJ),rJ=UX('"top"','"bottom"','"middle"'),iJ=UX('"right"','"left"','"center"'),aJ="datum.vgrad && ".concat(eJ," ? (").concat(iJ,") : (").concat(tJ," && !(datum.vgrad && ").concat(KX,')) ? "left" : ').concat(qX),oJ="item._anchor || (".concat(tJ,' ? "middle" : "start")'),uJ="".concat(nJ," ? (").concat(KX," ? -90 : 90) : 0"),sJ="".concat(tJ," ? (datum.vgrad ? (").concat(eJ,' ? "bottom" : "top") : ').concat(rJ,') : "top"');function lJ(e,t,n,r){var i=RX(e,t);var a={enter:{opacity:SX},update:{opacity:jX,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:SX}};z$(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:oJ},angle:{signal:uJ},align:{signal:aJ},baseline:{signal:sJ},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")});return GX({type:zX,role:eV,style:vX,from:r,encode:a},n)}function fJ(e,t){var n;if(jt(e)){if(e.signal){n=e.signal}else if(e.path){n="pathShape("+cJ(e.path)+")"}else if(e.sphere){n="geoShape("+cJ(e.sphere)+', {type: "Sphere"})'}}return n?t.signalRef(n):!!e}function cJ(e){return jt(e)&&e.signal?e.signal:Pn(e)}function dJ(e){var t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===MX?U$:t||L$}function hJ(e){return{marktype:e.type,name:e.name||undefined,role:e.role||dJ(e),zindex:+e.zindex||undefined,aria:e.aria,description:e.description}}function pJ(e,t){return e&&e.signal?t.signalRef(e.signal):e===false?false:true}function vJ(e,t){var n=pf(e.type);if(!n)pt("Unrecognized transform type: "+Pn(e.type));var r=EV(n.type.toLowerCase(),null,gJ(n,e,t));if(e.signal)t.addSignal(e.signal,t.proxy(r));r.metadata=n.metadata||{};return r}function gJ(e,t,n){var r={},i=e.params.length;for(var a=0;a<i;++a){var o=e.params[a];r[o.name]=mJ(o,t,n)}return r}function mJ(e,t,n){var r=e.type,i=t[e.name];if(r==="index"){return bJ(e,t,n)}else if(i===undefined){if(e.required){pt("Missing required "+Pn(t.type)+" parameter: "+Pn(e.name))}return}else if(r==="param"){return xJ(e,t,n)}else if(r==="projection"){return n.projectionRef(t[e.name])}return e.array&&!RV(i)?i.map((function(t){return yJ(e,t,n)})):yJ(e,i,n)}function yJ(e,t,n){var r=e.type;if(RV(t)){return EJ(r)?pt("Expression references can not be signals."):kJ(r)?n.fieldRef(t):DJ(r)?n.compareRef(t):n.signalRef(t.signal)}else{var i=e.expr||kJ(r);return i&&wJ(t)?n.exprRef(t.expr,t.as):i&&AJ(t)?CV(t.field,t.as):EJ(r)?tH(t,n):OJ(r)?DV(n.getData(t).values):kJ(r)?CV(t):DJ(r)?n.compareRef(t):t}}function bJ(e,t,n){if(!Cn(t.from)){pt('Lookup "from" parameter must be a string literal.')}return n.getData(t.from).lookupRef(n,t.key)}function xJ(e,t,n){var r=t[e.name];if(e.array){if(!St(r)){pt("Expected an array of sub-parameters. Instead: "+Pn(r))}return r.map((function(t){return _J(e,t,n)}))}else{return _J(e,r,n)}}function _J(e,t,n){var r=e.params.length;var i;for(var a=0;a<r;++a){i=e.params[a];for(var o in i.key){if(i.key[o]!==t[o]){i=null;break}}if(i)break}if(!i)pt("Unsupported parameter: "+Pn(t));var u=hn(gJ(i,t,n),i.key);return DV(n.add(xY(u)))}var wJ=function(e){return e&&e.expr};var AJ=function(e){return e&&e.field};var OJ=function(e){return e==="data"};var EJ=function(e){return e==="expr"};var kJ=function(e){return e==="field"};var DJ=function(e){return e==="compare"};function CJ(e,t,n){var r,i,a,o,u;if(!e){o=DV(n.add(oY(null,[{}])))}else if(r=e.facet){if(!t)pt("Only group marks can be faceted.");if(r.field!=null){o=u=FJ(r,n)}else{if(!e.data){a=vJ(hn({type:"aggregate",groupby:tn(r.groupby)},r.aggregate),n);a.params.key=n.keyRef(r.groupby);a.params.pulse=FJ(r,n);o=u=DV(n.add(a))}else{u=DV(n.getData(e.data).aggregate)}i=n.keyRef(r.groupby,true)}}if(!o){o=FJ(e,n)}return{key:i,pulse:o,parent:u}}function FJ(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:DV(t.getData(e.data).output)}function SJ(e,t,n,r,i){this.scope=e;this.input=t;this.output=n;this.values=r;this.aggregate=i;this.index={}}SJ.fromEntries=function(e,t){var n=t.length,r=t[n-1],i=t[n-2];var a=t[0],o=null,u=1;if(a&&a.type==="load"){a=t[1]}e.add(t[0]);for(;u<n;++u){t[u].params.pulse=DV(t[u-1]);e.add(t[u]);if(t[u].type==="aggregate")o=t[u]}return new SJ(e,a,i,r,o)};function jJ(e){return Cn(e)?e:null}function MJ(e,t,n){var r=TV(n.op,n.field);var i;if(t.ops){for(var a=0,o=t.as.length;a<o;++a){if(t.as[a]===r)return}}else{t.ops=["count"];t.fields=[null];t.as=["count"]}if(n.op){t.ops.push((i=n.op.signal)?e.signalRef(i):n.op);t.fields.push(e.fieldRef(n.field));t.as.push(r)}}function BJ(e,t,n,r,i,a,o){var u=t[n]||(t[n]={}),s=NV(a);var l=jJ(i),f,c;if(l!=null){e=t.scope;l=l+(s?"|"+s:"");f=u[l]}if(!f){var d=a?{field:FV,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:DV(t.output)};if(s)d.sort=e.sortRef(a);c=e.add(EV(r,undefined,d));if(o)t.index[i]=c;f=DV(c);if(l!=null)u[l]=f}return f}SJ.prototype={countsRef:function(e,t,n){var r=this,i=r.counts||(r.counts={}),a=jJ(t);var o,u,s;if(a!=null){e=r.scope;o=i[a]}if(!o){s={groupby:e.fieldRef(t,"key"),pulse:DV(r.output)};if(n&&n.field)MJ(e,s,n);u=e.add(rY(s));o=e.add(oY({pulse:DV(u)}));o={agg:u,ref:DV(o)};if(a!=null)i[a]=o}else if(n&&n.field){MJ(e,o.agg.params,n)}return o.ref},tuplesRef:function(){return DV(this.values)},extentRef:function(e,t){return BJ(e,this,"extent","extent",t,false)},domainRef:function(e,t){return BJ(e,this,"domain","values",t,false)},valuesRef:function(e,t,n){return BJ(e,this,"vals","values",t,n||true)},lookupRef:function(e,t){return BJ(e,this,"lookup","tupleindex",t,false)},indataRef:function(e,t){return BJ(e,this,"indata","tupleindex",t,true,true)}};function NJ(e,t,n){var r=e.from.facet,i=r.name,a=FJ(r,t);var o;if(!r.name){pt("Facet must have a name: "+Pn(r))}if(!r.data){pt("Facet must reference a data set: "+Pn(r))}if(r.field){o=t.add(_Y({field:t.fieldRef(r.field),pulse:a}))}else if(r.groupby){o=t.add(cY({key:t.keyRef(r.groupby),group:DV(t.proxy(n.parent)),pulse:a}))}else{pt("Facet must specify groupby or field: "+Pn(r))}var u=t.fork(),s=u.add(oY()),l=u.add(DY({pulse:DV(s)}));u.addData(i,new SJ(u,s,s,l));u.addSignal("parent",null);o.params.subflow={$subflow:u.parse(e).toRuntime()}}function TJ(e,t,n){var r=t.add(_Y({pulse:n.pulse})),i=t.fork();i.add(DY());i.addSignal("parent",null);r.params.subflow={$subflow:i.parse(e).toRuntime()}}function zJ(e,t,n){var r=e.remove,i=e.insert,a=e.toggle,o=e.modify,u=e.values,s=t.add(kV());var l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,u].map((function(e){return e==null?"null":e})).join(",")+"),0)";var f=tH(l,t);s.update=f.$expr;s.params=f.$params}function PJ(e,t){var n=dJ(e),r=e.type===MX,i=e.from&&e.from.facet,a=e.overlap;var o=e.layout||n===U$||n===I$,u,s,l,f,c,d,h;var p=n===L$||o||i;var v=CJ(e.from,r,t);s=t.add(sY({key:v.key||(e.key?CV(e.key):undefined),pulse:v.pulse,clean:!r}));var g=DV(s);s=l=t.add(oY({pulse:g}));s=t.add(gY({markdef:hJ(e),interactive:pJ(e.interactive,t),clip:fJ(e.clip,t),context:{$context:true},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:DV(s)}));var m=DV(s);s=f=t.add(lY(gV(e.encode,e.type,n,e.style,t,{mod:false,pulse:m})));s.params.parent=t.encode();if(e.transform){e.transform.forEach((function(e){var n=vJ(e,t),r=n.metadata;if(r.generates||r.changes){pt("Mark transforms should not generate new data.")}if(!r.nomod)f.params.mod=true;n.params.pulse=DV(s);t.add(s=n)}))}if(e.sort){s=t.add(CY({sort:t.compareRef(e.sort),pulse:DV(s)}))}var y=DV(s);if(i||o){o=t.add(FY({layout:t.objectProperty(e.layout),legends:t.legends,mark:m,pulse:y}));d=DV(o)}var b=t.add(aY({mark:m,pulse:d||y}));h=DV(b);if(r){if(p){u=t.operators;u.pop();if(o)u.pop()}t.pushState(y,d||h,g);i?NJ(e,t,v):p?TJ(e,t,v):t.parse(e);t.popState();if(p){if(o)u.push(o);u.push(b)}}if(a){h=RJ(a,h,t)}var x=t.add(EY({pulse:h})),_=t.add(DY({pulse:DV(x)},undefined,t.parent()));if(e.name!=null){c=e.name;t.addData(c,new SJ(t,l,x,_));if(e.on)e.on.forEach((function(e){if(e.insert||e.remove||e.toggle){pt("Marks only support modify triggers.")}zJ(e,t,c)}))}}function RJ(e,t,n){var r=e.method,i=e.bound,a=e.separation;var o={separation:RV(a)?n.signalRef(a.signal):a,method:RV(r)?n.signalRef(r.signal):r,pulse:t};if(e.order){o.sort=n.compareRef({field:e.order})}if(i){var u=i.tolerance;o.boundTolerance=RV(u)?n.signalRef(u.signal):+u;o.boundScale=n.scaleRef(i.scale);o.boundOrient=i.orient}return DV(n.add(bY(o)))}function LJ(e,t){var n=t.config.legend,r=e.encode||{},i=RX(e,n),a=r.legend||{},o=a.name||undefined,u=a.interactive,s=a.style,l={};var f=0,c,d,h;CX.forEach((function(t){return e[t]?(l[t]=e[t],f=f||e[t]):0}));if(!f)pt("Missing valid scale for legend.");var p=IJ(e,t.scaleType(f));var v={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()};var g=DV(t.add(oY(null,[v])));var m={enter:{x:{value:0},y:{value:0}}};var y=DV(t.add(pY(d={type:p,scale:t.scaleRef(f),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));if(p===bX){h=[$X(e,f,n,r.gradient),JX(e,n,r.labels,y)];d.count=d.count||t.signalRef("max(2,2*floor((".concat(qV(i.gradientLength()),")/100))"))}else if(p===xX){h=[VX(e,f,n,r.gradient,y),JX(e,n,r.labels,y)]}else{c=ZX(e,n);h=[QX(e,n,r,y,qV(c.columns))];d.size=WJ(e,t,h[0].marks)}h=[PX({role:J$,from:g,encode:m,marks:h,layout:c,interactive:u})];if(v.title){h.push(lJ(e,n,r.title,g))}return PJ(PX({role:Y$,from:g,encode:P$(qJ(i,e,n),a,FX),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:u,style:s}),t)}function IJ(e,t){var n=e.type||yX;if(!e.type&&UJ(e)===1&&(e.fill||e.stroke)){n=em(t)?bX:nm(t)?xX:yX}return n!==bX?n:nm(t)?xX:bX}function UJ(e){return CX.reduce((function(t,n){return t+(e[n]?1:0)}),0)}function qJ(e,t,n){var r={enter:{},update:{}};z$(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType});return r}function WJ(e,t,n){var r=qV(HJ("size",e,n)),i=qV(HJ("strokeWidth",e,n)),a=qV(GJ(n[1].encode,t,pX));return tH("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),t)}function HJ(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):LX(e,n[0].encode)}function GJ(e,t,n){return LX("fontSize",e)||IX("fontSize",t,n)}var $J='item.orient==="'.concat(eX,'"?-90:item.orient==="').concat(tX,'"?90:0');function VJ(e,t){e=Cn(e)?{text:e}:e;var n=RX(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||undefined,o=i.interactive,u=i.style,s=[];var l={},f=DV(t.add(oY(null,[l])));s.push(JJ(e,n,YJ(e),f));if(e.subtitle){s.push(QJ(e,n,r.subtitle,f))}return PJ(PX({role:tV,from:f,encode:XJ(n,i),marks:s,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:u}),t)}function YJ(e){var t=e.encode;return t&&t.title||hn({name:e.name,interactive:e.interactive,style:e.style},t)}function XJ(e,t){var n={enter:{},update:{}};z$(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:qX},angle:{signal:$J},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")});return P$(n,t,FX)}function JJ(e,t,n,r){var i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};z$(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")});return GX({type:zX,role:nV,style:gX,from:r,encode:o},n)}function QJ(e,t,n,r){var i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};z$(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")});return GX({type:zX,role:rV,style:mX,from:r,encode:o},n)}function ZJ(e,t){var n=[];if(e.transform){e.transform.forEach((function(e){n.push(vJ(e,t))}))}if(e.on){e.on.forEach((function(n){zJ(n,t,e.name)}))}t.addDataPipeline(e.name,KJ(e,t,n))}function KJ(e,t,n){var r=[];var i=null,a=false,o=false,u,s,l,f,c;if(e.values){if(RV(e.values)||IV(e.format)){r.push(tQ(t,e));r.push(i=eQ())}else{r.push(i=eQ({$ingest:e.values,$format:e.format}))}}else if(e.url){if(IV(e.url)||IV(e.format)){r.push(tQ(t,e));r.push(i=eQ())}else{r.push(i=eQ({$request:e.url,$format:e.format}))}}else if(e.source){i=u=tn(e.source).map((function(e){return DV(t.getData(e).output)}));r.push(null)}for(s=0,l=n.length;s<l;++s){f=n[s];c=f.metadata;if(!i&&!c.source){r.push(i=eQ())}r.push(f);if(c.generates)o=true;if(c.modifies&&!o)a=true;if(c.source)i=f;else if(c.changes)i=null}if(u){l=u.length-1;r[0]=OY({derive:a,pulse:l?u:u[0]});if(a||l){r.splice(1,0,eQ())}}if(!i)r.push(eQ());r.push(DY({}));return r}function eQ(e){var t=oY({},e);t.metadata={source:true};return t}function tQ(e,t){return vY({url:t.url?e.property(t.url):undefined,async:t.async?e.property(t.async):undefined,values:t.values?e.property(t.values):undefined,format:e.objectProperty(t.format)})}var nQ=function(e){return e===nX||e===KY};var rQ=function(e,t,n){return RV(e)?fQ(e.signal,t,n):e===eX||e===KY?t:n};var iQ=function(e,t,n){return RV(e)?sQ(e.signal,t,n):nQ(e)?t:n};var aQ=function(e,t,n){return RV(e)?lQ(e.signal,t,n):nQ(e)?n:t};var oQ=function(e,t,n){return RV(e)?cQ(e.signal,t,n):e===KY?{value:t}:{value:n}};var uQ=function(e,t,n){return RV(e)?dQ(e.signal,t,n):e===tX?{value:t}:{value:n}};var sQ=function(e,t,n){return hQ("".concat(e," === '").concat(KY,"' || ").concat(e," === '").concat(nX,"'"),t,n)};var lQ=function(e,t,n){return hQ("".concat(e," !== '").concat(KY,"' && ").concat(e," !== '").concat(nX,"'"),t,n)};var fQ=function(e,t,n){return vQ("".concat(e," === '").concat(eX,"' || ").concat(e," === '").concat(KY,"'"),t,n)};var cQ=function(e,t,n){return vQ("".concat(e," === '").concat(KY,"'"),t,n)};var dQ=function(e,t,n){return vQ("".concat(e," === '").concat(tX,"'"),t,n)};var hQ=function(e,t,n){t=t!=null?N$(t):t;n=n!=null?N$(n):n;if(pQ(t)&&pQ(n)){t=t?t.signal||Pn(t.value):null;n=n?n.signal||Pn(n.value):null;return{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}}else{return[hn({test:e},t)].concat(n||[])}};var pQ=function(e){return e==null||Object.keys(e).length===1};var vQ=function(e,t,n){return{signal:"".concat(e," ? (").concat(mQ(t),") : (").concat(mQ(n),")")}};var gQ=function(e,t,n,r,i){return{signal:(r!=null?"".concat(e," === '").concat(eX,"' ? (").concat(mQ(r),") : "):"")+(n!=null?"".concat(e," === '").concat(nX,"' ? (").concat(mQ(n),") : "):"")+(i!=null?"".concat(e," === '").concat(tX,"' ? (").concat(mQ(i),") : "):"")+(t!=null?"".concat(e," === '").concat(KY,"' ? (").concat(mQ(t),") : "):"")+"(null)"}};var mQ=function(e){return RV(e)?e.signal:e==null?null:Pn(e)};var yQ=function(e,t){return t===0?0:RV(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t}};var bQ=function(e,t){var n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function xQ(e,t,n,r){var i;if(t&&mn(t,e)){return t[e]}else if(mn(n,e)){return n[e]}else if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[vX][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[pX][i]}return null}function _Q(e){var t={};for(var n=0,r=e;n<r.length;n++){var i=r[n];if(!i)continue;for(var a in i)t[a]=1}return Object.keys(t)}function wQ(e,t){var n=t.config,r=n.style,i=n.axis,a=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,u,s,l;if(RV(o)){var f=_Q([n.axisX,n.axisY]),c=_Q([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);u={};for(var d=0,h=f;d<h.length;d++){l=h[d];u[l]=iQ(o,xQ(l,n.axisX,i,r),xQ(l,n.axisY,i,r))}s={};for(var p=0,v=c;p<v.length;p++){l=v[p];s[l]=gQ(o.signal,xQ(l,n.axisTop,i,r),xQ(l,n.axisBottom,i,r),xQ(l,n.axisLeft,i,r),xQ(l,n.axisRight,i,r))}}else{u=o===KY||o===nX?n.axisX:n.axisY;s=n["axis"+o[0].toUpperCase()+o.slice(1)]}var g=u||s||a?hn({},i,u,s,a):i;return g}function AQ(e,t,n,r){var i=RX(e,t),a=e.orient;var o,u;var s={enter:o={opacity:SX},update:u={opacity:jX},exit:{opacity:SX}};z$(s,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});var l=OQ(e,0);var f=OQ(e,1);o.x=u.x=iQ(a,l,SX);o.x2=u.x2=iQ(a,f);o.y=u.y=aQ(a,l,SX);o.y2=u.y2=aQ(a,f);return GX({type:NX,role:W$,from:r,encode:s},n)}function OQ(e,t){return{scale:e.scale,range:t}}function EQ(e,t,n,r,i){var a=RX(e,t),o=e.orient,u=e.gridScale,s=rQ(o,1,-1),l=kQ(e.offset,s);var f,c,d;var h={enter:f={opacity:SX},update:d={opacity:jX},exit:c={opacity:SX}};z$(h,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});var p={scale:e.scale,field:hX,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")};var v=iQ(o,{signal:"height"},{signal:"width"});var g=u?{scale:u,range:0,mult:s,offset:l}:{value:0,offset:l};var m=u?{scale:u,range:1,mult:s,offset:l}:hn(v,{mult:s,offset:l});f.x=d.x=iQ(o,p,g);f.y=d.y=aQ(o,p,g);f.x2=d.x2=aQ(o,m);f.y2=d.y2=iQ(o,m);c.x=iQ(o,p);c.y=aQ(o,p);return GX({type:NX,role:H$,key:hX,from:r,encode:h},n)}function kQ(e,t){if(t===1);else if(!jt(e)){e=RV(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0)}else{var n=e=hn({},e);while(n.mult!=null){if(!jt(n.mult)){n.mult=RV(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t;return e}else{n=n.mult=hn({},n.mult)}}n.mult=t}return e}function DQ(e,t,n,r,i,a){var o=RX(e,t),u=e.orient,s=rQ(u,-1,1);var l,f,c;var d={enter:l={opacity:SX},update:c={opacity:jX},exit:f={opacity:SX}};z$(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});var h=N$(i);h.mult=s;var p={scale:e.scale,field:hX,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};c.y=l.y=iQ(u,SX,p);c.y2=l.y2=iQ(u,h);f.x=iQ(u,p);c.x=l.x=aQ(u,SX,p);c.x2=l.x2=aQ(u,h);f.y=aQ(u,p);return GX({type:NX,role:$$,key:hX,from:r,encode:d},n)}function CQ(e,t,n,r,i){return{signal:'flush(range("'+e+'"), '+'scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function FQ(e,t,n,r,i,a){var o=RX(e,t),u=e.orient,s=e.scale,l=rQ(u,-1,1),f=qV(o("labelFlush")),c=qV(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");var p=f===0||!!f,v;var g=N$(i);g.mult=l;g.offset=N$(o("labelPadding")||0);g.offset.mult=l;var m={scale:s,field:hX,band:.5,offset:HX(a.offset,o("labelOffset"))};var y=iQ(u,p?CQ(s,f,'"left"','"right"','"center"'):{value:"center"},uQ(u,"left","right"));var b=iQ(u,oQ(u,"bottom","top"),p?CQ(s,f,'"top"','"bottom"','"middle"'):{value:"middle"});var x=CQ(s,f,"-(".concat(c,")"),c,0);p=p&&c;var _={opacity:SX,x:iQ(u,m,g),y:aQ(u,m,g)};var w={enter:_,update:v={opacity:jX,text:{field:lX},x:_.x,y:_.y,align:y,baseline:b},exit:{opacity:SX,x:_.x,y:_.y}};z$(w,{dx:!d&&p?iQ(u,x):null,dy:!h&&p?aQ(u,x):null});z$(w,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});var A=o("labelBound");var O=o("labelOverlap");O=O||A?{separation:o("labelSeparation"),method:O,order:"datum.index",bound:A?{scale:s,orient:u,tolerance:A}:null}:undefined;if(v.align!==y){v.align=bQ(v.align,y)}if(v.baseline!==b){v.baseline=bQ(v.baseline,b)}return GX({type:zX,role:G$,style:pX,key:hX,from:r,encode:w,overlap:O},n)}function SQ(e,t,n,r){var i=RX(e,t),a=e.orient,o=rQ(a,-1,1);var u,s;var l={enter:u={opacity:SX,anchor:N$(i("titleAnchor",null)),align:{signal:qX}},update:s=hn({},u,{opacity:jX,text:N$(e.title)}),exit:{opacity:SX}};var f={signal:'lerp(range("'.concat(e.scale,'"), ').concat(UX(0,1,.5),")")};s.x=iQ(a,f);s.y=aQ(a,f);u.angle=iQ(a,SX,yQ(o,90));u.baseline=iQ(a,oQ(a,nX,KY),{value:nX});s.angle=u.angle;s.baseline=u.baseline;z$(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")});jQ(i,a,l,n);l.update.align=bQ(l.update.align,u.align);l.update.angle=bQ(l.update.angle,u.angle);l.update.baseline=bQ(l.update.baseline,u.baseline);return GX({type:zX,role:V$,style:vX,from:r,encode:l},n)}function jQ(e,t,n,r){var i=function(e,t){return e!=null?(n.update[t]=bQ(N$(e),n.update[t]),false):!R$(t,r)?true:false};var a=i(e("titleX"),"x"),o=i(e("titleY"),"y");n.enter.auto=o===a?N$(o):iQ(t,N$(o),N$(a))}function MQ(e,t){var n=wQ(e,t),r=e.encode||{},i=r.axis||{},a=i.name||undefined,o=i.interactive,u=i.style,s=RX(e,n),l=WX(s);var f={scale:e.scale,ticks:!!s("ticks"),labels:!!s("labels"),grid:!!s("grid"),domain:!!s("domain"),title:e.title!=null};var c=DV(t.add(oY({},[f])));var d=DV(t.add(iY({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));var h=[];var p;if(f.grid){h.push(EQ(e,n,r.grid,d,l))}if(f.ticks){p=s("tickSize");h.push(DQ(e,n,r.ticks,d,p,l))}if(f.labels){p=f.ticks?p:0;h.push(FQ(e,n,r.labels,d,p,l))}if(f.domain){h.push(AQ(e,n,r.domain,c))}if(f.title){h.push(SQ(e,n,r.title,c))}return PJ(PX({role:q$,from:c,encode:P$(BQ(s,e),i,FX),marks:h,aria:s("aria"),description:s("description"),zindex:s("zindex"),name:a,interactive:o,style:u}),t)}function BQ(e,t){var n={enter:{},update:{}};z$(n,{orient:e("orient"),offset:e("offset")||0,position:UV(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType});return n}function NQ(e,t,n){var r=tn(e.signals),i=tn(e.scales);if(!n)r.forEach((function(e){return AV(e,t)}));tn(e.projections).forEach((function(e){return QY(e,t)}));i.forEach((function(e){return BY(e,t)}));tn(e.data).forEach((function(e){return ZJ(e,t)}));i.forEach((function(e){return NY(e,t)}));(n||r).forEach((function(e){return tY(e,t)}));tn(e.axes).forEach((function(e){return MQ(e,t)}));tn(e.marks).forEach((function(e){return PJ(e,t)}));tn(e.legends).forEach((function(e){return LJ(e,t)}));if(e.title)VJ(e.title,t);t.parseLambdas();return t}var TQ=function(e){return P$({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e)};function zQ(e,t){var n=t.config;var r=DV(t.root=t.add(kV()));var i=RQ(e,n);i.forEach((function(e){return AV(e,t)}));t.description=e.description||n.description;t.eventConfig=n.events;t.legends=t.objectProperty(n.legend&&n.legend.layout);t.locale=n.locale;var a=t.add(oY());var o=t.add(lY(gV(TQ(e.encode),MX,I$,e.style,t,{pulse:DV(a)})));var u=t.add(FY({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:DV(o)}));t.operators.pop();t.pushState(DV(o),DV(u),null);NQ(e,t,i);t.operators.push(u);var s=t.add(aY({mark:r,pulse:DV(u)}));s=t.add(EY({pulse:DV(s)}));s=t.add(DY({pulse:DV(s)}));t.addData("root",new SJ(t,a,a,s));return t}function PQ(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function RQ(e,t){var n=function(n){return UV(e[n],t[n])},r=[PQ("background",n("background")),PQ("autosize",S$(n("autosize"))),PQ("padding",B$(n("padding"))),PQ("width",n("width")||0),PQ("height",n("height")||0)],i=r.reduce((function(e,t){return e[t.name]=t,e}),{}),a={};tn(e.signals).forEach((function(e){if(mn(i,e.name)){e=hn(i[e.name],e)}else{r.push(e)}a[e.name]=e}));tn(t.signals).forEach((function(e){if(!mn(a,e.name)&&!mn(i,e.name)){r.push(e)}}));return r}function LQ(e,t){this.config=e||{};this.options=t||{};this.bindings=[];this.field={};this.signals={};this.lambdas={};this.scales={};this.events={};this.data={};this.streams=[];this.updates=[];this.operators=[];this.eventConfig=null;this.locale=null;this._id=0;this._subid=0;this._nextsub=[0];this._parent=[];this._encode=[];this._lookup=[];this._markpath=[]}function IQ(e){this.config=e.config;this.options=e.options;this.legends=e.legends;this.field=Object.create(e.field);this.signals=Object.create(e.signals);this.lambdas=Object.create(e.lambdas);this.scales=Object.create(e.scales);this.events=Object.create(e.events);this.data=Object.create(e.data);this.streams=[];this.updates=[];this.operators=[];this._id=0;this._subid=++e._nextsub[0];this._nextsub=e._nextsub;this._parent=e._parent.slice();this._encode=e._encode.slice();this._lookup=e._lookup.slice();this._markpath=e._markpath}LQ.prototype=IQ.prototype={parse:function(e){return NQ(e,this)},fork:function(){return new IQ(this)},isSubscope:function(){return this._subid>0},toRuntime:function(){this.finish();return{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id:function(){return(this._subid?this._subid+":":0)+this._id++},add:function(e){this.operators.push(e);e.id=this.id();if(e.refs){e.refs.forEach((function(t){t.$ref=e.id}));e.refs=null}return e},proxy:function(e){var t=e instanceof OV?DV(e):e;return this.add(AY({value:t}))},addStream:function(e){this.streams.push(e);e.id=this.id();return e},addUpdate:function(e){this.updates.push(e);return e},finish:function(){var e,t;if(this.root)this.root.root=true;for(e in this.signals){this.signals[e].signal=e}for(e in this.scales){this.scales[e].scale=e}function n(e,t,n){var r,i;if(e){r=e.data||(e.data={});i=r[t]||(r[t]=[]);i.push(n)}}for(e in this.data){t=this.data[e];n(t.input,e,"input");n(t.output,e,"output");n(t.values,e,"values");for(var r in t.index){n(t.index[r],e,"index:"+r)}}return this},pushState:function(e,t,n){this._encode.push(DV(this.add(DY({pulse:e}))));this._parent.push(t);this._lookup.push(n?DV(this.proxy(n)):null);this._markpath.push(-1)},popState:function(){this._encode.pop();this._parent.pop();this._lookup.pop();this._markpath.pop()},parent:function(){return zt(this._parent)},encode:function(){return zt(this._encode)},lookup:function(){return zt(this._lookup)},markpath:function(){var e=this._markpath;return++e[e.length-1]},fieldRef:function(e,t){if(Cn(e))return CV(e,t);if(!e.signal){pt("Unsupported field reference: "+Pn(e))}var n=e.signal;var r=this.field[n];if(!r){var i={name:this.signalRef(n)};if(t)i.as=t;this.field[n]=r=DV(this.add(dY(i)))}return r},compareRef:function(e){var t=this;var n=false;var r=function(e){return RV(e)?(n=true,t.signalRef(e.signal)):LV(e)?(n=true,t.exprRef(e.expr)):e};var i=tn(e.field).map(r),a=tn(e.order).map(r);return n?DV(this.add(uY({fields:i,orders:a}))):SV(i,a)},keyRef:function(e,t){var n=false;var r=function(e){return RV(e)?(n=true,DV(i[e.signal])):e};var i=this.signals;e=tn(e).map(r);return n?DV(this.add(hY({fields:e,flat:t}))):jV(e,t)},sortRef:function(e){if(!e)return e;var t=TV(e.op,e.field),n=e.order||MV;return n.signal?DV(this.add(uY({fields:t,orders:this.signalRef(n.signal)}))):SV(t,n)},event:function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t});this.events[n]=r}return this.events[n]},hasOwnSignal:function(e){return mn(this.signals,e)},addSignal:function(e,t){if(this.hasOwnSignal(e)){pt("Duplicate signal name: "+Pn(e))}var n=t instanceof OV?t:this.add(kV(t));return this.signals[e]=n},getSignal:function(e){if(!this.signals[e]){pt("Unrecognized signal name: "+Pn(e))}return this.signals[e]},signalRef:function(e){if(this.signals[e]){return DV(this.signals[e])}else if(!mn(this.lambdas,e)){this.lambdas[e]=this.add(kV(null))}return DV(this.lambdas[e])},parseLambdas:function(){var e=Object.keys(this.lambdas);for(var t=0,n=e.length;t<n;++t){var r=e[t],i=tH(r,this),a=this.lambdas[r];a.params=i.$params;a.update=i.$expr}},property:function(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty:function(e){return!e||!jt(e)?e:this.signalRef(e.signal||UQ(e))},exprRef:function(e,t){var n={expr:tH(e,this)};if(t)n.expr.$name=t;return DV(this.add(fY(n)))},addBinding:function(e,t){if(!this.bindings){pt("Nested signals do not support binding: "+Pn(e))}this.bindings.push(hn({signal:e},t))},addScaleProj:function(e,t){if(mn(this.scales,e)){pt("Duplicate scale or projection name: "+Pn(e))}this.scales[e]=this.add(t)},addScale:function(e,t){this.addScaleProj(e,kY(t))},addProjection:function(e,t){this.addScaleProj(e,wY(t))},getScale:function(e){if(!this.scales[e]){pt("Unrecognized scale name: "+Pn(e))}return this.scales[e]},scaleRef:function(e){return DV(this.getScale(e))},scaleType:function(e){return this.getScale(e).params.type},projectionRef:function(e){return this.scaleRef(e)},projectionType:function(e){return this.scaleType(e)},addData:function(e,t){if(mn(this.data,e)){pt("Duplicate data set name: "+Pn(e))}return this.data[e]=t},getData:function(e){if(!this.data[e]){pt("Undefined data set name: "+Pn(e))}return this.data[e]},addDataPipeline:function(e,t){if(mn(this.data,e)){pt("Duplicate data set name: "+Pn(e))}return this.addData(e,SJ.fromEntries(this,t))}};function UQ(e){return(St(e)?qQ:WQ)(e)}function qQ(e){var t=e.length;var n="[";for(var r=0;r<t;++r){var i=e[r];n+=(r>0?",":"")+(jt(i)?i.signal||UQ(i):Pn(i))}return n+"]"}function WQ(e){var t="{",n=0,r,i;for(r in e){i=e[r];t+=(++n>1?",":"")+Pn(r)+":"+(jt(i)?i.signal||UQ(i):Pn(i))}return t+"}"}function HQ(){var e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:true,domainWidth:1,domainColor:a,grid:false,gridWidth:1,gridColor:o,labels:true,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:true,tickColor:a,tickOffset:0,tickRound:true,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:true,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function GQ(e,t,n){if(!jt(e)){pt("Input Vega specification must be an object.")}t=Bt(HQ(),t,e.config);return zQ(e,new LQ(t,n)).toRuntime()}var $Q="5.23.0";hn(hf,dh,JE,Xk,qM,nB,GT,rT,QT,qz,aP,yP);var VQ=Object.freeze({__proto__:null,version:$Q,Dataflow:ff,EventStream:ml,MultiPulse:Vl,Operator:dl,Parameters:ol,Pulse:Wl,Transform:df,changeset:il,definition:pf,ingest:Zs,isTuple:Xs,transform:vf,transforms:hf,tupleid:Js,interpolate:dm,interpolateColors:lm,interpolateRange:sm,quantizeInterpolator:fm,scale:Qg,scheme:bm,projection:Vj,View:i$,defaultLocale:ls,formatLocale:es,locale:ss,resetDefaultLocale:fs,timeFormatLocale:os,expressionFunction:eH,parse:GQ,runtimeContext:jH,codegenExpression:VU,parseExpression:WU,parseSelector:w$,Debug:Ct,Error:Et,Info:Dt,None:Ot,Warn:kt,accessor:st,accessorFields:ft,accessorName:lt,array:tn,ascending:un,clampRange:nn,compare:on,constant:cn,debounce:dn,error:pt,extend:hn,extent:pn,extentIndex:vn,falsy:wt,fastmap:bn,field:gt,flush:xn,hasOwnProperty:mn,id:mt,identity:yt,inherits:_n,inrange:wn,isArray:St,isBoolean:An,isDate:On,isFunction:rn,isIterable:En,isNumber:kn,isObject:jt,isRegExp:Dn,isString:Cn,key:Fn,lerp:Sn,logger:Ft,lruCache:Mn,merge:Bn,mergeConfig:Bt,one:xt,pad:Tn,panLinear:Ht,panLog:Gt,panPow:$t,panSymlog:Vt,peek:zt,quarter:Kt,repeat:Nn,span:zn,splitAccessPath:vt,stringValue:Pn,toBoolean:Rn,toDate:In,toNumber:Pt,toSet:qn,toString:Un,truncate:Wn,truthy:_t,utcquarter:en,visitArray:Hn,writeConfig:Nt,zero:bt,zoomLinear:Xt,zoomLog:Jt,zoomPow:Qt,zoomSymlog:Zt,bandwidthNRD:bf,bin:xf,bootstrapCI:Af,cumulativeLogNormal:If,cumulativeNormal:Bf,cumulativeUniform:$f,densityLogNormal:Lf,densityNormal:Mf,densityUniform:Gf,dotbin:Of,quantileLogNormal:Uf,quantileNormal:Nf,quantileUniform:Vf,quantiles:mf,quartiles:yf,get random(){return _f},randomInteger:Df,randomKDE:Pf,randomLCG:kf,randomLogNormal:qf,randomMixture:Wf,randomNormal:zf,randomUniform:Yf,regressionExp:tc,regressionLinear:Kf,regressionLoess:lc,regressionLog:ec,regressionPoly:ic,regressionPow:nc,regressionQuad:rc,sampleCurve:pc,sampleLogNormal:Rf,sampleNormal:jf,sampleUniform:Hf,setRandom:wf,DATE:ca,DAY:da,DAYOFYEAR:ha,HOURS:pa,MILLISECONDS:ma,MINUTES:va,MONTH:la,QUARTER:sa,SECONDS:ga,TIME_UNITS:ya,WEEK:fa,YEAR:ua,dayofyear:Ea,timeBin:bo,timeFloor:qa,timeInterval:Ya,timeOffset:Qa,timeSequence:eo,timeUnitSpecifier:wa,timeUnits:xa,utcFloor:Ga,utcInterval:Xa,utcOffset:Za,utcSequence:to,utcdayofyear:ja,utcweek:Ma,week:ka,format:Ls,formats:Is,inferType:Ss,inferTypes:js,loader:Hs,read:qs,responseType:Us,typeParsers:Ds,path:Z,Bounds:wb,CanvasHandler:qw,CanvasRenderer:Qw,Gradient:Km,GroupItem:Ob,Handler:mw,Item:Ab,Marks:ew,RenderType:rO,Renderer:bw,ResourceLoader:Eb,SVGHandler:tA,SVGRenderer:NA,SVGStringRenderer:QA,Scenegraph:sw,boundClip:dO,boundContext:Vb,boundItem:tw,boundMark:rw,boundStroke:Cb,domChild:dw,domClear:hw,domCreate:fw,domFind:cw,font:q_,fontFamily:U_,fontSize:B_,intersect:oO,intersectBoxLine:ix,intersectPath:ex,intersectPoint:tx,intersectRule:rx,lineHeight:N_,markup:EA,multiLineOffset:P_,pathCurves:ty,pathEqual:vO,pathParse:uy,pathRectangle:Ty,pathRender:_y,pathSymbols:Ey,pathTrail:zy,point:vw,renderModule:aO,resetSVGClipId:xb,resetSVGDefIds:mO,sceneEqual:pO,sceneFromJSON:ow,scenePickVisit:gx,sceneToJSON:aw,sceneVisit:vx,sceneZOrder:px,serializeXML:kA,textMetrics:D_});function YQ(e,t,n){var r;if(t.x2){if(t.x){if(n&&e.x>e.x2){r=e.x;e.x=e.x2;e.x2=r}e.width=e.x2-e.x}else{e.x=e.x2-(e.width||0)}}if(t.xc){e.x=e.xc-(e.width||0)/2}if(t.y2){if(t.y){if(n&&e.y>e.y2){r=e.y;e.y=e.y2;e.y2=r}e.height=e.y2-e.y}else{e.y=e.y2-(e.height||0)}}if(t.yc){e.y=e.yc-(e.height||0)/2}}var XQ={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE};var JQ={"*":function(e,t){return e*t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},">":function(e,t){return e>t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},"==":function(e,t){return e==t},"!=":function(e,t){return e!=t},"===":function(e,t){return e===t},"!==":function(e,t){return e!==t},"&":function(e,t){return e&t},"|":function(e,t){return e|t},"^":function(e,t){return e^t},"<<":function(e,t){return e<<t},">>":function(e,t){return e>>t},">>>":function(e,t){return e>>>t}};var QQ={"+":function(e){return+e},"-":function(e){return-e},"~":function(e){return~e},"!":function(e){return!e}};var ZQ=Array.prototype.slice;var KQ=function(e,t,n){var r=n?n(t[0]):t[0];return r[e].apply(r,ZQ.call(t,1))};var eZ=function(e,t,n,r,i,a,o){return new Date(e,t||0,n!=null?n:1,r||0,i||0,a||0,o||0)};var tZ={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},now:Date.now,utc:Date.UTC,datetime:eZ,date:function(e){return new Date(e).getDate()},day:function(e){return new Date(e).getDay()},year:function(e){return new Date(e).getFullYear()},month:function(e){return new Date(e).getMonth()},hours:function(e){return new Date(e).getHours()},minutes:function(e){return new Date(e).getMinutes()},seconds:function(e){return new Date(e).getSeconds()},milliseconds:function(e){return new Date(e).getMilliseconds()},time:function(e){return new Date(e).getTime()},timezoneoffset:function(e){return new Date(e).getTimezoneOffset()},utcdate:function(e){return new Date(e).getUTCDate()},utcday:function(e){return new Date(e).getUTCDay()},utcyear:function(e){return new Date(e).getUTCFullYear()},utcmonth:function(e){return new Date(e).getUTCMonth()},utchours:function(e){return new Date(e).getUTCHours()},utcminutes:function(e){return new Date(e).getUTCMinutes()},utcseconds:function(e){return new Date(e).getUTCSeconds()},utcmilliseconds:function(e){return new Date(e).getUTCMilliseconds()},length:function(e){return e.length},join:function(){return KQ("join",arguments)},indexof:function(){return KQ("indexOf",arguments)},lastindexof:function(){return KQ("lastIndexOf",arguments)},slice:function(){return KQ("slice",arguments)},reverse:function(e){return e.slice().reverse()},parseFloat:parseFloat,parseInt:parseInt,upper:function(e){return String(e).toUpperCase()},lower:function(e){return String(e).toLowerCase()},substring:function(){return KQ("substring",arguments,String)},split:function(){return KQ("split",arguments,String)},replace:function(){return KQ("replace",arguments,String)},trim:function(e){return String(e).trim()},regexp:RegExp,test:function(e,t){return RegExp(e).test(t)}};var nZ=["view","item","group","xy","x","y"];var rZ={Literal:function(e,t){return t.value},Identifier:function(e,t){var n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:XQ[n]||e.params["$"+n]},MemberExpression:function(e,t){var n=!t.computed,r=e(t.object);if(n)e.memberDepth+=1;var i=e(t.property);if(n)e.memberDepth-=1;return r[i]},CallExpression:function(e,t){var n=t.arguments;var r=t.callee.name;if(r.startsWith("_")){r=r.slice(1)}return r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||tZ[r]).apply(e.fn,n.map(e))},ArrayExpression:function(e,t){return t.elements.map(e)},BinaryExpression:function(e,t){return JQ[t.operator](e(t.left),e(t.right))},UnaryExpression:function(e,t){return QQ[t.operator](e(t.argument))},ConditionalExpression:function(e,t){return e(t.test)?e(t.consequent):e(t.alternate)},LogicalExpression:function(e,t){return t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right)},ObjectExpression:function(e,t){return t.properties.reduce((function(t,n){e.memberDepth+=1;var r=e(n.key);e.memberDepth-=1;t[r]=e(n.value);return t}),{})}};function iZ(e,t,n,r,i,a){var o=function(e){return rZ[e.type](o,e)};o.memberDepth=0;o.fn=Object.create(t);o.params=n;o.datum=r;o.event=i;o.item=a;nZ.forEach((function(e){return o.fn[e]=function(){var t;var n=[];for(var r=0;r<arguments.length;r++){n[r]=arguments[r]}return(t=i.vega)[e].apply(t,n)}}));return o(e)}var aZ={operator:function(e,t){var n=t.ast,r=e.functions;return function(e){return iZ(n,r,e)}},parameter:function(e,t){var n=t.ast,r=e.functions;return function(e,t){return iZ(n,r,t,e)}},event:function(e,t){var n=t.ast,r=e.functions;return function(e){return iZ(n,r,undefined,undefined,e)}},handler:function(e,t){var n=t.ast,r=e.functions;return function(e,t){var i=t.item&&t.item.datum;return iZ(n,r,e,i,t)}},encode:function(e,t){var n=t.marktype,r=t.channels,i=e.functions,a=n==="group"||n==="image"||n==="rect";return function(e,t){var o=e.datum;var u=0,s;for(var l in r){s=iZ(r[l].ast,i,t,o,undefined,e);if(e[l]!==s){e[l]=s;u=1}}if(n!=="rule"){YQ(e,r,a)}return u}}};var oZ="vega-lite";var uZ='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer';var sZ="5.2.0";var lZ=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"];var fZ="https://vega.github.io/vega-lite/";var cZ="Vega-Lite is a concise high-level language for interactive visualization.";var dZ="build/vega-lite.js";var hZ="build/vega-lite.min.js";var pZ="build/vega-lite.min.js";var vZ="build/src/index";var gZ="build/src/index.d.ts";var mZ={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"};var yZ={test:"test"};var bZ=["bin","build","src","vega-lite*","tsconfig.json"];var xZ={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"};var _Z={type:"git",url:"https://github.com/vega/vega-lite.git"};var wZ="BSD-3-Clause";var AZ={url:"https://github.com/vega/vega-lite/issues"};var OZ={"@babel/core":"^7.16.0","@babel/preset-env":"^7.16.0","@babel/preset-typescript":"^7.16.0","@rollup/plugin-alias":"^3.1.8","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^21.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.6","@types/chai":"^4.2.22","@types/d3":"^7.1.0","@types/jest":"^27.0.2","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^5.4.0","@typescript-eslint/parser":"^5.4.0",ajv:"^8.8.0","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.1.1","del-cli":"^4.0.1",eslint:"^8.2.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^25.2.4","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.3.1",jest:"^27.3.1","jest-dev-server":"^6.0.0",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.4.1",puppeteer:"^11.0.0",rollup:"^2.60.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^13.0.2",terser:"^5.10.0","ts-jest":"^27.0.7","ts-json-schema-generator":"^0.97.0",typescript:"~4.5.2","vega-cli":"^5.21.0","vega-datasets":"~2.2.0","vega-embed":"^6.20.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"};var EZ={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-util":"~1.17.0",yargs:"~17.2.1"};var kZ={vega:"^5.21.0"};var DZ={node:">=12"};var CZ={name:oZ,author:uZ,version:sZ,collaborators:lZ,homepage:fZ,description:cZ,main:dZ,unpkg:hZ,jsdelivr:pZ,module:vZ,types:gZ,bin:mZ,directories:yZ,files:bZ,scripts:xZ,repository:_Z,license:wZ,bugs:AZ,devDependencies:OZ,dependencies:EZ,peerDependencies:kZ,engines:DZ};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var FZ=ce((function(e){var t=function(){function e(e,t){return t!=null&&e instanceof t}var t;try{t=Map}catch(f){t=function(){}}var n;try{n=Set}catch(f){n=function(){}}var r;try{r=Promise}catch(f){r=function(){}}function i(a,o,u,s,f){if(typeof o==="object"){u=o.depth;s=o.prototype;f=o.includeNonEnumerable;o=o.circular}var c=[];var d=[];var h=typeof Buffer!="undefined";if(typeof o=="undefined")o=true;if(typeof u=="undefined")u=Infinity;function p(a,u){if(a===null)return null;if(u===0)return a;var v;var g;if(typeof a!="object"){return a}if(e(a,t)){v=new t}else if(e(a,n)){v=new n}else if(e(a,r)){v=new r((function(e,t){a.then((function(t){e(p(t,u-1))}),(function(e){t(p(e,u-1))}))}))}else if(i.__isArray(a)){v=[]}else if(i.__isRegExp(a)){v=new RegExp(a.source,l(a));if(a.lastIndex)v.lastIndex=a.lastIndex}else if(i.__isDate(a)){v=new Date(a.getTime())}else if(h&&Buffer.isBuffer(a)){if(Buffer.allocUnsafe){v=Buffer.allocUnsafe(a.length)}else{v=new Buffer(a.length)}a.copy(v);return v}else if(e(a,Error)){v=Object.create(a)}else{if(typeof s=="undefined"){g=Object.getPrototypeOf(a);v=Object.create(g)}else{v=Object.create(s);g=s}}if(o){var m=c.indexOf(a);if(m!=-1){return d[m]}c.push(a);d.push(v)}if(e(a,t)){a.forEach((function(e,t){var n=p(t,u-1);var r=p(e,u-1);v.set(n,r)}))}if(e(a,n)){a.forEach((function(e){var t=p(e,u-1);v.add(t)}))}for(var y in a){var b;if(g){b=Object.getOwnPropertyDescriptor(g,y)}if(b&&b.set==null){continue}v[y]=p(a[y],u-1)}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(a);for(var y=0;y<x.length;y++){var _=x[y];var w=Object.getOwnPropertyDescriptor(a,_);if(w&&!w.enumerable&&!f){continue}v[_]=p(a[_],u-1);if(!w.enumerable){Object.defineProperty(v,_,{enumerable:false})}}}if(f){var A=Object.getOwnPropertyNames(a);for(var y=0;y<A.length;y++){var O=A[y];var w=Object.getOwnPropertyDescriptor(a,O);if(w&&w.enumerable){continue}v[O]=p(a[O],u-1);Object.defineProperty(v,O,{enumerable:false})}}return v}return p(a,u)}i.clonePrototype=function e(t){if(t===null)return null;var n=function(){};n.prototype=t;return new n};function a(e){return Object.prototype.toString.call(e)}i.__objToStr=a;function o(e){return typeof e==="object"&&a(e)==="[object Date]"}i.__isDate=o;function u(e){return typeof e==="object"&&a(e)==="[object Array]"}i.__isArray=u;function s(e){return typeof e==="object"&&a(e)==="[object RegExp]"}i.__isRegExp=s;function l(e){var t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";return t}i.__getRegExpFlags=l;return i}();if(e.exports){e.exports=t}}));var SZ=function e(t,n){if(t===n)return true;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return false;var r,i,a;if(Array.isArray(t)){r=t.length;if(r!=n.length)return false;for(i=r;i--!==0;)if(!e(t[i],n[i]))return false;return true}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();a=Object.keys(t);r=a.length;if(r!==Object.keys(n).length)return false;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return false;for(i=r;i--!==0;){var o=a[i];if(!e(t[o],n[o]))return false}return true}return t!==t&&n!==n};var jZ=function(e,t){if(!t)t={};if(typeof t==="function")t={cmp:t};var n=typeof t.cycles==="boolean"?t.cycles:false;var r=t.cmp&&function(e){return function(t){return function(n,r){var i={key:n,value:t[n]};var a={key:r,value:t[r]};return e(i,a)}}}(t.cmp);var i=[];return function e(t){if(t&&t.toJSON&&typeof t.toJSON==="function"){t=t.toJSON()}if(t===undefined)return;if(typeof t=="number")return isFinite(t)?""+t:"null";if(typeof t!=="object")return JSON.stringify(t);var a,o;if(Array.isArray(t)){o="[";for(a=0;a<t.length;a++){if(a)o+=",";o+=e(t[a])||"null"}return o+"]"}if(t===null)return"null";if(i.indexOf(t)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(t)-1;var s=Object.keys(t).sort(r&&r(t));o="";for(a=0;a<s.length;a++){var l=s[a];var f=e(t[l]);if(!f)continue;if(o)o+=",";o+=JSON.stringify(l)+":"+f}i.splice(u,1);return"{"+o+"}"}(e)};function MZ(e){return!!e.or}function BZ(e){return!!e.and}function NZ(e){return!!e.not}function TZ(e,t){if(NZ(e)){TZ(e.not,t)}else if(BZ(e)){for(var n=0,r=e.and;n<r.length;n++){var i=r[n];TZ(i,t)}}else if(MZ(e)){for(var a=0,o=e.or;a<o.length;a++){var i=o[a];TZ(i,t)}}else{t(e)}}function zZ(e,t){if(NZ(e)){return{not:zZ(e.not,t)}}else if(BZ(e)){return{and:e.and.map((function(e){return zZ(e,t)}))}}else if(MZ(e)){return{or:e.or.map((function(e){return zZ(e,t)}))}}else{return t(e)}}var PZ=SZ;var RZ=FZ;function LZ(e){throw new Error(e)}function IZ(e,t){var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];if(mn(e,a)){n[a]=e[a]}}return n}function UZ(e,t){var n=Object.assign({},e);for(var r=0,i=t;r<i.length;r++){var a=i[r];delete n[a]}return n}Set.prototype["toJSON"]=function(){return"Set(".concat(__spreadArray([],this,true).map((function(e){return jZ(e)})).join(","),")")};var qZ=jZ;function WZ(e){if(kn(e)){return e}var t=Cn(e)?e:jZ(e);if(t.length<250){return t}var n=0;for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);n=(n<<5)-n+i;n=n&n}return n}function HZ(e){return e===false||e===null}function GZ(e,t){return e.includes(t)}function $Z(e,t){var n=0;for(var r=0,i=e.entries();r<i.length;r++){var a=i[r],o=a[0],u=a[1];if(t(u,o,n++)){return true}}return false}function VZ(e,t){var n=0;for(var r=0,i=e.entries();r<i.length;r++){var a=i[r],o=a[0],u=a[1];if(!t(u,o,n++)){return false}}return true}function YZ(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var r=0,i=t;r<i.length;r++){var a=i[r];XZ(e,a!==null&&a!==void 0?a:{})}return e}function XZ(e,t){for(var n=0,r=rK(t);n<r.length;n++){var i=r[n];Nt(e,i,t[i],true)}}function JZ(e,t){var n=[];var r={};var i;for(var a=0,o=e;a<o.length;a++){var u=o[a];i=t(u);if(i in r){continue}r[i]=1;n.push(u)}return n}function QZ(e,t){var n=rK(e);var r=rK(t);if(n.length!==r.length){return false}for(var i=0,a=n;i<a.length;i++){var o=a[i];if(e[o]!==t[o]){return false}}return true}function ZZ(e,t){if(e.size!==t.size){return false}for(var n=0,r=e;n<r.length;n++){var i=r[n];if(!t.has(i)){return false}}return true}function KZ(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.has(i)){return true}}return false}function eK(e){var t=new Set;var n=function(e){var n=vt(e);var r=n.map((function(e,t){return t===0?e:"[".concat(e,"]")}));var i=r.map((function(e,t){return r.slice(0,t+1).join("")}));for(var a=0,o=i;a<o.length;a++){var u=o[a];t.add(u)}};for(var r=0,i=e;r<i.length;r++){var a=i[r];n(a)}return t}function tK(e,t){if(e===undefined||t===undefined){return true}return KZ(eK(e),eK(t))}function nK(e){return rK(e).length===0}var rK=Object.keys;var iK=Object.values;var aK=Object.entries;function oK(e){return e===true||e===false}function uK(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function sK(e,t){if(NZ(e)){return"!(".concat(sK(e.not,t),")")}else if(BZ(e)){return"(".concat(e.and.map((function(e){return sK(e,t)})).join(") && ("),")")}else if(MZ(e)){return"(".concat(e.or.map((function(e){return sK(e,t)})).join(") || ("),")")}else{return t(e)}}function lK(e,t){if(t.length===0){return true}var n=t.shift();if(n in e&&lK(e[n],t)){delete e[n]}return nK(e)}function fK(e){return e.charAt(0).toUpperCase()+e.substr(1)}function cK(e,t){if(t===void 0){t="datum"}var n=vt(e);var r=[];for(var i=1;i<=n.length;i++){var a="[".concat(n.slice(0,i).map(Pn).join("]["),"]");r.push("".concat(t).concat(a))}return r.join(" && ")}function dK(e,t){if(t===void 0){t="datum"}return"".concat(t,"[").concat(Pn(vt(e).join(".")),"]")}function hK(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function pK(e){return"".concat(vt(e).map(hK).join("\\."))}function vK(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function gK(e){return"".concat(vt(e).join("."))}function mK(e){if(!e){return 0}return vt(e).length}function yK(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i!==undefined){return i}}return undefined}var bK=42;function xK(e){var t=++bK;return e?String(e)+t:t}function _K(){bK=42}function wK(e){return AK(e)?e:"__".concat(e)}function AK(e){return e.startsWith("__")}function OK(e){if(e===undefined){return undefined}return(e%360+360)%360}function EK(e){if(kn(e)){return true}return!isNaN(e)&&!isNaN(parseFloat(e))}var kK=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var DK="row";var CK="column";var FK="facet";var SK="x";var jK="y";var MK="x2";var BK="y2";var NK="xOffset";var TK="yOffset";var zK="radius";var PK="radius2";var RK="theta";var LK="theta2";var IK="latitude";var UK="longitude";var qK="latitude2";var WK="longitude2";var HK="color";var GK="fill";var $K="stroke";var VK="shape";var YK="size";var XK="angle";var JK="opacity";var QK="fillOpacity";var ZK="strokeOpacity";var KK="strokeWidth";var e0="strokeDash";var t0="text";var n0="order";var r0="detail";var i0="key";var a0="tooltip";var o0="href";var u0="url";var s0="description";var l0={x:1,y:1,x2:1,y2:1};var f0={theta:1,theta2:1,radius:1,radius2:1};function c0(e){return e in f0}var d0={longitude:1,longitude2:1,latitude:1,latitude2:1};function h0(e){switch(e){case IK:return"y";case qK:return"y2";case UK:return"x";case WK:return"x2"}}function p0(e){return e in d0}var v0=rK(d0);var g0=Object.assign(Object.assign(Object.assign(Object.assign({},l0),f0),d0),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function m0(e){return e===HK||e===GK||e===$K}var y0={row:1,column:1,facet:1};var b0=rK(y0);var x0=Object.assign(Object.assign({},g0),y0);var _0=rK(x0);var w0=kK(x0,["order","detail","tooltip"]);var A0=kK(w0,["row","column","facet"]);function O0(e){return!!A0[e]}function E0(e){return!!x0[e]}var k0=[MK,BK,qK,WK,LK,PK];function D0(e){var t=C0(e);return t!==e}function C0(e){switch(e){case MK:return SK;case BK:return jK;case qK:return IK;case WK:return UK;case LK:return RK;case PK:return zK}return e}function F0(e){if(c0(e)){switch(e){case RK:return"startAngle";case LK:return"endAngle";case zK:return"outerRadius";case PK:return"innerRadius"}}return e}function S0(e){switch(e){case SK:return MK;case jK:return BK;case IK:return qK;case UK:return WK;case RK:return LK;case zK:return PK}return undefined}function j0(e){switch(e){case SK:case MK:return"width";case jK:case BK:return"height"}return undefined}function M0(e){switch(e){case SK:return"xOffset";case jK:return"yOffset";case MK:return"x2Offset";case BK:return"y2Offset";case RK:return"thetaOffset";case zK:return"radiusOffset";case LK:return"theta2Offset";case PK:return"radius2Offset"}return undefined}function B0(e){switch(e){case SK:return"xOffset";case jK:return"yOffset"}return undefined}function N0(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}var T0=rK(g0);var z0=kK(g0,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]);var P0=rK(z0);var R0={x:1,y:1};var L0=rK(R0);function I0(e){return e in R0}var U0={theta:1,radius:1};var q0=rK(U0);function W0(e){return e==="width"?SK:jK}var H0={xOffset:1,yOffset:1};function G0(e){return e in H0}var $0=kK(z0,["text","tooltip","href","url","description","detail","key","order"]);var V0=rK($0);function Y0(e){return!!z0[e]}function X0(e){switch(e){case HK:case GK:case $K:case YK:case VK:case JK:case KK:case e0:return true;case QK:case ZK:case XK:return false}}var J0=Object.assign(Object.assign(Object.assign(Object.assign({},R0),U0),H0),$0);var Q0=rK(J0);function Z0(e){return!!J0[e]}function K0(e,t){return n1(e)[t]}var e1={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"};var t1=kK(e1,["geoshape"]);function n1(e){switch(e){case HK:case GK:case $K:case s0:case r0:case i0:case a0:case o0:case n0:case JK:case QK:case ZK:case KK:case FK:case DK:case CK:return e1;case SK:case jK:case NK:case TK:case IK:case UK:return t1;case MK:case BK:case qK:case WK:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case YK:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case e0:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case VK:return{point:"always",geoshape:"always"};case t0:return{text:"always"};case XK:return{point:"always",square:"always",text:"always"};case u0:return{image:"always"};case RK:return{text:"always",arc:"always"};case zK:return{text:"always",arc:"always"};case LK:case PK:return{arc:"always"}}}function r1(e){switch(e){case SK:case jK:case RK:case zK:case NK:case TK:case YK:case XK:case KK:case JK:case QK:case ZK:case MK:case BK:case LK:case PK:return undefined;case FK:case DK:case CK:case VK:case e0:case t0:case a0:case o0:case u0:case s0:return"discrete";case HK:case GK:case $K:return"flexible";case IK:case UK:case qK:case WK:case r0:case i0:case n0:return undefined}}var i1={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};var a1={count:1,min:1,max:1};function o1(e){return!!e&&!!e["argmin"]}function u1(e){return!!e&&!!e["argmax"]}function s1(e){return Cn(e)&&!!i1[e]}var l1=new Set(["count","valid","missing","distinct"]);function f1(e){return Cn(e)&&l1.has(e)}function c1(e){return Cn(e)&&GZ(["min","max"],e)}var d1=new Set(["count","sum","distinct","valid","missing"]);var h1=new Set(["mean","average","median","q1","q3","min","max"]);function p1(e){if(An(e)){e=i8(e,undefined)}return"bin"+rK(e).map((function(t){return y1(e[t])?uK("_".concat(t,"_").concat(aK(e[t]))):uK("_".concat(t,"_").concat(e[t]))})).join("")}function v1(e){return e===true||m1(e)&&!e.binned}function g1(e){return e==="binned"||m1(e)&&e.binned===true}function m1(e){return jt(e)}function y1(e){return e===null||e===void 0?void 0:e["param"]}function b1(e){switch(e){case DK:case CK:case YK:case HK:case GK:case $K:case KK:case JK:case QK:case ZK:case VK:return 6;case e0:return 4;default:return 10}}function x1(e){return e&&!!e["expr"]}function _1(e){var t=rK(e||{});var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];n[a]=z1(e[a])}return n}var w1=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function A1(e){var t=e.anchor,n=e.frame,r=e.offset,i=e.orient,a=e.angle,o=e.limit,u=e.color,s=e.subtitleColor,l=e.subtitleFont,f=e.subtitleFontSize,c=e.subtitleFontStyle,d=e.subtitleFontWeight,h=e.subtitleLineHeight,p=e.subtitlePadding,v=w1(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]);var g=Object.assign(Object.assign({},v),u?{fill:u}:{});var m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),a!==undefined?{angle:a}:{}),o!==undefined?{limit:o}:{});var y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{subtitleColor:s}:{}),l?{subtitleFont:l}:{}),f?{subtitleFontSize:f}:{}),c?{subtitleFontStyle:c}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),p?{subtitlePadding:p}:{});var b=IZ(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:g,subtitleMarkConfig:b,nonMarkTitleProperties:m,subtitle:y}}function O1(e){return Cn(e)||St(e)&&Cn(e[0])}function E1(e){return e&&!!e["signal"]}function k1(e){return!!e["step"]}function D1(e){if(!St(e)){return"fields"in e&&!("data"in e)}return false}function C1(e){if(!St(e)){return"fields"in e&&"data"in e}return false}function F1(e){if(!St(e)){return"field"in e&&"data"in e}return false}var S1={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1};var j1=rK(S1);var M1={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};var B1=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var N1=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function T1(e){var t=St(e.condition)?e.condition.map(P1):P1(e.condition);return Object.assign(Object.assign({},z1(e)),{condition:t})}function z1(e){if(x1(e)){var t=e.expr,n=N1(e,["expr"]);return Object.assign({signal:t},n)}return e}function P1(e){if(x1(e)){var t=e.expr,n=N1(e,["expr"]);return Object.assign({signal:t},n)}return e}function R1(e){if(x1(e)){var t=e.expr,n=N1(e,["expr"]);return Object.assign({signal:t},n)}if(E1(e)){return e}return e!==undefined?{value:e}:undefined}function L1(e){if(E1(e)){return e.signal}return Pn(e)}function I1(e){if(E1(e)){return e.signal}return Pn(e.value)}function U1(e){if(E1(e)){return e.signal}return e==null?null:Pn(e)}function q1(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r];var o=G1(a,t.markDef,t.config);if(o!==undefined){e[a]=R1(o)}}return e}function W1(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function H1(e,t,n,r){if(r===void 0){r={}}var i=r.vgChannel,a=r.ignoreVgConfig;if(i&&t[i]!==undefined){return t[i]}else if(t[e]!==undefined){return t[e]}else if(a&&(!i||i===e)){return undefined}return G1(e,t,n,r)}function G1(e,t,n,r){var i=r===void 0?{}:r,a=i.vgChannel;return yK(a?$1(e,t,n.style):undefined,$1(e,t,n.style),a?n[t.type][a]:undefined,n[t.type][e],a?n.mark[a]:n.mark[e])}function $1(e,t,n){return V1(e,W1(t),n)}function V1(e,t,n){t=tn(t);var r;for(var i=0,a=t;i<a.length;i++){var o=a[i];var u=n[o];if(u&&u[e]!==undefined){r=u[e]}}return r}function Y1(e,t){return tn(e).reduce((function(e,n){var r;e.field.push(P4(n,t));e.order.push((r=n.sort)!==null&&r!==void 0?r:"ascending");return e}),{field:[],order:[]})}function X1(e,t){var n=__spreadArray([],e,true);t.forEach((function(e){for(var t=0,r=n;t<r.length;t++){var i=r[t];if(PZ(i,e)){return}}n.push(e)}));return n}function J1(e,t){if(PZ(e,t)||!t){return e}else if(!e){return t}else{return __spreadArray(__spreadArray([],tn(e),true),tn(t),true).join(", ")}}function Q1(e,t){var n=e.value;var r=t.value;if(n==null||r===null){return{explicit:e.explicit,value:null}}else if((O1(n)||E1(n))&&(O1(r)||E1(r))){return{explicit:e.explicit,value:J1(n,r)}}else if(O1(n)||E1(n)){return{explicit:e.explicit,value:n}}else if(O1(r)||E1(r)){return{explicit:e.explicit,value:r}}else if(!O1(n)&&!E1(n)&&!O1(r)&&!E1(r)){return{explicit:e.explicit,value:X1(n,r)}}throw new Error("It should never reach here")}function Z1(e){return"Invalid specification ".concat(qZ(e),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}var K1='Autosize "fit" only works for single views and layered views.';function e2(e){var t=e=="width"?"Width":"Height";return"".concat(t,' "container" only works for single views and layered views.')}function t2(e){var t=e=="width"?"Width":"Height";var n=e=="width"?"x":"y";return"".concat(t,' "container" only works well with autosize "fit" or "fit-').concat(n,'".')}function n2(e){return e?'Dropping "fit-'.concat(e,'" because spec has discrete ').concat(j0(e),"."):'Dropping "fit" because spec has discrete size.'}function r2(e){return"Unknown field for ".concat(e,". Cannot calculate view size.")}function i2(e){return'Cannot project a selection on encoding channel "'.concat(e,'", which has no field.')}function a2(e,t){return'Cannot project a selection on encoding channel "'.concat(e,'" as it uses an aggregate function ("').concat(t,'").')}function o2(e){return'The "nearest" transform is not supported for '.concat(e," marks.")}function u2(e){return"Selection not supported for ".concat(e," yet.")}function s2(e){return'Cannot find a selection named "'.concat(e,'".')}var l2="Scale bindings are currently only supported for scales with unbinned, continuous domains.";var f2="Legend bindings are only supported for selections over an individual field or encoding channel.";function c2(e){return'Lookups can only be performed on selection parameters. "'.concat(e,'" is a variable parameter.')}function d2(e){return'Cannot define and lookup the "'.concat(e,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?"}var h2="The same selection must be used to override scale domains in a layered view.";var p2='Interval selections should be initialized using "x" and/or "y" keys.';function v2(e){return'Unknown repeated value "'.concat(e,'".')}function g2(e){return'The "columns" property cannot be used when "'.concat(e,'" has nested row/column.')}var m2="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function y2(e){return'Unrecognized parse "'.concat(e,'".')}function b2(e,t,n){return'An ancestor parsed field "'.concat(e,'" as ').concat(n," but a child wants to parse the field as ").concat(t,".")}var x2="Attempt to add the same child twice.";function _2(e){return"Ignoring an invalid transform: ".concat(qZ(e),".")}var w2='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function A2(e){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(e," are dropped.")}function O2(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection ".concat(qZ(t)," is overridden by a child projection ").concat(qZ(n),".")}var E2="Arc marks uses theta channel rather than angle, replacing angle with theta.";function k2(e){return"".concat(e,"Offset dropped because ").concat(e," is continuous")}function D2(e){return"There is no ".concat(e," encoding. Replacing ").concat(e,"Offset encoding as ").concat(e,".")}function C2(e,t,n){return"Channel ".concat(e," is a ").concat(t,". Converted to {value: ").concat(qZ(n),"}.")}function F2(e){return'Invalid field type "'.concat(e,'".')}function S2(e,t){return'Invalid field type "'.concat(e,'" for aggregate: "').concat(t,'", using "quantitative" instead.')}function j2(e){return'Invalid aggregation operator "'.concat(e,'".')}function M2(e,t){var n=t.fill,r=t.stroke;return"Dropping color ".concat(e," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function B2(e){return"Position range does not support relative band size for ".concat(e,".")}function N2(e,t){return"Dropping ".concat(qZ(e),' from channel "').concat(t,'" since it does not contain any data field, datum, value, or signal.')}var T2="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function z2(e,t,n){return"".concat(e,' dropped as it is incompatible with "').concat(t,'"').concat(n?" when ".concat(n):"",".")}function P2(e){return"".concat(e," encoding has no scale, so specified scale is ignored.")}function R2(e){return"".concat(e,"-encoding is dropped as ").concat(e," is not a valid encoding channel.")}function L2(e){return"".concat(e," encoding should be discrete (ordinal / nominal / binned).")}function I2(e){return"".concat(e," encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).")}function U2(e){return"Facet encoding dropped as ".concat(e.join(" and ")," ").concat(e.length>1?"are":"is"," also specified.")}function q2(e,t){return'Using discrete channel "'.concat(e,'" to encode "').concat(t,'" field can be misleading as it does not encode ').concat(t==="ordinal"?"order":"magnitude",".")}function W2(e){return"The ".concat(e," for range marks cannot be an expression")}function H2(e,t){var n=e&&t?"x2 and y2":e?"x2":"y2";return"Line mark is for continuous lines and thus cannot be used with ".concat(n,". We will use the rule mark (line segments) instead.")}function G2(e,t){return'Specified orient "'.concat(e,'" overridden with "').concat(t,'".')}function $2(e){return'Cannot use the scale property "'.concat(e,'" with non-color channel.')}function V2(e){return"Cannot use the relative band size with ".concat(e," scale.")}function Y2(e){return"Using unaggregated domain with raw field has no effect (".concat(qZ(e),").")}function X2(e){return'Unaggregated domain not applicable for "'.concat(e,'" since it produces values outside the origin domain of the source data.')}function J2(e){return"Unaggregated domain is currently unsupported for log scale (".concat(qZ(e),").")}function Q2(e){return'Cannot apply size to non-oriented mark "'.concat(e,'".')}function Z2(e,t,n){return'Channel "'.concat(e,'" does not work with "').concat(t,'" scale. We are using "').concat(n,'" scale instead.')}function K2(e,t){return'FieldDef does not work with "'.concat(e,'" scale. We are using "').concat(t,'" scale instead.')}function e3(e,t,n){return"".concat(n,"-scale's \"").concat(t,'" is dropped as it does not work with ').concat(e," scale.")}function t3(e){return'The step for "'.concat(e,'" is dropped because the ').concat(e==="width"?"x":"y"," is continuous.")}function n3(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(qZ(n)," and ").concat(qZ(r),"). Using ").concat(qZ(n),".")}function r3(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(qZ(n)," and ").concat(qZ(r),"). Using the union of the two domains.")}function i3(e){return'Setting the scale to be independent for "'.concat(e,'" means we also have to set the guide (axis or legend) to be independent.')}function a3(e){return"Dropping sort property ".concat(qZ(e),' as unioned domains only support boolean or op "count", "min", and "max".')}var o3="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";var u3="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.";var s3="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.";var l3="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function f3(e){return'Cannot stack "'.concat(e,'" if there is already "').concat(e,'2".')}function c3(e){return"Cannot stack non-linear scale (".concat(e,").")}function d3(e){return'Stacking is applied even though the aggregate function is non-summative ("'.concat(e,'").')}function h3(e,t){return"Invalid ".concat(e,": ").concat(qZ(t),".")}function p3(e){return"Dropping day from datetime ".concat(qZ(e)," as day cannot be combined with other units.")}function v3(e,t){return"".concat(t?"extent ":"").concat(t&&e?"and ":"").concat(e?"center ":"").concat(t&&e?"are ":"is ","not needed when data are aggregated.")}function g3(e,t,n){return"".concat(e," is not usually used with ").concat(t," for ").concat(n,".")}function m3(e,t){return"Continuous axis should not have customized aggregation function ".concat(e,"; ").concat(t," already agregates the axis.")}function y3(e){return"1D error band does not support ".concat(e,".")}function b3(e){return"Channel ".concat(e,' is required for "binned" bin.')}function x3(e){return"Channel ".concat(e,' should not be used with "binned" bin.')}function _3(e){return"Domain for ".concat(e," is required for threshold scale.")}var w3=Ft(kt);var A3=w3;function O3(e){A3=e;return A3}function E3(){A3=w3;return A3}function k3(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}A3.warn.apply(A3,e)}function D3(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}A3.debug.apply(A3,e)}function C3(e){if(e&&jt(e)){for(var t=0,n=q3;t<n.length;t++){var r=n[t];if(r in e){return true}}}return false}var F3=["january","february","march","april","may","june","july","august","september","october","november","december"];var S3=F3.map((function(e){return e.substr(0,3)}));var j3=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];var M3=j3.map((function(e){return e.substr(0,3)}));function B3(e){if(EK(e)){e=+e}if(kn(e)){if(e>4){k3(h3("quarter",e))}return e-1}else{throw new Error(h3("quarter",e))}}function N3(e){if(EK(e)){e=+e}if(kn(e)){return e-1}else{var t=e.toLowerCase();var n=F3.indexOf(t);if(n!==-1){return n}var r=t.substr(0,3);var i=S3.indexOf(r);if(i!==-1){return i}throw new Error(h3("month",e))}}function T3(e){if(EK(e)){e=+e}if(kn(e)){return e%7}else{var t=e.toLowerCase();var n=j3.indexOf(t);if(n!==-1){return n}var r=t.substr(0,3);var i=M3.indexOf(r);if(i!==-1){return i}throw new Error(h3("day",e))}}function z3(e,t){var n=[];if(t&&e.day!==undefined){if(rK(e).length>1){k3(p3(e));e=RZ(e);delete e.day}}if(e.year!==undefined){n.push(e.year)}else{n.push(2012)}if(e.month!==undefined){var r=t?N3(e.month):e.month;n.push(r)}else if(e.quarter!==undefined){var i=t?B3(e.quarter):e.quarter;n.push(kn(i)?i*3:"".concat(i,"*3"))}else{n.push(0)}if(e.date!==undefined){n.push(e.date)}else if(e.day!==undefined){var a=t?T3(e.day):e.day;n.push(kn(a)?a+1:"".concat(a,"+1"))}else{n.push(1)}for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var s=u[o];var l=e[s];n.push(typeof l==="undefined"?0:l)}return n}function P3(e){var t=z3(e,true);var n=t.join(", ");if(e.utc){return"utc(".concat(n,")")}else{return"datetime(".concat(n,")")}}function R3(e){var t=z3(e,false);var n=t.join(", ");if(e.utc){return"utc(".concat(n,")")}else{return"datetime(".concat(n,")")}}function L3(e){var t=z3(e,true);if(e.utc){return+new Date(Date.UTC.apply(Date,t))}else{return+new(Date.bind.apply(Date,__spreadArray([void 0],t,false)))}}var I3=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var U3={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};var q3=rK(U3);function W3(e){return!!U3[e]}function H3(e){return e.startsWith("utc")}function G3(e){return e.substr(3)}var $3={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function V3(e){return q3.filter((function(t){return Y3(e,t)}))}function Y3(e,t){var n=e.indexOf(t);if(n<0){return false}if(n>0&&t==="seconds"&&e.charAt(n-1)==="i"){return false}if(e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"){return false}if(n>0&&t==="year"&&e.charAt(n-1)==="f"){return false}return true}function X3(e,t,n){var r=n===void 0?{end:false}:n,i=r.end;var a=cK(t);var o=H3(e)?"utc":"";function u(e){if(e==="quarter"){return"(".concat(o,"quarter(").concat(a,")-1)")}else{return"".concat(o).concat(e,"(").concat(a,")")}}var s;var l={};for(var f=0,c=q3;f<c.length;f++){var d=c[f];if(Y3(e,d)){l[d]=u(d);s=d}}if(i){l[s]+="+1"}return R3(l)}function J3(e){if(!e){return undefined}var t=V3(e);return"timeUnitSpecifier(".concat(qZ(t),", ").concat(qZ($3),")")}function Q3(e,t,n){if(!e){return undefined}var r=J3(e);var i=n||H3(e);return"".concat(i?"utc":"time","Format(").concat(t,", ").concat(r,")")}function Z3(e){if(!e){return undefined}var t;if(Cn(e)){t={unit:e}}else if(jt(e)){t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})}if(H3(t.unit)){t.utc=true;t.unit=G3(t.unit)}return t}function K3(e){var t=Z3(e),n=t.utc,r=I3(t,["utc"]);if(r.unit){return(n?"utc":"")+rK(r).map((function(e){return uK("".concat(e==="unit"?"":"_".concat(e,"_")).concat(r[e]))})).join("")}else{return(n?"utc":"")+"timeunit"+rK(r).map((function(e){return uK("_".concat(e,"_").concat(r[e]))})).join("")}}function e5(e){return e===null||e===void 0?void 0:e["param"]}function t5(e){return e&&!!e.field&&e.equal!==undefined}function n5(e){return e&&!!e.field&&e.lt!==undefined}function r5(e){return e&&!!e.field&&e.lte!==undefined}function i5(e){return e&&!!e.field&&e.gt!==undefined}function a5(e){return e&&!!e.field&&e.gte!==undefined}function o5(e){if(e===null||e===void 0?void 0:e.field){if(St(e.range)&&e.range.length===2){return true}else if(E1(e.range)){return true}}return false}function u5(e){return e&&!!e.field&&(St(e.oneOf)||St(e.in))}function s5(e){return e&&!!e.field&&e.valid!==undefined}function l5(e){return u5(e)||t5(e)||o5(e)||n5(e)||i5(e)||r5(e)||a5(e)}function f5(e,t){return l8(e,{timeUnit:t,wrapTime:true})}function c5(e,t){return e.map((function(e){return f5(e,t)}))}function d5(e,t){if(t===void 0){t=true}var n;var r=e.field;var i=(n=Z3(e.timeUnit))===null||n===void 0?void 0:n.unit;var a=i?"time(".concat(X3(i,r),")"):P4(e,{expr:"datum"});if(t5(e)){return"".concat(a,"===").concat(f5(e.equal,i))}else if(n5(e)){var o=e.lt;return"".concat(a,"<").concat(f5(o,i))}else if(i5(e)){var u=e.gt;return"".concat(a,">").concat(f5(u,i))}else if(r5(e)){var o=e.lte;return"".concat(a,"<=").concat(f5(o,i))}else if(a5(e)){var u=e.gte;return"".concat(a,">=").concat(f5(u,i))}else if(u5(e)){return"indexof([".concat(c5(e.oneOf,i).join(","),"], ").concat(a,") !== -1")}else if(s5(e)){return h5(a,e.valid)}else if(o5(e)){var s=e.range;var u=E1(s)?{signal:"".concat(s.signal,"[0]")}:s[0];var o=E1(s)?{signal:"".concat(s.signal,"[1]")}:s[1];if(u!==null&&o!==null&&t){return"inrange("+a+", ["+f5(u,i)+", "+f5(o,i)+"])"}var l=[];if(u!==null){l.push("".concat(a," >= ").concat(f5(u,i)))}if(o!==null){l.push("".concat(a," <= ").concat(f5(o,i)))}return l.length>0?l.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(qZ(e)))}function h5(e,t){if(t===void 0){t=true}if(t){return"isValid(".concat(e,") && isFinite(+").concat(e,")")}else{return"!isValid(".concat(e,") || !isFinite(+").concat(e,")")}}function p5(e){var t;if(l5(e)&&e.timeUnit){return Object.assign(Object.assign({},e),{timeUnit:(t=Z3(e.timeUnit))===null||t===void 0?void 0:t.unit})}return e}var v5={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function g5(e){return e==="quantitative"||e==="temporal"}function m5(e){return e==="ordinal"||e==="nominal"}var y5=v5.quantitative;var b5=v5.ordinal;var x5=v5.temporal;var _5=v5.nominal;var w5=v5.geojson;function A5(e){if(e){e=e.toLowerCase();switch(e){case"q":case y5:return"quantitative";case"t":case x5:return"temporal";case"o":case b5:return"ordinal";case"n":case _5:return"nominal";case w5:return"geojson"}}return undefined}var O5=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var E5={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"};var k5={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function D5(e,t){var n=k5[e];var r=k5[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}var C5={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function F5(e){return C5[e]}var S5=new Set(["linear","log","pow","sqrt","symlog"]);var j5=new Set(__spreadArray(__spreadArray([],S5,true),["time","utc"],false));function M5(e){return S5.has(e)}var B5=new Set(["quantile","quantize","threshold"]);var N5=new Set(__spreadArray(__spreadArray(__spreadArray([],j5,true),B5,true),["sequential","identity"],false));var T5=new Set(["ordinal","bin-ordinal","point","band"]);function z5(e){return T5.has(e)}function P5(e){return N5.has(e)}function R5(e){return j5.has(e)}function L5(e){return B5.has(e)}var I5={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function U5(e){return!Cn(e)&&!!e["name"]}function q5(e){return e===null||e===void 0?void 0:e["param"]}function W5(e){return e&&e["unionWith"]}function H5(e){return jt(e)&&"field"in e}var G5={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1};var $5=O5(G5,["type","domain","range","rangeMax","rangeMin","scheme"]);var V5=rK($5);function Y5(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return true;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return R5(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return R5(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return R5(e);case"nice":return R5(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return P5(e)&&!GZ(["log","time","utc","threshold","quantile"],e)}}function X5(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":if(!m0(e)){return $2(e)}return undefined;case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return undefined}}function J5(e,t){if(GZ([b5,_5],t)){return e===undefined||z5(e)}else if(t===x5){return GZ([E5.TIME,E5.UTC,undefined],e)}else if(t===y5){return M5(e)||L5(e)||e===undefined}return true}function Q5(e,t,n){if(n===void 0){n=false}if(!Z0(e)){return false}switch(e){case SK:case jK:case NK:case TK:case RK:case zK:if(R5(t)){return true}else if(t==="band"){return true}else if(t==="point"){return!n}return false;case YK:case KK:case JK:case QK:case ZK:case XK:return R5(t)||L5(t)||GZ(["band","point","ordinal"],t);case HK:case GK:case $K:return t!=="band";case e0:case VK:return t==="ordinal"||L5(t)}}var Z5={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"};var K5=Z5.arc;var e6=Z5.area;var t6=Z5.bar;var n6=Z5.image;var r6=Z5.line;var i6=Z5.point;var a6=Z5.rect;var o6=Z5.rule;var u6=Z5.text;var s6=Z5.tick;var l6=Z5.trail;var f6=Z5.circle;var c6=Z5.square;var d6=Z5.geoshape;function h6(e){return["line","area","trail"].includes(e)}function p6(e){return["rect","bar","image","arc"].includes(e)}var v6=new Set(rK(Z5));function g6(e){return e["type"]}var m6=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"];var y6=["fill","fillOpacity"];var b6=__spreadArray(__spreadArray([],m6,true),y6,true);var x6={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1};var _6=rK(x6);var w6={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]};var A6={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1};var O6={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1};var E6=rK(O6);function k6(e){return e&&e["band"]!=undefined}var D6={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};var C6=5;var F6={binSpacing:1,continuousBandSize:C6,timeUnitBandPosition:.5};var S6={binSpacing:0,continuousBandSize:C6,timeUnitBandPosition:.5};var j6={thickness:1};function M6(e){return g6(e)?e.type:e}function B6(e){var t=e.channel,n=e.channelDef,r=e.markDef,i=e.scale,a=e.config;var o=I6(e);if(A4(n)&&!f1(n.aggregate)&&i&&R5(i.get("type"))){return N6({fieldDef:n,channel:t,markDef:r,ref:o,config:a})}return o}function N6(e){var t=e.fieldDef,n=e.channel,r=e.markDef,i=e.ref,a=e.config;if(h6(r.type)){return i}var o=H1("invalid",r,a);if(o===null){return[T6(t,n),i]}return i}function T6(e,t){var n=z6(e,true);var r=C0(t);var i=r==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function z6(e,t){if(t===void 0){t=true}return h5(Cn(e)?e:P4(e,{expr:"datum"}),!t)}function P6(e){var t=e.datum;if(C3(t)){return P3(t)}return"".concat(qZ(t))}function R6(e,t,n,r){var i={};if(t){i.scale=t}if(E4(e)){var a=e.datum;if(C3(a)){i.signal=P3(a)}else if(E1(a)){i.signal=a.signal}else if(x1(a)){i.signal=a.expr}else{i.value=a}}else{i.field=P4(e,n)}if(r){var o=r.offset,u=r.band;if(o){i.offset=o}if(u){i.band=u}}return i}function L6(e){var t=e.scaleName,n=e.fieldOrDatumDef,r=e.fieldOrDatumDef2,i=e.offset,a=e.startSuffix,o=e.bandPosition,u=o===void 0?.5:o;var s=0<u&&u<1?"datum":undefined;var l=P4(n,{expr:s,suffix:a});var f=r!==undefined?P4(r,{expr:s}):P4(n,{suffix:"end",expr:s});var c={};if(u===0||u===1){c.scale=t;var d=u===0?l:f;c.field=d}else{var h=E1(u)?"".concat(u.signal," * ").concat(l," + (1-").concat(u.signal,") * ").concat(f):"".concat(u," * ").concat(l," + ").concat(1-u," * ").concat(f);c.signal='scale("'.concat(t,'", ').concat(h,")")}if(i){c.offset=i}return c}function I6(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,f=e.defaultRef,c=e.bandPosition;var d;if(n){if(C4(n)){var h=u===null||u===void 0?void 0:u.get("type");if(F4(n)){c!==null&&c!==void 0?c:c=g4({fieldDef:n,fieldDef2:r,markDef:i,config:a});var p=n.bin,v=n.timeUnit,g=n.type;if(v1(p)||c&&v&&g===x5){if(s===null||s===void 0?void 0:s.impute){return R6(n,o,{binSuffix:"mid"},{offset:l})}if(c&&!z5(h)){return L6({scaleName:o,fieldOrDatumDef:n,bandPosition:c,offset:l})}return R6(n,o,c8(n,t)?{binSuffix:"range"}:{},{offset:l})}else if(g1(p)){if(A4(r)){return L6({scaleName:o,fieldOrDatumDef:n,fieldOrDatumDef2:r,bandPosition:c,offset:l})}else{var m=t===SK?MK:BK;k3(b3(m))}}}return R6(n,o,z5(h)?{binSuffix:"range"}:{},{offset:l,band:h==="band"?(d=c!==null&&c!==void 0?c:n.bandPosition)!==null&&d!==void 0?d:.5:undefined})}else if(S4(n)){var y=n.value;var b=l?{offset:l}:{};return Object.assign(Object.assign({},U6(t,y)),b)}}if(rn(f)){f=f()}if(f){return Object.assign(Object.assign({},f),l?{offset:l}:{})}return f}function U6(e,t){if(GZ(["x","x2"],e)&&t==="width"){return{field:{group:"width"}}}else if(GZ(["y","y2"],e)&&t==="height"){return{field:{group:"height"}}}return R1(t)}function q6(e){return e&&e!=="number"&&e!=="time"}function W6(e,t,n){return"".concat(e,"(").concat(t).concat(n?", ".concat(qZ(n)):"",")")}var H6=" – ";function G6(e){var t=e.fieldOrDatumDef,n=e.format,r=e.formatType,i=e.expr,a=e.normalizeStack,o=e.config;var u,s;if(q6(r)){return V6({fieldOrDatumDef:t,format:n,formatType:r,expr:i,config:o})}var l=$6(t,i,a);if(u8(t)){var f=t4(l,A4(t)?(u=Z3(t.timeUnit))===null||u===void 0?void 0:u.unit:undefined,n,o.timeFormat,j4(t)&&((s=t.scale)===null||s===void 0?void 0:s.type)===E5.UTC);return f?{signal:f}:undefined}n=J6(O4(t),n,o);if(A4(t)&&v1(t.bin)){var c=P4(t,{expr:i,binSuffix:"end"});return{signal:e4(l,c,n,r,o)}}else if(n||O4(t)==="quantitative"){return{signal:"".concat(Z6(l,n))}}else{return{signal:"isValid(".concat(l,") ? ").concat(l,' : ""+').concat(l)}}}function $6(e,t,n){if(A4(e)){if(n){return"".concat(P4(e,{expr:t,suffix:"end"}),"-").concat(P4(e,{expr:t,suffix:"start"}))}else{return P4(e,{expr:t})}}else{return P6(e)}}function V6(e){var t=e.fieldOrDatumDef,n=e.format,r=e.formatType,i=e.expr,a=e.normalizeStack,o=e.config,u=e.field;u!==null&&u!==void 0?u:u=$6(t,i,a);if(A4(t)&&v1(t.bin)){var s=P4(t,{expr:i,binSuffix:"end"});return{signal:e4(u,s,n,r,o)}}return{signal:W6(r,u,n)}}function Y6(e,t,n,r,i,a){var o;if(q6(r)){return undefined}if(u8(e)){var u=A4(e)?(o=Z3(e.timeUnit))===null||o===void 0?void 0:o.unit:undefined;return Q6(n,u,i,a)}return J6(t,n,i)}function X6(e,t,n){if(e&&(E1(e)||e==="number"||e==="time")){return e}if(u8(t)&&n!=="time"&&n!=="utc"){return"time"}return undefined}function J6(e,t,n){if(Cn(t)){return t}if(e===y5){return n.numberFormat}return undefined}function Q6(e,t,n,r){if(e){return e}if(t){return{signal:J3(t)}}return r?undefined:n.timeFormat}function Z6(e,t){return"format(".concat(e,', "').concat(t||"",'")')}function K6(e,t,n,r){var i;if(q6(n)){return W6(n,e,t)}return Z6(e,(i=Cn(t)?t:undefined)!==null&&i!==void 0?i:r.numberFormat)}function e4(e,t,n,r,i){var a=K6(e,n,r,i);var o=K6(t,n,r,i);return"".concat(h5(e,false),' ? "null" : ').concat(a,' + "').concat(H6,'" + ').concat(o)}function t4(e,t,n,r,i){if(!t||n){n=Cn(n)?n:r;return"".concat(i?"utc":"time","Format(").concat(e,", '").concat(n,"')")}else{return Q3(t,e,i)}}var n4="min";var r4={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function i4(e){return e in r4}function a4(e){return!!e&&!!e["encoding"]}function o4(e){return!!e&&(e["op"]==="count"||!!e["field"])}function u4(e){return!!e&&St(e)}function s4(e){return"row"in e||"column"in e}function l4(e){return!!e&&"header"in e}function f4(e){return"facet"in e}var c4=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function d4(e){return e["param"]}function h4(e){return e&&!Cn(e)&&"repeat"in e}function p4(e){var t=e.field,n=e.timeUnit,r=e.bin,i=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function v4(e){return"sort"in e}function g4(e){var t=e.fieldDef,n=e.fieldDef2,r=e.markDef,i=e.config;if(C4(t)&&t.bandPosition!==undefined){return t.bandPosition}if(A4(t)){var a=t.timeUnit,o=t.bin;if(a&&!n){return p6(r.type)?0:G1("timeUnitBandPosition",r,i)}else if(v1(o)){return.5}}return undefined}function m4(e){var t=e.channel,n=e.fieldDef,r=e.fieldDef2,i=e.markDef,a=e.config,o=e.scaleType,u=e.useVlSizeChannel;var s,l,f;var c=j0(t);var d=H1(u?"size":c,i,a,{vgChannel:c});if(d!==undefined){return d}if(A4(n)){var h=n.timeUnit,p=n.bin;if(h&&!r){return{band:G1("timeUnitBandSize",i,a)}}else if(v1(p)&&!z5(o)){return{band:1}}}if(p6(i.type)){if(o){if(z5(o)){return((s=a[i.type])===null||s===void 0?void 0:s.discreteBandSize)||{band:1}}else{return(l=a[i.type])===null||l===void 0?void 0:l.continuousBandSize}}return(f=a[i.type])===null||f===void 0?void 0:f.discreteBandSize}return undefined}function y4(e,t,n,r){if(v1(e.bin)||e.timeUnit&&F4(e)&&e.type==="temporal"){return g4({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==undefined}return false}function b4(e){return e&&"condition"in e}function x4(e){var t=e&&e["condition"];return!!t&&!St(t)&&A4(t)}function _4(e){var t=e&&e["condition"];return!!t&&!St(t)&&C4(t)}function w4(e){var t=e&&e["condition"];return!!t&&(St(t)||S4(t))}function A4(e){return e&&(!!e["field"]||e["aggregate"]==="count")}function O4(e){return e&&e["type"]}function E4(e){return e&&"datum"in e}function k4(e){return F4(e)&&!R4(e)||D4(e)}function D4(e){return E4(e)&&kn(e.datum)}function C4(e){return A4(e)||E4(e)}function F4(e){return e&&("field"in e||e["aggregate"]==="count")&&"type"in e}function S4(e){return e&&"value"in e&&"value"in e}function j4(e){return e&&("scale"in e||"sort"in e)}function M4(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function B4(e){return e&&"legend"in e}function N4(e){return e&&("format"in e||"formatType"in e)}function T4(e){return UZ(e,["legend","axis","header","scale"])}function z4(e){return"op"in e}function P4(e,t){if(t===void 0){t={}}var n,r,i;var a=e.field;var o=t.prefix;var u=t.suffix;var s="";if(I4(e)){a=wK("count")}else{var l=void 0;if(!t.nofn){if(z4(e)){l=e.op}else{var f=e.bin,c=e.aggregate,d=e.timeUnit;if(v1(f)){l=p1(f);u=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")}else if(c){if(u1(c)){s='["'.concat(a,'"]');a="argmax_".concat(c.argmax)}else if(o1(c)){s='["'.concat(a,'"]');a="argmin_".concat(c.argmin)}else{l=String(c)}}else if(d){l=K3(d);u=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:"")}}}if(l){a=a?"".concat(l,"_").concat(a):l}}if(u){a="".concat(a,"_").concat(u)}if(o){a="".concat(o,"_").concat(a)}if(t.forAs){return gK(a)}else if(t.expr){return dK(a,t.expr)+s}else{return pK(a)+s}}function R4(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return true;case"quantitative":return A4(e)&&!!e.bin;case"temporal":return false}throw new Error(F2(e.type))}function L4(e){var t;return j4(e)&&L5((t=e.scale)===null||t===void 0?void 0:t.type)}function I4(e){return e.aggregate==="count"}function U4(e,t){var n;var r=e.field,i=e.bin,a=e.timeUnit,o=e.aggregate;if(o==="count"){return t.countTitle}else if(v1(i)){return"".concat(r," (binned)")}else if(a){var u=(n=Z3(a))===null||n===void 0?void 0:n.unit;if(u){return"".concat(r," (").concat(V3(u).join("-"),")")}}else if(o){if(u1(o)){return"".concat(r," for max ").concat(o.argmax)}else if(o1(o)){return"".concat(r," for min ").concat(o.argmin)}else{return"".concat(fK(o)," of ").concat(r)}}return r}function q4(e){var t=e.aggregate,n=e.bin,r=e.timeUnit,i=e.field;if(u1(t)){return"".concat(i," for argmax(").concat(t.argmax,")")}else if(o1(t)){return"".concat(i," for argmin(").concat(t.argmin,")")}var a=Z3(r);var o=t||(a===null||a===void 0?void 0:a.unit)||(a===null||a===void 0?void 0:a.maxbins)&&"timeunit"||v1(n)&&"bin";if(o){return"".concat(o.toUpperCase(),"(").concat(i,")")}else{return i}}var W4=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return q4(e);default:return U4(e,t)}};var H4=W4;function G4(e){H4=e}function $4(){G4(W4)}function V4(e,t,n){var r=n.allowDisabling,i=n.includeDefault,a=i===void 0?true:i;var o,u;var s=(o=Y4(e))===null||o===void 0?void 0:o.title;if(!A4(e)){return s!==null&&s!==void 0?s:e.title}var l=e;var f=a?X4(l,t):undefined;if(r){return yK(s,l.title,f)}else{return(u=s!==null&&s!==void 0?s:l.title)!==null&&u!==void 0?u:f}}function Y4(e){if(M4(e)&&e.axis){return e.axis}else if(B4(e)&&e.legend){return e.legend}else if(l4(e)&&e.header){return e.header}return undefined}function X4(e,t){return H4(e,t)}function J4(e){var t;if(N4(e)){var n=e.format,r=e.formatType;return{format:n,formatType:r}}else{var i=(t=Y4(e))!==null&&t!==void 0?t:{};var a=i.format,r=i.formatType;return{format:a,formatType:r}}}function Q4(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(v4(e)&&St(e.sort)){return"ordinal"}var r=e.aggregate,i=e.bin,a=e.timeUnit;if(a){return"temporal"}if(i||r&&!u1(r)&&!o1(r)){return"quantitative"}if(j4(e)&&((n=e.scale)===null||n===void 0?void 0:n.type)){switch(k5[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}}return"nominal"}function Z4(e){if(A4(e)){return e}else if(x4(e)){return e.condition}return undefined}function K4(e){if(C4(e)){return e}else if(_4(e)){return e.condition}return undefined}function e8(e,t,n,r){if(r===void 0){r={}}if(Cn(e)||kn(e)||An(e)){var i=Cn(e)?"string":kn(e)?"number":"boolean";k3(C2(t,i,e));return{value:e}}if(C4(e)){return t8(e,t,n,r)}else if(_4(e)){return Object.assign(Object.assign({},e),{condition:t8(e.condition,t,n,r)})}return e}function t8(e,t,n,r){var i;if(N4(e)){var a=e.format,o=e.formatType,u=c4(e,["format","formatType"]);if(q6(o)&&!n.customFormatTypes){k3(A2(t));return t8(u,t,n,r)}}else{var s=M4(e)?"axis":B4(e)?"legend":l4(e)?"header":null;if(s&&e[s]){var l=e[s],f=l.format,o=l.formatType,c=c4(l,["format","formatType"]);if(q6(o)&&!n.customFormatTypes){k3(A2(t));return t8(Object.assign(Object.assign({},e),(i={},i[s]=c,i)),t,n,r)}}}if(A4(e)){return r8(e,t,r)}return n8(e)}function n8(e){var t=e["type"];if(t){return e}var n=e.datum;t=kn(n)?"quantitative":Cn(n)?"nominal":C3(n)?"temporal":undefined;return Object.assign(Object.assign({},e),{type:t})}function r8(e,t,n){var r=n===void 0?{}:n,i=r.compositeMark,a=i===void 0?false:i;var o=e.aggregate,u=e.timeUnit,s=e.bin,l=e.field;var f=Object.assign({},e);if(!a&&o&&!s1(o)&&!u1(o)&&!o1(o)){k3(j2(o));delete f.aggregate}if(u){f.timeUnit=Z3(u)}if(l){f.field="".concat(l)}if(v1(s)){f.bin=i8(s,t)}if(g1(s)&&!I0(t)){k3(x3(t))}if(F4(f)){var c=f.type;var d=A5(c);if(c!==d){f.type=d}if(c!=="quantitative"){if(f1(o)){k3(S2(c,o));f.type="quantitative"}}}else if(!D0(t)){var h=Q4(f,t);f["type"]=h}if(F4(f)){var p=o8(f,t)||{},v=p.compatible,g=p.warning;if(v===false){k3(g)}}if(v4(f)&&Cn(f.sort)){var m=f.sort;if(i4(m)){return Object.assign(Object.assign({},f),{sort:{encoding:m}})}var y=m.substr(1);if(m.charAt(0)==="-"&&i4(y)){return Object.assign(Object.assign({},f),{sort:{encoding:y,order:"descending"}})}}if(l4(f)){var b=f.header;if(b){var x=b.orient,_=c4(b,["orient"]);if(x){return Object.assign(Object.assign({},f),{header:Object.assign(Object.assign({},_),{labelOrient:b.labelOrient||x,titleOrient:b.titleOrient||x})})}}}return f}function i8(e,t){if(An(e)){return{maxbins:b1(t)}}else if(e==="binned"){return{binned:true}}else if(!e.maxbins&&!e.step){return Object.assign(Object.assign({},e),{maxbins:b1(t)})}else{return e}}var a8={compatible:true};function o8(e,t){var n=e.type;if(n==="geojson"&&t!=="shape"){return{compatible:false,warning:"Channel ".concat(t," should not be used with a geojson data.")}}switch(t){case DK:case CK:case FK:if(!R4(e)){return{compatible:false,warning:L2(t)}}return a8;case SK:case jK:case NK:case TK:case HK:case GK:case $K:case t0:case r0:case i0:case a0:case o0:case u0:case XK:case RK:case zK:case s0:return a8;case UK:case WK:case IK:case qK:if(n!==y5){return{compatible:false,warning:"Channel ".concat(t," should be used with a quantitative field only, not ").concat(e.type," field.")}}return a8;case JK:case QK:case ZK:case KK:case YK:case LK:case PK:case MK:case BK:if(n==="nominal"&&!e["sort"]){return{compatible:false,warning:"Channel ".concat(t," should not be used with an unsorted discrete field.")}}return a8;case VK:case e0:if(!R4(e)&&!L4(e)){return{compatible:false,warning:I2(t)}}return a8;case n0:if(e.type==="nominal"&&!("sort"in e)){return{compatible:false,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}return a8}}function u8(e){var t=J4(e).formatType;return t==="time"||!t&&s8(e)}function s8(e){return e&&(e["type"]==="temporal"||A4(e)&&!!e.timeUnit)}function l8(e,t){var n;var r=t.timeUnit,i=t.type,a=t.wrapTime,o=t.undefinedIfExprNotRequired;var u;var s=r&&((u=Z3(r))===null||u===void 0?void 0:u.unit);var l=s||i==="temporal";var f;if(x1(e)){f=e.expr}else if(E1(e)){f=e.signal}else if(C3(e)){l=true;f=P3(e)}else if(Cn(e)||kn(e)){if(l){f="datetime(".concat(qZ(e),")");if(W3(s)){if(kn(e)&&e<1e4||Cn(e)&&isNaN(Date.parse(e))){f=P3((n={},n[s]=e,n))}}}}if(f){return a&&l?"time(".concat(f,")"):f}return o?undefined:qZ(e)}function f8(e,t){var n=e.type;return t.map((function(t){var r=l8(t,{timeUnit:A4(e)?e.timeUnit:undefined,type:n,undefinedIfExprNotRequired:true});if(r!==undefined){return{signal:r}}return t}))}function c8(e,t){if(!v1(e.bin)){console.warn("Only call this method for binned field defs.");return false}return Z0(t)&&["ordinal","nominal"].includes(e.type)}var d8={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function h8(e){return e&&e["condition"]}var p8=["domain","grid","labels","ticks","title"];var v8={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"};var g8={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1};var m8=Object.assign(Object.assign({},g8),{style:1,labelExpr:1,encoding:1});function y8(e){return!!m8[e]}var b8={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1};var x8=rK(b8);function _8(e){return"mark"in e}var w8=function(){function e(e,t){this.name=e;this.run=t}e.prototype.hasMatchingType=function(e){if(_8(e)){return M6(e.mark)===this.name}return false};return e}();var A8=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function O8(e,t){var n=e&&e[t];if(n){if(St(n)){return $Z(n,(function(e){return!!e.field}))}else{return A4(n)||x4(n)}}return false}function E8(e,t){var n=e&&e[t];if(n){if(St(n)){return $Z(n,(function(e){return!!e.field}))}else{return A4(n)||E4(n)||_4(n)}}return false}function k8(e,t){if(I0(t)){var n=e[t];if((A4(n)||E4(n))&&m5(n.type)){var r=B0(t);return E8(e,r)}}return false}function D8(e){return $Z(_0,(function(t){if(O8(e,t)){var n=e[t];if(St(n)){return $Z(n,(function(e){return!!e.aggregate}))}else{var r=Z4(n);return r&&!!r.aggregate}}return false}))}function C8(e,t){var n=[];var r=[];var i=[];var a=[];var o={};B8(e,(function(u,s){if(A4(u)){var l=u.field,f=u.aggregate,c=u.bin,d=u.timeUnit,h=A8(u,["field","aggregate","bin","timeUnit"]);if(f||d||c){var p=Y4(u);var v=p===null||p===void 0?void 0:p.title;var g=P4(u,{forAs:true});var m=Object.assign(Object.assign(Object.assign({},v?[]:{title:V4(u,t,{allowDisabling:true})}),h),{field:g});if(f){var y=void 0;if(u1(f)){y="argmax";g=P4({op:"argmax",field:f.argmax},{forAs:true});m.field="".concat(g,".").concat(l)}else if(o1(f)){y="argmin";g=P4({op:"argmin",field:f.argmin},{forAs:true});m.field="".concat(g,".").concat(l)}else if(f!=="boxplot"&&f!=="errorbar"&&f!=="errorband"){y=f}if(y){var b={op:y,as:g};if(l){b.field=l}a.push(b)}}else{n.push(g);if(F4(u)&&v1(c)){r.push({bin:c,field:l,as:g});n.push(P4(u,{binSuffix:"end"}));if(c8(u,s)){n.push(P4(u,{binSuffix:"range"}))}if(I0(s)){var x={field:"".concat(g,"_end")};o["".concat(s,"2")]=x}m.bin="binned";if(!D0(s)){m["type"]=y5}}else if(d){i.push({timeUnit:d,field:l,as:g});var _=F4(u)&&u.type!==x5&&"time";if(_){if(s===t0||s===a0){m["formatType"]=_}else if(Y0(s)){m["legend"]=Object.assign({formatType:_},m["legend"])}else if(I0(s)){m["axis"]=Object.assign({formatType:_},m["axis"])}}}}o[s]=m}else{n.push(l);o[s]=e[s]}}else{o[s]=e[s]}}));return{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function F8(e,t,n){var r=K0(t,n);if(!r){return false}else if(r==="binned"){var i=e[t===MK?SK:jK];if(A4(i)&&A4(e[t])&&g1(i.bin)){return true}else{return false}}return true}function S8(e,t,n,r){var i={};for(var a=0,o=rK(e);a<o.length;a++){var u=o[a];if(!E0(u)){k3(R2(u))}}var s=function(a){if(!e[a]){return"continue"}var o=e[a];if(G0(a)){var u=N0(a);var s=i[u];if(A4(s)){if(g5(s.type)){if(A4(o)){k3(k2(u));return"continue"}}}else{a=u;k3(D2(u))}}if(a==="angle"&&t==="arc"&&!e.theta){k3(E2);a=RK}if(!F8(e,a,t)){k3(z2(a,t));return"continue"}if(a===YK&&t==="line"){var l=Z4(e[a]);if(l===null||l===void 0?void 0:l.aggregate){k3(T2);return"continue"}}if(a===HK&&(n?"fill"in e:"stroke"in e)){k3(M2("encoding",{fill:"fill"in e,stroke:"stroke"in e}));return"continue"}if(a===r0||a===n0&&!St(o)&&!S4(o)||a===a0&&St(o)){if(o){i[a]=tn(o).reduce((function(e,t){if(!A4(t)){k3(N2(t,a))}else{e.push(r8(t,a))}return e}),[])}}else{if(a===a0&&o===null){i[a]=null}else if(!A4(o)&&!E4(o)&&!S4(o)&&!b4(o)&&!E1(o)){k3(N2(o,a));return"continue"}i[a]=e8(o,a,r)}};for(var l=0,f=T0;l<f.length;l++){var c=f[l];s(c)}return i}function j8(e,t){var n={};for(var r=0,i=rK(e);r<i.length;r++){var a=i[r];var o=e8(e[a],a,t,{compositeMark:true});n[a]=o}return n}function M8(e){var t=[];for(var n=0,r=rK(e);n<r.length;n++){var i=r[n];if(O8(e,i)){var a=e[i];var o=tn(a);for(var u=0,s=o;u<s.length;u++){var l=s[u];if(A4(l)){t.push(l)}else if(x4(l)){t.push(l.condition)}}}}return t}function B8(e,t,n){if(!e){return}for(var r=0,i=rK(e);r<i.length;r++){var a=i[r];var o=e[a];if(St(o)){for(var u=0,s=o;u<s.length;u++){var l=s[u];t.call(n,l,a)}}else{t.call(n,o,a)}}}function N8(e,t,n,r){if(!e){return n}return rK(e).reduce((function(n,i){var a=e[i];if(St(a)){return a.reduce((function(e,n){return t.call(r,e,n,i)}),n)}else{return t.call(r,n,a,i)}}),n)}function T8(e,t){return rK(t).reduce((function(n,r){switch(r){case SK:case jK:case o0:case s0:case u0:case MK:case BK:case NK:case TK:case RK:case LK:case zK:case PK:case IK:case UK:case qK:case WK:case t0:case VK:case XK:case a0:return n;case n0:if(e==="line"||e==="trail"){return n}case r0:case i0:{var i=t[r];if(St(i)||A4(i)){for(var a=0,o=tn(i);a<o.length;a++){var u=o[a];if(!u.aggregate){n.push(P4(u,{}))}}}return n}case YK:if(e==="trail"){return n}case HK:case GK:case $K:case JK:case QK:case ZK:case e0:case KK:{var u=Z4(t[r]);if(u&&!u.aggregate){n.push(P4(u,{}))}return n}}}),[])}var z8=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function P8(e){var t=e.tooltip,n=z8(e,["tooltip"]);if(!t){return{filteredEncoding:n}}var r;var i;if(St(t)){for(var a=0,o=t;a<o.length;a++){var u=o[a];if(u.aggregate){if(!r){r=[]}r.push(u)}else{if(!i){i=[]}i.push(u)}}if(r){n.tooltip=r}}else{if(t["aggregate"]){n.tooltip=t}else{i=t}}if(St(i)&&i.length===1){i=i[0]}return{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function R8(e,t,n,r){if(r===void 0){r=true}if("tooltip"in n){return{tooltip:n.tooltip}}var i=e.map((function(e){var n=e.fieldPrefix,i=e.titlePrefix;var a=r?" of ".concat(L8(t)):"";return{field:n+t.field,type:t.type,title:E1(i)?{signal:"".concat(i,'"').concat(escape(a),'"')}:i+a}}));var a=M8(n).map(T4);return{tooltip:__spreadArray(__spreadArray([],i,true),JZ(a,WZ),true)}}function L8(e){var t=e.title,n=e.field;return yK(t,n)}function I8(e,t,n,r,i){var a=n.scale,o=n.axis;return function(u){var s,l;var f=u.partName,c=u.mark,d=u.positionPrefix,h=u.endPositionPrefix,p=h===void 0?undefined:h,v=u.extraEncoding,g=v===void 0?{}:v;var m=L8(n);return U8(e,f,i,{mark:c,encoding:Object.assign(Object.assign(Object.assign((s={},s[t]=Object.assign(Object.assign(Object.assign({field:"".concat(d,"_").concat(n.field),type:n.type},m!==undefined?{title:m}:{}),a!==undefined?{scale:a}:{}),o!==undefined?{axis:o}:{}),s),Cn(p)?(l={},l["".concat(t,"2")]={field:"".concat(p,"_").concat(n.field)},l):{}),r),g)})}}function U8(e,t,n,r){var i=e.clip,a=e.color,o=e.opacity;var u=e.type;if(e[t]||e[t]===undefined&&n[t]){return[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),a?{color:a}:{}),o?{opacity:o}:{}),g6(r.mark)?r.mark:{type:r.mark}),{style:"".concat(u,"-").concat(t)}),An(e[t])?{}:e[t])})]}return[]}function q8(e,t,n){var r=e.encoding;var i=t==="vertical"?"y":"x";var a=r[i];var o=r["".concat(i,"2")];var u=r["".concat(i,"Error")];var s=r["".concat(i,"Error2")];return{continuousAxisChannelDef:W8(a,n),continuousAxisChannelDef2:W8(o,n),continuousAxisChannelDefError:W8(u,n),continuousAxisChannelDefError2:W8(s,n),continuousAxis:i}}function W8(e,t){if(e===null||e===void 0?void 0:e.aggregate){var n=e.aggregate,r=z8(e,["aggregate"]);if(n!==t){k3(m3(n,t))}return r}else{return e}}function H8(e,t){var n=e.mark,r=e.encoding;var i=r.x,a=r.y;if(g6(n)&&n.orient){return n.orient}if(k4(i)){if(k4(a)){var o=A4(i)&&i.aggregate;var u=A4(a)&&a.aggregate;if(!o&&u===t){return"vertical"}else if(!u&&o===t){return"horizontal"}else if(o===t&&u===t){throw new Error("Both x and y cannot have aggregate")}else{if(u8(a)&&!u8(i)){return"horizontal"}return"vertical"}}return"horizontal"}else if(k4(a)){return"vertical"}else{throw new Error("Need a valid continuous axis for ".concat(t,"s"))}}var G8=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var $8="boxplot";var V8=["box","median","outliers","rule","ticks"];var Y8=new w8($8,J8);function X8(e){if(kn(e)){return"tukey"}return e}function J8(e,t){var n,r;var i=t.config;var a,o;e=Object.assign(Object.assign({},e),{encoding:j8(e.encoding,i)});var u=e.mark,s=e.encoding,l=e.params,f=e.projection,c=G8(e,["mark","encoding","params","projection"]);var d=g6(u)?u:{type:u};if(l){k3(u2("boxplot"))}var h=(a=d.extent)!==null&&a!==void 0?a:i.boxplot.extent;var p=H1("size",d,i);var v=X8(h);var g=Z8(e,h,i),m=g.bins,y=g.timeUnits,b=g.transform,x=g.continuousAxisChannelDef,_=g.continuousAxis,w=g.groupby,A=g.aggregate,O=g.encodingWithoutContinuousAxis,E=g.ticksOrient,k=g.boxOrient,D=g.customTooltipWithoutAggregatedField;var C=O.color,F=O.size,S=G8(O,["color","size"]);var j=function(e){return I8(d,_,x,e,i.boxplot)};var M=j(S);var B=j(O);var N=j(Object.assign(Object.assign({},S),F?{size:F}:{}));var T=R8([{fieldPrefix:v==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:v==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],x,O);var z={type:"tick",color:"black",opacity:1,orient:E,invalid:null,aria:false};var P=v==="min-max"?T:R8([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],x,O);var R=__spreadArray(__spreadArray(__spreadArray(__spreadArray([],M({partName:"rule",mark:{type:"rule",invalid:null,aria:false},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:P}),true),M({partName:"rule",mark:{type:"rule",invalid:null,aria:false},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:P}),true),M({partName:"ticks",mark:z,positionPrefix:"lower_whisker",extraEncoding:P}),true),M({partName:"ticks",mark:z,positionPrefix:"upper_whisker",extraEncoding:P}),true);var L=__spreadArray(__spreadArray(__spreadArray([],v!=="tukey"?R:[],true),B({partName:"box",mark:Object.assign(Object.assign({type:"bar"},p?{size:p}:{}),{orient:k,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:T}),true),N({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},jt(i.boxplot.median)&&i.boxplot.median.color?{color:i.boxplot.median.color}:{}),p?{size:p}:{}),{orient:E,aria:false}),positionPrefix:"mid_box",extraEncoding:T}),true);if(v==="min-max"){return Object.assign(Object.assign({},c),{transform:((o=c.transform)!==null&&o!==void 0?o:[]).concat(b),layer:L})}var I='datum["lower_box_'.concat(x.field,'"]');var U='datum["upper_box_'.concat(x.field,'"]');var q="(".concat(U," - ").concat(I,")");var W="".concat(I," - ").concat(h," * ").concat(q);var H="".concat(U," + ").concat(h," * ").concat(q);var G='datum["'.concat(x.field,'"]');var $={joinaggregate:Q8(x.field),groupby:w};var V={transform:[{filter:"(".concat(W," <= ").concat(G,") && (").concat(G," <= ").concat(H,")")},{aggregate:__spreadArray([{op:"min",field:x.field,as:"lower_whisker_".concat(x.field)},{op:"max",field:x.field,as:"upper_whisker_".concat(x.field)},{op:"min",field:"lower_box_".concat(x.field),as:"lower_box_".concat(x.field)},{op:"max",field:"upper_box_".concat(x.field),as:"upper_box_".concat(x.field)}],A,true),groupby:w}],layer:R};var Y=G8(S,["tooltip"]);var X=x.scale,J=x.axis;var Q=L8(x);var Z=UZ(J,["title"]);var K=U8(d,"outliers",i.boxplot,{transform:[{filter:"(".concat(G," < ").concat(W,") || (").concat(G," > ").concat(H,")")}],mark:"point",encoding:Object.assign(Object.assign(Object.assign((n={},n[_]=Object.assign(Object.assign(Object.assign({field:x.field,type:x.type},Q!==undefined?{title:Q}:{}),X!==undefined?{scale:X}:{}),nK(Z)?{}:{axis:Z}),n),Y),C?{color:C}:{}),D?{tooltip:D}:{})})[0];var ee;var te=__spreadArray(__spreadArray(__spreadArray([],m,true),y,true),[$],false);if(K){ee={transform:te,layer:[K,V]}}else{ee=V;(r=ee.transform).unshift.apply(r,te)}return Object.assign(Object.assign({},c),{layer:[ee,{transform:b,layer:L}]})}function Q8(e){return[{op:"q1",field:e,as:"lower_box_".concat(e)},{op:"q3",field:e,as:"upper_box_".concat(e)}]}function Z8(e,t,n){var r=H8(e,$8);var i=q8(e,r,$8),a=i.continuousAxisChannelDef,o=i.continuousAxis;var u=a.field;var s=X8(t);var l=__spreadArray(__spreadArray([],Q8(u),true),[{op:"median",field:u,as:"mid_box_".concat(u)},{op:"min",field:u,as:(s==="min-max"?"lower_whisker_":"min_")+u},{op:"max",field:u,as:(s==="min-max"?"upper_whisker_":"max_")+u}],false);var f=s==="min-max"||s==="tukey"?[]:[{calculate:'datum["upper_box_'.concat(u,'"] - datum["lower_box_').concat(u,'"]'),as:"iqr_".concat(u)},{calculate:'min(datum["upper_box_'.concat(u,'"] + datum["iqr_').concat(u,'"] * ').concat(t,', datum["max_').concat(u,'"])'),as:"upper_whisker_".concat(u)},{calculate:'max(datum["lower_box_'.concat(u,'"] - datum["iqr_').concat(u,'"] * ').concat(t,', datum["min_').concat(u,'"])'),as:"lower_whisker_".concat(u)}];var c=e.encoding,d=o,h=G8(c,[typeof d==="symbol"?d:d+""]);var p=P8(h),v=p.customTooltipWithoutAggregatedField,g=p.filteredEncoding;var m=C8(g,n),y=m.bins,b=m.timeUnits,x=m.aggregate,_=m.groupby,w=m.encoding;var A=r==="vertical"?"horizontal":"vertical";var O=r;var E=__spreadArray(__spreadArray(__spreadArray(__spreadArray([],y,true),b,true),[{aggregate:__spreadArray(__spreadArray([],x,true),l,true),groupby:_}],false),f,true);return{bins:y,timeUnits:b,transform:E,groupby:_,aggregate:x,continuousAxisChannelDef:a,continuousAxis:o,encodingWithoutContinuousAxis:w,ticksOrient:A,boxOrient:O,customTooltipWithoutAggregatedField:v}}var K8=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var e9="errorbar";var t9=["ticks","rule"];var n9=new w8(e9,r9);function r9(e,t){var n=t.config;e=Object.assign(Object.assign({},e),{encoding:j8(e.encoding,n)});var r=s9(e,e9,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.ticksOrient,l=r.markDef,f=r.outerSpec,c=r.tooltipEncoding;delete u["size"];var d=I8(l,o,a,u,n.errorbar);var h=l.thickness;var p=l.size;var v=Object.assign(Object.assign({type:"tick",orient:s,aria:false},h!==undefined?{thickness:h}:{}),p!==undefined?{size:p}:{});var g=__spreadArray(__spreadArray(__spreadArray([],d({partName:"ticks",mark:v,positionPrefix:"lower",extraEncoding:c}),true),d({partName:"ticks",mark:v,positionPrefix:"upper",extraEncoding:c}),true),d({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},h!==undefined?{size:h}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c}),true);return Object.assign(Object.assign(Object.assign({},f),{transform:i}),g.length>1?{layer:g}:Object.assign({},g[0]))}function i9(e,t){var n=e.encoding;if(a9(n)){return{orient:H8(e,t),inputType:"raw"}}var r=o9(n);var i=u9(n);var a=n.x;var o=n.y;if(r){if(i){throw new Error("".concat(t," cannot be both type aggregated-upper-lower and aggregated-error"))}var u=n.x2;var s=n.y2;if(C4(u)&&C4(s)){throw new Error("".concat(t," cannot have both x2 and y2"))}else if(C4(u)){if(k4(a)){return{orient:"horizontal",inputType:"aggregated-upper-lower"}}else{throw new Error("Both x and x2 have to be quantitative in ".concat(t))}}else if(C4(s)){if(k4(o)){return{orient:"vertical",inputType:"aggregated-upper-lower"}}else{throw new Error("Both y and y2 have to be quantitative in ".concat(t))}}throw new Error("No ranged axis")}else{var l=n.xError;var f=n.xError2;var c=n.yError;var d=n.yError2;if(C4(f)&&!C4(l)){throw new Error("".concat(t," cannot have xError2 without xError"))}if(C4(d)&&!C4(c)){throw new Error("".concat(t," cannot have yError2 without yError"))}if(C4(l)&&C4(c)){throw new Error("".concat(t," cannot have both xError and yError with both are quantiative"))}else if(C4(l)){if(k4(a)){return{orient:"horizontal",inputType:"aggregated-error"}}else{throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}}else if(C4(c)){if(k4(o)){return{orient:"vertical",inputType:"aggregated-error"}}else{throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}}throw new Error("No ranged axis")}}function a9(e){return(C4(e.x)||C4(e.y))&&!C4(e.x2)&&!C4(e.y2)&&!C4(e.xError)&&!C4(e.xError2)&&!C4(e.yError)&&!C4(e.yError2)}function o9(e){return C4(e.x2)||C4(e.y2)}function u9(e){return C4(e.xError)||C4(e.xError2)||C4(e.yError)||C4(e.yError2)}function s9(e,t,n){var r;var i=e.mark,a=e.encoding,o=e.params,u=e.projection,s=K8(e,["mark","encoding","params","projection"]);var l=g6(i)?i:{type:i};if(o){k3(u2(t))}var f=i9(e,t),c=f.orient,d=f.inputType;var h=q8(e,c,t),p=h.continuousAxisChannelDef,v=h.continuousAxisChannelDef2,g=h.continuousAxisChannelDefError,m=h.continuousAxisChannelDefError2,y=h.continuousAxis;var b=l9(l,p,v,g,m,d,t,n),x=b.errorBarSpecificAggregate,_=b.postAggregateCalculates,w=b.tooltipSummary,A=b.tooltipTitleWithFieldName;var O=a,E=y,k=y==="x"?"x2":"y2",D=y==="x"?"xError":"yError",C=y==="x"?"xError2":"yError2",F=K8(O,[typeof E==="symbol"?E:E+"",typeof k==="symbol"?k:k+"",typeof D==="symbol"?D:D+"",typeof C==="symbol"?C:C+""]);var S=C8(F,n),j=S.bins,M=S.timeUnits,B=S.aggregate,N=S.groupby,T=S.encoding;var z=__spreadArray(__spreadArray([],B,true),x,true);var P=d!=="raw"?[]:N;var R=R8(w,p,T,A);return{transform:__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],(r=s.transform)!==null&&r!==void 0?r:[],true),j,true),M,true),z.length===0?[]:[{aggregate:z,groupby:P}],true),_,true),groupby:P,continuousAxisChannelDef:p,continuousAxis:y,encodingWithoutContinuousAxis:T,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:s,tooltipEncoding:R}}function l9(e,t,n,r,i,a,o,u){var s=[];var l=[];var f=t.field;var c;var d=false;if(a==="raw"){var h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":u.errorbar.center;var p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!==(p==="iqr")){k3(g3(h,p,o))}if(p==="stderr"||p==="stdev"){s=[{op:p,field:f,as:"extent_".concat(f)},{op:h,field:f,as:"center_".concat(f)}];l=[{calculate:'datum["center_'.concat(f,'"] + datum["extent_').concat(f,'"]'),as:"upper_".concat(f)},{calculate:'datum["center_'.concat(f,'"] - datum["extent_').concat(f,'"]'),as:"lower_".concat(f)}];c=[{fieldPrefix:"center_",titlePrefix:fK(h)},{fieldPrefix:"upper_",titlePrefix:f9(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:f9(h,p,"-")}];d=true}else{var v=void 0;var g=void 0;var m=void 0;if(p==="ci"){v="mean";g="ci0";m="ci1"}else{v="median";g="q1";m="q3"}s=[{op:g,field:f,as:"lower_".concat(f)},{op:m,field:f,as:"upper_".concat(f)},{op:v,field:f,as:"center_".concat(f)}];c=[{fieldPrefix:"upper_",titlePrefix:V4({field:f,aggregate:m,type:"quantitative"},u,{allowDisabling:false})},{fieldPrefix:"lower_",titlePrefix:V4({field:f,aggregate:g,type:"quantitative"},u,{allowDisabling:false})},{fieldPrefix:"center_",titlePrefix:V4({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:false})}]}}else{if(e.center||e.extent){k3(v3(e.center,e.extent))}if(a==="aggregated-upper-lower"){c=[];l=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_".concat(f)},{calculate:'datum["'.concat(f,'"]'),as:"lower_".concat(f)}]}else if(a==="aggregated-error"){c=[{fieldPrefix:"",titlePrefix:f}];l=[{calculate:'datum["'.concat(f,'"] + datum["').concat(r.field,'"]'),as:"upper_".concat(f)}];if(i){l.push({calculate:'datum["'.concat(f,'"] + datum["').concat(i.field,'"]'),as:"lower_".concat(f)})}else{l.push({calculate:'datum["'.concat(f,'"] - datum["').concat(r.field,'"]'),as:"lower_".concat(f)})}}for(var y=0,b=l;y<b.length;y++){var x=b[y];c.push({fieldPrefix:x.as.substring(0,6),titlePrefix:vK(vK(x.calculate,'datum["',""),'"]',"")})}}return{postAggregateCalculates:l,errorBarSpecificAggregate:s,tooltipSummary:c,tooltipTitleWithFieldName:d}}function f9(e,t,n){return"".concat(fK(e)," ").concat(n," ").concat(t)}var c9="errorband";var d9=["band","borders"];var h9=new w8(c9,p9);function p9(e,t){var n=t.config;e=Object.assign(Object.assign({},e),{encoding:j8(e.encoding,n)});var r=s9(e,c9,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.markDef,l=r.outerSpec,f=r.tooltipEncoding;var c=s;var d=I8(c,o,a,u,n.errorband);var h=e.encoding.x!==undefined&&e.encoding.y!==undefined;var p={type:h?"area":"rect"};var v={type:h?"line":"rule"};var g=Object.assign(Object.assign({},c.interpolate?{interpolate:c.interpolate}:{}),c.tension&&c.interpolate?{tension:c.tension}:{});if(h){p=Object.assign(Object.assign(Object.assign({},p),g),{ariaRoleDescription:"errorband"});v=Object.assign(Object.assign(Object.assign({},v),g),{aria:false})}else if(c.interpolate){k3(y3("interpolate"))}else if(c.tension){k3(y3("tension"))}return Object.assign(Object.assign({},l),{transform:i,layer:__spreadArray(__spreadArray(__spreadArray([],d({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f}),true),d({partName:"borders",mark:v,positionPrefix:"lower",extraEncoding:f}),true),d({partName:"borders",mark:v,positionPrefix:"upper",extraEncoding:f}),true)})}var v9={};function g9(e,t,n){var r=new w8(e,t);v9[e]={normalizer:r,parts:n}}function m9(){return rK(v9)}g9($8,J8,V8);g9(e9,r9,t9);g9(c9,p9,d9);var y9=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"];var b9={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"};var x9={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"};var _9=rK(b9);var w9=rK(x9);var A9={header:1,headerRow:1,headerColumn:1,headerFacet:1};var O9=rK(A9);var E9=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"];var k9={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35};var D9={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1};var C9="_vgsid_";var F9={point:{on:"click",fields:[C9],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function S9(e){return!!e&&(e==="legend"||!!e.legend)}function j9(e){return S9(e)&&jt(e)}function M9(e){return!!e["select"]}var B9=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function N9(e){var t=[];for(var n=0,r=e||[];n<r.length;n++){var i=r[n];if(M9(i))continue;var a=i.expr,o=i.bind,u=B9(i,["expr","bind"]);if(o&&a){var s=Object.assign(Object.assign({},u),{bind:o,init:a});t.push(s)}else{var s=Object.assign(Object.assign(Object.assign({},u),a?{update:a}:{}),o?{bind:o}:{});t.push(s)}}return t}function T9(e){return P9(e)||R9(e)||z9(e)}function z9(e){return"concat"in e}function P9(e){return"vconcat"in e}function R9(e){return"hconcat"in e}function L9(e){var t=e.step,n=e.offsetIsDiscrete;var r;if(n){return(r=t.for)!==null&&r!==void 0?r:"offset"}else{return"position"}}function I9(e){return jt(e)&&e["step"]!==undefined}function U9(e){return e["view"]||e["width"]||e["height"]}var q9=20;var W9={align:1,bounds:1,center:1,columns:1,spacing:1};var H9=rK(W9);function G9(e,t,n){var r,i;var a=n[t];var o={};var u=a.spacing,s=a.columns;if(u!==undefined){o.spacing=u}if(s!==undefined){if(f4(e)&&!s4(e.facet)||z9(e)){o.columns=s}}if(P9(e)){o.columns=1}for(var l=0,f=H9;l<f.length;l++){var c=f[l];if(e[c]!==undefined){if(c==="spacing"){var d=e[c];o[c]=kn(d)?d:{row:(r=d.row)!==null&&r!==void 0?r:u,column:(i=d.column)!==null&&i!==void 0?i:u}}else{o[c]=e[c]}}}return o}var $9=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function V9(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function Y9(e,t){var n=X9(e,t);return I9(n)?n.step:J9}function X9(e,t){var n;var r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return yK(r,{step:e.step})}var J9=20;var Q9={continuousWidth:200,continuousHeight:200,step:J9};var Z9={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Q9,mark:A6,arc:{},area:{},bar:F6,circle:{},geoshape:{},image:{},line:{},point:{},rect:S6,rule:{color:"black"},square:{},text:{color:"black"},tick:j6,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:true,ticks:false},errorband:{band:{opacity:.3},borders:false},scale:I5,projection:{},legend:k9,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:F9,style:{},title:{},facet:{spacing:q9},concat:{spacing:q9}};var K9=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"];var e7={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12};var t7={blue:K9[0],orange:K9[1],red:K9[2],teal:K9[3],green:K9[4],yellow:K9[5],purple:K9[6],pink:K9[7],brown:K9[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function n7(e){if(e===void 0){e={}}return{signals:[{name:"color",value:jt(e)?Object.assign(Object.assign({},t7),e):t7}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function r7(e){return{signals:[{name:"fontSize",value:jt(e)?Object.assign(Object.assign({},e7),e):e7}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function i7(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function a7(e){var t=rK(e||{});var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];var o=e[a];n[a]=h8(o)?T1(o):z1(o)}return n}function o7(e){var t=rK(e);var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];n[a]=a7(e[a])}return n}var u7=__spreadArray(__spreadArray(__spreadArray(__spreadArray([],E6,true),x8,true),O9,true),["background","padding","legend","lineBreak","scale","style","title","view"],false);function s7(e){if(e===void 0){e={}}var t=e.color,n=e.font,r=e.fontSize,i=e.selection,a=$9(e,["color","font","fontSize","selection"]);var o=Bt({},RZ(Z9),n?i7(n):{},t?n7(t):{},r?r7(r):{},a||{});if(i){Nt(o,"selection",i,true)}var u=UZ(o,u7);for(var s=0,l=["background","lineBreak","padding"];s<l.length;s++){var f=l[s];if(o[f]){u[f]=z1(o[f])}}for(var c=0,d=E6;c<d.length;c++){var h=d[c];if(o[h]){u[h]=_1(o[h])}}for(var p=0,v=x8;p<v.length;p++){var g=v[p];if(o[g]){u[g]=a7(o[g])}}for(var m=0,y=O9;m<y.length;m++){var b=y[m];if(o[b]){u[b]=_1(o[b])}}if(o.legend){u.legend=_1(o.legend)}if(o.scale){u.scale=_1(o.scale)}if(o.style){u.style=o7(o.style)}if(o.title){u.title=_1(o.title)}if(o.view){u.view=_1(o.view)}return u}var l7=new Set(__spreadArray(["view"],v6,true));var f7=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"];var c7=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},w6);function d7(e){e=RZ(e);for(var t=0,n=f7;t<n.length;t++){var r=n[t];delete e[r]}if(e.axis){for(var r in e.axis){if(h8(e.axis[r])){delete e.axis[r]}}}if(e.legend){for(var i=0,a=y9;i<a.length;i++){var r=a[i];delete e.legend[r]}}if(e.mark){for(var o=0,u=_6;o<u.length;o++){var r=u[o];delete e.mark[r]}if(e.mark.tooltip&&jt(e.mark.tooltip)){delete e.mark.tooltip}}if(e.params){e.signals=(e.signals||[]).concat(N9(e.params));delete e.params}for(var s=0,l=l7;s<l.length;s++){var f=l[s];for(var c=0,d=_6;c<d.length;c++){var r=d[c];delete e[f][r]}var h=c7[f];if(h){for(var p=0,v=h;p<v.length;p++){var r=v[p];delete e[f][r]}}p7(e,f)}for(var g=0,m=m9();g<m.length;g++){var y=m[g];delete e[y]}h7(e);for(var r in e){if(jt(e[r])&&nK(e[r])){delete e[r]}}return nK(e)?undefined:e}function h7(e){var t=A1(e.title),n=t.titleMarkConfig,r=t.subtitleMarkConfig,i=t.subtitle;if(!nK(n)){e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),n)}if(!nK(r)){e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),r)}if(!nK(i)){e.title=i}else{delete e.title}}function p7(e,t,n,r){var i=r?e[t][r]:e[t];if(t==="view"){n="cell"}var a=Object.assign(Object.assign({},i),e.style[n!==null&&n!==void 0?n:t]);if(!nK(a)){e.style[n!==null&&n!==void 0?n:t]=a}if(!r){delete e[t]}}function v7(e){return"layer"in e}function g7(e){return"repeat"in e}function m7(e){return!St(e.repeat)&&e.repeat["layer"]}var y7=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var b7=function(){function e(){}e.prototype.map=function(e,t){if(f4(e)){return this.mapFacet(e,t)}else if(g7(e)){return this.mapRepeat(e,t)}else if(R9(e)){return this.mapHConcat(e,t)}else if(P9(e)){return this.mapVConcat(e,t)}else if(z9(e)){return this.mapConcat(e,t)}else{return this.mapLayerOrUnit(e,t)}};e.prototype.mapLayerOrUnit=function(e,t){if(v7(e)){return this.mapLayer(e,t)}else if(_8(e)){return this.mapUnit(e,t)}throw new Error(Z1(e))};e.prototype.mapLayer=function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map((function(e){return n.mapLayerOrUnit(e,t)}))})};e.prototype.mapHConcat=function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((function(e){return n.map(e,t)}))})};e.prototype.mapVConcat=function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((function(e){return n.map(e,t)}))})};e.prototype.mapConcat=function(e,t){var n=this;var r=e.concat,i=y7(e,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map((function(e){return n.map(e,t)}))})};e.prototype.mapFacet=function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})};e.prototype.mapRepeat=function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})};return e}();var x7={zero:1,center:1,normalize:1};function _7(e){return e in x7}var w7=new Set([K5,t6,e6,o6,i6,f6,c6,r6,u6,s6]);var A7=new Set([t6,e6,K5]);function O7(e){return A4(e)&&O4(e)==="quantitative"&&!e.bin}function E7(e,t){var n,r;var i=t==="x"?"y":"radius";var a=e[t];var o=e[i];if(A4(a)&&A4(o)){if(O7(a)&&O7(o)){if(a.stack){return t}else if(o.stack){return i}var u=A4(a)&&!!a.aggregate;var s=A4(o)&&!!o.aggregate;if(u!==s){return u?t:i}else{var l=(n=a.scale)===null||n===void 0?void 0:n.type;var f=(r=o.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear"){return i}else if(f&&f!=="linear"){return t}}}else if(O7(a)){return t}else if(O7(o)){return i}}else if(O7(a)){return t}else if(O7(o)){return i}return undefined}function k7(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function D7(e,t,n){if(n===void 0){n={}}var r,i;var a=g6(e)?e.type:e;if(!w7.has(a)){return null}var o=E7(t,"x")||E7(t,"theta");if(!o){return null}var u=t[o];var s=A4(u)?P4(u,{}):undefined;var l=k7(o);var f=[];var c=new Set;if(t[l]){var d=t[l];var h=A4(d)?P4(d,{}):undefined;if(h&&h!==s){f.push(l);c.add(h)}var p=l==="x"?"xOffset":"yOffset";var v=t[p];var g=A4(v)?P4(v,{}):undefined;if(g&&g!==s){f.push(p);c.add(g)}}var m=P0.reduce((function(e,n){if(n!=="tooltip"&&O8(t,n)){var r=t[n];for(var i=0,a=tn(r);i<a.length;i++){var o=a[i];var u=Z4(o);if(u.aggregate){continue}var s=P4(u,{});if(!s||!c.has(s)){e.push({channel:n,fieldDef:u})}}}return e}),[]);var y;if(u.stack!==undefined){if(An(u.stack)){y=u.stack?"zero":null}else{y=u.stack}}else if(A7.has(a)){y="zero"}if(!y||!_7(y)){return null}if(D8(t)&&m.length===0){return null}if(((r=u===null||u===void 0?void 0:u.scale)===null||r===void 0?void 0:r.type)&&((i=u===null||u===void 0?void 0:u.scale)===null||i===void 0?void 0:i.type)!==E5.LINEAR){if(n.disallowNonLinearStack){return null}else{k3(c3(u.scale.type))}}if(C4(t[S0(o)])){if(u.stack!==undefined){k3(f3(o))}return null}if(A4(u)&&u.aggregate&&!d1.has(u.aggregate)){k3(d3(u.aggregate))}return{groupbyChannels:f,groupbyFields:c,fieldChannel:o,impute:u.impute===null?false:h6(a),stackBy:m,offset:y}}var C7=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function F7(e){var t=C7(e,["point","line"]);return rK(t).length>1?t:t.type}function S7(e){var t;for(var n=0,r=["line","area","rule","trail"];n<r.length;n++){var i=r[n];if(e[i]){e=Object.assign(Object.assign({},e),(t={},t[i]=UZ(e[i],["point","line"]),t))}}return e}function j7(e,t,n){if(t===void 0){t={}}if(e.point==="transparent"){return{opacity:0}}else if(e.point){return jt(e.point)?e.point:{}}else if(e.point!==undefined){return null}else{if(t.point||n.shape){return jt(t.point)?t.point:{}}return undefined}}function M7(e,t){if(t===void 0){t={}}if(e.line){return e.line===true?{}:e.line}else if(e.line!==undefined){return null}else{if(t.line){return t.line===true?{}:t.line}return undefined}}var B7=function(){function e(){this.name="path-overlay"}e.prototype.hasMatchingType=function(e,t){if(_8(e)){var n=e.mark,r=e.encoding;var i=g6(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!j7(i,t[i.type],r);case"area":return!!j7(i,t[i.type],r)||!!M7(i,t[i.type])}}return false};e.prototype.run=function(e,t,n){var r;var i=t.config;var a=e.params,o=e.projection,u=e.mark,s=e.encoding,l=C7(e,["params","projection","mark","encoding"]);var f=j8(s,i);var c=g6(u)?u:{type:u};var d=j7(c,i[c.type],f);var h=c.type==="area"&&M7(c,i[c.type]);var p=[Object.assign(Object.assign({},a?{params:a}:{}),{mark:F7(Object.assign(Object.assign({},c.type==="area"&&c.opacity===undefined&&c.fillOpacity===undefined?{opacity:.7}:{}),c)),encoding:UZ(f,["shape"])})];var v=D7(c,f);var g=f;if(v){var m=v.fieldChannel,y=v.offset;g=Object.assign(Object.assign({},f),(r={},r[m]=Object.assign(Object.assign({},f[m]),y?{stack:y}:{}),r))}if(h){p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},IZ(c,["clip","interpolate","tension","tooltip"])),h),encoding:g}))}if(d){p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:true},IZ(c,["clip","tooltip"])),d),encoding:g}))}return n(Object.assign(Object.assign({},l),{layer:p}),Object.assign(Object.assign({},t),{config:S7(i)}))};return e}();var N7=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function T7(e,t){if(!t){return e}if(s4(e)){return U7(e,t)}return R7(e,t)}function z7(e,t){if(!t){return e}return U7(e,t)}function P7(e,t,n){var r;var i=t[e];if(h4(i)){if(i.repeat in n){return Object.assign(Object.assign({},t),(r={},r[e]=n[i.repeat],r))}else{k3(v2(i.repeat));return undefined}}return t}function R7(e,t){e=P7("field",e,t);if(e===undefined){return undefined}else if(e===null){return null}if(v4(e)&&o4(e.sort)){var n=P7("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}function L7(e,t){if(A4(e)){return R7(e,t)}else{var n=P7("datum",e,t);if(n!==e&&!n.type){n.type="nominal"}return n}}function I7(e,t){if(C4(e)){var n=L7(e,t);if(n){return n}else if(b4(e)){return{condition:e.condition}}}else{if(_4(e)){var n=L7(e.condition,t);if(n){return Object.assign(Object.assign({},e),{condition:n})}else{var r=N7(e,["condition"]);return r}}return e}return undefined}function U7(e,t){var n={};for(var r in e){if(mn(e,r)){var i=e[r];if(St(i)){n[r]=i.map((function(e){return I7(e,t)})).filter((function(e){return e}))}else{var a=I7(i,t);if(a!==undefined){n[r]=a}}}}return n}var q7=function(){function e(){this.name="RuleForRangedLine"}e.prototype.hasMatchingType=function(e){if(_8(e)){var t=e.encoding,n=e.mark;if(n==="line"||g6(n)&&n.type==="line"){for(var r=0,i=k0;r<i.length;r++){var a=i[r];var o=C0(a);var u=t[o];if(t[a]){if(A4(u)&&!g1(u.bin)||E4(u)){return true}}}}}return false};e.prototype.run=function(e,t,n){var r=e.encoding,i=e.mark;k3(H2(!!r.x2,!!r.y2));return n(Object.assign(Object.assign({},e),{mark:jt(i)?Object.assign(Object.assign({},i),{type:"rule"}):"rule"}),t)};return e}();var W7=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var H7=function(e){Ee(t,e);function t(){var t=e.apply(this,arguments)||this;t.nonFacetUnitNormalizers=[Y8,n9,h9,new B7,new q7];return t}t.prototype.map=function(t,n){if(_8(t)){var r=O8(t.encoding,DK);var i=O8(t.encoding,CK);var a=O8(t.encoding,FK);if(r||i||a){return this.mapFacetedUnit(t,n)}}return e.prototype.map.call(this,t,n)};t.prototype.mapUnit=function(e,t){var n=t.parentEncoding,r=t.parentProjection;var i=z7(e.encoding,t.repeater);var a=Object.assign(Object.assign({},e),i?{encoding:i}:{});if(n||r){return this.mapUnitWithParentEncodingOrProjection(a,t)}var o=this.mapLayerOrUnit.bind(this);for(var u=0,s=this.nonFacetUnitNormalizers;u<s.length;u++){var l=s[u];if(l.hasMatchingType(a,t.config)){return l.run(a,t,o)}}return a};t.prototype.mapRepeat=function(e,t){if(m7(e)){return this.mapLayerRepeat(e,t)}else{return this.mapNonLayerRepeat(e,t)}};t.prototype.mapLayerRepeat=function(e,t){var n=this;var r=e.repeat,i=e.spec,a=W7(e,["repeat","spec"]);var o=r.row,u=r.column,s=r.layer;var l=t.repeater,f=l===void 0?{}:l,c=t.repeaterPrefix,d=c===void 0?"":c;if(o||u){return this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),u?{column:u}:{}),spec:{repeat:{layer:s},spec:i}}),t)}else{return Object.assign(Object.assign({},a),{layer:s.map((function(e){var r=Object.assign(Object.assign({},f),{layer:e});var a="".concat((i.name||"")+d,"child__layer_").concat(uK(e));var o=n.mapLayerOrUnit(i,Object.assign(Object.assign({},t),{repeater:r,repeaterPrefix:a}));o.name=a;return o}))})}};t.prototype.mapNonLayerRepeat=function(e,t){var n;var r=e.repeat,i=e.spec,a=e.data,o=W7(e,["repeat","spec","data"]);if(!St(r)&&e.columns){e=UZ(e,["columns"]);k3(g2("repeat"))}var u=[];var s=t.repeater,l=s===void 0?{}:s,f=t.repeaterPrefix,c=f===void 0?"":f;var d=!St(r)&&r.row||[l?l.row:null];var h=!St(r)&&r.column||[l?l.column:null];var p=St(r)&&r||[l?l.repeat:null];for(var v=0,g=p;v<g.length;v++){var m=g[v];for(var y=0,b=d;y<b.length;y++){var x=b[y];for(var _=0,w=h;_<w.length;_++){var A=w[_];var O={repeat:m,row:x,column:A,layer:l.layer};var E=(i.name||"")+c+"child__"+(St(r)?"".concat(uK(m)):(r.row?"row_".concat(uK(x)):"")+(r.column?"column_".concat(uK(A)):""));var k=this.map(i,Object.assign(Object.assign({},t),{repeater:O,repeaterPrefix:E}));k.name=E;u.push(UZ(k,["data"]))}}}var D=St(r)?e.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(n=i.data)!==null&&n!==void 0?n:a,align:"all"},o),{columns:D,concat:u})};t.prototype.mapFacet=function(t,n){var r=t.facet;if(s4(r)&&t.columns){t=UZ(t,["columns"]);k3(g2("facet"))}return e.prototype.mapFacet.call(this,t,n)};t.prototype.mapUnitWithParentEncodingOrProjection=function(e,t){var n=e.encoding,r=e.projection;var i=t.parentEncoding,a=t.parentProjection,o=t.config;var u=$7({parentProjection:a,projection:r});var s=G7({parentEncoding:i,encoding:z7(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})};t.prototype.mapFacetedUnit=function(e,t){var n=e.encoding,r=n.row,i=n.column,a=n.facet,o=W7(n,["row","column","facet"]);var u=e.mark,s=e.width,l=e.projection,f=e.height,c=e.view,d=e.params,h=e.encoding,p=W7(e,["mark","width","projection","height","view","params","encoding"]);var v=this.getFacetMappingAndLayout({row:r,column:i,facet:a},t),g=v.facetMapping,m=v.layout;var y=z7(o,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{width:s}:{}),f?{height:f}:{}),c?{view:c}:{}),l?{projection:l}:{}),{mark:u,encoding:y}),d?{params:d}:{})}),t)};t.prototype.getFacetMappingAndLayout=function(e,t){var n;var r=e.row,i=e.column,a=e.facet;if(r||i){if(a){k3(U2(__spreadArray(__spreadArray([],r?[DK]:[],true),i?[CK]:[],true)))}var o={};var u={};for(var s=0,l=[DK,CK];s<l.length;s++){var f=l[s];var c=e[f];if(c){var d=W7(c,["align","center","spacing","columns"]);o[f]=d;for(var h=0,p=["align","center","spacing"];h<p.length;h++){var v=p[h];if(c[v]!==undefined){(n=u[v])!==null&&n!==void 0?n:u[v]={};u[v][f]=c[v]}}}}return{facetMapping:o,layout:u}}else{var g=a.align,m=a.center,y=a.spacing,b=a.columns,o=W7(a,["align","center","spacing","columns"]);return{facetMapping:T7(o,t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},g?{align:g}:{}),m?{center:m}:{}),y?{spacing:y}:{}),b?{columns:b}:{})}}};t.prototype.mapLayer=function(t,n){var r=n.parentEncoding,i=n.parentProjection,a=W7(n,["parentEncoding","parentProjection"]);var o=t.encoding,u=t.projection,s=W7(t,["encoding","projection"]);var l=Object.assign(Object.assign({},a),{parentEncoding:G7({parentEncoding:r,encoding:o,layer:true}),parentProjection:$7({parentProjection:i,projection:u})});return e.prototype.mapLayer.call(this,s,l)};return t}(b7);function G7(e){var t=e.parentEncoding,n=e.encoding,r=n===void 0?{}:n,i=e.layer;var a={};if(t){var o=new Set(__spreadArray(__spreadArray([],rK(t),true),rK(r),true));for(var u=0,s=o;u<s.length;u++){var l=s[u];var f=r[l];var c=t[l];if(C4(f)){var d=Object.assign(Object.assign({},c),f);a[l]=d}else if(_4(f)){a[l]=Object.assign(Object.assign({},f),{condition:Object.assign(Object.assign({},c),f.condition)})}else if(f||f===null){a[l]=f}else if(i||S4(c)||E1(c)||C4(c)||St(c)){a[l]=c}}}else{a=r}return!a||nK(a)?undefined:a}function $7(e){var t=e.parentProjection,n=e.projection;if(t&&n){k3(O2({parentProjection:t,projection:n}))}return n!==null&&n!==void 0?n:t}function V7(e){return"filter"in e}function Y7(e){return(e===null||e===void 0?void 0:e["stop"])!==undefined}function X7(e){return"lookup"in e}function J7(e){return"data"in e}function Q7(e){return"param"in e}function Z7(e){return"pivot"in e}function K7(e){return"density"in e}function eee(e){return"quantile"in e}function tee(e){return"regression"in e}function nee(e){return"loess"in e}function ree(e){return"sample"in e}function iee(e){return"window"in e}function aee(e){return"joinaggregate"in e}function oee(e){return"flatten"in e}function uee(e){return"calculate"in e}function see(e){return"bin"in e}function lee(e){return"impute"in e}function fee(e){return"timeUnit"in e}function cee(e){return"aggregate"in e}function dee(e){return"stack"in e}function hee(e){return"fold"in e}function pee(e){return e.map((function(e){if(V7(e)){return{filter:zZ(e.filter,p5)}}return e}))}var vee=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var gee=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.map=function(t,n){var r,i;(r=n.emptySelections)!==null&&r!==void 0?r:n.emptySelections={};(i=n.selectionPredicates)!==null&&i!==void 0?i:n.selectionPredicates={};t=mee(t,n);return e.prototype.map.call(this,t,n)};t.prototype.mapLayerOrUnit=function(t,n){t=mee(t,n);if(t.encoding){var r={};for(var i=0,a=aK(t.encoding);i<a.length;i++){var o=a[i],u=o[0],s=o[1];r[u]=yee(s,n)}t=Object.assign(Object.assign({},t),{encoding:r})}return e.prototype.mapLayerOrUnit.call(this,t,n)};t.prototype.mapUnit=function(e,t){var n=e,r=n.selection,i=vee(n,["selection"]);if(r){return Object.assign(Object.assign({},i),{params:aK(r).map((function(e){var n=e[0],r=e[1];var i;var a=r,o=a.init,u=a.bind,s=a.empty,l=vee(a,["init","bind","empty"]);if(l.type==="single"){l.type="point";l.toggle=false}else if(l.type==="multi"){l.type="point"}t.emptySelections[n]=s!=="none";for(var f=0,c=iK((i=t.selectionPredicates[n])!==null&&i!==void 0?i:{});f<c.length;f++){var d=c[f];d.empty=s!=="none"}return{name:n,value:o,select:l,bind:u}}))})}return e};return t}(b7);function mee(e,t){var n=e.transform,r=vee(e,["transform"]);if(n){var i=n.map((function(e){if(V7(e)){return{filter:xee(e,t)}}else if(see(e)&&m1(e.bin)){return Object.assign(Object.assign({},e),{bin:bee(e.bin)})}else if(X7(e)){var n=e.from,r=n.selection,i=vee(n,["selection"]);return r?Object.assign(Object.assign({},e),{from:Object.assign({param:r},i)}):e}return e}));return Object.assign(Object.assign({},r),{transform:i})}return e}function yee(e,t){var n,r;var i=RZ(e);if(A4(i)&&m1(i.bin)){i.bin=bee(i.bin)}if(j4(i)&&((r=(n=i.scale)===null||n===void 0?void 0:n.domain)===null||r===void 0?void 0:r.selection)){var a=i.scale.domain,o=a.selection,u=vee(a,["selection"]);i.scale.domain=Object.assign(Object.assign({},u),o?{param:o}:{})}if(b4(i)){if(St(i.condition)){i.condition=i.condition.map((function(e){var n=e.selection,r=e.param,i=e.test,a=vee(e,["selection","param","test"]);return r?e:Object.assign(Object.assign({},a),{test:xee(e,t)})}))}else{var s=yee(i.condition,t),l=s.selection,f=s.param,c=s.test,d=vee(s,["selection","param","test"]);i.condition=f?i.condition:Object.assign(Object.assign({},d),{test:xee(i.condition,t)})}}return i}function bee(e){var t=e.extent;if(t===null||t===void 0?void 0:t.selection){var n=t.selection,r=vee(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},r),{param:n})})}return e}function xee(e,t){var n=function(e){return zZ(e,(function(e){var n,r;var i;var a=(n=t.emptySelections[e])!==null&&n!==void 0?n:true;var o={param:e,empty:a};(r=(i=t.selectionPredicates)[e])!==null&&r!==void 0?r:i[e]=[];t.selectionPredicates[e].push(o);return o}))};return e.selection?n(e.selection):zZ(e.test||e.filter,(function(e){return e.selection?n(e.selection):e}))}var _ee=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.map=function(t,n){var r;var i=(r=n.selections)!==null&&r!==void 0?r:[];if(t.params&&!_8(t)){var a=[];for(var o=0,u=t.params;o<u.length;o++){var s=u[o];if(M9(s)){i.push(s)}else{a.push(s)}}t.params=a}n.selections=i;return e.prototype.map.call(this,t,kee(t,n))};t.prototype.mapUnit=function(e,t){var n;var r=t.selections;if(!r||!r.length)return e;var i=((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name);var a=[];for(var o=0,u=r;o<u.length;o++){var s=u[o];if(!s.views||!s.views.length){a.push(s)}else{for(var l=0,f=s.views;l<f.length;l++){var c=f[l];if(Cn(c)&&(c===e.name||i.indexOf(c)>=0)||St(c)&&c.map((function(e){return i.indexOf(e)})).every((function(e,t,n){return e!==-1&&(t===0||e>n[t-1])}))){a.push(s)}}}}if(a.length)e.params=a;return e};return t}(b7);var wee=function(e){var t=_ee.prototype[e];_ee.prototype[e]=function(e,n){return t.call(this,e,kee(e,n))}};for(var Aee=0,Oee=["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"];Aee<Oee.length;Aee++){var Eee=Oee[Aee];wee(Eee)}function kee(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function Dee(e,t){if(t===undefined){t=s7(e.config)}var n=jee(e,t);var r=e.width,i=e.height;var a=Bee(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}var Cee=new H7;var Fee=new gee;var See=new _ee;function jee(e,t){if(t===void 0){t={}}var n={config:t};return See.map(Cee.map(Fee.map(e,n),n),n)}function Mee(e){return Cn(e)?{type:e}:e!==null&&e!==void 0?e:{}}function Bee(e,t,n){var r=t.width,i=t.height;var a=_8(e)||v7(e);var o={};if(!a){if(r=="container"){k3(e2("width"));r=undefined}if(i=="container"){k3(e2("height"));i=undefined}}else{if(r=="container"&&i=="container"){o.type="fit";o.contains="padding"}else if(r=="container"){o.type="fit-x";o.contains="padding"}else if(i=="container"){o.type="fit-y";o.contains="padding"}}var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Mee(n.autosize):{}),Mee(e.autosize));if(u.type==="fit"&&!a){k3(K1);u.type="pad"}if(r=="container"&&!(u.type=="fit"||u.type=="fit-x")){k3(t2("width"))}if(i=="container"&&!(u.type=="fit"||u.type=="fit-y")){k3(t2("height"))}if(PZ(u,{type:"pad"})){return undefined}return u}function Nee(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Tee(e){return e?"fit-".concat(W0(e)):"fit"}var zee=["background","padding"];function Pee(e,t){var n={};for(var r=0,i=zee;r<i.length;r++){var a=i[r];if(e&&e[a]!==undefined){n[a]=z1(e[a])}}if(t){n.params=e.params}return n}var Ree=function(){function e(e,t){if(e===void 0){e={}}if(t===void 0){t={}}this.explicit=e;this.implicit=t}e.prototype.clone=function(){return new e(RZ(this.explicit),RZ(this.implicit))};e.prototype.combine=function(){return Object.assign(Object.assign({},this.explicit),this.implicit)};e.prototype.get=function(e){return yK(this.explicit[e],this.implicit[e])};e.prototype.getWithExplicit=function(e){if(this.explicit[e]!==undefined){return{explicit:true,value:this.explicit[e]}}else if(this.implicit[e]!==undefined){return{explicit:false,value:this.implicit[e]}}return{explicit:false,value:undefined}};e.prototype.setWithExplicit=function(e,t){var n=t.value,r=t.explicit;if(n!==undefined){this.set(e,n,r)}};e.prototype.set=function(e,t,n){delete this[n?"implicit":"explicit"][e];this[n?"explicit":"implicit"][e]=t;return this};e.prototype.copyKeyFromSplit=function(e,t){var n=t.explicit,r=t.implicit;if(n[e]!==undefined){this.set(e,n[e],true)}else if(r[e]!==undefined){this.set(e,r[e],false)}};e.prototype.copyKeyFromObject=function(e,t){if(t[e]!==undefined){this.set(e,t[e],true)}};e.prototype.copyAll=function(e){for(var t=0,n=rK(e.combine());t<n.length;t++){var r=n[t];var i=e.getWithExplicit(r);this.setWithExplicit(r,i)}};return e}();function Lee(e){return{explicit:true,value:e}}function Iee(e){return{explicit:false,value:e}}function Uee(e){return function(t,n,r,i){var a=e(t.value,n.value);if(a>0){return t}else if(a<0){return n}return qee(t,n,r,i)}}function qee(e,t,n,r){if(e.explicit&&t.explicit){k3(n3(n,r,e.value,t.value))}return e}function Wee(e,t,n,r,i){if(i===void 0){i=qee}if(e===undefined||e.value===undefined){return t}if(e.explicit&&!t.explicit){return e}else if(t.explicit&&!e.explicit){return t}else if(PZ(e.value,t.value)){return e}else{return i(e,t,n,r)}}var Hee=function(e){Ee(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this,t,n)||this;i.explicit=t;i.implicit=n;i.parseNothing=r;return i}t.prototype.clone=function(){var t=e.prototype.clone.call(this);t.parseNothing=this.parseNothing;return t};return t}(Ree);function Gee(e){return"url"in e}function $ee(e){return"values"in e}function Vee(e){return"name"in e&&!Gee(e)&&!$ee(e)&&!Yee(e)}function Yee(e){return e&&(Xee(e)||Jee(e)||Qee(e))}function Xee(e){return"sequence"in e}function Jee(e){return"sphere"in e}function Qee(e){return"graticule"in e}var Zee;(function(e){e[e["Raw"]=0]="Raw";e[e["Main"]=1]="Main";e[e["Row"]=2]="Row";e[e["Column"]=3]="Column";e[e["Lookup"]=4]="Lookup"})(Zee||(Zee={}));var Kee=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function ete(e,t,n){if(t===void 0){t=true}if(n===void 0){n=yt}if(St(e)){var r=e.map((function(e){return ete(e,t,n)}));return t?"[".concat(r.join(", "),"]"):r}else if(C3(e)){if(t){return n(P3(e))}else{return n(L3(e))}}return t?n(qZ(e)):e}function tte(e,t){var n;for(var r=0,i=iK((n=e.component.selection)!==null&&n!==void 0?n:{});r<i.length;r++){var a=i[r];var o=a.name;var u="".concat(o).concat(Cne,", ").concat(a.resolve==="global"?"true":"{unit: ".concat(Bne(e),"}"));for(var s=0,l=jne;s<l.length;s++){var f=l[s];if(!f.defined(a))continue;if(f.signals)t=f.signals(e,a,t);if(f.modifyExpr)u=f.modifyExpr(e,a,u)}t.push({name:o+Fne,on:[{events:{signal:a.name+Cne},update:"modify(".concat(Pn(a.name+Dne),", ").concat(u,")")}]})}return ste(t)}function nte(e,t){if(e.component.selection&&rK(e.component.selection).length){var n=Pn(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:w$("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return ste(t)}function rte(e,t){var n;var r=false;var i=function(n){var i=n.name;var a=Pn(i+Dne);var o=t.filter((function(e){return e.name===i}));if(o.length===0){var u=n.resolve==="global"?"union":n.resolve;var s=n.type==="point"?", true, true)":")";t.push({name:n.name,update:"".concat(Sne,"(").concat(a,", ").concat(Pn(u)).concat(s)})}r=true;for(var l=0,f=jne;l<f.length;l++){var c=f[l];if(c.defined(n)&&c.topLevelSignals){t=c.topLevelSignals(e,n,t)}}};for(var a=0,o=iK((n=e.component.selection)!==null&&n!==void 0?n:{});a<o.length;a++){var u=o[a];i(u)}if(r){var s=t.filter((function(e){return e.name==="unit"}));if(s.length===0){t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}}return ste(t)}function ite(e,t){var n;var r=__spreadArray([],t,true);var i=function(t){var n={name:t.name+Dne};if(t.init){var i=t.project.items.map((function(e){var t=Kee(e,["signals"]);return t}));n.values=t.init.map((function(t){return{unit:Bne(e,{escape:false}),fields:i,values:ete(t,false)}}))}var a=r.filter((function(e){return e.name===t.name+Dne}));if(!a.length){r.push(n)}};for(var a=0,o=iK((n=e.component.selection)!==null&&n!==void 0?n:{});a<o.length;a++){var u=o[a];i(u)}return r}function ate(e,t){var n;for(var r=0,i=iK((n=e.component.selection)!==null&&n!==void 0?n:{});r<i.length;r++){var a=i[r];for(var o=0,u=jne;o<u.length;o++){var s=u[o];if(s.defined(a)&&s.marks){t=s.marks(e,a,t)}}}return t}function ote(e,t){for(var n=0,r=e.children;n<r.length;n++){var i=r[n];if(Roe(i)){t=ate(i,t)}}return t}function ute(e,t,n,r){var i=qne(e,t.param,t);return{signal:P5(n.get("type"))&&St(r)&&r[0]>r[1]?"isValid(".concat(i,") && reverse(").concat(i,")"):i}}function ste(e){return e.map((function(e){if(e.on&&!e.on.length)delete e.on;return e}))}var lte=function(){function e(e,t){this.debugName=t;this._children=[];this._parent=null;if(e){this.parent=e}}e.prototype.clone=function(){throw new Error("Cannot clone node")};Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){this._parent=e;if(e){e.addChild(this)}},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:false,configurable:true});e.prototype.numChildren=function(){return this._children.length};e.prototype.addChild=function(e,t){if(this._children.includes(e)){k3(x2);return}if(t!==undefined){this._children.splice(t,0,e)}else{this._children.push(e)}};e.prototype.removeChild=function(e){var t=this._children.indexOf(e);this._children.splice(t,1);return t};e.prototype.remove=function(){var e=this._parent.removeChild(this);for(var t=0,n=this._children;t<n.length;t++){var r=n[t];r._parent=this._parent;this._parent.addChild(r,e++)}};e.prototype.insertAsParentOf=function(e){var t=e.parent;t.removeChild(this);this.parent=t;e.parent=this};e.prototype.swapWithParent=function(){var e=this._parent;var t=e.parent;for(var n=0,r=this._children;n<r.length;n++){var i=r[n];i.parent=e}this._children=[];e.removeChild(this);e.parent.removeChild(e);this.parent=t;e.parent=this};return e}();var fte=function(e){Ee(t,e);function t(t,n,r,i){var a=e.call(this,t,n)||this;a.type=r;a.refCounts=i;a._source=a._name=n;if(a.refCounts&&!(a._name in a.refCounts)){a.refCounts[a._name]=0}return a}t.prototype.clone=function(){var e=new this.constructor;e.debugName="clone_".concat(this.debugName);e._source=this._source;e._name="clone_".concat(this._name);e.type=this.type;e.refCounts=this.refCounts;e.refCounts[e._name]=0;return e};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){if(this._hash===undefined){this._hash="Output ".concat(xK())}return this._hash};t.prototype.getSource=function(){this.refCounts[this._name]++;return this._source};t.prototype.isRequired=function(){return!!this.refCounts[this._name]};t.prototype.setSource=function(e){this._source=e};return t}(lte);var cte=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var dte=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.formula=n;return r}t.prototype.clone=function(){return new t(null,RZ(this.formula))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef((function(e,t){var n=t.field,r=t.timeUnit;if(r){var i=P4(t,{forAs:true});e[WZ({as:i,field:n,timeUnit:r})]={as:i,field:n,timeUnit:r}}return e}),{});if(nK(r)){return null}return new t(e,r)};t.makeFromTransform=function(e,n){var r;var i=Object.assign({},n),a=i.timeUnit,o=cte(i,["timeUnit"]);var u=Z3(a);var s=Object.assign(Object.assign({},o),{timeUnit:u});return new t(e,(r={},r[WZ(s)]=s,r))};t.prototype.merge=function(e){this.formula=Object.assign({},this.formula);for(var t in e.formula){if(!this.formula[t]){this.formula[t]=e.formula[t]}}for(var n=0,r=e.children;n<r.length;n++){var i=r[n];e.removeChild(i);i.parent=this}e.remove()};t.prototype.removeFormulas=function(e){var t={};for(var n=0,r=aK(this.formula);n<r.length;n++){var i=r[n],a=i[0],o=i[1];if(!e.has(o.as)){t[a]=o}}this.formula=t};t.prototype.producedFields=function(){return new Set(iK(this.formula).map((function(e){return e.as})))};t.prototype.dependentFields=function(){return new Set(iK(this.formula).map((function(e){return e.field})))};t.prototype.hash=function(){return"TimeUnit ".concat(WZ(this.formula))};t.prototype.assemble=function(){var e=[];for(var t=0,n=iK(this.formula);t<n.length;t++){var r=n[t];var i=r.field,a=r.as,o=r.timeUnit;var u=Z3(o),s=u.unit,l=u.utc,f=cte(u,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:pK(i),type:"timeunit"},s?{units:V3(s)}:{}),l?{timezone:"utc"}:{}),f),{as:[a,"".concat(a,"_end")]}))}return e};return t}(lte);var hte=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var pte="_tuple_fields";var vte=function(){function e(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}this.items=e;this.hasChannel={};this.hasField={}}return e}();var gte={defined:function(){return true},parse:function(e,t,n){var r;var i=t.name;var a=(r=t.project)!==null&&r!==void 0?r:t.project=new vte;var o={};var u={};var s=new Set;var l=function(e,t){var n;var r=t==="visual"?e.channel:e.field;var a=uK("".concat(i,"_").concat(r));for(var o=1;s.has(a);o++){a=uK("".concat(i,"_").concat(r,"_").concat(o))}s.add(a);return n={},n[t]=a,n};var f=t.type;var c=e.config.selection[f];var d=n.value!==undefined?tn(n.value):null;var h=jt(n.select)?n.select:{},p=h.fields,v=h.encodings;if(!p&&!v&&d){for(var g=0,m=d;g<m.length;g++){var y=m[g];if(!jt(y)){continue}for(var b=0,x=rK(y);b<x.length;b++){var _=x[b];if(O0(_)){(v||(v=[])).push(_)}else{if(f==="interval"){k3(p2);v=c.encodings}else{(p||(p=[])).push(_)}}}}}if(!p&&!v){v=c.encodings;if("fields"in c){p=c.fields}}for(var w=0,A=v!==null&&v!==void 0?v:[];w<A.length;w++){var O=A[w];var E=e.fieldDef(O);if(E){var k=E.field;if(E.aggregate){k3(a2(O,E.aggregate));continue}else if(!k){k3(i2(O));continue}if(E.timeUnit){k=e.vgField(O);var D={timeUnit:E.timeUnit,as:k,field:E.field};u[WZ(D)]=D}if(!o[k]){var C="E";if(f==="interval"){var F=e.getScaleComponent(O).get("type");if(P5(F)){C="R"}}else if(E.bin){C="R-RE"}var S={field:k,channel:O,type:C};S.signals=Object.assign(Object.assign({},l(S,"data")),l(S,"visual"));a.items.push(o[k]=S);a.hasField[k]=a.hasChannel[O]=o[k]}}else{k3(i2(O))}}for(var j=0,M=p!==null&&p!==void 0?p:[];j<M.length;j++){var B=M[j];if(a.hasField[B])continue;var S={type:"E",field:B};S.signals=Object.assign({},l(S,"data"));a.items.push(S);a.hasField[B]=S}if(d){t.init=d.map((function(e){return a.items.map((function(t){return jt(e)?e[t.channel]!==undefined?e[t.channel]:e[t.field]:e}))}))}if(!nK(u)){a.timeUnit=new dte(null,u)}},signals:function(e,t,n){var r=t.name+pte;var i=n.filter((function(e){return e.name===r}));return i.length>0?n:n.concat({name:r,value:t.project.items.map((function(e){var t=hte(e,["signals","hasLegend"]);t.field=pK(t.field);return t}))})}};var mte={defined:function(e){return e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales"},parse:function(e,t){var n=t.scales=[];for(var r=0,i=t.project.items;r<i.length;r++){var a=i[r];var o=a.channel;if(!Z0(o)){continue}var u=e.getScaleComponent(o);var s=u?u.get("type"):undefined;if(!u||!P5(s)){k3(l2);continue}u.set("selectionExtent",{param:t.name,field:a.field},true);n.push(a)}},topLevelSignals:function(e,t,n){var r=t.scales.filter((function(e){return n.filter((function(t){return t.name===e.signals.data})).length===0}));if(!e.parent||bte(e)||r.length===0){return n}var i=n.filter((function(e){return e.name===t.name}))[0];var a=i.update;if(a.indexOf(Sne)>=0){i.update="{".concat(r.map((function(e){return"".concat(Pn(pK(e.field)),": ").concat(e.signals.data)})).join(", "),"}")}else{for(var o=0,u=r;o<u.length;o++){var s=u[o];var l="".concat(Pn(pK(s.field)),": ").concat(s.signals.data);if(!a.includes(l)){a="".concat(a.substring(0,a.length-1),", ").concat(l,"}")}}i.update=a}return n.concat(r.map((function(e){return{name:e.signals.data}})))},signals:function(e,t,n){if(e.parent&&!bte(e)){var r=function(e){var t=n.filter((function(t){return t.name===e.signals.data}))[0];t.push="outer";delete t.value;delete t.update};for(var i=0,a=t.scales;i<a.length;i++){var o=a[i];r(o)}}return n}};function yte(e,t){var n=Pn(e.scaleName(t));return"domain(".concat(n,")")}function bte(e){var t;return e.parent&&Uoe(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:bte(e.parent.parent))}var xte=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var _te="_brush";var wte="_scale_trigger";var Ate={defined:function(e){return e.type==="interval"},signals:function(e,t,n){var r=t.name;var i=r+pte;var a=mte.defined(t);var o=t.init?t.init[0]:null;var u=[];var s=[];if(t.translate&&!a){var l="!event.item || event.item.mark.name !== ".concat(Pn(r+_te));Ete(t,(function(e,t){var n;var r;var i=tn((n=(r=t.between[0]).filter)!==null&&n!==void 0?n:r.filter=[]);if(!i.includes(l)){i.push(l)}return e}))}t.project.items.forEach((function(r,i){var a=r.channel;if(a!==SK&&a!==jK){k3("Interval selections only support x and y encoding channels.");return}var l=o?o[i]:null;var f=Ote(e,t,r,l);var c=r.signals.data;var d=r.signals.visual;var h=Pn(e.scaleName(a));var p=e.getScaleComponent(a).get("type");var v=P5(p)?"+":"";n.push.apply(n,f);u.push(c);s.push({scaleName:e.scaleName(a),expr:"(!isArray(".concat(c,") || ")+"(".concat(v,"invert(").concat(h,", ").concat(d,")[0] === ").concat(v).concat(c,"[0] && ")+"".concat(v,"invert(").concat(h,", ").concat(d,")[1] === ").concat(v).concat(c,"[1]))")})}));if(!a&&s.length){n.push({name:r+wte,value:{},on:[{events:s.map((function(e){return{scale:e.scaleName}})),update:"".concat(s.map((function(e){return e.expr})).join(" && ")," ? ").concat(r+wte," : {}")}]})}var f="unit: ".concat(Bne(e),", fields: ").concat(i,", values");return n.concat(Object.assign(Object.assign({name:r+Cne},o?{init:"{".concat(f,": ").concat(ete(o),"}")}:{}),u.length?{on:[{events:[{signal:u.join(" || ")}],update:"".concat(u.join(" && ")," ? {").concat(f,": [").concat(u,"]} : null")}]}:{}))},marks:function(e,t,n){var r=t.name;var i=t.project.hasChannel,a=i.x,o=i.y;var u=a===null||a===void 0?void 0:a.signals.visual;var s=o===null||o===void 0?void 0:o.signals.visual;var l="data(".concat(Pn(t.name+Dne),")");if(mte.defined(t)||!a&&!o){return n}var f={x:a!==undefined?{signal:"".concat(u,"[0]")}:{value:0},y:o!==undefined?{signal:"".concat(s,"[0]")}:{value:0},x2:a!==undefined?{signal:"".concat(u,"[1]")}:{field:{group:"width"}},y2:o!==undefined?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if(t.resolve==="global"){for(var c=0,d=rK(f);c<d.length;c++){var h=d[c];f[h]=[Object.assign({test:"".concat(l,".length && ").concat(l,"[0].unit === ").concat(Bne(e))},f[h]),{value:0}]}}var p=t.mark,v=p.fill,g=p.fillOpacity,m=p.cursor,y=xte(p,["fill","fillOpacity","cursor"]);var b=rK(y).reduce((function(e,t){e[t]=[{test:[a!==undefined&&"".concat(u,"[0] !== ").concat(u,"[1]"),o!==undefined&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter((function(e){return e})).join(" && "),value:y[t]},{value:null}];return e}),{});return __spreadArray(__spreadArray([{name:"".concat(r+_te,"_bg"),type:"rect",clip:true,encode:{enter:{fill:{value:v},fillOpacity:{value:g}},update:f}}],n,true),[{name:r+_te,type:"rect",clip:true,encode:{enter:Object.assign(Object.assign({},m?{cursor:{value:m}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},f),b)}}],false)}};function Ote(e,t,n,r){var i=n.channel;var a=n.signals.visual;var o=n.signals.data;var u=mte.defined(t);var s=Pn(e.scaleName(i));var l=e.getScaleComponent(i);var f=l?l.get("type"):undefined;var c=function(e){return"scale(".concat(s,", ").concat(e,")")};var d=e.getSizeSignalRef(i===SK?"width":"height").signal;var h="".concat(i,"(unit)");var p=Ete(t,(function(e,t){return __spreadArray(__spreadArray([],e,true),[{events:t.between[0],update:"[".concat(h,", ").concat(h,"]")},{events:t,update:"[".concat(a,"[0], clamp(").concat(h,", 0, ").concat(d,")]")}],false)}));p.push({events:{signal:t.name+wte},update:P5(f)?"[".concat(c("".concat(o,"[0]")),", ").concat(c("".concat(o,"[1]")),"]"):"[0, 0]"});return u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:ete(r,true,c)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:ete(r)}:{}),{on:[{events:{signal:a},update:"".concat(a,"[0] === ").concat(a,"[1] ? null : invert(").concat(s,", ").concat(a,")")}]})]}function Ete(e,t){return e.events.reduce((function(e,n){if(!n.between){k3("".concat(n," is not an ordered event stream for interval selections."));return e}return t(e,n)}),[])}var kte={defined:function(e){return e.type==="point"},signals:function(e,t,n){var r;var i=t.name;var a=i+pte;var o=t.project;var u="(item().isVoronoi ? datum.datum : datum)";var s=o.items.map((function(t){var n=e.fieldDef(t.channel);return(n===null||n===void 0?void 0:n.bin)?"[".concat(u,"[").concat(Pn(e.vgField(t.channel,{})),"], ")+"".concat(u,"[").concat(Pn(e.vgField(t.channel,{binSuffix:"end"})),"]]"):"".concat(u,"[").concat(Pn(t.field),"]")})).join(", ");var l="unit: ".concat(Bne(e),", fields: ").concat(a,", values");var f=t.events;var c=iK((r=e.component.selection)!==null&&r!==void 0?r:{}).reduce((function(e,t){return t.type==="interval"?e.concat(t.name+_te):e}),[]).map((function(e){return"indexof(item().mark.name, '".concat(e,"') < 0")})).join(" && ");var d="datum && item().mark.marktype !== 'group'".concat(c?" && ".concat(c):"");return n.concat([{name:i+Cne,on:f?[{events:f,update:"".concat(d," ? {").concat(l,": [").concat(s,"]} : null"),force:true}]:[]}])}};function Dte(e,t,n,r){var i,a;var o=b4(t)&&t.condition;var u=r(t);if(o){var s=tn(o);var l=s.map((function(t){var n=r(t);if(d4(t)){var i=t.param,a=t.empty;var o=Une(e,{param:i,empty:a});return Object.assign({test:o},n)}else{var u=Hne(e,t.test);return Object.assign({test:u},n)}}));return i={},i[n]=__spreadArray(__spreadArray([],l,true),u!==undefined?[u]:[],true),i}else{return u!==undefined?(a={},a[n]=u,a):{}}}function Cte(e,t){if(t===void 0){t="text"}var n=e.encoding[t];return Dte(e,n,t,(function(t){return Fte(t,e.config)}))}function Fte(e,t,n){if(n===void 0){n="datum"}if(e){if(S4(e)){return R1(e.value)}if(C4(e)){var r=J4(e),i=r.format,a=r.formatType;return G6({fieldOrDatumDef:e,format:i,formatType:a,expr:n,config:t})}}return undefined}function Ste(e,t){if(t===void 0){t={}}var n=e.encoding,r=e.markDef,i=e.config,a=e.stack;var o=n.tooltip;if(St(o)){return{tooltip:Mte({tooltip:o},a,i,t)}}else{var u=t.reactiveGeom?"datum.datum":"datum";return Dte(e,o,"tooltip",(function(e){var o=Fte(e,i,u);if(o){return o}if(e===null){return undefined}var s=H1("tooltip",r,i);if(s===true){s={content:"encoding"}}if(Cn(s)){return{value:s}}else if(jt(s)){if(E1(s)){return s}else if(s.content==="encoding"){return Mte(n,a,i,t)}else{return{signal:u}}}return undefined}))}}function jte(e,t,n,r){var i=r===void 0?{}:r,a=i.reactiveGeom;var o={};var u=a?"datum.datum":"datum";var s=[];function l(r,i){var a=C0(i);var l=F4(r)?r:Object.assign(Object.assign({},r),{type:e[a].type});var f=l.title||X4(l,n);var c=tn(f).join(", ");var d;if(I0(i)){var h=i==="x"?"x2":"y2";var p=Z4(e[h]);if(g1(l.bin)&&p){var v=P4(l,{expr:u});var g=P4(p,{expr:u});var m=J4(l),y=m.format,b=m.formatType;d=e4(v,g,y,b,n);o[h]=true}else if(t&&t.fieldChannel===i&&t.offset==="normalize"){var x=J4(l),_=x.format,b=x.formatType;d=G6({fieldOrDatumDef:l,format:_,formatType:b,expr:u,config:n,normalizeStack:true}).signal}}d!==null&&d!==void 0?d:d=Fte(l,n,u).signal;s.push({channel:i,key:c,value:d})}B8(e,(function(e,t){if(A4(e)){l(e,t)}else if(x4(e)){l(e.condition,t)}}));var f={};for(var c=0,d=s;c<d.length;c++){var h=d[c],p=h.channel,v=h.key,g=h.value;if(!o[p]&&!f[v]){f[v]=g}}return f}function Mte(e,t,n,r){var i=r===void 0?{}:r,a=i.reactiveGeom;var o=jte(e,t,n,{reactiveGeom:a});var u=aK(o).map((function(e){var t=e[0],n=e[1];return'"'.concat(t,'": ').concat(n)}));return u.length>0?{signal:"{".concat(u.join(", "),"}")}:undefined}function Bte(e){var t=e.markDef,n=e.config;var r=H1("aria",t,n);if(r===false){return{}}return Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),Nte(e)),Tte(e))}function Nte(e){var t=e.mark,n=e.markDef,r=e.config;if(r.aria===false){return{}}var i=H1("ariaRoleDescription",n,r);if(i!=null){return{ariaRoleDescription:{value:i}}}return t in M1?{}:{ariaRoleDescription:{value:t}}}function Tte(e){var t=e.encoding,n=e.markDef,r=e.config,i=e.stack;var a=t.description;if(a){return Dte(e,a,"description",(function(t){return Fte(t,e.config)}))}var o=H1("description",n,r);if(o!=null){return{description:R1(o)}}if(r.aria===false){return{}}var u=jte(t,i,r);if(nK(u)){return undefined}return{description:{signal:aK(u).map((function(e,t){var n=e[0],r=e[1];return'"'.concat(t>0?"; ":"").concat(n,': " + (').concat(r,")")})).join(" + ")}}}function zte(e,t,n){if(n===void 0){n={}}var r=t.markDef,i=t.encoding,a=t.config;var o=n.vgChannel;var u=n.defaultRef,s=n.defaultValue;if(u===undefined){s!==null&&s!==void 0?s:s=H1(e,r,a,{vgChannel:o,ignoreVgConfig:true});if(s!==undefined){u=R1(s)}}var l=i[e];return Dte(t,l,o!==null&&o!==void 0?o:e,(function(n){return I6({channel:e,channelDef:n,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:u})}))}function Pte(e,t){if(t===void 0){t={filled:undefined}}var n,r,i,a;var o=e.markDef,u=e.encoding,s=e.config;var l=o.type;var f=(n=t.filled)!==null&&n!==void 0?n:H1("filled",o,s);var c=GZ(["bar","point","circle","square","geoshape"],l)?"transparent":undefined;var d=(i=(r=H1(f===true?"color":undefined,o,s,{vgChannel:"fill"}))!==null&&r!==void 0?r:s.mark[f===true&&"color"])!==null&&i!==void 0?i:c;var h=(a=H1(f===false?"color":undefined,o,s,{vgChannel:"stroke"}))!==null&&a!==void 0?a:s.mark[f===false&&"color"];var p=f?"fill":"stroke";var v=Object.assign(Object.assign({},d?{fill:R1(d)}:{}),h?{stroke:R1(h)}:{});if(o.color&&(f?o.fill:o.stroke)){k3(M2("property",{fill:"fill"in o,stroke:"stroke"in o}))}return Object.assign(Object.assign(Object.assign(Object.assign({},v),zte("color",e,{vgChannel:p,defaultValue:f?d:h})),zte("fill",e,{defaultValue:u.fill?d:undefined})),zte("stroke",e,{defaultValue:u.stroke?h:undefined}))}function Rte(e){var t=e.encoding,n=e.mark;var r=t.order;if(!h6(n)&&S4(r)){return Dte(e,r,"zindex",(function(e){return R1(e.value)}))}return{}}function Lte(e){var t=e.channel,n=e.markDef,r=e.encoding,i=r===void 0?{}:r,a=e.model,o=e.bandPosition;var u="".concat(t,"Offset");var s=n[u];var l=i[u];if((u==="xOffset"||u==="yOffset")&&l){var f=I6({channel:u,channelDef:l,markDef:n,config:a===null||a===void 0?void 0:a.config,scaleName:a.scaleName(u),scale:a.getScaleComponent(u),stack:null,defaultRef:R1(s),bandPosition:o});return{offsetType:"encoding",offset:f}}var c=n[u];if(c){return{offsetType:"visual",offset:c}}return{}}function Ite(e,t,n){var r;var i=n.defaultPos,a=n.vgChannel;var o=t.encoding,u=t.markDef,s=t.config,l=t.stack;var f=o[e];var c=o[S0(e)];var d=t.scaleName(e);var h=t.getScaleComponent(e);var p=Lte({channel:e,markDef:u,encoding:o,model:t,bandPosition:.5}),v=p.offset,g=p.offsetType;var m=qte({model:t,defaultPos:i,channel:e,scaleName:d,scale:h});var y=!f&&I0(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:Ute({channel:e,channelDef:f,channel2Def:c,markDef:u,config:s,scaleName:d,scale:h,stack:l,offset:v,defaultRef:m,bandPosition:g==="encoding"?0:undefined});return y?(r={},r[a||e]=y,r):undefined}function Ute(e){var t=e.channel,n=e.channelDef,r=e.scaleName,i=e.stack,a=e.offset,o=e.markDef;if(C4(n)&&i&&t===i.fieldChannel){if(A4(n)){var u=n.bandPosition;if(u===undefined&&o.type==="text"&&(t==="radius"||t==="theta")){u=.5}if(u!==undefined){return L6({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:u,offset:a})}}return R6(n,r,{suffix:"end"},{offset:a})}return B6(e)}function qte(e){var t=e.model,n=e.defaultPos,r=e.channel,i=e.scaleName,a=e.scale;var o=t.markDef,u=t.config;return function(){var e=C0(r);var s=F0(r);var l=H1(r,o,u,{vgChannel:s});if(l!==undefined){return U6(r,l)}switch(n){case"zeroOrMin":case"zeroOrMax":if(i){var f=a.get("type");if(GZ([E5.LOG,E5.TIME,E5.UTC],f));else{if(a.domainDefinitelyIncludesZero()){return{scale:i,value:0}}}}if(n==="zeroOrMin"){return e==="y"?{field:{group:"height"}}:{value:0}}else{switch(e){case"radius":return{signal:"min(".concat(t.width.signal,",").concat(t.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}}break;case"mid":{var c=t[j0(r)];return Object.assign(Object.assign({},c),{mult:.5})}}return undefined}}var Wte={left:"x",center:"xc",right:"x2"};var Hte={top:"y",middle:"yc",bottom:"y2"};function Gte(e,t,n,r){if(r===void 0){r="middle"}if(e==="radius"||e==="theta"){return F0(e)}var i=e==="x"?"align":"baseline";var a=H1(i,t,n);var o;if(E1(a)){k3(W2(i));o=undefined}else{o=a}if(e==="x"){return Wte[o||(r==="top"?"left":"center")]}else{return Hte[o||r]}}function $te(e,t,n){var r=n.defaultPos,i=n.defaultPos2,a=n.range;if(a){return Vte(e,t,{defaultPos:r,defaultPos2:i})}return Ite(e,t,{defaultPos:r})}function Vte(e,t,n){var r=n.defaultPos,i=n.defaultPos2;var a=t.markDef,o=t.config;var u=S0(e);var s=j0(e);var l=Yte(t,i,u);var f=l[s]?Gte(e,a,o):F0(e);return Object.assign(Object.assign({},Ite(e,t,{defaultPos:r,vgChannel:f})),l)}function Yte(e,t,n){var r,i,a,o,u;var s=e.encoding,l=e.mark,f=e.markDef,c=e.stack,d=e.config;var h=C0(n);var p=j0(n);var v=F0(n);var g=s[h];var m=e.scaleName(h);var y=e.getScaleComponent(h);var b=(n in s||n in f?Lte({channel:n,markDef:f,encoding:s,model:e}):Lte({channel:h,markDef:f,encoding:s,model:e})).offset;if(!g&&(n==="x2"||n==="y2")&&(s.latitude||s.longitude)){var x=j0(n);var _=e.markDef[x];if(_!=null){return r={},r[x]={value:_},r}else{return i={},i[v]={field:e.getName(n)},i}}var w=Xte({channel:n,channelDef:g,channel2Def:s[n],markDef:f,config:d,scaleName:m,scale:y,stack:c,offset:b,defaultRef:undefined});if(w!==undefined){return a={},a[v]=w,a}return Jte(n,f)||Jte(n,(o={},o[n]=$1(n,f,d.style),o[p]=$1(p,f,d.style),o))||Jte(n,d[l])||Jte(n,d.mark)||(u={},u[v]=qte({model:e,defaultPos:t,channel:n,scaleName:m,scale:y})(),u)}function Xte(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,f=e.defaultRef;if(C4(n)&&s&&t.charAt(0)===s.fieldChannel.charAt(0)){return R6(n,o,{suffix:"start"},{offset:l})}return B6({channel:t,channelDef:r,scaleName:o,scale:u,stack:s,markDef:i,config:a,offset:l,defaultRef:f})}function Jte(e,t){var n,r,i;var a=j0(e);var o=F0(e);if(t[o]!==undefined){return n={},n[o]=U6(e,t[o]),n}else if(t[e]!==undefined){return r={},r[o]=U6(e,t[e]),r}else if(t[a]){var u=t[a];if(k6(u)){k3(B2(a))}else{return i={},i[a]=U6(e,u),i}}return undefined}function Qte(e,t){var n,r;var i=e.config,a=e.encoding,o=e.markDef;var u=o.type;var s=S0(t);var l=j0(t);var f=a[t];var c=a[s];var d=e.getScaleComponent(t);var h=d?d.get("type"):undefined;var p=o.orient;var v=(r=(n=a[l])!==null&&n!==void 0?n:a.size)!==null&&r!==void 0?r:H1("size",o,i,{vgChannel:l});var g=u==="bar"&&(t==="x"?p==="vertical":p==="horizontal");if(A4(f)&&(v1(f.bin)||g1(f.bin)||f.timeUnit&&!c)&&!(v&&!k6(v))&&!z5(h)){return tne({fieldDef:f,fieldDef2:c,channel:t,model:e})}else if((C4(f)&&z5(h)||g)&&!c){return Kte(f,t,e)}else{return Vte(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}}function Zte(e,t,n,r,i){if(k6(i)){if(n){var a=n.get("type");if(a==="band"){return{scale:t,band:i.band}}else if(i.band!==1){k3(V2(a));i=undefined}}else{return{mult:i.band,field:{group:e}}}}else if(E1(i)){return i}else if(i){return{value:i}}if(n){var o=n.get("range");if(k1(o)&&kn(o.step)){return{value:o.step-2}}}var u=Y9(r.view,e);return{value:u-2}}function Kte(e,t,n){var r,i,a;var o=n.markDef,u=n.encoding,s=n.config,l=n.stack;var f=o.orient;var c=n.scaleName(t);var d=n.getScaleComponent(t);var h=j0(t);var p=S0(t);var v=M0(t);var g=n.scaleName(v);var m=f==="horizontal"&&t==="y"||f==="vertical"&&t==="x";var y;if(u.size||o.size){if(m){y=zte("size",n,{vgChannel:h,defaultRef:R1(o.size)})}else{k3(Q2(o.type))}}var b=m4({channel:t,fieldDef:e,markDef:o,config:s,scaleType:d===null||d===void 0?void 0:d.get("type"),useVlSizeChannel:m});y=y||(r={},r[h]=Zte(h,g||c,d,s,b),r);var x=(d===null||d===void 0?void 0:d.get("type"))!=="band"||!("band"in y[h])?"middle":"top";var _=Gte(t,o,s,x);var w=_==="xc"||_==="yc";var A=Lte({channel:t,markDef:o,encoding:u,model:n,bandPosition:w?.5:0}),O=A.offset,E=A.offsetType;var k=B6({channel:t,channelDef:e,markDef:o,config:s,scaleName:c,scale:d,stack:l,offset:O,defaultRef:qte({model:n,defaultPos:"mid",channel:t,scaleName:c,scale:d}),bandPosition:w?E==="encoding"?0:.5:E1(b)?{signal:"(1-".concat(b,")/2")}:k6(b)?(1-b.band)/2:0});if(h){return Object.assign((i={},i[_]=k,i),y)}else{var D=F0(p);var C=y[h];var F=O?Object.assign(Object.assign({},C),{offset:O}):C;return a={},a[_]=k,a[D]=St(k)?[k[0],Object.assign(Object.assign({},k[1]),{offset:F})]:Object.assign(Object.assign({},k),{offset:F}),a}}function ene(e,t,n,r,i){if(c0(e)){return 0}var a=e==="x"||e==="y2"?-t/2:t/2;if(E1(n)||E1(i)||E1(r)){var o=U1(n);var u=U1(i);var s=U1(r);var l=s?"".concat(s," + "):"";var f=o?"(".concat(o," ? -1 : 1) * "):"";var c=u?"(".concat(u," + ").concat(a,")"):a;return{signal:l+f+c}}else{i=i||0;return r+(n?-i-a:+i+a)}}function tne(e){var t,n,r;var i=e.fieldDef,a=e.fieldDef2,o=e.channel,u=e.model;var s,l,f;var c=u.config,d=u.markDef,h=u.encoding;var p=u.getScaleComponent(o);var v=u.scaleName(o);var g=p?p.get("type"):undefined;var m=p.get("reverse");var y=m4({channel:o,fieldDef:i,markDef:d,config:c,scaleType:g});var b=(s=u.component.axes[o])===null||s===void 0?void 0:s[0];var x=(l=b===null||b===void 0?void 0:b.get("translate"))!==null&&l!==void 0?l:.5;var _=I0(o)?(f=H1("binSpacing",d,c))!==null&&f!==void 0?f:0:0;var w=S0(o);var A=F0(o);var O=F0(w);var E=Lte({channel:o,markDef:d,encoding:h,model:u,bandPosition:0}).offset;var k=E1(y)?{signal:"(1-".concat(y.signal,")/2")}:k6(y)?(1-y.band)/2:.5;if(v1(i.bin)||i.timeUnit){return t={},t[O]=nne({fieldDef:i,scaleName:v,bandPosition:k,offset:ene(w,_,m,x,E)}),t[A]=nne({fieldDef:i,scaleName:v,bandPosition:E1(k)?{signal:"1-".concat(k.signal)}:1-k,offset:ene(o,_,m,x,E)}),t}else if(g1(i.bin)){var D=R6(i,v,{},{offset:ene(w,_,m,x,E)});if(A4(a)){return n={},n[O]=D,n[A]=R6(a,v,{},{offset:ene(o,_,m,x,E)}),n}else if(m1(i.bin)&&i.bin.step){return r={},r[O]=D,r[A]={signal:'scale("'.concat(v,'", ').concat(P4(i,{expr:"datum"})," + ").concat(i.bin.step,")"),offset:ene(o,_,m,x,E)},r}}k3(b3(w));return undefined}function nne(e){var t=e.fieldDef,n=e.scaleName,r=e.bandPosition,i=e.offset;return L6({scaleName:n,fieldOrDatumDef:t,bandPosition:r,offset:i})}var rne=new Set(["aria","width","height"]);function ine(e,t){var n=t.color==="include"?Pte(e):{},r=n.fill,i=r===void 0?undefined:r,a=n.stroke,o=a===void 0?undefined:a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},one(e.markDef,t)),ane(e,"fill",i)),ane(e,"stroke",o)),zte("opacity",e)),zte("fillOpacity",e)),zte("strokeOpacity",e)),zte("strokeWidth",e)),zte("strokeDash",e)),Rte(e)),Ste(e)),Cte(e,"href")),Bte(e))}function ane(e,t,n){var r,i;var a=e.config,o=e.mark,u=e.markDef;var s=H1("invalid",u,a);if(s==="hide"&&n&&!h6(o)){var l=une(e,{invalid:true,channels:Q0});if(l){return r={},r[t]=__spreadArray([{test:l,value:null}],tn(n),true),r}}return n?(i={},i[t]=n,i):{}}function one(e,t){return j1.reduce((function(n,r){if(!rne.has(r)&&e[r]!==undefined&&t[r]!=="ignore"){n[r]=R1(e[r])}return n}),{})}function une(e,t){var n=t.invalid,r=n===void 0?false:n,i=t.channels;var a=i.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var i=r.get("type");var a=e.vgField(n,{expr:"datum"});if(a&&P5(i)){t[a]=true}}return t}),{});var o=rK(a);if(o.length>0){var u=r?"||":"&&";return o.map((function(e){return z6(e,r)})).join(" ".concat(u," "))}return undefined}function sne(e){var t=e.config,n=e.markDef;var r=H1("invalid",n,t);if(r){var i=lne(e,{channels:L0});if(i){return{defined:{signal:i}}}}return{}}function lne(e,t){var n=t.invalid,r=n===void 0?false:n,i=t.channels;var a=i.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var i=r.get("type");var a=e.vgField(n,{expr:"datum"});if(a&&P5(i)){t[a]=true}}return t}),{});var o=rK(a);if(o.length>0){var u=r?"||":"&&";return o.map((function(e){return z6(e,r)})).join(" ".concat(u," "))}return undefined}function fne(e,t){var n;if(t!==undefined){return n={},n[e]=R1(t),n}return undefined}var cne="voronoi";var dne={defined:function(e){return e.type==="point"&&e.nearest},parse:function(e,t){if(t.events){for(var n=0,r=t.events;n<r.length;n++){var i=r[n];i.markname=e.getName(cne)}}},marks:function(e,t,n){var r=t.project.hasChannel,i=r.x,a=r.y;var o=e.mark;if(h6(o)){k3(o2(o));return n}var u={name:e.getName(cne),type:"path",interactive:true,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:true}},Ste(e,{reactiveGeom:true}))},transform:[{type:"voronoi",x:{expr:i||!a?"datum.datum.x || 0":"0"},y:{expr:a||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};var s=0;var l=false;n.forEach((function(t,n){var r;var i=(r=t.name)!==null&&r!==void 0?r:"";if(i===e.component.mark[0].name){s=n}else if(i.indexOf(cne)>=0){l=true}}));if(!l){n.splice(s+1,0,u)}return n}};var hne={defined:function(e){return e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!S9(e.bind)},parse:function(e,t,n){return Tne(t,n)},topLevelSignals:function(e,t,n){var r=t.name;var i=t.project;var a=t.bind;var o=t.init&&t.init[0];var u=dne.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";i.items.forEach((function(e,i){var s,l;var f=uK("".concat(r,"_").concat(e.field));var c=n.filter((function(e){return e.name===f}));if(!c.length){n.unshift(Object.assign(Object.assign({name:f},o?{init:ete(o[i])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(u,"[").concat(Pn(e.field),"] : null")}]:[],bind:(l=(s=a[e.field])!==null&&s!==void 0?s:a[e.channel])!==null&&l!==void 0?l:a}))}}));return n},signals:function(e,t,n){var r=t.name;var i=t.project;var a=n.filter((function(e){return e.name===r+Cne}))[0];var o=r+pte;var u=i.items.map((function(e){return uK("".concat(r,"_").concat(e.field))}));var s=u.map((function(e){return"".concat(e," !== null")})).join(" && ");if(u.length){a.update="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null")}delete a.value;delete a.on;return n}};var pne="_toggle";var vne={defined:function(e){return e.type==="point"&&!!e.toggle},signals:function(e,t,n){return n.concat({name:t.name+pne,value:false,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+Cne;var r=t.name+pne;return"".concat(r," ? null : ").concat(n,", ")+(t.resolve==="global"?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(Bne(e),"}, "))+"".concat(r," ? ").concat(n," : null")}};var gne={defined:function(e){return e.clear!==undefined&&e.clear!==false},parse:function(e,t){if(t.clear){t.clear=Cn(t.clear)?w$(t.clear,"view"):t.clear}},topLevelSignals:function(e,t,n){if(hne.defined(t)){var r=function(e){var r=n.findIndex((function(n){return n.name===uK("".concat(t.name,"_").concat(e.field))}));if(r!==-1){n[r].on.push({events:t.clear,update:"null"})}};for(var i=0,a=t.project.items;i<a.length;i++){var o=a[i];r(o)}}return n},signals:function(e,t,n){function r(e,r){if(e!==-1&&n[e].on){n[e].on.push({events:t.clear,update:r})}}if(t.type==="interval"){var i=function(e){var t=n.findIndex((function(t){return t.name===e.signals.visual}));r(t,"[0, 0]");if(t===-1){var i=n.findIndex((function(t){return t.name===e.signals.data}));r(i,"null")}};for(var a=0,o=t.project.items;a<o.length;a++){var u=o[a];i(u)}}else{var s=n.findIndex((function(e){return e.name===t.name+Cne}));r(s,"null");if(vne.defined(t)){s=n.findIndex((function(e){return e.name===t.name+pne}));r(s,"false")}}return n}};var mne={defined:function(e){var t=e.resolve==="global"&&e.bind&&S9(e.bind);var n=e.project.items.length===1&&e.project.items[0].field!==C9;if(t&&!n){k3(f2)}return t&&n},parse:function(e,t,n){var r;var i=RZ(n);i.select=Cn(i.select)?{type:i.select,toggle:t.toggle}:Object.assign(Object.assign({},i.select),{toggle:t.toggle});Tne(t,i);if(jt(n.select)&&(n.select.on||n.select.clear)){var a='event.item && indexof(event.item.mark.role, "legend") < 0';for(var o=0,u=t.events;o<u.length;o++){var s=u[o];s.filter=tn((r=s.filter)!==null&&r!==void 0?r:[]);if(!s.filter.includes(a)){s.filter.push(a)}}}var l=j9(t.bind)?t.bind.legend:"click";var f=Cn(l)?w$(l,"view"):tn(l);t.bind={legend:{merge:f}}},topLevelSignals:function(e,t,n){var r=t.name;var i=j9(t.bind)&&t.bind.legend;var a=function(e){return function(t){var n=RZ(t);n.markname=e;return n}};var o=function(e){if(!e.hasLegend)return"continue";var o="".concat(uK(e.field),"_legend");var u="".concat(r,"_").concat(o);var s=n.filter((function(e){return e.name===u}));if(s.length===0){var l=i.merge.map(a("".concat(o,"_symbols"))).concat(i.merge.map(a("".concat(o,"_labels")))).concat(i.merge.map(a("".concat(o,"_entries"))));n.unshift(Object.assign(Object.assign({name:u},!t.init?{value:null}:{}),{on:[{events:l,update:"datum.value || item().items[0].items[0].datum.value",force:true},{events:i.merge,update:"!event.item || !datum ? null : ".concat(u),force:true}]}))}};for(var u=0,s=t.project.items;u<s.length;u++){var l=s[u];o(l)}return n},signals:function(e,t,n){var r=t.name;var i=t.project;var a=n.find((function(e){return e.name===r+Cne}));var o=r+pte;var u=i.items.filter((function(e){return e.hasLegend})).map((function(e){return uK("".concat(r,"_").concat(uK(e.field),"_legend"))}));var s=u.map((function(e){return"".concat(e," !== null")})).join(" && ");var l="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null");if(t.events&&u.length>0){a.on.push({events:u.map((function(e){return{signal:e}})),update:l})}else if(u.length>0){a.update=l;delete a.value;delete a.on}var f=n.find((function(e){return e.name===r+pne}));var c=j9(t.bind)&&t.bind.legend;if(f){if(!t.events)f.on[0].events=c;else f.on.push(Object.assign(Object.assign({},f.on[0]),{events:c}))}return n}};function yne(e,t,n){var r,i,a,o;var u=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;for(var s=0,l=iK((i=e.component.selection)!==null&&i!==void 0?i:{});s<l.length;s++){var f=l[s];var c=(a=f.project.hasField[u])!==null&&a!==void 0?a:f.project.hasChannel[t];if(c&&mne.defined(f)){var d=(o=n.get("selections"))!==null&&o!==void 0?o:[];d.push(f.name);n.set("selections",d,false);c.hasLegend=true}}}var bne="_translate_anchor";var xne="_translate_delta";var _ne={defined:function(e){return e.type==="interval"&&e.translate},signals:function(e,t,n){var r=t.name;var i=mte.defined(t);var a=r+bne;var o=t.project.hasChannel,u=o.x,s=o.y;var l=w$(t.translate,"scope");if(!i){l=l.map((function(e){return e.between[0].markname=r+_te,e}))}n.push({name:a,value:{},on:[{events:l.map((function(e){return e.between[0]})),update:"{x: x(unit), y: y(unit)"+(u!==undefined?", extent_x: ".concat(i?yte(e,SK):"slice(".concat(u.signals.visual,")")):"")+(s!==undefined?", extent_y: ".concat(i?yte(e,jK):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+xne,value:{},on:[{events:l,update:"{x: ".concat(a,".x - x(unit), y: ").concat(a,".y - y(unit)}")}]});if(u!==undefined){wne(e,t,u,"width",n)}if(s!==undefined){wne(e,t,s,"height",n)}return n}};function wne(e,t,n,r,i){var a,o;var u=t.name;var s=u+bne;var l=u+xne;var f=n.channel;var c=mte.defined(t);var d=i.filter((function(e){return e.name===n.signals[c?"data":"visual"]}))[0];var h=e.getSizeSignalRef(r).signal;var p=e.getScaleComponent(f);var v=p.get("type");var g=p.get("reverse");var m=!c?"":f===SK?g?"":"-":g?"-":"";var y="".concat(s,".extent_").concat(f);var b="".concat(m).concat(l,".").concat(f," / ").concat(c?"".concat(h):"span(".concat(y,")"));var x=!c?"panLinear":v==="log"?"panLog":v==="symlog"?"panSymlog":v==="pow"?"panPow":"panLinear";var _=!c?"":v==="pow"?", ".concat((a=p.get("exponent"))!==null&&a!==void 0?a:1):v==="symlog"?", ".concat((o=p.get("constant"))!==null&&o!==void 0?o:1):"";var w="".concat(x,"(").concat(y,", ").concat(b).concat(_,")");d.on.push({events:{signal:l},update:c?w:"clampRange(".concat(w,", 0, ").concat(h,")")})}var Ane="_zoom_anchor";var One="_zoom_delta";var Ene={defined:function(e){return e.type==="interval"&&e.zoom},signals:function(e,t,n){var r=t.name;var i=mte.defined(t);var a=r+One;var o=t.project.hasChannel,u=o.x,s=o.y;var l=Pn(e.scaleName(SK));var f=Pn(e.scaleName(jK));var c=w$(t.zoom,"scope");if(!i){c=c.map((function(e){return e.markname=r+_te,e}))}n.push({name:r+Ane,on:[{events:c,update:!i?"{x: x(unit), y: y(unit)}":"{"+[l?"x: invert(".concat(l,", x(unit))"):"",f?"y: invert(".concat(f,", y(unit))"):""].filter((function(e){return!!e})).join(", ")+"}"}]},{name:a,on:[{events:c,force:true,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]});if(u!==undefined){kne(e,t,u,"width",n)}if(s!==undefined){kne(e,t,s,"height",n)}return n}};function kne(e,t,n,r,i){var a,o;var u=t.name;var s=n.channel;var l=mte.defined(t);var f=i.filter((function(e){return e.name===n.signals[l?"data":"visual"]}))[0];var c=e.getSizeSignalRef(r).signal;var d=e.getScaleComponent(s);var h=d.get("type");var p=l?yte(e,s):f.name;var v=u+One;var g="".concat(u).concat(Ane,".").concat(s);var m=!l?"zoomLinear":h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear";var y=!l?"":h==="pow"?", ".concat((a=d.get("exponent"))!==null&&a!==void 0?a:1):h==="symlog"?", ".concat((o=d.get("constant"))!==null&&o!==void 0?o:1):"";var b="".concat(m,"(").concat(p,", ").concat(g,", ").concat(v).concat(y,")");f.on.push({events:{signal:v},update:l?b:"clampRange(".concat(b,", 0, ").concat(c,")")})}var Dne="_store";var Cne="_tuple";var Fne="_modify";var Sne="vlSelectionResolve";var jne=[kte,Ate,gte,vne,hne,mte,mne,gne,_ne,Ene,dne];function Mne(e){var t=e.parent;while(t){if(Loe(t))break;t=t.parent}return t}function Bne(e,t){var n=t===void 0?{escape:true}:t,r=n.escape;var i=r?Pn(e.name):e.name;var a=Mne(e);if(a){var o=a.facet;for(var u=0,s=b0;u<s.length;u++){var l=s[u];if(o[l]){i+=" + '__facet_".concat(l,"_' + (facet[").concat(Pn(a.vgField(l)),"])")}}}return i}function Nne(e){var t;return iK((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((function(e,t){return e||t.project.items.some((function(e){return e.field===C9}))}),false)}function Tne(e,t){if(Cn(t.select)||!t.select.on)delete e.events;if(Cn(t.select)||!t.select.clear)delete e.clear;if(Cn(t.select)||!t.select.toggle)delete e.toggle}function zne(e){var t=[];if(e.type==="Identifier"){return[e.name]}if(e.type==="Literal"){return[e.value]}if(e.type==="MemberExpression"){t.push.apply(t,zne(e.object));t.push.apply(t,zne(e.property))}return t}function Pne(e){if(e.object.type==="MemberExpression"){return Pne(e.object)}return e.object.name==="datum"}function Rne(e){var t=WU(e);var n=new Set;t.visit((function(e){if(e.type==="MemberExpression"&&Pne(e)){n.add(zne(e).slice(1).join("."))}}));return n}var Lne=function(e){Ee(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.model=n;i.filter=r;i.expr=Hne(i.model,i.filter,i);i._dependentFields=Rne(i.expr);return i}t.prototype.clone=function(){return new t(null,this.model,RZ(this.filter))};t.prototype.dependentFields=function(){return this._dependentFields};t.prototype.producedFields=function(){return new Set};t.prototype.assemble=function(){return{type:"filter",expr:this.expr}};t.prototype.hash=function(){return"Filter ".concat(this.expr)};return t}(lte);function Ine(e,t){var n;var r={};var i=e.config.selection;if(!t||!t.length)return r;for(var a=0,o=t;a<o.length;a++){var u=o[a];var s=uK(u.name);var l=u.select;var f=Cn(l)?l:l.type;var c=jt(l)?RZ(l):{type:f};var d=i[f];for(var h in d){if(h==="fields"||h==="encodings"){continue}if(h==="mark"){c[h]=Object.assign(Object.assign({},d[h]),c[h])}if(c[h]===undefined||c[h]===true){c[h]=(n=d[h])!==null&&n!==void 0?n:c[h]}}var p=r[s]=Object.assign(Object.assign({},c),{name:s,type:f,init:u.value,bind:u.bind,events:Cn(c.on)?w$(c.on,"scope"):tn(RZ(c.on))});for(var v=0,g=jne;v<g.length;v++){var m=g[v];if(m.defined(p)&&m.parse){m.parse(e,p,u)}}}return r}function Une(e,t,n,r){if(r===void 0){r="datum"}var i=Cn(t)?t:t.param;var a=uK(i);var o=Pn(a+Dne);var u;try{u=e.getSelectionComponent(a,i)}catch(Bse){return"!!".concat(a)}if(u.project.timeUnit){var s=n!==null&&n!==void 0?n:e.component.data.raw;var l=u.project.timeUnit.clone();if(s.parent){l.insertAsParentOf(s)}else{s.parent=l}}var f="vlSelectionTest(".concat(o,", ").concat(r).concat(u.resolve==="global"?")":", ".concat(Pn(u.resolve),")"));var c="length(data(".concat(o,"))");return t.empty===false?"".concat(c," && ").concat(f):"!".concat(c," || ").concat(f)}function qne(e,t,n){var r=uK(t);var i=n["encoding"];var a=n["field"];var o;try{o=e.getSelectionComponent(r,t)}catch(Bse){return r}if(!i&&!a){a=o.project.items[0].field;if(o.project.items.length>1){k3('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(Pn(a),"."))}}else if(i&&!a){var u=o.project.items.filter((function(e){return e.channel===i}));if(!u.length||u.length>1){a=o.project.items[0].field;k3((!u.length?"No ":"Multiple ")+"matching ".concat(Pn(i)," encoding found for selection ").concat(Pn(n.param),". ")+'Using "field": '.concat(Pn(a),"."))}else{a=u[0].field}}return"".concat(o.name,"[").concat(Pn(pK(a)),"]")}function Wne(e,t){var n;for(var r=0,i=aK((n=e.component.selection)!==null&&n!==void 0?n:{});r<i.length;r++){var a=i[r],o=a[0],u=a[1];var s=e.getName("lookup_".concat(o));e.component.data.outputNodes[s]=u.materialized=new fte(new Lne(t,e,{param:o}),s,Zee.Lookup,e.component.data.outputNodeRefCounts)}}function Hne(e,t,n){return sK(t,(function(t){if(Cn(t)){return t}else if(e5(t)){return Une(e,t,n)}else{return d5(t)}}))}var Gne=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function $ne(e,t){if(!e){return undefined}if(St(e)&&!O1(e)){return e.map((function(e){return X4(e,t)})).join(", ")}return e}function Vne(e,t,n,r){var i,a,o;var u,s;(i=e.encode)!==null&&i!==void 0?i:e.encode={};(a=(u=e.encode)[t])!==null&&a!==void 0?a:u[t]={};(o=(s=e.encode[t]).update)!==null&&o!==void 0?o:s.update={};e.encode[t].update[n]=r}function Yne(e,t,n,r){if(r===void 0){r={header:false}}var i,a;var o=e.combine(),u=o.disable,s=o.orient,l=o.scale,f=o.labelExpr,c=o.title,d=o.zindex,h=Gne(o,["disable","orient","scale","labelExpr","title","zindex"]);if(u){return undefined}for(var p in h){var v=v8[p];var g=h[p];if(v&&v!==t&&v!=="both"){delete h[p]}else if(h8(g)){var m=g.condition,y=Gne(g,["condition"]);var b=tn(m);var x=d8[p];if(x){var _=x.vgProp,w=x.part;var A=__spreadArray(__spreadArray([],b.map((function(e){var t=e.test,n=Gne(e,["test"]);return Object.assign({test:Hne(null,t)},n)})),true),[y],false);Vne(h,w,_,A);delete h[p]}else if(x===null){var O={signal:b.map((function(e){var t=e.test,n=Gne(e,["test"]);return"".concat(Hne(null,t)," ? ").concat(I1(n)," : ")})).join("")+I1(y)};h[p]=O}}else if(E1(g)){var x=d8[p];if(x){var _=x.vgProp,w=x.part;Vne(h,w,_,g);delete h[p]}}if(GZ(["labelAlign","labelBaseline"],p)&&h[p]===null){delete h[p]}}if(t==="grid"){if(!h.grid){return undefined}if(h.encode){var E=h.encode.grid;h.encode=Object.assign({},E?{grid:E}:{});if(nK(h.encode)){delete h.encode}}return Object.assign(Object.assign({scale:l,orient:s},h),{domain:false,labels:false,aria:false,maxExtent:0,minExtent:0,ticks:false,zindex:yK(d,0)})}else{if(!r.header&&e.mainExtracted){return undefined}if(f!==undefined){var k=f;if(((a=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&E1(h.encode.labels.update.text)){k=vK(f,"datum.label",h.encode.labels.update.text.signal)}Vne(h,"labels","text",{signal:k})}if(h.labelAlign===null){delete h.labelAlign}if(h.encode){for(var D=0,C=p8;D<C.length;D++){var w=C[D];if(!e.hasAxisPart(w)){delete h.encode[w]}}if(nK(h.encode)){delete h.encode}}var F=$ne(c,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:s,grid:false},F?{title:F}:{}),h),n.aria===false?{aria:false}:{}),{zindex:yK(d,0)})}}function Xne(e){var t=e.component.axes;var n=[];for(var r=0,i=L0;r<i.length;r++){var a=i[r];if(t[a]){for(var o=0,u=t[a];o<u.length;o++){var s=u[o];if(!s.get("disable")&&!s.get("gridScale")){var l=a==="x"?"height":"width";var f=e.getSizeSignalRef(l).signal;if(l!==f){n.push({name:l,update:f})}}}}}return n}function Jne(e,t){var n=e.x,r=n===void 0?[]:n,i=e.y,a=i===void 0?[]:i;return __spreadArray(__spreadArray(__spreadArray(__spreadArray([],r.map((function(e){return Yne(e,"grid",t)})),true),a.map((function(e){return Yne(e,"grid",t)})),true),r.map((function(e){return Yne(e,"main",t)})),true),a.map((function(e){return Yne(e,"main",t)})),true).filter((function(e){return e}))}function Qne(e,t,n,r){return Object.assign.apply(null,__spreadArray([{}],e.map((function(e){if(e==="axisOrient"){var i=n==="x"?"bottom":"left";var a=t[n==="x"?"axisBottom":"axisLeft"]||{};var o=t[n==="x"?"axisTop":"axisRight"]||{};var u=new Set(__spreadArray(__spreadArray([],rK(a),true),rK(o),true));var s={};for(var l=0,f=u.values();l<f.length;l++){var c=f[l];s[c]={signal:"".concat(r["signal"],' === "').concat(i,'" ? ').concat(U1(a[c])," : ").concat(U1(o[c]))}}return s}return t[e]})),true))}function Zne(e,t,n,r){var i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:M5(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[];var a=e==="x"?"axisX":"axisY";var o=E1(n)?"axisOrient":"axis".concat(fK(n));var u=__spreadArray(__spreadArray([],i,true),i.map((function(e){return a+e.substr(4)})),true);var s=["axis",o,a];return{vlOnlyAxisConfig:Qne(u,r,e,n),vgAxisConfig:Qne(s,r,e,n),axisConfigStyle:Kne(__spreadArray(__spreadArray([],s,true),u,true),r)}}function Kne(e,t){var n;var r=[{}];for(var i=0,a=e;i<a.length;i++){var o=a[i];var u=(n=t[o])===null||n===void 0?void 0:n.style;if(u){u=tn(u);for(var s=0,l=u;s<l.length;s++){var f=l[s];r.push(t.style[f])}}}return Object.assign.apply(null,r)}function ere(e,t,n,r){if(r===void 0){r={}}var i;var a=V1(e,n,t);if(a!==undefined){return{configFrom:"style",configValue:a}}for(var o=0,u=["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"];o<u.length;o++){var s=u[o];if(((i=r[s])===null||i===void 0?void 0:i[e])!==undefined){return{configFrom:s,configValue:r[s][e]}}}return{}}var tre={scale:function(e){var t=e.model,n=e.channel;return t.scaleName(n)},format:function(e){var t=e.fieldOrDatumDef,n=e.config,r=e.axis;var i=r.format,a=r.formatType;return Y6(t,t.type,i,a,n,true)},formatType:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.scaleType;var i=t.formatType;return X6(i,n,r)},grid:function(e){var t=e.fieldOrDatumDef,n=e.axis,r=e.scaleType;var i;return(i=n.grid)!==null&&i!==void 0?i:nre(r,t)},gridScale:function(e){var t=e.model,n=e.channel;return rre(t,n)},labelAlign:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,i=e.channel;return t.labelAlign||ure(n,r,i)},labelAngle:function(e){var t=e.labelAngle;return t},labelBaseline:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,i=e.channel;return t.labelBaseline||ore(n,r,i)},labelFlush:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.channel;var i;return(i=t.labelFlush)!==null&&i!==void 0?i:sre(n.type,r)},labelOverlap:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.scaleType;var i;return(i=t.labelOverlap)!==null&&i!==void 0?i:lre(n.type,r,A4(n)&&!!n.timeUnit,A4(n)?n.sort:undefined)},orient:function(e){var t=e.orient;return t},tickCount:function(e){var t=e.channel,n=e.model,r=e.axis,i=e.fieldOrDatumDef,a=e.scaleType;var o;var u=t==="x"?"width":t==="y"?"height":undefined;var s=u?n.getSizeSignalRef(u):undefined;return(o=r.tickCount)!==null&&o!==void 0?o:cre({fieldOrDatumDef:i,scaleType:a,size:s,values:r.values})},title:function(e){var t=e.axis,n=e.model,r=e.channel;if(t.title!==undefined){return t.title}var i=dre(n,r);if(i!==undefined){return i}var a=n.typedFieldDef(r);var o=r==="x"?"x2":"y2";var u=n.fieldDef(o);return X1(a?[p4(a)]:[],A4(u)?[p4(u)]:[])},values:function(e){var t=e.axis,n=e.fieldOrDatumDef;return hre(t,n)},zindex:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.mark;var i;return(i=t.zindex)!==null&&i!==void 0?i:pre(r,n)}};function nre(e,t){return!z5(e)&&A4(t)&&!v1(t===null||t===void 0?void 0:t.bin)&&!g1(t===null||t===void 0?void 0:t.bin)}function rre(e,t){var n=t==="x"?"y":"x";if(e.getScaleComponent(n)){return e.scaleName(n)}return undefined}function ire(e,t,n,r,i){var a=t===null||t===void 0?void 0:t.labelAngle;if(a!==undefined){return E1(a)?a:OK(a)}else{var o=ere("labelAngle",r,t===null||t===void 0?void 0:t.style,i).configValue;if(o!==undefined){return OK(o)}else{if(n===SK&&GZ([_5,b5],e.type)&&!(A4(e)&&e.timeUnit)){return 270}return undefined}}}function are(e){return"(((".concat(e.signal," % 360) + 360) % 360)")}function ore(e,t,n,r){if(e!==undefined){if(n==="x"){if(E1(e)){var i=are(e);var a=E1(t)?"(".concat(t.signal,' === "top")'):t==="top";return{signal:"(45 < ".concat(i," && ").concat(i," < 135) || (225 < ").concat(i," && ").concat(i,' < 315) ? "middle" :')+"(".concat(i," <= 45 || 315 <= ").concat(i,") === ").concat(a,' ? "bottom" : "top"')}}if(45<e&&e<135||225<e&&e<315){return"middle"}if(E1(t)){var o=e<=45||315<=e?"===":"!==";return{signal:"".concat(t.signal," ").concat(o,' "top" ? "bottom" : "top"')}}return(e<=45||315<=e)===(t==="top")?"bottom":"top"}else{if(E1(e)){var u=are(e);var s=E1(t)?"(".concat(t.signal,' === "left")'):t==="left";var l=r?'"middle"':"null";return{signal:"".concat(u," <= 45 || 315 <= ").concat(u," || (135 <= ").concat(u," && ").concat(u," <= 225) ? ").concat(l," : (45 <= ").concat(u," && ").concat(u," <= 135) === ").concat(s,' ? "top" : "bottom"')}}if(e<=45||315<=e||135<=e&&e<=225){return r?"middle":null}if(E1(t)){var o=45<=e&&e<=135?"===":"!==";return{signal:"".concat(t.signal," ").concat(o,' "left" ? "top" : "bottom"')}}return(45<=e&&e<=135)===(t==="left")?"top":"bottom"}}return undefined}function ure(e,t,n){if(e===undefined){return undefined}var r=n==="x";var i=r?0:90;var a=r?"bottom":"left";if(E1(e)){var o=are(e);var u=E1(t)?"(".concat(t.signal,' === "').concat(a,'")'):t===a;return{signal:"(".concat(i?"(".concat(o," + 90)"):o," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(i," < ").concat(o," && ").concat(o," < ").concat(180+i,") === ").concat(u,' ? "left" : "right"')}}if((e+i)%180===0){return r?null:"center"}if(E1(t)){var s=i<e&&e<180+i?"===":"!==";var u="".concat(t.signal," ").concat(s,' "').concat(a,'"');return{signal:"".concat(u,' ? "left" : "right"')}}if((i<e&&e<180+i)===(t===a)){return"left"}return"right"}function sre(e,t){if(t==="x"&&GZ(["quantitative","temporal"],e)){return true}return undefined}function lre(e,t,n,r){if(n&&!jt(r)||e!=="nominal"&&e!=="ordinal"){if(t==="log"||t==="symlog"){return"greedy"}return true}return undefined}function fre(e){return e==="x"?"bottom":"left"}function cre(e){var t=e.fieldOrDatumDef,n=e.scaleType,r=e.size,i=e.values;var a;if(!i&&!z5(n)&&n!=="log"){if(A4(t)){if(v1(t.bin)){return{signal:"ceil(".concat(r.signal,"/10)")}}if(t.timeUnit&&GZ(["month","hours","day","quarter"],(a=Z3(t.timeUnit))===null||a===void 0?void 0:a.unit)){return undefined}}return{signal:"ceil(".concat(r.signal,"/40)")}}return undefined}function dre(e,t){var n=t==="x"?"x2":"y2";var r=e.fieldDef(t);var i=e.fieldDef(n);var a=r?r.title:undefined;var o=i?i.title:undefined;if(a&&o){return J1(a,o)}else if(a){return a}else if(o){return o}else if(a!==undefined){return a}else if(o!==undefined){return o}return undefined}function hre(e,t){var n=e.values;if(St(n)){return f8(t,n)}else if(E1(n)){return n}return undefined}function pre(e,t){if(e==="rect"&&R4(t)){return 1}return 0}var vre=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;r._dependentFields=Rne(r.transform.calculate);return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.parseAllForSortIndex=function(e,n){n.forEachFieldDef((function(n,r){if(!j4(n)){return}if(u4(n.sort)){var i=n.field,a=n.timeUnit;var o=n.sort;var u=o.map((function(e,t){return"".concat(d5({field:i,timeUnit:a,equal:e})," ? ").concat(t," : ")})).join("")+o.length;e=new t(e,{calculate:u,as:gre(n,r,{forAs:true})})}}));return e};t.prototype.producedFields=function(){return new Set([this.transform.as])};t.prototype.dependentFields=function(){return this._dependentFields};t.prototype.assemble=function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}};t.prototype.hash=function(){return"Calculate ".concat(WZ(this.transform))};return t}(lte);function gre(e,t,n){return P4(e,Object.assign({prefix:t,suffix:"sort_index"},n!==null&&n!==void 0?n:{}))}function mre(e,t){if(GZ(["top","bottom"],t)){return"column"}else if(GZ(["left","right"],t)){return"row"}return e==="row"?"row":"column"}function yre(e,t,n,r){var i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return yK((t||{})[e],i[e],n.header[e])}function bre(e,t,n,r){var i={};for(var a=0,o=e;a<o.length;a++){var u=o[a];var s=yre(u,t||{},n,r);if(s!==undefined){i[u]=s}}return i}var xre=["row","column"];var _re=["header","footer"];function wre(e,t){var n=e.component.layoutHeaders[t].title;var r=e.config?e.config:undefined;var i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:undefined;var a=bre(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),o=a.titleAnchor,u=a.titleAngle,s=a.titleOrient;var l=mre(t,s);var f=OK(u);return{name:"".concat(t,"-title"),type:"group",role:"".concat(l,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),Ore(f,l)),Are(l,f,o)),Mre(r,i,t,_9,b9))}}function Are(e,t,n){if(n===void 0){n="middle"}switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}var r=ure(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function Ore(e,t){var n=ore(e,t==="row"?"left":"top",t==="row"?"y":"x",true);return n?{baseline:n}:{}}function Ere(e,t){var n=e.component.layoutHeaders[t];var r=[];for(var i=0,a=_re;i<a.length;i++){var o=a[i];if(n[o]){for(var u=0,s=n[o];u<s.length;u++){var l=s[u];var f=Cre(e,t,o,n,l);if(f!=null){r.push(f)}}}}return r}function kre(e,t){var n;var r=e.sort;if(o4(r)){return{field:P4(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}}else if(St(r)){return{field:gre(e,t,{expr:"datum"}),order:"ascending"}}else{return{field:P4(e,{expr:"datum"}),order:r!==null&&r!==void 0?r:"ascending"}}}function Dre(e,t,n){var r=bre(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),i=r.format,a=r.formatType,o=r.labelAngle,u=r.labelAnchor,s=r.labelOrient,l=r.labelExpr;var f=G6({fieldOrDatumDef:e,format:i,formatType:a,expr:"parent",config:n}).signal;var c=mre(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?vK(vK(l,"datum.label",f),"datum.value",P4(e,{expr:"parent"})):f}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Ore(o,c)),Are(c,o,u)),Mre(n,e,t,w9,x9))}function Cre(e,t,n,r,i){var a;if(i){var o=null;var u=r.facetFieldDef;var s=e.config?e.config:undefined;if(u&&i.labels){var l=bre(["labelOrient"],u.header,s,t).labelOrient;if(t==="row"&&!GZ(["top","bottom"],l)||t==="column"&&!GZ(["left","right"],l)){o=Dre(u,t,s)}}var f=Loe(e)&&!s4(e.facet);var c=i.axes;var d=(c===null||c===void 0?void 0:c.length)>0;if(o||d){var h=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("".concat(t,"_").concat(n)),type:"group",role:"".concat(t,"-").concat(n)},r.facetFieldDef?{from:{data:e.getName("".concat(t,"_domain"))},sort:kre(u,t)}:{}),d&&f?{from:{data:e.getName("facet_domain_".concat(t))}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:(a={},a[h]=i.sizeSignal,a)}}:{}),d?{axes:c}:{})}}return null}var Fre={column:{start:0,end:1},row:{start:1,end:0}};function Sre(e,t){return Fre[t][e]}function jre(e,t){var n={};for(var r=0,i=b0;r<i.length;r++){var a=i[r];var o=e[a];if(o===null||o===void 0?void 0:o.facetFieldDef){var u=bre(["titleAnchor","titleOrient"],o.facetFieldDef.header,t,a),s=u.titleAnchor,l=u.titleOrient;var f=mre(a,l);var c=Sre(s,f);if(c!==undefined){n[f]=c}}}return nK(n)?undefined:n}function Mre(e,t,n,r,i){var a={};for(var o=0,u=r;o<u.length;o++){var s=u[o];if(!i[s]){continue}var l=yre(s,t===null||t===void 0?void 0:t.header,e,n);if(l!==undefined){a[i[s]]=l}}return a}function Bre(e){return __spreadArray(__spreadArray(__spreadArray(__spreadArray([],Nre(e,"width"),true),Nre(e,"height"),true),Nre(e,"childWidth"),true),Nre(e,"childHeight"),true)}function Nre(e,t){var n=t==="width"?"x":"y";var r=e.component.layoutSize.get(t);if(!r||r==="merged"){return[]}var i=e.getSizeSignalRef(t).signal;if(r==="step"){var a=e.getScaleComponent(n);if(a){var o=a.get("type");var u=a.get("range");if(z5(o)&&k1(u)){var s=e.scaleName(n);if(Loe(e.parent)){var l=e.parent.component.resolve;if(l.scale[n]==="independent"){return[Tre(s,u)]}}return[Tre(s,u),{name:i,update:zre(s,a,"domain('".concat(s,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){var f=i.endsWith("width");var c=f?"containerSize()[0]":"containerSize()[1]";var d=V9(e.config.view,f?"width":"height");var h="isFinite(".concat(c,") ? ").concat(c," : ").concat(d);return[{name:i,init:h,on:[{update:h,events:"window:resize"}]}]}else{return[{name:i,value:r}]}}function Tre(e,t){var n="".concat(e,"_step");if(E1(t.step)){return{name:n,update:t.step.signal}}else{return{name:n,value:t.step}}}function zre(e,t,n){var r=t.get("type");var i=t.get("padding");var a=yK(t.get("paddingOuter"),i);var o=t.get("paddingInner");o=r==="band"?o!==undefined?o:i:1;return"bandspace(".concat(n,", ").concat(U1(o),", ").concat(U1(a),") * ").concat(e,"_step")}function Pre(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function Rre(e,t){return rK(e).reduce((function(n,r){var i=e[r];return Object.assign(Object.assign({},n),Dte(t,i,r,(function(e){return R1(e.value)})))}),{})}function Lre(e,t){if(Loe(t)){return e==="theta"?"independent":"shared"}else if(Uoe(t)){return"shared"}else if(Ioe(t)){return I0(e)||e==="theta"||e==="radius"?"independent":"shared"}throw new Error("invalid model type for resolve")}function Ire(e,t){var n=e.scale[t];var r=I0(t)?"axis":"legend";if(n==="independent"){if(e[r][t]==="shared"){k3(i3(t))}return"independent"}return e[r][t]||"shared"}var Ure=Object.assign(Object.assign({},D9),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1});var qre=rK(Ure);var Wre=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Ree);var Hre={symbols:Gre,gradient:$re,labels:Vre,entries:Yre};function Gre(e,t){var n=t.fieldOrDatumDef,r=t.model,i=t.channel,a=t.legendCmpt,o=t.legendType;var u,s,l,f,c,d,h,p;if(o!=="symbol"){return undefined}var v=r.markDef,g=r.encoding,m=r.config,y=r.mark;var b=v.filled&&y!=="trail";var x=Object.assign(Object.assign({},q1({},r,b6)),Pte(r,{filled:b}));var _=(u=a.get("symbolOpacity"))!==null&&u!==void 0?u:m.legend.symbolOpacity;var w=(s=a.get("symbolFillColor"))!==null&&s!==void 0?s:m.legend.symbolFillColor;var A=(l=a.get("symbolStrokeColor"))!==null&&l!==void 0?l:m.legend.symbolStrokeColor;var O=_===undefined?(f=Xre(g.opacity))!==null&&f!==void 0?f:v.opacity:undefined;if(x.fill){if(i==="fill"||b&&i===HK){delete x.fill}else{if(x.fill["field"]){if(w){delete x.fill}else{x.fill=R1((c=m.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black");x.fillOpacity=R1(O!==null&&O!==void 0?O:1)}}else if(St(x.fill)){var E=(p=(h=Jre((d=g.fill)!==null&&d!==void 0?d:g.color))!==null&&h!==void 0?h:v.fill)!==null&&p!==void 0?p:b&&v.color;if(E){x.fill=R1(E)}}}}if(x.stroke){if(i==="stroke"||!b&&i===HK){delete x.stroke}else{if(x.stroke["field"]||A){delete x.stroke}else if(St(x.stroke)){var k=yK(Jre(g.stroke||g.color),v.stroke,b?v.color:undefined);if(k){x.stroke={value:k}}}}}if(i!==JK){var D=A4(n)&&Zre(r,a,n);if(D){x.opacity=[Object.assign({test:D},R1(O!==null&&O!==void 0?O:1)),R1(m.legend.unselectedOpacity)]}else if(O){x.opacity=R1(O)}}x=Object.assign(Object.assign({},x),e);return nK(x)?undefined:x}function $re(e,t){var n=t.model,r=t.legendType,i=t.legendCmpt;var a;if(r!=="gradient"){return undefined}var o=n.config,u=n.markDef,s=n.encoding;var l={};var f=(a=i.get("gradientOpacity"))!==null&&a!==void 0?a:o.legend.gradientOpacity;var c=f===undefined?Xre(s.opacity)||u.opacity:undefined;if(c){l.opacity=R1(c)}l=Object.assign(Object.assign({},l),e);return nK(l)?undefined:l}function Vre(e,t){var n=t.fieldOrDatumDef,r=t.model,i=t.channel,a=t.legendCmpt;var o=r.legend(i)||{};var u=r.config;var s=A4(n)?Zre(r,a,n):undefined;var l=s?[{test:s,value:1},{value:u.legend.unselectedOpacity}]:undefined;var f=o.format,c=o.formatType;var d=q6(c)?V6({fieldOrDatumDef:n,field:"datum.value",format:f,formatType:c,config:u}):undefined;var h=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),d?{text:d}:{}),e);return nK(h)?undefined:h}function Yre(e,t){var n=t.legendCmpt;var r=n.get("selections");return(r===null||r===void 0?void 0:r.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function Xre(e){return Qre(e,(function(e,t){return Math.max(e,t.value)}))}function Jre(e){return Qre(e,(function(e,t){return yK(e,t.value)}))}function Qre(e,t){if(w4(e)){return tn(e.condition).reduce(t,e.value)}else if(S4(e)){return e.value}return undefined}function Zre(e,t,n){var r=t.get("selections");if(!(r===null||r===void 0?void 0:r.length))return undefined;var i=Pn(n.field);return r.map((function(e){var t=Pn(uK(e)+Dne);return"(!length(data(".concat(t,")) || (").concat(e,"[").concat(i,"] && indexof(").concat(e,"[").concat(i,"], datum.value) >= 0))")})).join(" || ")}var Kre={direction:function(e){var t=e.direction;return t},format:function(e){var t=e.fieldOrDatumDef,n=e.legend,r=e.config;var i=n.format,a=n.formatType;return Y6(t,t.type,i,a,r,false)},formatType:function(e){var t=e.legend,n=e.fieldOrDatumDef,r=e.scaleType;var i=t.formatType;return X6(i,n,r)},gradientLength:function(e){var t,n;var r=e.legend,i=e.legendConfig;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:oie(e)},labelOverlap:function(e){var t=e.legend,n=e.legendConfig,r=e.scaleType;var i,a;return(a=(i=t.labelOverlap)!==null&&i!==void 0?i:n.labelOverlap)!==null&&a!==void 0?a:sie(r)},symbolType:function(e){var t=e.legend,n=e.markDef,r=e.channel,i=e.encoding;var a;return(a=t.symbolType)!==null&&a!==void 0?a:tie(n.type,r,i.shape,n.shape)},title:function(e){var t=e.fieldOrDatumDef,n=e.config;return V4(t,n,{allowDisabling:true})},type:function(e){var t=e.legendType,n=e.scaleType,r=e.channel;if(m0(r)&&R5(n)){if(t==="gradient"){return undefined}}else if(t==="symbol"){return undefined}return t},values:function(e){var t=e.fieldOrDatumDef,n=e.legend;return eie(n,t)}};function eie(e,t){var n=e.values;if(St(n)){return f8(t,n)}else if(E1(n)){return n}return undefined}function tie(e,t,n,r){var i;if(t!=="shape"){var a=(i=Jre(n))!==null&&i!==void 0?i:r;if(a){return a}}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function nie(e){var t=e.legend;return yK(t.type,rie(e))}function rie(e){var t=e.channel,n=e.timeUnit,r=e.scaleType;if(m0(t)){if(GZ(["quarter","month","day"],n)){return"symbol"}if(R5(r)){return"gradient"}}return"symbol"}function iie(e){var t=e.legendConfig,n=e.legendType,r=e.orient,i=e.legend;var a,o;return(o=(a=i.direction)!==null&&a!==void 0?a:t[n?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:aie(r,n)}function aie(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case undefined:return undefined;default:return t==="gradient"?"horizontal":undefined}}function oie(e){var t=e.legendConfig,n=e.model,r=e.direction,i=e.orient,a=e.scaleType;var o=t.gradientHorizontalMaxLength,u=t.gradientHorizontalMinLength,s=t.gradientVerticalMaxLength,l=t.gradientVerticalMinLength;if(R5(a)){if(r==="horizontal"){if(i==="top"||i==="bottom"){return uie(n,"width",u,o)}else{return u}}else{return uie(n,"height",l,s)}}return undefined}function uie(e,t,n,r){var i=e.getSizeSignalRef(t).signal;return{signal:"clamp(".concat(i,", ").concat(n,", ").concat(r,")")}}function sie(e){if(GZ(["quantile","threshold","log","symlog"],e)){return"greedy"}return undefined}function lie(e){var t=Roe(e)?fie(e):pie(e);e.component.legends=t;return t}function fie(e){var t=e.encoding;var n={};for(var r=0,i=__spreadArray([HK],E9,true);r<i.length;r++){var a=i[r];var o=K4(t[a]);if(!o||!e.getScaleComponent(a)){continue}if(a===VK&&A4(o)&&o.type===w5){continue}n[a]=hie(e,a)}return n}function cie(e,t){var n;var r=e.scaleName(t);if(e.mark==="trail"){if(t==="color"){return{stroke:r}}else if(t==="size"){return{strokeWidth:r}}}if(t==="color"){return e.markDef.filled?{fill:r}:{stroke:r}}return n={},n[t]=r,n}function die(e,t,n,r){switch(t){case"disable":return n!==undefined;case"values":return!!(n===null||n===void 0?void 0:n.values);case"title":if(t==="title"&&e===(r===null||r===void 0?void 0:r.title)){return true}}return e===(n||{})[t]}function hie(e,t){var n,r,i;var a=e.legend(t);var o=e.markDef,u=e.encoding,s=e.config;var l=s.legend;var f=new Wre({},cie(e,t));yne(e,t,f);var c=a!==undefined?!a:l.disable;f.set("disable",c,a!==undefined);if(c){return f}a=a||{};var d=e.getScaleComponent(t).get("type");var h=K4(u[t]);var p=A4(h)?(n=Z3(h.timeUnit))===null||n===void 0?void 0:n.unit:undefined;var v=a.orient||s.legend.orient||"right";var g=nie({legend:a,channel:t,timeUnit:p,scaleType:d});var m=iie({legend:a,legendType:g,orient:v,legendConfig:l});var y={legend:a,channel:t,model:e,markDef:o,encoding:u,fieldOrDatumDef:h,legendConfig:l,config:s,scaleType:d,orient:v,legendType:g,direction:m};for(var b=0,x=qre;b<x.length;b++){var _=x[b];if(g==="gradient"&&_.startsWith("symbol")||g==="symbol"&&_.startsWith("gradient")){continue}var w=_ in Kre?Kre[_](y):a[_];if(w!==undefined){var A=die(w,_,a,e.fieldDef(t));if(A||s.legend[_]===undefined){f.set(_,w,A)}}}var O=(r=a===null||a===void 0?void 0:a.encoding)!==null&&r!==void 0?r:{};var E=f.get("selections");var k={};var D={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:f,legendType:g};for(var C=0,F=["labels","legend","title","symbols","gradient","entries"];C<F.length;C++){var S=F[C];var j=Rre((i=O[S])!==null&&i!==void 0?i:{},e);var M=S in Hre?Hre[S](j,D):j;if(M!==undefined&&!nK(M)){k[S]=Object.assign(Object.assign(Object.assign({},(E===null||E===void 0?void 0:E.length)&&A4(h)?{name:"".concat(uK(h.field),"_legend_").concat(S)}:{}),(E===null||E===void 0?void 0:E.length)?{interactive:!!E}:{}),{update:M})}}if(!nK(k)){f.set("encode",k,!!(a===null||a===void 0?void 0:a.encoding))}return f}function pie(e){var t=e.component,n=t.legends,r=t.resolve;for(var i=0,a=e.children;i<a.length;i++){var o=a[i];lie(o);for(var u=0,s=rK(o.component.legends);u<s.length;u++){var l=s[u];r.legend[l]=Ire(e.component.resolve,l);if(r.legend[l]==="shared"){n[l]=vie(n[l],o.component.legends[l]);if(!n[l]){r.legend[l]="independent";delete n[l]}}}}for(var f=0,c=rK(n);f<c.length;f++){var l=c[f];for(var d=0,h=e.children;d<h.length;d++){var o=h[d];if(!o.component.legends[l]){continue}if(r.legend[l]==="shared"){delete o.component.legends[l]}}}return n}function vie(e,t){var n,r,i,a;if(!e){return t.clone()}var o=e.getWithExplicit("orient");var u=t.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value){return undefined}var s=false;var l=function(n){var r=Wee(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(function(e,t){switch(n){case"symbolType":return gie(e,t);case"title":return Q1(e,t);case"type":s=true;return Iee("symbol")}return qee(e,t,n,"legend")}));e.setWithExplicit(n,r)};for(var f=0,c=qre;f<c.length;f++){var d=c[f];l(d)}if(s){if((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient){lK(e.implicit,["encode","gradient"])}if((a=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||a===void 0?void 0:a.gradient){lK(e.explicit,["encode","gradient"])}}return e}function gie(e,t){if(t.value==="circle"){return t}return e}var mie=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function yie(e,t,n,r){var i,a,o;var u,s;(i=e.encode)!==null&&i!==void 0?i:e.encode={};(a=(u=e.encode)[t])!==null&&a!==void 0?a:u[t]={};(o=(s=e.encode[t]).update)!==null&&o!==void 0?o:s.update={};e.encode[t].update[n]=r}function bie(e){var t=e.component.legends;var n={};for(var r=0,i=rK(t);r<i.length;r++){var a=i[r];var o=e.getScaleComponent(a);var u=qZ(o.get("domains"));if(n[u]){for(var s=0,l=n[u];s<l.length;s++){var f=l[s];var c=vie(f,t[a]);if(!c){n[u].push(t[a])}}}else{n[u]=[t[a].clone()]}}var d=iK(n).flat().map((function(t){return xie(t,e.config)})).filter((function(e){return e!==undefined}));return d}function xie(e,t){var n,r,i;var a=e.combine(),o=a.disable,u=a.labelExpr,s=a.selections,l=mie(a,["disable","labelExpr","selections"]);if(o){return undefined}if(t.aria===false&&l.aria==undefined){l.aria=false}if((n=l.encode)===null||n===void 0?void 0:n.symbols){var f=l.encode.symbols.update;if(f.fill&&f.fill["value"]!=="transparent"&&!f.stroke&&!l.stroke){f.stroke={value:"transparent"}}for(var c=0,d=E9;c<d.length;c++){var h=d[c];if(l[h]){delete f[h]}}}if(!l.title){delete l.title}if(u!==undefined){var p=u;if(((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&E1(l.encode.labels.update.text)){p=vK(u,"datum.label",l.encode.labels.update.text.signal)}yie(l,"labels","text",{signal:p})}return l}function _ie(e){if(Uoe(e)||Ioe(e)){return wie(e)}else{return Aie(e)}}function wie(e){return e.children.reduce((function(e,t){return e.concat(t.assembleProjections())}),Aie(e))}function Aie(e){var t=e.component.projection;if(!t||t.merged){return[]}var n=t.combine();var r=n.name;if(!t.data){return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}else{var i={signal:"[".concat(t.size.map((function(e){return e.signal})).join(", "),"]")};var a=t.data.reduce((function(t,n){var r=E1(n)?n.signal:"data('".concat(e.lookupDataSource(n),"')");if(!GZ(t,r)){t.push(r)}return t}),[]);if(a.length<=0){throw new Error("Projection's fit didn't find any data sources")}return[Object.assign({name:r,size:i,fit:{signal:a.length>1?"[".concat(a.join(", "),"]"):a[0]}},n)]}}var Oie=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];var Eie=function(e){Ee(t,e);function t(t,n,r,i){var a=e.call(this,Object.assign({},n),{name:t})||this;a.specifiedProjection=n;a.size=r;a.data=i;a.merged=false;return a}Object.defineProperty(t.prototype,"isFit",{get:function(){return!!this.data},enumerable:false,configurable:true});return t}(Ree);function kie(e){e.component.projection=Roe(e)?Die(e):Sie(e)}function Die(e){var t;if(e.hasProjection){var n=_1(e.specifiedProjection);var r=!(n&&(n.scale!=null||n.translate!=null));var i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:undefined;var a=r?Cie(e):undefined;var o=new Eie(e.projectionName(true),Object.assign(Object.assign({},(t=_1(e.config.projection))!==null&&t!==void 0?t:{}),n!==null&&n!==void 0?n:{}),i,a);if(!o.get("type")){o.set("type","equalEarth",false)}return o}return undefined}function Cie(e){var t=[];var n=e.encoding;for(var r=0,i=[[UK,IK],[WK,qK]];r<i.length;r++){var a=i[r];if(K4(n[a[0]])||K4(n[a[1]])){t.push({signal:e.getName("geojson_".concat(t.length))})}}if(e.channelHasField(VK)&&e.typedFieldDef(VK).type===w5){t.push({signal:e.getName("geojson_".concat(t.length))})}if(t.length===0){t.push(e.requestDataName(Zee.Main))}return t}function Fie(e,t){var n=VZ(Oie,(function(n){if(!mn(e.explicit,n)&&!mn(t.explicit,n)){return true}if(mn(e.explicit,n)&&mn(t.explicit,n)&&PZ(e.get(n),t.get(n))){return true}return false}));var r=PZ(e.size,t.size);if(r){if(n){return e}else if(PZ(e.explicit,{})){return t}else if(PZ(t.explicit,{})){return e}}return null}function Sie(e){var t;if(e.children.length===0){return undefined}var n;for(var r=0,i=e.children;r<i.length;r++){var a=i[r];kie(a)}var o=VZ(e.children,(function(e){var t=e.component.projection;if(!t){return true}else if(!n){n=t;return true}else{var r=Fie(n,t);if(r){n=r}return!!r}}));if(n&&o){var u=e.projectionName(true);var s=new Eie(u,n.specifiedProjection,n.size,RZ(n.data));for(var l=0,f=e.children;l<f.length;l++){var a=f[l];var c=a.component.projection;if(c){if(c.isFit){(t=s.data).push.apply(t,a.component.projection.data)}a.renameProjection(c.get("name"),u);c.merged=true}}return s}return undefined}var jie=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function Mie(e,t,n,r){var i,a;if(c8(t,n)){var o=Roe(e)?(a=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&a!==void 0?a:{}:{};var u=P4(t,{expr:"datum"});var s=P4(t,{expr:"datum",binSuffix:"end"});return{formulaAs:P4(t,{binSuffix:"range",forAs:true}),formula:e4(u,s,o.format,o.formatType,r)}}return{}}function Bie(e,t){return"".concat(p1(e),"_").concat(t)}function Nie(e,t){return{signal:e.getName("".concat(t,"_bins")),extentSignal:e.getName("".concat(t,"_extent"))}}function Tie(e,t,n){var r;var i=(r=i8(n,undefined))!==null&&r!==void 0?r:{};var a=Bie(i,t);return e.getName("".concat(a,"_bins"))}function zie(e){return"as"in e}function Pie(e,t,n){var r;var i;if(zie(e)){r=Cn(e.as)?[e.as,"".concat(e.as,"_end")]:[e.as[0],e.as[1]]}else{r=[P4(e,{forAs:true}),P4(e,{binSuffix:"end",forAs:true})]}var a=Object.assign({},i8(t,undefined));var o=Bie(a,e.field);var u=Nie(n,o),s=u.signal,l=u.extentSignal;if(y1(a.extent)){var f=a.extent;i=qne(n,f.param,f);delete a.extent}var c=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),l?{extentSignal:l}:{}),i?{span:i}:{});return{key:o,binComponent:c}}var Rie=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.bins=n;return r}t.prototype.clone=function(){return new t(null,RZ(this.bins))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef((function(e,t,r){if(F4(t)&&v1(t.bin)){var i=Pie(t,t.bin,n),a=i.key,o=i.binComponent;e[a]=Object.assign(Object.assign(Object.assign({},o),e[a]),Mie(n,t,r,n.config))}return e}),{});if(nK(r)){return null}return new t(e,r)};t.makeFromTransform=function(e,n,r){var i;var a=Pie(n,n.bin,r),o=a.key,u=a.binComponent;return new t(e,(i={},i[o]=u,i))};t.prototype.merge=function(e,t){for(var n=0,r=rK(e.bins);n<r.length;n++){var i=r[n];if(i in this.bins){t(e.bins[i].signal,this.bins[i].signal);this.bins[i].as=JZ(__spreadArray(__spreadArray([],this.bins[i].as,true),e.bins[i].as,true),WZ)}else{this.bins[i]=e.bins[i]}}for(var a=0,o=e.children;a<o.length;a++){var u=o[a];e.removeChild(u);u.parent=this}e.remove()};t.prototype.producedFields=function(){return new Set(iK(this.bins).map((function(e){return e.as})).flat(2))};t.prototype.dependentFields=function(){return new Set(iK(this.bins).map((function(e){return e.field})))};t.prototype.hash=function(){return"Bin ".concat(WZ(this.bins))};t.prototype.assemble=function(){return iK(this.bins).flatMap((function(e){var t=[];var n=e.as,r=n[0],i=n.slice(1);var a=e.bin,o=a.extent,u=jie(a,["extent"]);var s=Object.assign(Object.assign(Object.assign({type:"bin",field:pK(e.field),as:r,signal:e.signal},!y1(o)?{extent:o}:{extent:null}),e.span?{span:{signal:"span(".concat(e.span,")")}}:{}),u);if(!o&&e.extentSignal){t.push({type:"extent",field:pK(e.field),signal:e.extentSignal});s.extent={signal:e.extentSignal}}t.push(s);for(var l=0,f=i;l<f.length;l++){var c=f[l];for(var d=0;d<2;d++){t.push({type:"formula",expr:P4({field:r[d]},{expr:"datum"}),as:c[d]})}}if(e.formula){t.push({type:"formula",expr:e.formula,as:e.formulaAs})}return t}))};return t}(lte);function Lie(e,t,n,r){var i;var a=Roe(r)?r.encoding[S0(t)]:undefined;if(F4(n)&&Roe(r)&&y4(n,a,r.markDef,r.config)){e.add(P4(n,{}));e.add(P4(n,{suffix:"end"}));if(n.bin&&c8(n,t)){e.add(P4(n,{binSuffix:"range"}))}}else if(p0(t)){var o=h0(t);e.add(r.getName(o))}else{e.add(P4(n))}if(j4(n)&&H5((i=n.scale)===null||i===void 0?void 0:i.range)){e.add(n.scale.range.field)}return e}function Iie(e,t){var n;var r;for(var i=0,a=rK(t);i<a.length;i++){var o=a[i];var u=t[o];for(var s=0,l=rK(u);s<l.length;s++){var f=l[s];if(o in e){e[o][f]=new Set(__spreadArray(__spreadArray([],(r=e[o][f])!==null&&r!==void 0?r:[],true),u[f],true))}else{e[o]=(n={},n[f]=u[f],n)}}}}var Uie=function(e){Ee(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.dimensions=n;i.measures=r;return i}t.prototype.clone=function(){return new t(null,new Set(this.dimensions),RZ(this.measures))};Object.defineProperty(t.prototype,"groupBy",{get:function(){return this.dimensions},enumerable:false,configurable:true});t.makeFromEncoding=function(e,n){var r=false;n.forEachFieldDef((function(e){if(e.aggregate){r=true}}));var i={};var a=new Set;if(!r){return null}n.forEachFieldDef((function(e,t){var r,o,u,s;var l=e.aggregate,f=e.field;if(l){if(l==="count"){(r=i["*"])!==null&&r!==void 0?r:i["*"]={};i["*"]["count"]=new Set([P4(e,{forAs:true})])}else{if(o1(l)||u1(l)){var c=o1(l)?"argmin":"argmax";var d=l[c];(o=i[d])!==null&&o!==void 0?o:i[d]={};i[d][c]=new Set([P4({op:c,field:d},{forAs:true})])}else{(u=i[f])!==null&&u!==void 0?u:i[f]={};i[f][l]=new Set([P4(e,{forAs:true})])}if(Z0(t)&&n.scaleDomain(t)==="unaggregated"){(s=i[f])!==null&&s!==void 0?s:i[f]={};i[f]["min"]=new Set([P4({field:f,aggregate:"min"},{forAs:true})]);i[f]["max"]=new Set([P4({field:f,aggregate:"max"},{forAs:true})])}}}else{Lie(a,t,e,n)}}));if(a.size+rK(i).length===0){return null}return new t(e,a,i)};t.makeFromTransform=function(e,n){var r,i,a;var o=new Set;var u={};for(var s=0,l=n.aggregate;s<l.length;s++){var f=l[s];var c=f.op,d=f.field,h=f.as;if(c){if(c==="count"){(r=u["*"])!==null&&r!==void 0?r:u["*"]={};u["*"]["count"]=new Set([h?h:P4(f,{forAs:true})])}else{(i=u[d])!==null&&i!==void 0?i:u[d]={};u[d][c]=new Set([h?h:P4(f,{forAs:true})])}}}for(var p=0,v=(a=n.groupby)!==null&&a!==void 0?a:[];p<v.length;p++){var f=v[p];o.add(f)}if(o.size+rK(u).length===0){return null}return new t(e,o,u)};t.prototype.merge=function(e){if(ZZ(this.dimensions,e.dimensions)){Iie(this.measures,e.measures);return true}D3("different dimensions, cannot merge");return false};t.prototype.addDimensions=function(e){e.forEach(this.dimensions.add,this.dimensions)};t.prototype.dependentFields=function(){return new Set(__spreadArray(__spreadArray([],this.dimensions,true),rK(this.measures),true))};t.prototype.producedFields=function(){var e=new Set;for(var t=0,n=rK(this.measures);t<n.length;t++){var r=n[t];for(var i=0,a=rK(this.measures[r]);i<a.length;i++){var o=a[i];var u=this.measures[r][o];if(u.size===0){e.add("".concat(o,"_").concat(r))}else{u.forEach(e.add,e)}}}return e};t.prototype.hash=function(){return"Aggregate ".concat(WZ({dimensions:this.dimensions,measures:this.measures}))};t.prototype.assemble=function(){var e=[];var t=[];var n=[];for(var r=0,i=rK(this.measures);r<i.length;r++){var a=i[r];for(var o=0,u=rK(this.measures[a]);o<u.length;o++){var s=u[o];for(var l=0,f=this.measures[a][s];l<f.length;l++){var c=f[l];n.push(c);e.push(s);t.push(a==="*"?null:pK(a))}}}var d={type:"aggregate",groupby:__spreadArray([],this.dimensions,true).map(pK),ops:e,fields:t,as:n};return d};return t}(lte);var qie=function(e){Ee(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.model=n;a.name=r;a.data=i;for(var o=0,u=b0;o<u.length;o++){var s=u[o];var l=n.facet[s];if(l){var f=l.bin,c=l.sort;a[s]=Object.assign({name:n.getName("".concat(s,"_domain")),fields:__spreadArray([P4(l)],v1(f)?[P4(l,{binSuffix:"end"})]:[],true)},o4(c)?{sortField:c}:St(c)?{sortIndexField:gre(l,s)}:{})}}a.childModel=n.child;return a}t.prototype.hash=function(){var e="Facet";for(var t=0,n=b0;t<n.length;t++){var r=n[t];if(this[r]){e+=" ".concat(r.charAt(0),":").concat(WZ(this[r]))}}return e};Object.defineProperty(t.prototype,"fields",{get:function(){var e;var t=[];for(var n=0,r=b0;n<r.length;n++){var i=r[n];if((e=this[i])===null||e===void 0?void 0:e.fields){t.push.apply(t,this[i].fields)}}return t},enumerable:false,configurable:true});t.prototype.dependentFields=function(){var e=new Set(this.fields);for(var t=0,n=b0;t<n.length;t++){var r=n[t];if(this[r]){if(this[r].sortField){e.add(this[r].sortField.field)}if(this[r].sortIndexField){e.add(this[r].sortIndexField)}}}return e};t.prototype.producedFields=function(){return new Set};t.prototype.getSource=function(){return this.name};t.prototype.getChildIndependentFieldsWithStep=function(){var e={};for(var t=0,n=L0;t<n.length;t++){var r=n[t];var i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type");var o=i.get("range");if(z5(a)&&k1(o)){var u=Yae(this.childModel,r);var s=Vae(u);if(s){e[r]=s}else{k3(r2(r))}}}}return e};t.prototype.assembleRowColumnHeaderData=function(e,t,n){var r={row:"y",column:"x",facet:undefined}[e];var i=[];var a=[];var o=[];if(r&&n&&n[r]){if(t){i.push("distinct_".concat(n[r]));a.push("max")}else{i.push(n[r]);a.push("distinct")}o.push("distinct_".concat(n[r]))}var u=this[e],s=u.sortField,l=u.sortIndexField;if(s){var f=s.op,c=f===void 0?n4:f,d=s.field;i.push(d);a.push(c);o.push(P4(s,{forAs:true}))}else if(l){i.push(l);a.push("max");o.push(l)}return{name:this[e].name,source:t!==null&&t!==void 0?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},i.length?{fields:i,ops:a,as:o}:{})]}};t.prototype.assembleFacetHeaderData=function(e){var t,n;var r=this.model.layout.columns;var i=this.model.component.layoutHeaders;var a=[];var o={};for(var u=0,s=xre;u<s.length;u++){var l=s[u];for(var f=0,c=_re;f<c.length;f++){var d=c[f];var h=(t=i[l]&&i[l][d])!==null&&t!==void 0?t:[];for(var p=0,v=h;p<v.length;p++){var g=v[p];if(((n=g.axes)===null||n===void 0?void 0:n.length)>0){o[l]=true;break}}}if(o[l]){var m='length(data("'.concat(this.facet.name,'"))');var y=l==="row"?r?{signal:"ceil(".concat(m," / ").concat(r,")")}:1:r?{signal:"min(".concat(m,", ").concat(r,")")}:{signal:m};a.push({name:"".concat(this.facet.name,"_").concat(l),transform:[{type:"sequence",start:0,stop:y}]})}}var b=o.row,x=o.column;if(b||x){a.unshift(this.assembleRowColumnHeaderData("facet",null,e))}return a};t.prototype.assemble=function(){var e,t;var n=[];var r=null;var i=this.getChildIndependentFieldsWithStep();var a=this,o=a.column,u=a.row,s=a.facet;if(o&&u&&(i.x||i.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);var l=[].concat((e=i.x)!==null&&e!==void 0?e:[],(t=i.y)!==null&&t!==void 0?t:[]);var f=l.map((function(){return"distinct"}));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:f}]})}for(var c=0,d=[CK,DK];c<d.length;c++){var h=d[c];if(this[h]){n.push(this.assembleRowColumnHeaderData(h,r,i))}}if(s){var p=this.assembleFacetHeaderData(i);if(p){n.push.apply(n,p)}}return n};return t}(lte);function Wie(e){if(e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')){return e.slice(1,-1)}return e}function Hie(e,t){var n=cK(e);if(t==="number"){return"toNumber(".concat(n,")")}else if(t==="boolean"){return"toBoolean(".concat(n,")")}else if(t==="string"){return"toString(".concat(n,")")}else if(t==="date"){return"toDate(".concat(n,")")}else if(t==="flatten"){return n}else if(t.startsWith("date:")){var r=Wie(t.slice(5,t.length));return"timeParse(".concat(n,",'").concat(r,"')")}else if(t.startsWith("utc:")){var r=Wie(t.slice(4,t.length));return"utcParse(".concat(n,",'").concat(r,"')")}else{k3(y2(t));return null}}function Gie(e){var t={};TZ(e.filter,(function(e){var n;if(l5(e)){var r=null;if(t5(e)){r=z1(e.equal)}else if(r5(e)){r=z1(e.lte)}else if(n5(e)){r=z1(e.lt)}else if(i5(e)){r=z1(e.gt)}else if(a5(e)){r=z1(e.gte)}else if(o5(e)){r=e.range[0]}else if(u5(e)){r=((n=e.oneOf)!==null&&n!==void 0?n:e["in"])[0]}if(r){if(C3(r)){t[e.field]="date"}else if(kn(r)){t[e.field]="number"}else if(Cn(r)){t[e.field]="string"}}if(e.timeUnit){t[e.field]="date"}}}));return t}function $ie(e){var t={};function n(e){if(u8(e)){t[e.field]="date"}else if(e.type==="quantitative"&&c1(e.aggregate)){t[e.field]="number"}else if(mK(e.field)>1){if(!(e.field in t)){t[e.field]="flatten"}}else if(j4(e)&&o4(e.sort)&&mK(e.sort.field)>1){if(!(e.sort.field in t)){t[e.sort.field]="flatten"}}}if(Roe(e)||Loe(e)){e.forEachFieldDef((function(t,r){if(F4(t)){n(t)}else{var i=C0(r);var a=e.fieldDef(i);n(Object.assign(Object.assign({},t),{type:a.type}))}}))}if(Roe(e)){var r=e.mark,i=e.markDef,a=e.encoding;if(h6(r)&&!e.encoding.order){var o=i.orient==="horizontal"?"y":"x";var u=a[o];if(A4(u)&&u.type==="quantitative"&&!(u.field in t)){t[u.field]="number"}}}return t}function Vie(e){var t={};if(Roe(e)&&e.component.selection){for(var n=0,r=rK(e.component.selection);n<r.length;n++){var i=r[n];var a=e.component.selection[i];for(var o=0,u=a.project.items;o<u.length;o++){var s=u[o];if(!s.channel&&mK(s.field)>1){t[s.field]="flatten"}}}}return t}var Yie=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r._parse=n;return r}t.prototype.clone=function(){return new t(null,RZ(this._parse))};t.prototype.hash=function(){return"Parse ".concat(WZ(this._parse))};t.makeExplicit=function(e,t,n){var r;var i={};var a=t.data;if(!Yee(a)&&((r=a===null||a===void 0?void 0:a.format)===null||r===void 0?void 0:r.parse)){i=a.format.parse}return this.makeWithAncestors(e,i,{},n)};t.makeWithAncestors=function(e,n,r,i){for(var a=0,o=rK(r);a<o.length;a++){var u=o[a];var s=i.getWithExplicit(u);if(s.value!==undefined){if(s.explicit||s.value===r[u]||s.value==="derived"||r[u]==="flatten"){delete r[u]}else{k3(b2(u,r[u],s.value))}}}for(var l=0,f=rK(n);l<f.length;l++){var c=f[l];var s=i.get(c);if(s!==undefined){if(s===n[c]){delete n[c]}else{k3(b2(c,n[c],s))}}}var d=new Ree(n,r);i.copyAll(d);var h={};for(var p=0,v=rK(d.combine());p<v.length;p++){var g=v[p];var m=d.get(g);if(m!==null){h[g]=m}}if(rK(h).length===0||i.parseNothing){return null}return new t(e,h)};Object.defineProperty(t.prototype,"parse",{get:function(){return this._parse},enumerable:false,configurable:true});t.prototype.merge=function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse);e.remove()};t.prototype.assembleFormatParse=function(){var e={};for(var t=0,n=rK(this._parse);t<n.length;t++){var r=n[t];var i=this._parse[r];if(mK(r)===1){e[r]=i}}return e};t.prototype.producedFields=function(){return new Set(rK(this._parse))};t.prototype.dependentFields=function(){return new Set(rK(this._parse))};t.prototype.assembleTransforms=function(e){var t=this;if(e===void 0){e=false}return rK(this._parse).filter((function(t){return e?mK(t)>1:true})).map((function(e){var n=Hie(e,t._parse[e]);if(!n){return null}var r={type:"formula",expr:n,as:gK(e)};return r})).filter((function(e){return e!==null}))};return t}(lte);var Xie=function(e){Ee(t,e);function t(t){return e.call(this,t)||this}t.prototype.clone=function(){return new t(null)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set([C9])};t.prototype.hash=function(){return"Identifier"};t.prototype.assemble=function(){return{type:"identifier",as:C9}};return t}(lte);var Jie=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.params=n;return r}t.prototype.clone=function(){return new t(null,this.params)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return undefined};t.prototype.hash=function(){return"Graticule ".concat(WZ(this.params))};t.prototype.assemble=function(){return Object.assign({type:"graticule"},this.params===true?{}:this.params)};return t}(lte);var Qie=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.params=n;return r}t.prototype.clone=function(){return new t(null,this.params)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){var e;return new Set([(e=this.params.as)!==null&&e!==void 0?e:"data"])};t.prototype.hash=function(){return"Hash ".concat(WZ(this.params))};t.prototype.assemble=function(){return Object.assign({type:"sequence"},this.params)};return t}(lte);var Zie=function(e){Ee(t,e);function t(t){var n=e.call(this,null)||this;t!==null&&t!==void 0?t:t={name:"source"};var r;if(!Yee(t)){r=t.format?Object.assign({},UZ(t.format,["parse"])):{}}if($ee(t)){n._data={values:t.values}}else if(Gee(t)){n._data={url:t.url};if(!r.type){var i=/(?:\.([^.]+))?$/.exec(t.url)[1];if(!GZ(["json","csv","tsv","dsv","topojson"],i)){i="json"}r.type=i}}else if(Jee(t)){n._data={values:[{type:"Sphere"}]}}else if(Vee(t)||Yee(t)){n._data={}}n._generator=Yee(t);if(t.name){n._name=t.name}if(r&&!nK(r)){n._data.format=r}return n}t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return undefined};Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:false,configurable:true});t.prototype.hasName=function(){return!!this._name};Object.defineProperty(t.prototype,"isGenerator",{get:function(){return this._generator},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"dataName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"parent",{set:function(e){throw new Error("Source nodes have to be roots.")},enumerable:false,configurable:true});t.prototype.remove=function(){throw new Error("Source nodes are roots and cannot be removed.")};t.prototype.hash=function(){throw new Error("Cannot hash sources")};t.prototype.assemble=function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})};return t}(lte);var Kie=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t==="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n};var eae=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t==="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)};var tae;function nae(e){return e instanceof Zie||e instanceof Jie||e instanceof Qie}var rae=function(){function e(){tae.set(this,void 0);Kie(this,tae,false,"f")}e.prototype.setModified=function(){Kie(this,tae,true,"f")};Object.defineProperty(e.prototype,"modifiedFlag",{get:function(){return eae(this,tae,"f")},enumerable:false,configurable:true});return e}();tae=new WeakMap;var iae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getNodeDepths=function(e,t,n){n.set(e,t);for(var r=0,i=e.children;r<i.length;r++){var a=i[r];this.getNodeDepths(a,t+1,n)}return n};t.prototype.optimize=function(e){var t=this.getNodeDepths(e,0,new Map);var n=__spreadArray([],t.entries(),true).sort((function(e,t){return t[1]-e[1]}));for(var r=0,i=n;r<i.length;r++){var a=i[r];this.run(a[0])}return this.modifiedFlag};return t}(rae);var aae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.optimize=function(e){this.run(e);for(var t=0,n=e.children;t<n.length;t++){var r=n[t];this.optimize(r)}return this.modifiedFlag};return t}(rae);var oae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.mergeNodes=function(e,t){var n=t.shift();for(var r=0,i=t;r<i.length;r++){var a=i[r];e.removeChild(a);a.parent=n;a.remove()}};t.prototype.run=function(e){var t=e.children.map((function(e){return e.hash()}));var n={};for(var r=0;r<t.length;r++){if(n[t[r]]===undefined){n[t[r]]=[e.children[r]]}else{n[t[r]].push(e.children[r])}}for(var i=0,a=rK(n);i<a.length;i++){var o=a[i];if(n[o].length>1){this.setModified();this.mergeNodes(e,n[o])}}};return t}(aae);var uae=function(e){Ee(t,e);function t(t){var n=e.call(this)||this;n.requiresSelectionId=t&&Nne(t);return n}t.prototype.run=function(e){if(e instanceof Xie){if(!(this.requiresSelectionId&&(nae(e.parent)||e.parent instanceof Uie||e.parent instanceof Yie))){this.setModified();e.remove()}}};return t}(aae);var sae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.optimize=function(e){this.run(e,new Set);return this.modifiedFlag};t.prototype.run=function(e,t){var n=new Set;if(e instanceof dte){n=e.producedFields();if(KZ(n,t)){this.setModified();e.removeFormulas(t);if(e.producedFields.length===0){e.remove()}}}for(var r=0,i=e.children;r<i.length;r++){var a=i[r];this.run(a,new Set(__spreadArray(__spreadArray([],t,true),n,true)))}};return t}(rae);var lae=function(e){Ee(t,e);function t(){return e.call(this)||this}t.prototype.run=function(e){if(e instanceof fte&&!e.isRequired()){this.setModified();e.remove()}};return t}(aae);var fae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){if(nae(e)){return}if(e.numChildren()>1){return}for(var t=0,n=e.children;t<n.length;t++){var r=n[t];if(r instanceof Yie){if(e instanceof Yie){this.setModified();e.merge(r)}else{if(tK(e.producedFields(),r.dependentFields())){continue}this.setModified();r.swapWithParent()}}}return};return t}(iae);var cae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=__spreadArray([],e.children,true);var n=e.children.filter((function(e){return e instanceof Yie}));if(e.numChildren()>1&&n.length>=1){var r={};var i=new Set;for(var a=0,o=n;a<o.length;a++){var u=o[a];var s=u.parse;for(var l=0,f=rK(s);l<f.length;l++){var c=f[l];if(!(c in r)){r[c]=s[c]}else if(r[c]!==s[c]){i.add(c)}}}for(var d=0,h=i;d<h.length;d++){var p=h[d];delete r[p]}if(!nK(r)){this.setModified();var v=new Yie(e,r);for(var g=0,m=t;g<m.length;g++){var y=m[g];if(y instanceof Yie){for(var b=0,x=rK(r);b<x.length;b++){var _=x[b];delete y.parse[_]}}e.removeChild(y);y.parent=v;if(y instanceof Yie&&rK(y.parse).length===0){y.remove()}}}}};return t}(iae);var dae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){if(e instanceof fte||e.numChildren()>0||e instanceof qie);else if(e instanceof Zie);else{this.setModified();e.remove()}};return t}(iae);var hae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.children.filter((function(e){return e instanceof dte}));var n=t.pop();for(var r=0,i=t;r<i.length;r++){var a=i[r];this.setModified();n.merge(a)}};return t}(iae);var pae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.children.filter((function(e){return e instanceof Uie}));var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];var o=WZ(a.groupBy);if(!(o in n)){n[o]=[]}n[o].push(a)}for(var u=0,s=rK(n);u<s.length;u++){var l=s[u];var f=n[l];if(f.length>1){var c=f.pop();for(var d=0,h=f;d<h.length;d++){var a=h[d];if(c.merge(a)){e.removeChild(a);a.parent=c;a.remove();this.setModified()}}}}};return t}(iae);var vae=function(e){Ee(t,e);function t(t){var n=e.call(this)||this;n.model=t;return n}t.prototype.run=function(e){var t=!(nae(e)||e instanceof Lne||e instanceof Yie||e instanceof Xie);var n=[];var r=[];for(var i=0,a=e.children;i<a.length;i++){var o=a[i];if(o instanceof Rie){if(t&&!tK(e.producedFields(),o.dependentFields())){n.push(o)}else{r.push(o)}}}if(n.length>0){var u=n.pop();for(var s=0,l=n;s<l.length;s++){var f=l[s];u.merge(f,this.model.renameSignal.bind(this.model))}this.setModified();if(e instanceof Rie){e.merge(u,this.model.renameSignal.bind(this.model))}else{u.swapWithParent()}}if(r.length>1){var c=r.pop();for(var d=0,h=r;d<h.length;d++){var p=h[d];c.merge(p,this.model.renameSignal.bind(this.model))}this.setModified()}};return t}(iae);var gae=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=__spreadArray([],e.children,true);var n=$Z(t,(function(e){return e instanceof fte}));if(!n||e.numChildren()<=1){return}var r=[];var i;for(var a=0,o=t;a<o.length;a++){var u=o[a];if(u instanceof fte){var s=u;while(s.numChildren()===1){var l=s.children[0];if(l instanceof fte){s=l}else{break}}r.push.apply(r,s.children);if(i){e.removeChild(u);u.parent=i.parent;i.parent.removeChild(i);i.parent=s;this.setModified()}else{i=s}}else{r.push(u)}}if(r.length){this.setModified();for(var f=0,c=r;f<c.length;f++){var u=c[f];u.parent.removeChild(u);u.parent=i}}};return t}(iae);var mae=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.addDimensions=function(e){this.transform.groupby=JZ(this.transform.groupby.concat(e),(function(e){return e}))};t.prototype.dependentFields=function(){var e=new Set;if(this.transform.groupby){this.transform.groupby.forEach(e.add,e)}this.transform.joinaggregate.map((function(e){return e.field})).filter((function(e){return e!==undefined})).forEach(e.add,e);return e};t.prototype.producedFields=function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))};t.prototype.getDefaultName=function(e){var t;return(t=e.as)!==null&&t!==void 0?t:P4(e)};t.prototype.hash=function(){return"JoinAggregateTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=[];var t=[];var n=[];for(var r=0,i=this.transform.joinaggregate;r<i.length;r++){var a=i[r];t.push(a.op);n.push(this.getDefaultName(a));e.push(a.field===undefined?null:a.field)}var o=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},o!==undefined?{groupby:o}:{})};return t}(lte);function yae(e){return e.stack.stackBy.reduce((function(e,t){var n=t.fieldDef;var r=P4(n);if(r){e.push(r)}return e}),[])}function bae(e){return St(e)&&e.every((function(e){return Cn(e)}))&&e.length>1}var xae=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r._stack=n;return r}t.prototype.clone=function(){return new t(null,RZ(this._stack))};t.makeFromTransform=function(e,n){var r=n.stack,i=n.groupby,a=n.as,o=n.offset,u=o===void 0?"zero":o;var s=[];var l=[];if(n.sort!==undefined){for(var f=0,c=n.sort;f<c.length;f++){var d=c[f];s.push(d.field);l.push(yK(d.order,"ascending"))}}var h={field:s,order:l};var p;if(bae(a)){p=a}else if(Cn(a)){p=[a,"".concat(a,"_end")]}else{p=["".concat(n.stack,"_start"),"".concat(n.stack,"_end")]}return new t(e,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:u,sort:h,facetby:[],as:p})};t.makeFromEncoding=function(e,n){var r=n.stack;var i=n.encoding;if(!r){return null}var a=r.groupbyChannels,o=r.fieldChannel,u=r.offset,s=r.impute;var l=a.map((function(e){var t=i[e];return Z4(t)})).filter((function(e){return!!e}));var f=yae(n);var c=n.encoding.order;var d;if(St(c)||A4(c)){d=Y1(c)}else{d=f.reduce((function(e,t){e.field.push(t);e.order.push(o==="y"?"descending":"ascending");return e}),{field:[],order:[]})}return new t(e,{dimensionFieldDefs:l,stackField:n.vgField(o),facetby:[],stackby:f,sort:d,offset:u,impute:s,as:[n.vgField(o,{suffix:"start",forAs:true}),n.vgField(o,{suffix:"end",forAs:true})]})};Object.defineProperty(t.prototype,"stack",{get:function(){return this._stack},enumerable:false,configurable:true});t.prototype.addDimensions=function(e){var t;(t=this._stack.facetby).push.apply(t,e)};t.prototype.dependentFields=function(){var e=new Set;e.add(this._stack.stackField);this.getGroupbyFields().forEach(e.add,e);this._stack.facetby.forEach(e.add,e);this._stack.sort.field.forEach(e.add,e);return e};t.prototype.producedFields=function(){return new Set(this._stack.as)};t.prototype.hash=function(){return"Stack ".concat(WZ(this._stack))};t.prototype.getGroupbyFields=function(){var e=this._stack,t=e.dimensionFieldDefs,n=e.impute,r=e.groupby;if(t.length>0){return t.map((function(e){if(e.bin){if(n){return[P4(e,{binSuffix:"mid"})]}return[P4(e,{}),P4(e,{binSuffix:"end"})]}return[P4(e)]})).flat()}return r!==null&&r!==void 0?r:[]};t.prototype.assemble=function(){var e=[];var t=this._stack,n=t.facetby,r=t.dimensionFieldDefs,i=t.stackField,a=t.stackby,o=t.sort,u=t.offset,s=t.impute,l=t.as;if(s){for(var f=0,c=r;f<c.length;f++){var d=c[f];var h=d.bandPosition,p=h===void 0?.5:h,v=d.bin;if(v){var g=P4(d,{expr:"datum"});var m=P4(d,{expr:"datum",binSuffix:"end"});e.push({type:"formula",expr:"".concat(p,"*").concat(g,"+").concat(1-p,"*").concat(m),as:P4(d,{binSuffix:"mid",forAs:true})})}e.push({type:"impute",field:i,groupby:__spreadArray(__spreadArray([],a,true),n,true),key:P4(d,{binSuffix:"mid"}),method:"value",value:0})}}e.push({type:"stack",groupby:__spreadArray(__spreadArray([],this.getGroupbyFields(),true),n,true),field:i,sort:o,as:l,offset:u});return e};return t}(lte);var _ae=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.addDimensions=function(e){this.transform.groupby=JZ(this.transform.groupby.concat(e),(function(e){return e}))};t.prototype.dependentFields=function(){var e,t;var n=new Set;((e=this.transform.groupby)!==null&&e!==void 0?e:[]).forEach(n.add,n);((t=this.transform.sort)!==null&&t!==void 0?t:[]).forEach((function(e){return n.add(e.field)}));this.transform.window.map((function(e){return e.field})).filter((function(e){return e!==undefined})).forEach(n.add,n);return n};t.prototype.producedFields=function(){return new Set(this.transform.window.map(this.getDefaultName))};t.prototype.getDefaultName=function(e){var t;return(t=e.as)!==null&&t!==void 0?t:P4(e)};t.prototype.hash=function(){return"WindowTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e;var t=[];var n=[];var r=[];var i=[];for(var a=0,o=this.transform.window;a<o.length;a++){var u=o[a];n.push(u.op);r.push(this.getDefaultName(u));i.push(u.param===undefined?null:u.param);t.push(u.field===undefined?null:u.field)}var s=this.transform.frame;var l=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every((function(e){return s1(e)}))){return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},l!==undefined?{groupby:l}:{})}var f=[];var c=[];if(this.transform.sort!==undefined){for(var d=0,h=this.transform.sort;d<h.length;d++){var p=h[d];f.push(p.field);c.push((e=p.order)!==null&&e!==void 0?e:"ascending")}}var v={field:f,order:c};var g=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:t,sort:v},g!==undefined?{ignorePeers:g}:{}),l!==undefined?{groupby:l}:{}),s!==undefined?{frame:s}:{})};return t}(lte);function wae(e){function t(n){if(!(n instanceof qie)){var r=n.clone();if(r instanceof fte){var i=Eae+r.getSource();r.setSource(i);e.model.component.data.outputNodes[i]=r}else if(r instanceof Uie||r instanceof xae||r instanceof _ae||r instanceof mae){r.addDimensions(e.fields)}for(var a=0,o=n.children.flatMap(t);a<o.length;a++){var u=o[a];u.parent=r}return[r]}return n.children.flatMap(t)}return t}function Aae(e){if(e instanceof qie){if(e.numChildren()===1&&!(e.children[0]instanceof fte)){var t=e.children[0];if(t instanceof Uie||t instanceof xae||t instanceof _ae||t instanceof mae){t.addDimensions(e.fields)}t.swapWithParent();Aae(e)}else{var n=e.model.component.data.main;Oae(n);var r=wae(e);var i=e.children.map(r).flat();for(var a=0,o=i;a<o.length;a++){var u=o[a];u.parent=n}}}else{e.children.map(Aae)}}function Oae(e){if(e instanceof fte&&e.type===Zee.Main){if(e.numChildren()===1){var t=e.children[0];if(!(t instanceof qie)){t.swapWithParent();Oae(e)}}}}var Eae="scale_";var kae=5;function Dae(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];for(var i=0,a=r.children;i<a.length;i++){var o=a[i];if(o.parent!==r){return false}}if(!Dae(r.children)){return false}}return true}function Cae(e,t){var n=false;for(var r=0,i=t;r<i.length;r++){var a=i[r];n=e.optimize(a)||n}return n}function Fae(e,t,n){var r=e.sources;var i=false;i=Cae(new lae,r)||i;i=Cae(new uae(t),r)||i;r=r.filter((function(e){return e.numChildren()>0}));i=Cae(new dae,r)||i;r=r.filter((function(e){return e.numChildren()>0}));if(!n){i=Cae(new fae,r)||i;i=Cae(new vae(t),r)||i;i=Cae(new sae,r)||i;i=Cae(new cae,r)||i;i=Cae(new pae,r)||i;i=Cae(new hae,r)||i;i=Cae(new oae,r)||i;i=Cae(new gae,r)||i}e.sources=r;return i}function Sae(e,t){Dae(e.sources);var n=0;var r=0;for(var i=0;i<kae;i++){if(!Fae(e,t,true)){break}n++}e.sources.map(Aae);for(var i=0;i<kae;i++){if(!Fae(e,t,false)){break}r++}Dae(e.sources);if(Math.max(n,r)===kae){k3("Maximum optimization runs(".concat(kae,") reached."))}}var jae=function(){function e(e){Object.defineProperty(this,"signal",{enumerable:true,get:e})}e.fromName=function(t,n){return new e((function(){return t(n)}))};return e}();var Mae=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function Bae(e){if(Roe(e)){Nae(e)}else{Tae(e)}}function Nae(e){var t=e.component.scales;for(var n=0,r=rK(t);n<r.length;n++){var i=r[n];var a=Pae(e,i);var o=t[i];o.setWithExplicit("domains",a);qae(e,i);if(e.component.data.isFaceted){var u=e;while(!Loe(u)&&u.parent){u=u.parent}var s=u.component.resolve.scale[i];if(s==="shared"){for(var l=0,f=a.value;l<f.length;l++){var c=f[l];if(F1(c)){c.data=Eae+c.data.replace(Eae,"")}}}}}}function Tae(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];Bae(r)}var i=e.component.scales;for(var a=0,o=rK(i);a<o.length;a++){var u=o[a];var s=void 0;var l=null;for(var f=0,c=e.children;f<c.length;f++){var r=c[f];var d=r.component.scales[u];if(d){if(s===undefined){s=d.getWithExplicit("domains")}else{s=Wee(s,d.getWithExplicit("domains"),"domains","scale",Gae)}var h=d.get("selectionExtent");if(l&&h&&l.param!==h.param){k3(h2)}l=h}}i[u].setWithExplicit("domains",s);if(l){i[u].set("selectionExtent",l,true)}}}function zae(e,t,n,r){if(e==="unaggregated"){var i=Hae(t,n),a=i.valid,o=i.reason;if(!a){k3(o);return undefined}}else if(e===undefined&&r.useUnaggregatedDomain){var a=Hae(t,n).valid;if(a){return"unaggregated"}}return e}function Pae(e,t){var n=e.getScaleComponent(t).get("type");var r=e.encoding;var i=zae(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);if(i!==e.scaleDomain(t)){e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})}if(t==="x"&&K4(r.x2)){if(K4(r.x)){return Wee(Iae(n,i,e,"x"),Iae(n,i,e,"x2"),"domain","scale",Gae)}else{return Iae(n,i,e,"x2")}}else if(t==="y"&&K4(r.y2)){if(K4(r.y)){return Wee(Iae(n,i,e,"y"),Iae(n,i,e,"y2"),"domain","scale",Gae)}else{return Iae(n,i,e,"y2")}}return Iae(n,i,e,t)}function Rae(e,t,n){return e.map((function(e){var r=l8(e,{timeUnit:n,type:t});return{signal:"{data: ".concat(r,"}")}}))}function Lae(e,t,n){var r;var i=(r=Z3(n))===null||r===void 0?void 0:r.unit;if(t==="temporal"||i){return Rae(e,t,i)}return[e]}function Iae(e,t,n,r){var i=n.encoding;var a=K4(i[r]);var o=a.type;var u=a["timeUnit"];if(W5(t)){var s=Iae(e,undefined,n,r);var l=Lae(t.unionWith,o,u);return Lee(__spreadArray(__spreadArray([],s.value,true),l,true))}else if(E1(t)){return Lee([t])}else if(t&&t!=="unaggregated"&&!q5(t)){return Lee(Lae(t,o,u))}var f=n.stack;if(f&&r===f.fieldChannel){if(f.offset==="normalize"){return Iee([[0,1]])}var c=n.requestDataName(Zee.Main);return Iee([{data:c,field:n.vgField(r,{suffix:"start"})},{data:c,field:n.vgField(r,{suffix:"end"})}])}var d=Z0(r)&&A4(a)?Wae(n,r,e):undefined;if(E4(a)){var h=Lae([a.datum],o,u);return Iee(h)}var p=a;if(t==="unaggregated"){var v=n.requestDataName(Zee.Main);var g=a.field;return Iee([{data:v,field:P4({field:g,aggregate:"min"})},{data:v,field:P4({field:g,aggregate:"max"})}])}else if(v1(p.bin)){if(z5(e)){if(e==="bin-ordinal"){return Iee([])}return Iee([{data:oK(d)?n.requestDataName(Zee.Main):n.requestDataName(Zee.Raw),field:n.vgField(r,c8(p,r)?{binSuffix:"range"}:{}),sort:d===true||!jt(d)?{field:n.vgField(r,{}),op:"min"}:d}])}else{var m=p.bin;if(v1(m)){var y=Tie(n,p.field,m);return Iee([new jae((function(){var e=n.getSignalName(y);return"[".concat(e,".start, ").concat(e,".stop]")}))])}else{return Iee([{data:n.requestDataName(Zee.Main),field:n.vgField(r,{})}])}}}else if(p.timeUnit&&GZ(["time","utc"],e)&&y4(p,Roe(n)?n.encoding[S0(r)]:undefined,n.markDef,n.config)){var b=n.requestDataName(Zee.Main);return Iee([{data:b,field:n.vgField(r)},{data:b,field:n.vgField(r,{suffix:"end"})}])}else if(d){return Iee([{data:oK(d)?n.requestDataName(Zee.Main):n.requestDataName(Zee.Raw),field:n.vgField(r),sort:d}])}else{return Iee([{data:n.requestDataName(Zee.Main),field:n.vgField(r)}])}}function Uae(e,t){var n=e.op,r=e.field,i=e.order;return Object.assign(Object.assign({op:n!==null&&n!==void 0?n:t?"sum":n4},r?{field:pK(r)}:{}),i?{order:i}:{})}function qae(e,t){var n;var r=e.component.scales[t];var i=e.specifiedScales[t].domain;var a=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin;var o=q5(i)&&i;var u=m1(a)&&y1(a.extent)&&a.extent;if(o||u){r.set("selectionExtent",o!==null&&o!==void 0?o:u,true)}}function Wae(e,t,n){if(!z5(n)){return undefined}var r=e.fieldDef(t);var i=r.sort;if(u4(i)){return{op:"min",field:gre(r,t),order:"ascending"}}var a=e.stack;var o=a?new Set(__spreadArray(__spreadArray([],a.groupbyFields,true),a.stackBy.map((function(e){return e.fieldDef.field})),true)):undefined;if(o4(i)){var u=a&&!o.has(i.field);return Uae(i,u)}else if(a4(i)){var s=i.encoding,l=i.order;var f=e.fieldDef(s);var c=f.aggregate,d=f.field;var u=a&&!o.has(d);if(o1(c)||u1(c)){return Uae({field:P4(f),order:l},u)}else if(s1(c)||!c){return Uae({op:c,field:d,order:l},u)}}else if(i==="descending"){return{op:"min",field:e.vgField(t),order:"descending"}}else if(GZ(["ascending",undefined],i)){return true}return undefined}function Hae(e,t){var n=e.aggregate,r=e.type;if(!n){return{valid:false,reason:Y2(e)}}if(Cn(n)&&!h1.has(n)){return{valid:false,reason:X2(n)}}if(r==="quantitative"){if(t==="log"){return{valid:false,reason:J2(e)}}}return{valid:true}}function Gae(e,t,n,r){if(e.explicit&&t.explicit){k3(r3(n,r,e.value,t.value))}return{explicit:e.explicit,value:__spreadArray(__spreadArray([],e.value,true),t.value,true)}}function $ae(e){var t=JZ(e.map((function(e){if(F1(e)){var t=Mae(e,["sort"]);return t}return e})),WZ);var n=JZ(e.map((function(e){if(F1(e)){var t=e.sort;if(t!==undefined&&!oK(t)){if("op"in t&&t.op==="count"){delete t.field}if(t.order==="ascending"){delete t.order}}return t}return undefined})).filter((function(e){return e!==undefined})),WZ);if(t.length===0){return undefined}else if(t.length===1){var r=e[0];if(F1(r)&&n.length>0){var i=n[0];if(n.length>1){k3(o3);i=true}else{if(jt(i)&&"field"in i){var a=i.field;if(r.field===a){i=i.order?{order:i.order}:true}}}return Object.assign(Object.assign({},r),{sort:i})}return r}var o=JZ(n.map((function(e){if(oK(e)||!("op"in e)||Cn(e.op)&&e.op in a1){return e}k3(a3(e));return true})),WZ);var u;if(o.length===1){u=o[0]}else if(o.length>1){k3(o3);u=true}var s=JZ(e.map((function(e){if(F1(e)){return e.data}return null})),(function(e){return e}));if(s.length===1&&s[0]!==null){var l=Object.assign({data:s[0],fields:t.map((function(e){return e.field}))},u?{sort:u}:{});return l}return Object.assign({fields:t},u?{sort:u}:{})}function Vae(e){if(F1(e)&&Cn(e.field)){return e.field}else if(D1(e)){var t;for(var n=0,r=e.fields;n<r.length;n++){var i=r[n];if(F1(i)&&Cn(i.field)){if(!t){t=i.field}else if(t!==i.field){k3(u3);return t}}}k3(s3);return t}else if(C1(e)){k3(l3);var a=e.fields[0];return Cn(a)?a:undefined}return undefined}function Yae(e,t){var n=e.component.scales[t];var r=n.get("domains").map((function(t){if(F1(t)){t.data=e.lookupDataSource(t.data)}return t}));return $ae(r)}var Xae=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function Jae(e){if(Uoe(e)||Ioe(e)){return e.children.reduce((function(e,t){return e.concat(Jae(t))}),Qae(e))}else{return Qae(e)}}function Qae(e){return rK(e.component.scales).reduce((function(t,n){var r=e.component.scales[n];if(r.merged){return t}var i=r.combine();var a=i.name,o=i.type,u=i.selectionExtent,s=i.domains,l=i.range,f=i.reverse,c=Xae(i,["name","type","selectionExtent","domains","range","reverse"]);var d=Zae(i.range,a,n,e);var h=Yae(e,n);var p=u?ute(e,u,r,h):null;t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},h?{domain:h}:{}),p?{domainRaw:p}:{}),{range:d}),f!==undefined?{reverse:f}:{}),c));return t}),[])}function Zae(e,t,n,r){if(I0(n)){if(k1(e)){return{step:{signal:"".concat(t,"_step")}}}}else if(jt(e)&&F1(e)){return Object.assign(Object.assign({},e),{data:r.lookupDataSource(e.data)})}return e}var Kae=function(e){Ee(t,e);function t(t,n){var r=e.call(this,{},{name:t})||this;r.merged=false;r.setWithExplicit("type",n);return r}t.prototype.domainDefinitelyIncludesZero=function(){if(this.get("zero")!==false){return true}return $Z(this.get("domains"),(function(e){return St(e)&&e.length===2&&e[0]<=0&&e[1]>=0}))};return t}(Ree);var eoe=["range","scheme"];function toe(e){var t=e.component.scales;for(var n=0,r=Q0;n<r.length;n++){var i=r[n];var a=t[i];if(!a){continue}var o=roe(i,e);a.setWithExplicit("range",o)}}function noe(e,t){var n=e.fieldDef(t);if(n===null||n===void 0?void 0:n.bin){var r=n.bin,i=n.field;var a=j0(t);var o=e.getName(a);if(jt(r)&&r.binned&&r.step!==undefined){return new jae((function(){var n=e.scaleName(t);var i='(domain("'.concat(n,'")[1] - domain("').concat(n,'")[0]) / ').concat(r.step);return"".concat(e.getSignalName(o)," / (").concat(i,")")}))}else if(v1(r)){var u=Tie(e,i,r);return new jae((function(){var t=e.getSignalName(u);var n="(".concat(t,".stop - ").concat(t,".start) / ").concat(t,".step");return"".concat(e.getSignalName(o)," / (").concat(n,")")}))}}return undefined}function roe(e,t){var n=t.specifiedScales[e];var r=t.size;var i=t.getScaleComponent(e);var a=i.get("type");for(var o=0,u=eoe;o<u.length;o++){var s=u[o];if(n[s]!==undefined){var l=Y5(a,s);var f=X5(e,s);if(!l){k3(e3(a,s,e))}else if(f){k3(f)}else{switch(s){case"range":{var c=n.range;if(St(c)){if(I0(e)){return Lee(c.map((function(e){if(e==="width"||e==="height"){var n=t.getName(e);var r=t.getSignalName.bind(t);return jae.fromName(r,n)}return e})))}}else if(jt(c)){return Lee({data:t.requestDataName(Zee.Main),field:c.field,sort:{op:"min",field:t.vgField(e)}})}return Lee(c)}case"scheme":return Lee(ioe(n[s]))}}}}var d=e===SK||e==="xOffset"?"width":"height";var h=r[d];if(I9(h)){if(I0(e)){if(z5(a)){var p=ooe(h,t,e);if(p){return Lee({step:p})}}else{k3(t3(d))}}else if(G0(e)){var v=e===NK?"x":"y";var g=t.getScaleComponent(v);var m=g.get("type");if(m==="band"){var p=uoe(h,a);if(p){return Lee(p)}}}}var y=n.rangeMin,b=n.rangeMax;var x=aoe(e,t);if((y!==undefined||b!==undefined)&&Y5(a,"rangeMin")&&St(x)&&x.length===2){return Lee([y!==null&&y!==void 0?y:x[0],b!==null&&b!==void 0?b:x[1]])}return Iee(x)}function ioe(e){if(U5(e)){return Object.assign({scheme:e.name},UZ(e,["name"]))}return{scheme:e}}function aoe(e,t){var n=t.size,r=t.config,i=t.mark,a=t.encoding;var o=t.getSignalName.bind(t);var u=K4(a[e]).type;var s=t.getScaleComponent(e);var l=s.get("type");var f=t.specifiedScales[e],c=f.domain,d=f.domainMid;switch(e){case SK:case jK:{if(GZ(["point","band"],l)){var h=loe(e,n,r.view);if(I9(h)){var p=ooe(h,t,e);return{step:p}}}var v=j0(e);var g=t.getName(v);if(e===jK&&P5(l)){return[jae.fromName(o,g),0]}else{return[0,jae.fromName(o,g)]}}case NK:case TK:return soe(e,t,l);case YK:{var m=t.component.scales[e].get("zero");var y=doe(i,m,r);var b=poe(i,n,t,r);if(L5(l)){return coe(y,b,foe(l,r,c,e))}else{return[y,b]}}case RK:return[0,Math.PI*2];case XK:return[0,360];case zK:{return[0,new jae((function(){var e=t.getSignalName("width");var n=t.getSignalName("height");return"min(".concat(e,",").concat(n,")/2")}))]}case KK:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case e0:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case VK:return"symbol";case HK:case GK:case $K:if(l==="ordinal"){return u==="nominal"?"category":"ordinal"}else{if(d!==undefined){return"diverging"}else{return i==="rect"||i==="geoshape"?"heatmap":"ramp"}}case JK:case QK:case ZK:return[r.scale.minOpacity,r.scale.maxOpacity]}}function ooe(e,t,n){var r,i,a,o,u;var s=t.encoding;var l=t.getScaleComponent(n);var f=B0(n);var c=s[f];var d=L9({step:e,offsetIsDiscrete:C4(c)&&m5(c.type)});if(d==="offset"&&E8(s,f)){var h=t.getScaleComponent(f);var p=t.scaleName(f);var v="domain('".concat(p,"').length");if(h.get("type")==="band"){var g=(i=(r=h.get("paddingInner"))!==null&&r!==void 0?r:h.get("padding"))!==null&&i!==void 0?i:0;var m=(o=(a=h.get("paddingOuter"))!==null&&a!==void 0?a:h.get("padding"))!==null&&o!==void 0?o:0;v="bandspace(".concat(v,", ").concat(g,", ").concat(m,")")}var y=(u=l.get("paddingInner"))!==null&&u!==void 0?u:l.get("padding");return{signal:"".concat(e.step," * ").concat(v," / (1-").concat(L1(y),")")}}else{return e.step}}function uoe(e,t){var n=L9({step:e,offsetIsDiscrete:z5(t)});if(n==="offset"){return{step:e.step}}return undefined}function soe(e,t,n){var r=e===NK?"x":"y";var i=t.getScaleComponent(r);var a=i.get("type");var o=t.scaleName(r);if(a==="band"){var u=loe(r,t.size,t.config.view);if(I9(u)){var s=uoe(u,n);if(s){return s}}return[0,{signal:"bandwidth('".concat(o,"')")}]}else{return LZ("Cannot use ".concat(e," scale if ").concat(r," scale is not discrete."))}}function loe(e,t,n){var r=e===SK?"width":"height";var i=t[r];if(i){return i}return X9(n,r)}function foe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":if(n!==undefined&&St(n)){return n.length+1}else{k3(_3(r));return 3}}}function coe(e,t,n){var r=function(){var r=U1(t);var i=U1(e);var a="(".concat(r," - ").concat(i,") / (").concat(n," - 1)");return"sequence(".concat(i,", ").concat(r," + ").concat(a,", ").concat(a,")")};if(E1(t)){return new jae(r)}else{return{signal:r()}}}function doe(e,t,n){if(t){if(E1(t)){return{signal:"".concat(t.signal," ? 0 : ").concat(doe(e,false,n))}}else{return 0}}switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(z2("size",e))}var hoe=.95;function poe(e,t,n,r){var i={x:noe(n,"x"),y:noe(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==undefined){return r.scale.maxBandSize}var a=voe(t,i,r.view);if(kn(a)){return a-1}else{return new jae((function(){return"".concat(a.signal," - 1")}))}}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize){return r.scale.maxSize}var o=voe(t,i,r.view);if(kn(o)){return Math.pow(hoe*o,2)}else{return new jae((function(){return"pow(".concat(hoe," * ").concat(o.signal,", 2)")}))}}}throw new Error(z2("size",e))}function voe(e,t,n){var r=I9(e.width)?e.width.step:Y9(n,"width");var i=I9(e.height)?e.height.step:Y9(n,"height");if(t.x||t.y){return new jae((function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:i];return"min(".concat(e.join(", "),")")}))}return Math.min(r,i)}function goe(e,t){if(Roe(e)){moe(e,t)}else{xoe(e,t)}}function moe(e,t){var n=e.component.scales;var r=e.config,i=e.encoding,a=e.markDef,o=e.specifiedScales;for(var u=0,s=rK(n);u<s.length;u++){var l=s[u];var f=o[l];var c=n[l];var d=e.getScaleComponent(l);var h=K4(i[l]);var p=f[t];var v=d.get("type");var g=d.get("padding");var m=d.get("paddingInner");var y=Y5(v,t);var b=X5(l,t);if(p!==undefined){if(!y){k3(e3(v,t,l))}else if(b){k3(b)}}if(y&&b===undefined){if(p!==undefined){var x=h["timeUnit"];var _=h.type;switch(t){case"domainMax":case"domainMin":if(C3(f[t])||_==="temporal"||x){c.set(t,{signal:l8(f[t],{type:_,timeUnit:x})},true)}else{c.set(t,f[t],true)}break;default:c.copyKeyFromObject(t,f)}}else{var w=t in yoe?yoe[t]({model:e,channel:l,fieldOrDatumDef:h,scaleType:v,scalePadding:g,scalePaddingInner:m,domain:f.domain,domainMin:f.domainMin,domainMax:f.domainMax,markDef:a,config:r,hasNestedOffsetScale:k8(i,l)}):r.scale[t];if(w!==undefined){c.set(t,w,false)}}}}}var yoe={bins:function(e){var t=e.model,n=e.fieldOrDatumDef;return A4(n)?_oe(t,n):undefined},interpolate:function(e){var t=e.channel,n=e.fieldOrDatumDef;return woe(t,n.type)},nice:function(e){var t=e.scaleType,n=e.channel,r=e.domain,i=e.domainMin,a=e.domainMax,o=e.fieldOrDatumDef;return Aoe(t,n,r,i,a,o)},padding:function(e){var t=e.channel,n=e.scaleType,r=e.fieldOrDatumDef,i=e.markDef,a=e.config;return Ooe(t,n,a.scale,r,i,a.bar)},paddingInner:function(e){var t=e.scalePadding,n=e.channel,r=e.markDef,i=e.scaleType,a=e.config,o=e.hasNestedOffsetScale;return Eoe(t,n,r.type,i,a.scale,o)},paddingOuter:function(e){var t=e.scalePadding,n=e.channel,r=e.scaleType,i=e.scalePaddingInner,a=e.config,o=e.hasNestedOffsetScale;return koe(t,n,r,i,a.scale,o)},reverse:function(e){var t=e.fieldOrDatumDef,n=e.scaleType,r=e.channel,i=e.config;var a=A4(t)?t.sort:undefined;return Doe(n,a,r,i.scale)},zero:function(e){var t=e.channel,n=e.fieldOrDatumDef,r=e.domain,i=e.markDef,a=e.scaleType;return Coe(t,n,r,i,a)}};function boe(e){if(Roe(e)){toe(e)}else{xoe(e,"range")}}function xoe(e,t){var n=e.component.scales;for(var r=0,i=e.children;r<i.length;r++){var a=i[r];if(t==="range"){boe(a)}else{goe(a,t)}}for(var o=0,u=rK(n);o<u.length;o++){var s=u[o];var l=void 0;for(var f=0,c=e.children;f<c.length;f++){var a=c[f];var d=a.component.scales[s];if(d){var h=d.getWithExplicit(t);l=Wee(l,h,t,"scale",Uee((function(e,n){switch(t){case"range":if(e.step&&n.step){return e.step-n.step}return 0}return 0})))}}n[s].setWithExplicit(t,l)}}function _oe(e,t){var n=t.bin;if(v1(n)){var r=Tie(e,t.field,n);return new jae((function(){return e.getSignalName(r)}))}else if(g1(n)&&m1(n)&&n.step!==undefined){return{step:n.step}}return undefined}function woe(e,t){if(GZ([HK,GK,$K],e)&&t!=="nominal"){return"hcl"}return undefined}function Aoe(e,t,n,r,i,a){var o;if(((o=Z4(a))===null||o===void 0?void 0:o.bin)||St(n)||i!=null||r!=null||GZ([E5.TIME,E5.UTC],e)){return undefined}return I0(t)?true:undefined}function Ooe(e,t,n,r,i,a){if(I0(e)){if(R5(t)){if(n.continuousPadding!==undefined){return n.continuousPadding}var o=i.type,u=i.orient;if(o==="bar"&&!(A4(r)&&(r.bin||r.timeUnit))){if(u==="vertical"&&e==="x"||u==="horizontal"&&e==="y"){return a.continuousBandSize}}}if(t===E5.POINT){return n.pointPadding}}return undefined}function Eoe(e,t,n,r,i,a){if(a===void 0){a=false}if(e!==undefined){return undefined}if(I0(t)){var o=i.bandPaddingInner,u=i.barBandPaddingInner,s=i.rectBandPaddingInner,l=i.bandWithNestedOffsetPaddingInner;if(a){return l}return yK(o,n==="bar"?u:s)}else if(G0(t)){if(r===E5.BAND){return i.offsetBandPaddingInner}}return undefined}function koe(e,t,n,r,i,a){if(a===void 0){a=false}if(e!==undefined){return undefined}if(I0(t)){var o=i.bandPaddingOuter,u=i.bandWithNestedOffsetPaddingOuter;if(a){return u}if(n===E5.BAND){return yK(o,E1(r)?{signal:"".concat(r.signal,"/2")}:r/2)}}else if(G0(t)){if(n===E5.POINT){return.5}else if(n===E5.BAND){return i.offsetBandPaddingOuter}}return undefined}function Doe(e,t,n,r){if(n==="x"&&r.xReverse!==undefined){if(P5(e)&&t==="descending"){if(E1(r.xReverse)){return{signal:"!".concat(r.xReverse.signal)}}else{return!r.xReverse}}return r.xReverse}if(P5(e)&&t==="descending"){return true}return undefined}function Coe(e,t,n,r,i){var a=!!n&&n!=="unaggregated";if(a){if(P5(i)){if(St(n)){var o=n[0];var u=n[n.length-1];if(o<=0&&u>=0){return true}}return false}}if(e==="size"&&t.type==="quantitative"&&!L5(i)){return true}if(!(A4(t)&&t.bin)&&GZ(__spreadArray(__spreadArray([],L0,true),q0,true),e)){var s=r.orient,l=r.type;if(GZ(["bar","area","line","trail"],l)){if(s==="horizontal"&&e==="y"||s==="vertical"&&e==="x"){return false}}return true}return false}function Foe(e,t,n,r,i){if(i===void 0){i=false}var a=Soe(t,n,r,i);var o=e.type;if(!Z0(t)){return null}if(o!==undefined){if(!Q5(t,o)){k3(Z2(t,o,a));return a}if(A4(n)&&!J5(o,n.type)){k3(K2(o,a));return a}return o}return a}function Soe(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":{if(m0(e)||r1(e)==="discrete"){if(e==="shape"&&t.type==="ordinal"){k3(q2(e,"ordinal"))}return"ordinal"}if(I0(e)||G0(e)){if(GZ(["rect","bar","image","rule"],n.type)){return"band"}if(r){return"band"}}else if(n.type==="arc"&&e in U0){return"band"}var a=n[j0(e)];if(k6(a)){return"band"}if(M4(t)&&((i=t.axis)===null||i===void 0?void 0:i.tickBand)){return"band"}return"point"}case"temporal":if(m0(e)){return"time"}else if(r1(e)==="discrete"){k3(q2(e,"temporal"));return"ordinal"}else if(A4(t)&&t.timeUnit&&Z3(t.timeUnit).utc){return"utc"}return"time";case"quantitative":if(m0(e)){if(A4(t)&&v1(t.bin)){return"bin-ordinal"}return"linear"}else if(r1(e)==="discrete"){k3(q2(e,"quantitative"));return"ordinal"}return"linear";case"geojson":return undefined}throw new Error(F2(t.type))}function joe(e,t){var n=t===void 0?{}:t,r=n.ignoreRange;Moe(e);Bae(e);for(var i=0,a=V5;i<a.length;i++){var o=a[i];goe(e,o)}if(!r){boe(e)}}function Moe(e){if(Roe(e)){e.component.scales=Boe(e)}else{e.component.scales=Toe(e)}}function Boe(e){var t=e.encoding,n=e.mark,r=e.markDef;var i={};for(var a=0,o=Q0;a<o.length;a++){var u=o[a];var s=K4(t[u]);if(s&&n===d6&&u===VK&&s.type===w5){continue}var l=s&&s["scale"];if(G0(u)){var f=N0(u);if(!k8(t,f)){if(l){k3(P2(u))}continue}}if(s&&l!==null&&l!==false){l!==null&&l!==void 0?l:l={};var c=k8(t,u);var d=Foe(l,u,s,r,c);i[u]=new Kae(e.scaleName("".concat(u),true),{value:d,explicit:l.type===d})}}return i}var Noe=Uee((function(e,t){return F5(e)-F5(t)}));function Toe(e){var t;var n;var r=e.component.scales={};var i={};var a=e.component.resolve;for(var o=0,u=e.children;o<u.length;o++){var s=u[o];Moe(s);for(var l=0,f=rK(s.component.scales);l<f.length;l++){var c=f[l];(t=(n=a.scale)[c])!==null&&t!==void 0?t:n[c]=Lre(c,e);if(a.scale[c]==="shared"){var d=i[c];var h=s.component.scales[c].getWithExplicit("type");if(d){if(D5(d.value,h.value)){i[c]=Wee(d,h,"type","scale",Noe)}else{a.scale[c]="independent";delete i[c]}}else{i[c]=h}}}}for(var p=0,v=rK(i);p<v.length;p++){var c=v[p];var g=e.scaleName(c,true);var m=i[c];r[c]=new Kae(g,m);for(var y=0,b=e.children;y<b.length;y++){var s=b[y];var x=s.component.scales[c];if(x){s.renameScale(x.get("name"),g);x.merged=true}}}return r}var zoe=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var Poe=function(){function e(){this.nameMap={}}e.prototype.rename=function(e,t){this.nameMap[e]=t};e.prototype.has=function(e){return this.nameMap[e]!==undefined};e.prototype.get=function(e){while(this.nameMap[e]&&e!==this.nameMap[e]){e=this.nameMap[e]}return e};return e}();function Roe(e){return(e===null||e===void 0?void 0:e.type)==="unit"}function Loe(e){return(e===null||e===void 0?void 0:e.type)==="facet"}function Ioe(e){return(e===null||e===void 0?void 0:e.type)==="concat"}function Uoe(e){return(e===null||e===void 0?void 0:e.type)==="layer"}var qoe=function(){function e(e,t,n,r,i,a,o){var u=this;var s,l;this.type=t;this.parent=n;this.config=i;this.correctDataNames=function(e){var t,n,r;if((t=e.from)===null||t===void 0?void 0:t.data){e.from.data=u.lookupDataSource(e.from.data)}if((r=(n=e.from)===null||n===void 0?void 0:n.facet)===null||r===void 0?void 0:r.data){e.from.facet.data=u.lookupDataSource(e.from.facet.data)}return e};this.parent=n;this.config=i;this.view=_1(o);this.name=(s=e.name)!==null&&s!==void 0?s:r;this.title=O1(e.title)?{text:e.title}:e.title?_1(e.title):undefined;this.scaleNameMap=n?n.scaleNameMap:new Poe;this.projectionNameMap=n?n.projectionNameMap:new Poe;this.signalNameMap=n?n.signalNameMap:new Poe;this.data=e.data;this.description=e.description;this.transforms=pee((l=e.transform)!==null&&l!==void 0?l:[]);this.layout=t==="layer"||t==="unit"?{}:G9(e,t,i);this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:f4(e)||(n===null||n===void 0?void 0:n.component.data.isFaceted)&&e.data===undefined},layoutSize:new Ree,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?RZ(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}Object.defineProperty(e.prototype,"width",{get:function(){return this.getSizeSignalRef("width")},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this.getSizeSignalRef("height")},enumerable:false,configurable:true});e.prototype.parse=function(){this.parseScale();this.parseLayoutSize();this.renameTopLevelLayoutSizeSignal();this.parseSelections();this.parseProjection();this.parseData();this.parseAxesAndHeaders();this.parseLegends();this.parseMarkGroup()};e.prototype.parseScale=function(){joe(this)};e.prototype.parseProjection=function(){kie(this)};e.prototype.renameTopLevelLayoutSizeSignal=function(){if(this.getName("width")!=="width"){this.renameSignal(this.getName("width"),"width")}if(this.getName("height")!=="height"){this.renameSignal(this.getName("height"),"height")}};e.prototype.parseLegends=function(){lie(this)};e.prototype.assembleEncodeFromView=function(e){var t=zoe(e,["style"]);var n={};for(var r=0,i=rK(t);r<i.length;r++){var a=i[r];var o=t[a];if(o!==undefined){n[a]=R1(o)}}return n};e.prototype.assembleGroupEncodeEntry=function(e){var t={};if(this.view){t=this.assembleEncodeFromView(this.view)}if(!e){if(this.description){t["description"]=R1(this.description)}if(this.type==="unit"||this.type==="layer"){return Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},t!==null&&t!==void 0?t:{})}}return nK(t)?undefined:t};e.prototype.assembleLayout=function(){if(!this.layout){return undefined}var e=this.layout,t=e.spacing,n=zoe(e,["spacing"]);var r=this,i=r.component,a=r.config;var o=jre(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})};e.prototype.assembleDefaultLayout=function(){return{}};e.prototype.assembleHeaderMarks=function(){var e=this.component.layoutHeaders;var t=[];for(var n=0,r=b0;n<r.length;n++){var i=r[n];if(e[i].title){t.push(wre(this,i))}}for(var a=0,o=xre;a<o.length;a++){var i=o[a];t=t.concat(Ere(this,i))}return t};e.prototype.assembleAxes=function(){return Jne(this.component.axes,this.config)};e.prototype.assembleLegends=function(){return bie(this)};e.prototype.assembleProjections=function(){return _ie(this)};e.prototype.assembleTitle=function(){var e,t,n;var r=(e=this.title)!==null&&e!==void 0?e:{},i=r.encoding,a=zoe(r,["encoding"]);var o=Object.assign(Object.assign(Object.assign({},A1(this.config.title).nonMarkTitleProperties),a),i?{encode:{update:i}}:{});if(o.text){if(GZ(["unit","layer"],this.type)){if(GZ(["middle",undefined],o.anchor)){(t=o.frame)!==null&&t!==void 0?t:o.frame="group"}}else{(n=o.anchor)!==null&&n!==void 0?n:o.anchor="start"}return nK(o)?undefined:o}return undefined};e.prototype.assembleGroup=function(e){if(e===void 0){e=[]}var t={};e=e.concat(this.assembleSignals());if(e.length>0){t.signals=e}var n=this.assembleLayout();if(n){t.layout=n}t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||Loe(this.parent)?Jae(this):[];if(r.length>0){t.scales=r}var i=this.assembleAxes();if(i.length>0){t.axes=i}var a=this.assembleLegends();if(a.length>0){t.legends=a}return t};e.prototype.getName=function(e){return uK((this.name?"".concat(this.name,"_"):"")+e)};e.prototype.getDataName=function(e){return this.getName(Zee[e].toLowerCase())};e.prototype.requestDataName=function(e){var t=this.getDataName(e);var n=this.component.data.outputNodeRefCounts;n[t]=(n[t]||0)+1;return t};e.prototype.getSizeSignalRef=function(e){if(Loe(this.parent)){var t=Pre(e);var n=W0(t);var r=this.component.scales[n];if(r&&!r.merged){var i=r.get("type");var a=r.get("range");if(z5(i)&&k1(a)){var o=r.get("name");var u=Yae(this,n);var s=Vae(u);if(s){var l=P4({aggregate:"distinct",field:s},{expr:"datum"});return{signal:zre(o,r,l)}}else{k3(r2(n));return null}}}}return{signal:this.signalNameMap.get(this.getName(e))}};e.prototype.lookupDataSource=function(e){var t=this.component.data.outputNodes[e];if(!t){return e}return t.getSource()};e.prototype.getSignalName=function(e){return this.signalNameMap.get(e)};e.prototype.renameSignal=function(e,t){this.signalNameMap.rename(e,t)};e.prototype.renameScale=function(e,t){this.scaleNameMap.rename(e,t)};e.prototype.renameProjection=function(e,t){this.projectionNameMap.rename(e,t)};e.prototype.scaleName=function(e,t){if(t){return this.getName(e)}if(E0(e)&&Z0(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))){return this.scaleNameMap.get(this.getName(e))}return undefined};e.prototype.projectionName=function(e){if(e){return this.getName("projection")}if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))){return this.projectionNameMap.get(this.getName("projection"))}return undefined};e.prototype.getScaleComponent=function(e){if(!this.component.scales){throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().")}var t=this.component.scales[e];if(t&&!t.merged){return t}return this.parent?this.parent.getScaleComponent(e):undefined};e.prototype.getSelectionComponent=function(e,t){var n=this.component.selection[e];if(!n&&this.parent){n=this.parent.getSelectionComponent(e,t)}if(!n){throw new Error(s2(t))}return n};e.prototype.hasAxisOrientSignalRef=function(){var e,t;return((e=this.component.axes.x)===null||e===void 0?void 0:e.some((function(e){return e.hasOrientSignalRef()})))||((t=this.component.axes.y)===null||t===void 0?void 0:t.some((function(e){return e.hasOrientSignalRef()})))};return e}();var Woe=function(e){Ee(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.vgField=function(e,t){if(t===void 0){t={}}var n=this.fieldDef(e);if(!n){return undefined}return P4(n,t)};t.prototype.reduceFieldDef=function(e,t){return N8(this.getMapping(),(function(t,n,r){var i=Z4(n);if(i){return e(t,i,r)}return t}),t)};t.prototype.forEachFieldDef=function(e,t){B8(this.getMapping(),(function(t,n){var r=Z4(t);if(r){e(r,n)}}),t)};return t}(qoe);var Hoe=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var Goe=function(e){Ee(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=RZ(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:"value",(o=u[1])!==null&&o!==void 0?o:"density"];return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArray([this.transform.density],(e=this.transform.groupby)!==null&&e!==void 0?e:[],true))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"DensityTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.density,n=Hoe(e,["density"]);var r=Object.assign({type:"kde",field:t},n);return r};return t}(lte);var $oe=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.filter=n;return r}t.prototype.clone=function(){return new t(null,Object.assign({},this.filter))};t.make=function(e,n){var r=n.config,i=n.mark,a=n.markDef;var o=H1("invalid",a,r);if(o!=="filter"){return null}var u=n.reduceFieldDef((function(e,t,r){var a=Z0(r)&&n.getScaleComponent(r);if(a){var o=a.get("type");if(P5(o)&&t.aggregate!=="count"&&!h6(i)){e[t.field]=t}}return e}),{});if(!rK(u).length){return null}return new t(e,u)};t.prototype.dependentFields=function(){return new Set(rK(this.filter))};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"FilterInvalid ".concat(WZ(this.filter))};t.prototype.assemble=function(){var e=this;var t=rK(this.filter).reduce((function(t,n){var r=e.filter[n];var i=P4(r,{expr:"datum"});if(r!==null){if(r.type==="temporal"){t.push("(isDate(".concat(i,") || (isValid(").concat(i,") && isFinite(+").concat(i,")))"))}else if(r.type==="quantitative"){t.push("isValid(".concat(i,")"));t.push("isFinite(+".concat(i,")"))}else;}return t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null};return t}(lte);var Voe=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;r.transform=RZ(n);var i=r.transform,a=i.flatten,o=i.as,u=o===void 0?[]:o;r.transform.as=a.map((function(e,t){var n;return(n=u[t])!==null&&n!==void 0?n:e}));return r}t.prototype.clone=function(){return new t(this.parent,RZ(this.transform))};t.prototype.dependentFields=function(){return new Set(this.transform.flatten)};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"FlattenTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.flatten,n=e.as;var r={type:"flatten",fields:t,as:n};return r};return t}(lte);var Yoe=function(e){Ee(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=RZ(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:"key",(o=u[1])!==null&&o!==void 0?o:"value"];return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.dependentFields=function(){return new Set(this.transform.fold)};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"FoldTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.fold,n=e.as;var r={type:"fold",fields:t,as:n};return r};return t}(lte);var Xoe=function(e){Ee(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.fields=n;a.geojson=r;a.signal=i;return a}t.prototype.clone=function(){return new t(null,RZ(this.fields),this.geojson,this.signal)};t.parseAll=function(e,n){if(n.component.projection&&!n.component.projection.isFit){return e}var r=0;for(var i=0,a=[[UK,IK],[WK,qK]];i<a.length;i++){var o=a[i];var u=o.map((function(e){var t=K4(n.encoding[e]);return A4(t)?t.field:E4(t)?{expr:"".concat(t.datum)}:S4(t)?{expr:"".concat(t["value"])}:undefined}));if(u[0]||u[1]){e=new t(e,u,null,n.getName("geojson_".concat(r++)))}}if(n.channelHasField(VK)){var s=n.typedFieldDef(VK);if(s.type===w5){e=new t(e,null,s.field,n.getName("geojson_".concat(r++)))}}return e};t.prototype.dependentFields=function(){var e;var t=((e=this.fields)!==null&&e!==void 0?e:[]).filter(Cn);return new Set(__spreadArray(__spreadArray([],this.geojson?[this.geojson]:[],true),t,true))};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(WZ(this.fields))};t.prototype.assemble=function(){return __spreadArray(__spreadArray([],this.geojson?[{type:"filter",expr:'isValid(datum["'.concat(this.geojson,'"])')}]:[],true),[Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})],false)};return t}(lte);var Joe=function(e){Ee(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.projection=n;a.fields=r;a.as=i;return a}t.prototype.clone=function(){return new t(null,this.projection,RZ(this.fields),RZ(this.as))};t.parseAll=function(e,n){if(!n.projectionName()){return e}for(var r=0,i=[[UK,IK],[WK,qK]];r<i.length;r++){var a=i[r];var o=a.map((function(e){var t=K4(n.encoding[e]);return A4(t)?t.field:E4(t)?{expr:"".concat(t.datum)}:S4(t)?{expr:"".concat(t["value"])}:undefined}));var u=a[0]===WK?"2":"";if(o[0]||o[1]){e=new t(e,n.projectionName(),o,[n.getName("x".concat(u)),n.getName("y".concat(u))])}}return e};t.prototype.dependentFields=function(){return new Set(this.fields.filter(Cn))};t.prototype.producedFields=function(){return new Set(this.as)};t.prototype.hash=function(){return"Geopoint ".concat(this.projection," ").concat(WZ(this.fields)," ").concat(WZ(this.as))};t.prototype.assemble=function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}};return t}(lte);var Qoe=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArray([this.transform.impute,this.transform.key],(e=this.transform.groupby)!==null&&e!==void 0?e:[],true))};t.prototype.producedFields=function(){return new Set([this.transform.impute])};t.prototype.processSequence=function(e){var t=e.start,n=t===void 0?0:t,r=e.stop,i=e.step;var a=__spreadArray([n,r],i?[i]:[],true).join(",");return{signal:"sequence(".concat(a,")")}};t.makeFromTransform=function(e,n){return new t(e,n)};t.makeFromEncoding=function(e,n){var r=n.encoding;var i=r.x;var a=r.y;if(A4(i)&&A4(a)){var o=i.impute?i:a.impute?a:undefined;if(o===undefined){return undefined}var u=i.impute?a:a.impute?i:undefined;var s=o.impute,l=s.method,f=s.value,c=s.frame,d=s.keyvals;var h=T8(n.mark,r);return new t(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},l?{method:l}:{}),f!==undefined?{value:f}:{}),c?{frame:c}:{}),d!==undefined?{keyvals:d}:{}),h.length?{groupby:h}:{}))}return null};t.prototype.hash=function(){return"Impute ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.impute,n=e.key,r=e.keyvals,i=e.method,a=e.groupby,o=e.value,u=e.frame,s=u===void 0?[null,null]:u;var l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:Y7(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){var f=Object.assign({type:"window",as:["imputed_".concat(t,"_value")],ops:[i],fields:[t],frame:s,ignorePeers:false},a?{groupby:a}:{});var c={type:"formula",expr:"datum.".concat(t," === null ? datum.imputed_").concat(t,"_value : datum.").concat(t),as:t};return[l,f,c]}else{return[l]}};return t}(lte);var Zoe=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var Koe=function(e){Ee(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=RZ(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:n.on,(o=u[1])!==null&&o!==void 0?o:n.loess];return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArray([this.transform.loess,this.transform.on],(e=this.transform.groupby)!==null&&e!==void 0?e:[],true))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"LoessTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.loess,n=e.on,r=Zoe(e,["loess","on"]);var i=Object.assign({type:"loess",x:n,y:t},r);return i};return t}(lte);var eue=function(e){Ee(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.transform=n;i.secondary=r;return i}t.prototype.clone=function(){return new t(null,RZ(this.transform),this.secondary)};t.make=function(e,n,r,i){var a=n.component.data.sources;var o=r.from;var u=null;if(J7(o)){var s=Oue(o.data,a);if(!s){s=new Zie(o.data);a.push(s)}var l=n.getName("lookup_".concat(i));u=new fte(s,l,Zee.Lookup,n.component.data.outputNodeRefCounts);n.component.data.outputNodes[l]=u}else if(Q7(o)){var f=o.param;r=Object.assign({as:f},r);var c=void 0;try{c=n.getSelectionComponent(uK(f),f)}catch(Bse){throw new Error(c2(f))}u=c.materialized;if(!u){throw new Error(d2(f))}}return new t(e,r,u.getSource())};t.prototype.dependentFields=function(){return new Set([this.transform.lookup])};t.prototype.producedFields=function(){return new Set(this.transform.as?tn(this.transform.as):this.transform.from.fields)};t.prototype.hash=function(){return"Lookup ".concat(WZ({transform:this.transform,secondary:this.secondary}))};t.prototype.assemble=function(){var e;if(this.transform.from.fields){e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:tn(this.transform.as)}:{})}else{var t=this.transform.as;if(!Cn(t)){k3(w2);t="_lookup"}e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})};return t}(lte);var tue=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var nue=function(e){Ee(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=RZ(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:"prob",(o=u[1])!==null&&o!==void 0?o:"value"];return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArray([this.transform.quantile],(e=this.transform.groupby)!==null&&e!==void 0?e:[],true))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"QuantileTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.quantile,n=tue(e,["quantile"]);var r=Object.assign({type:"quantile",field:t},n);return r};return t}(lte);var rue=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};var iue=function(e){Ee(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=RZ(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:n.on,(o=u[1])!==null&&o!==void 0?o:n.regression];return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArray([this.transform.regression,this.transform.on],(e=this.transform.groupby)!==null&&e!==void 0?e:[],true))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"RegressionTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.regression,n=e.on,r=rue(e,["regression","on"]);var i=Object.assign({type:"regression",x:n,y:t},r);return i};return t}(lte);var aue=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.addDimensions=function(e){var t;this.transform.groupby=JZ(((t=this.transform.groupby)!==null&&t!==void 0?t:[]).concat(e),(function(e){return e}))};t.prototype.producedFields=function(){return undefined};t.prototype.dependentFields=function(){var e;return new Set(__spreadArray([this.transform.pivot,this.transform.value],(e=this.transform.groupby)!==null&&e!==void 0?e:[],true))};t.prototype.hash=function(){return"PivotTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,i=e.limit,a=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==undefined?{limit:i}:{}),a!==undefined?{op:a}:{}),r!==undefined?{groupby:r}:{})};return t}(lte);var oue=function(e){Ee(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,RZ(this.transform))};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"SampleTransform ".concat(WZ(this.transform))};t.prototype.assemble=function(){return{type:"sample",size:this.transform.sample}};return t}(lte);function uue(e){var t=0;function n(r,i){var a,o,u;var s;if(r instanceof Zie){if(!r.isGenerator&&!Gee(r.data)){e.push(i);var l={name:null,source:i.name,transform:[]};i=l}}if(r instanceof Yie){if(r.parent instanceof Zie&&!i.source){i.format=Object.assign(Object.assign({},(s=i.format)!==null&&s!==void 0?s:{}),{parse:r.assembleFormatParse()});(a=i.transform).push.apply(a,r.assembleTransforms(true))}else{(o=i.transform).push.apply(o,r.assembleTransforms())}}if(r instanceof qie){if(!i.name){i.name="data_".concat(t++)}if(!i.source||i.transform.length>0){e.push(i);r.data=i.name}else{r.data=i.source}e.push.apply(e,r.assemble());return}if(r instanceof Jie||r instanceof Qie||r instanceof $oe||r instanceof Lne||r instanceof vre||r instanceof Joe||r instanceof Uie||r instanceof eue||r instanceof _ae||r instanceof mae||r instanceof Yoe||r instanceof Voe||r instanceof Goe||r instanceof Koe||r instanceof nue||r instanceof iue||r instanceof Xie||r instanceof oue||r instanceof aue){i.transform.push(r.assemble())}if(r instanceof Rie||r instanceof dte||r instanceof Qoe||r instanceof xae||r instanceof Xoe){(u=i.transform).push.apply(u,r.assemble())}if(r instanceof fte){if(i.source&&i.transform.length===0){r.setSource(i.source)}else if(r.parent instanceof fte){r.setSource(i.name)}else{if(!i.name){i.name="data_".concat(t++)}r.setSource(i.name);if(r.numChildren()===1){e.push(i);var l={name:null,source:i.name,transform:[]};i=l}}}switch(r.numChildren()){case 0:if(r instanceof fte&&(!i.source||i.transform.length>0)){e.push(i)}break;case 1:n(r.children[0],i);break;default:{if(!i.name){i.name="data_".concat(t++)}var f=i.name;if(!i.source||i.transform.length>0){e.push(i)}else{f=i.source}for(var c=0,d=r.children;c<d.length;c++){var h=d[c];var l={name:null,source:f,transform:[]};n(h,l)}break}}}return n}function sue(e){var t=[];var n=uue(t);for(var r=0,i=e.children;r<i.length;r++){var a=i[r];n(a,{source:e.name,name:null,transform:[]})}return t}function lue(e,t){var n,r;var i=[];var a=uue(i);var o=0;for(var u=0,s=e.sources;u<s.length;u++){var l=s[u];if(!l.hasName()){l.dataName="source_".concat(o++)}var f=l.assemble();a(l,f)}for(var c=0,d=i;c<d.length;c++){var h=d[c];if(h.transform.length===0){delete h.transform}}var p=0;for(var v=0,g=i.entries();v<g.length;v++){var m=g[v],y=m[0],h=m[1];if(((n=h.transform)!==null&&n!==void 0?n:[]).length===0&&!h.source){i.splice(p++,0,i.splice(y,1)[0])}}for(var b=0,x=i;b<x.length;b++){var h=x[b];for(var _=0,w=(r=h.transform)!==null&&r!==void 0?r:[];_<w.length;_++){var A=w[_];if(A.type==="lookup"){A.from=e.outputNodes[A.from].getSource()}}}for(var O=0,E=i;O<E.length;O++){var h=E[O];if(h.name in t){h.values=t[h.name]}}return i}function fue(e){if(e==="top"||e==="left"||E1(e)){return"header"}return"footer"}function cue(e){for(var t=0,n=b0;t<n.length;t++){var r=n[t];due(e,r)}pue(e,"x");pue(e,"y")}function due(e,t){var n;var r;var i=e.facet,a=e.config,o=e.child,u=e.component;if(e.channelHasField(t)){var s=i[t];var l=yre("title",null,a,t);var f=V4(s,a,{allowDisabling:true,includeDefault:l===undefined||!!l});if(o.component.layoutHeaders[t].title){f=St(f)?f.join(", "):f;f+=" / ".concat(o.component.layoutHeaders[t].title);o.component.layoutHeaders[t].title=null}var c=yre("labelOrient",s.header,a,t);var d=s.header!==null?yK((r=s.header)===null||r===void 0?void 0:r.labels,a.header.labels,true):false;var h=GZ(["bottom","right"],c)?"footer":"header";u.layoutHeaders[t]=(n={title:s.header!==null?f:null,facetFieldDef:s},n[h]=t==="facet"?[]:[hue(e,t,d)],n)}}function hue(e,t,n){var r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):undefined,axes:[]}}function pue(e,t){var n;var r=e.child;if(r.component.axes[t]){var i=e.component,a=i.layoutHeaders,o=i.resolve;o.axis[t]=Ire(o,t);if(o.axis[t]==="shared"){var u=t==="x"?"column":"row";var s=a[u];for(var l=0,f=r.component.axes[t];l<f.length;l++){var c=f[l];var d=fue(c.get("orient"));(n=s[d])!==null&&n!==void 0?n:s[d]=[hue(e,u,false)];var h=Yne(c,"main",e.config,{header:true});if(h){s[d][0].axes.push(h)}c.mainExtracted=true}}}}function vue(e){mue(e);yue(e,"width");yue(e,"height")}function gue(e){mue(e);var t=e.layout.columns===1?"width":"childWidth";var n=e.layout.columns===undefined?"height":"childHeight";yue(e,t);yue(e,n)}function mue(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.parseLayoutSize()}}function yue(e,t){var n;var r=Pre(t);var i=W0(r);var a=e.component.resolve;var o=e.component.layoutSize;var u;for(var s=0,l=e.children;s<l.length;s++){var f=l[s];var c=f.component.layoutSize.getWithExplicit(r);var d=(n=a.scale[i])!==null&&n!==void 0?n:Lre(i,e);if(d==="independent"&&c.value==="step"){u=undefined;break}if(u){if(d==="independent"&&u.value!==c.value){u=undefined;break}u=Wee(u,c,r,"")}else{u=c}}if(u){for(var h=0,p=e.children;h<p.length;h++){var f=p[h];e.renameSignal(f.getName(r),e.getName(t));f.component.layoutSize.set(r,"merged",false)}o.setWithExplicit(t,u)}else{o.setWithExplicit(t,{explicit:false,value:undefined})}}function bue(e){var t=e.size,n=e.component;for(var r=0,i=L0;r<i.length;r++){var a=i[r];var o=j0(a);if(t[o]){var u=t[o];n.layoutSize.set(o,I9(u)?"step":u,true)}else{var s=xue(e,o);n.layoutSize.set(o,s,false)}}}function xue(e,t){var n=t==="width"?"x":"y";var r=e.config;var i=e.getScaleComponent(n);if(i){var a=i.get("type");var o=i.get("range");if(z5(a)){var u=X9(r.view,t);if(k1(o)||I9(u)){return"step"}else{return u}}else{return V9(r.view,t)}}else if(e.hasProjection||e.mark==="arc"){return V9(r.view,t)}else{var u=X9(r.view,t);return I9(u)?u.step:u}}function _ue(e,t,n){return P4(t,Object.assign({suffix:"by_".concat(P4(e))},n!==null&&n!==void 0?n:{}))}var wue=function(e){Ee(t,e);function t(t,n,r,i){var a=e.call(this,t,"facet",n,r,i,t.resolve)||this;a.child=kse(t.spec,a,a.getName("child"),undefined,i);a.children=[a.child];a.facet=a.initFacet(t.facet);return a}t.prototype.initFacet=function(e){if(!s4(e)){return{facet:this.initFacetFieldDef(e,"facet")}}var t=rK(e);var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];if(![DK,CK].includes(a)){k3(z2(a,"facet"));break}var o=e[a];if(o.field===undefined){k3(N2(o,a));break}n[a]=this.initFacetFieldDef(o,a)}return n};t.prototype.initFacetFieldDef=function(e,t){var n=r8(e,t);if(n.header){n.header=_1(n.header)}else if(n.header===null){n.header=null}return n};t.prototype.channelHasField=function(e){return!!this.facet[e]};t.prototype.fieldDef=function(e){return this.facet[e]};t.prototype.parseData=function(){this.component.data=Due(this);this.child.parseData()};t.prototype.parseLayoutSize=function(){mue(this)};t.prototype.parseSelections=function(){this.child.parseSelections();this.component.selection=this.child.component.selection};t.prototype.parseMarkGroup=function(){this.child.parseMarkGroup()};t.prototype.parseAxesAndHeaders=function(){this.child.parseAxesAndHeaders();cue(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.child.assembleSelectionTopLevelSignals(e)};t.prototype.assembleSignals=function(){this.child.assembleSignals();return[]};t.prototype.assembleSelectionData=function(e){return this.child.assembleSelectionData(e)};t.prototype.getHeaderLayoutMixins=function(){var e,t,n;var r={};for(var i=0,a=b0;i<a.length;i++){var o=a[i];for(var u=0,s=_re;u<s.length;u++){var l=s[u];var f=this.component.layoutHeaders[o];var c=f[l];var d=f.facetFieldDef;if(d){var h=yre("titleOrient",d.header,this.config,o);if(["right","bottom"].includes(h)){var p=mre(o,h);(e=r.titleAnchor)!==null&&e!==void 0?e:r.titleAnchor={};r.titleAnchor[p]="end"}}if(c===null||c===void 0?void 0:c[0]){var v=o==="row"?"height":"width";var g=l==="header"?"headerBand":"footerBand";if(o!=="facet"&&!this.child.component.layoutSize.get(v)){(t=r[g])!==null&&t!==void 0?t:r[g]={};r[g][o]=.5}if(f.title){(n=r.offset)!==null&&n!==void 0?n:r.offset={};r.offset[o==="row"?"rowTitle":"columnTitle"]=10}}}}return r};t.prototype.assembleDefaultLayout=function(){var e=this.facet,t=e.column,n=e.row;var r=t?this.columnDistinctSignal():n?1:undefined;var i="all";if(!n&&this.component.resolve.scale.x==="independent"){i="none"}else if(!t&&this.component.resolve.scale.y==="independent"){i="none"}return Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})};t.prototype.assembleLayoutSignals=function(){return this.child.assembleLayoutSignals()};t.prototype.columnDistinctSignal=function(){if(this.parent&&this.parent instanceof t){return undefined}else{var e=this.getName("column_domain");return{signal:"length(data('".concat(e,"'))")}}};t.prototype.assembleGroupStyle=function(){return undefined};t.prototype.assembleGroup=function(n){if(this.parent&&this.parent instanceof t){return Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:P4(this.facet.column,{prefix:"distinct"})}}}}:{}),e.prototype.assembleGroup.call(this,n))}return e.prototype.assembleGroup.call(this,n)};t.prototype.getCardinalityAggregateForChild=function(){var e=[];var n=[];var r=[];if(this.child instanceof t){if(this.child.channelHasField("column")){var i=P4(this.child.facet.column);e.push(i);n.push("distinct");r.push("distinct_".concat(i))}}else{for(var a=0,o=L0;a<o.length;a++){var u=o[a];var s=this.child.component.scales[u];if(s&&!s.merged){var l=s.get("type");var f=s.get("range");if(z5(l)&&k1(f)){var c=Yae(this.child,u);var d=Vae(c);if(d){e.push(d);n.push("distinct");r.push("distinct_".concat(d))}else{k3(r2(u))}}}}}return{fields:e,ops:n,as:r}};t.prototype.assembleFacet=function(){var e=this.component.data.facetRoot,t=e.name,n=e.data;var r=this.facet,i=r.row,a=r.column;var o=this.getCardinalityAggregateForChild(),u=o.fields,s=o.ops,l=o.as;var f=[];for(var c=0,d=b0;c<d.length;c++){var h=d[c];var p=this.facet[h];if(p){f.push(P4(p));var v=p.bin,g=p.sort;if(v1(v)){f.push(P4(p,{binSuffix:"end"}))}if(o4(g)){var m=g.field,y=g.op,b=y===void 0?n4:y;var x=_ue(p,g);if(i&&a){u.push(x);s.push("max");l.push(x)}else{u.push(m);s.push(b);l.push(x)}}else if(St(g)){var x=gre(p,h);u.push(x);s.push("max");l.push(x)}}}var _=!!i&&!!a;return Object.assign({name:t,data:n,groupby:f},_||u.length>0?{aggregate:Object.assign(Object.assign({},_?{cross:_}:{}),u.length?{fields:u,ops:s,as:l}:{})}:{})};t.prototype.facetSortFields=function(e){var t=this.facet;var n=t[e];if(n){if(o4(n.sort)){return[_ue(n,n.sort,{expr:"datum"})]}else if(St(n.sort)){return[gre(n,e,{expr:"datum"})]}return[P4(n,{expr:"datum"})]}return[]};t.prototype.facetSortOrder=function(e){var t=this.facet;var n=t[e];if(n){var r=n.sort;var i=(o4(r)?r.order:!St(r)&&r)||"ascending";return[i]}return[]};t.prototype.assembleLabelTitle=function(){var e;var t=this,n=t.facet,r=t.config;if(n.facet){return Dre(n.facet,"facet",r)}var i={row:["top","bottom"],column:["left","right"]};for(var a=0,o=xre;a<o.length;a++){var u=o[a];if(n[u]){var s=yre("labelOrient",(e=n[u])===null||e===void 0?void 0:e.header,r,u);if(i[u].includes(s)){return Dre(n[u],u,r)}}}return undefined};t.prototype.assembleMarks=function(){var e=this;var t=this.child;var n=this.component.data.facetRoot;var r=sue(n);var i=t.assembleGroupEncodeEntry(false);var a=this.assembleLabelTitle()||t.assembleTitle();var o=t.assembleGroupStyle();var u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:b0.map((function(t){return e.facetSortFields(t)})).flat(),order:b0.map((function(t){return e.facetSortOrder(t)})).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(nte(this,[])));return[u]};t.prototype.getMapping=function(){return this.facet};return t}(Woe);function Aue(e,t){var n=t.row,r=t.column;if(n&&r){var i=null;for(var a=0,o=[n,r];a<o.length;a++){var u=o[a];if(o4(u.sort)){var s=u.sort,l=s.field,f=s.op,c=f===void 0?n4:f;e=i=new mae(e,{joinaggregate:[{op:c,field:l,as:_ue(u,u.sort,{forAs:true})}],groupby:[P4(u)]})}}return i}return null}function Oue(e,t){var n,r,i,a;for(var o=0,u=t;o<u.length;o++){var s=u[o];var l=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName){continue}var f=(n=e["format"])===null||n===void 0?void 0:n.mesh;var c=(r=l.format)===null||r===void 0?void 0:r.feature;if(f&&c){continue}var d=(i=e["format"])===null||i===void 0?void 0:i.feature;if((d||c)&&d!==c){continue}var h=(a=l.format)===null||a===void 0?void 0:a.mesh;if((f||h)&&f!==h){continue}if($ee(e)&&$ee(l)){if(PZ(e.values,l.values)){return s}}else if(Gee(e)&&Gee(l)){if(e.url===l.url){return s}}else if(Vee(e)){if(e.name===s.dataName){return s}}}return null}function Eue(e,t){if(e.data||!e.parent){if(e.data===null){var n=new Zie({values:[]});t.push(n);return n}var r=Oue(e.data,t);if(r){if(!Yee(e.data)){r.data.format=YZ({},e.data.format,r.data.format)}if(!r.hasName()&&e.data.name){r.dataName=e.data.name}return r}else{var i=new Zie(e.data);t.push(i);return i}}else{return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}}function kue(e,t,n){var r;var i,a;var o=0;for(var u=0,s=t.transforms;u<s.length;u++){var l=s[u];var f=undefined;var c=void 0;if(uee(l)){c=e=new vre(e,l);f="derived"}else if(V7(l)){var d=Gie(l);c=e=(i=Yie.makeWithAncestors(e,{},d,n))!==null&&i!==void 0?i:e;e=new Lne(e,t,l.filter)}else if(see(l)){c=e=Rie.makeFromTransform(e,l,t);f="number"}else if(fee(l)){f="date";var h=n.getWithExplicit(l.field);if(h.value===undefined){e=new Yie(e,(r={},r[l.field]=f,r));n.set(l.field,f,false)}c=e=dte.makeFromTransform(e,l)}else if(cee(l)){c=e=Uie.makeFromTransform(e,l);f="number";if(Nne(t)){e=new Xie(e)}}else if(X7(l)){c=e=eue.make(e,t,l,o++);f="derived"}else if(iee(l)){c=e=new _ae(e,l);f="number"}else if(aee(l)){c=e=new mae(e,l);f="number"}else if(dee(l)){c=e=xae.makeFromTransform(e,l);f="derived"}else if(hee(l)){c=e=new Yoe(e,l);f="derived"}else if(oee(l)){c=e=new Voe(e,l);f="derived"}else if(Z7(l)){c=e=new aue(e,l);f="derived"}else if(ree(l)){e=new oue(e,l)}else if(lee(l)){c=e=Qoe.makeFromTransform(e,l);f="derived"}else if(K7(l)){c=e=new Goe(e,l);f="derived"}else if(eee(l)){c=e=new nue(e,l);f="derived"}else if(tee(l)){c=e=new iue(e,l);f="derived"}else if(nee(l)){c=e=new Koe(e,l);f="derived"}else{k3(_2(l));continue}if(c&&f!==undefined){for(var p=0,v=(a=c.producedFields())!==null&&a!==void 0?a:[];p<v.length;p++){var g=v[p];n.set(g,f,false)}}}return e}function Due(e){var t,n,r,i,a,o,u,s,l,f;var c=Eue(e,e.component.data.sources);var d=e.component.data,h=d.outputNodes,p=d.outputNodeRefCounts;var v=e.data;var g=v&&(Yee(v)||Gee(v)||$ee(v));var m=!g&&e.parent?e.parent.component.data.ancestorParse.clone():new Hee;if(Yee(v)){if(Xee(v)){c=new Qie(c,v.sequence)}else if(Qee(v)){c=new Jie(c,v.graticule)}m.parseNothing=true}else if(((t=v===null||v===void 0?void 0:v.format)===null||t===void 0?void 0:t.parse)===null){m.parseNothing=true}c=(n=Yie.makeExplicit(c,e,m))!==null&&n!==void 0?n:c;c=new Xie(c);var y=e.parent&&Uoe(e.parent);if(Roe(e)||Loe(e)){if(y){c=(r=Rie.makeFromEncoding(c,e))!==null&&r!==void 0?r:c}}if(e.transforms.length>0){c=kue(c,e,m)}var b=Vie(e);var x=$ie(e);c=(i=Yie.makeWithAncestors(c,{},Object.assign(Object.assign({},b),x),m))!==null&&i!==void 0?i:c;if(Roe(e)){c=Xoe.parseAll(c,e);c=Joe.parseAll(c,e)}if(Roe(e)||Loe(e)){if(!y){c=(a=Rie.makeFromEncoding(c,e))!==null&&a!==void 0?a:c}c=(o=dte.makeFromEncoding(c,e))!==null&&o!==void 0?o:c;c=vre.parseAllForSortIndex(c,e)}var _=e.getDataName(Zee.Raw);var w=new fte(c,_,Zee.Raw,p);h[_]=w;c=w;if(Roe(e)){var A=Uie.makeFromEncoding(c,e);if(A){c=A;if(Nne(e)){c=new Xie(c)}}c=(u=Qoe.makeFromEncoding(c,e))!==null&&u!==void 0?u:c;c=(s=xae.makeFromEncoding(c,e))!==null&&s!==void 0?s:c}if(Roe(e)){c=(l=$oe.make(c,e))!==null&&l!==void 0?l:c}var O=e.getDataName(Zee.Main);var E=new fte(c,O,Zee.Main,p);h[O]=E;c=E;if(Roe(e)){Wne(e,E)}var k=null;if(Loe(e)){var D=e.getName("facet");c=(f=Aue(c,e.facet))!==null&&f!==void 0?f:c;k=new qie(c,e,D,E.getSource());h[D]=k}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:p,raw:w,main:E,facetRoot:k,ancestorParse:m})}var Cue=function(e){Ee(t,e);function t(t,n,r,i){var a=this;var o,u,s,l;a=e.call(this,t,"concat",n,r,i,t.resolve)||this;if(((u=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||u===void 0?void 0:u.x)==="shared"||((l=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||l===void 0?void 0:l.y)==="shared"){k3(m2)}a.children=a.getChildren(t).map((function(e,t){return kse(e,a,a.getName("concat_".concat(t)),undefined,i)}));return a}t.prototype.parseData=function(){this.component.data=Due(this);for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseData()}};t.prototype.parseSelections=function(){this.component.selection={};for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseSelections();for(var r=0,i=rK(n.component.selection);r<i.length;r++){var a=i[r];this.component.selection[a]=n.component.selection[a]}}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxesAndHeaders=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseAxesAndHeaders()}};t.prototype.getChildren=function(e){if(P9(e)){return e.vconcat}else if(R9(e)){return e.hconcat}return e.concat};t.prototype.parseLayoutSize=function(){gue(this)};t.prototype.parseAxisGroup=function(){return null};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)};t.prototype.assembleSignals=function(){this.children.forEach((function(e){return e.assembleSignals()}));return[]};t.prototype.assembleLayoutSignals=function(){var e=Bre(this);for(var t=0,n=this.children;t<n.length;t++){var r=n[t];e.push.apply(e,r.assembleLayoutSignals())}return e};t.prototype.assembleSelectionData=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)};t.prototype.assembleMarks=function(){return this.children.map((function(e){var t=e.assembleTitle();var n=e.assembleGroupStyle();var r=e.assembleGroupEncodeEntry(false);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))};t.prototype.assembleGroupStyle=function(){return undefined};t.prototype.assembleDefaultLayout=function(){var e=this.layout.columns;return Object.assign(Object.assign({},e!=null?{columns:e}:{}),{bounds:"full",align:"each"})};return t}(qoe);function Fue(e){return e===false||e===null}var Sue=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},g8),{labelExpr:1,encode:1});var jue=rK(Sue);var Mue=function(e){Ee(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this)||this;i.explicit=t;i.implicit=n;i.mainExtracted=r;return i}t.prototype.clone=function(){return new t(RZ(this.explicit),RZ(this.implicit),this.mainExtracted)};t.prototype.hasAxisPart=function(e){if(e==="axis"){return true}if(e==="grid"||e==="title"){return!!this.get(e)}return!Fue(this.get(e))};t.prototype.hasOrientSignalRef=function(){return E1(this.explicit.orient)};return t}(Ree);function Bue(e,t,n){var r;var i=e.encoding,a=e.config;var o=(r=K4(i[t]))!==null&&r!==void 0?r:K4(i[S0(t)]);var u=e.axis(t)||{};var s=u.format,l=u.formatType;if(q6(l)){return Object.assign({text:V6({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:l,config:a})},n)}return n}function Nue(e){return L0.reduce((function(t,n){if(e.component.scales[n]){t[n]=[Uue(n,e)]}return t}),{})}var Tue={bottom:"top",top:"bottom",left:"right",right:"left"};function zue(e){var t;var n=e.component,r=n.axes,i=n.resolve;var a={top:0,bottom:0,right:0,left:0};for(var o=0,u=e.children;o<u.length;o++){var s=u[o];s.parseAxesAndHeaders();for(var l=0,f=rK(s.component.axes);l<f.length;l++){var c=f[l];i.axis[c]=Ire(e.component.resolve,c);if(i.axis[c]==="shared"){r[c]=Pue(r[c],s.component.axes[c]);if(!r[c]){i.axis[c]="independent";delete r[c]}}}}for(var d=0,h=L0;d<h.length;d++){var c=h[d];for(var p=0,v=e.children;p<v.length;p++){var s=v[p];if(!s.component.axes[c]){continue}if(i.axis[c]==="independent"){r[c]=((t=r[c])!==null&&t!==void 0?t:[]).concat(s.component.axes[c]);for(var g=0,m=s.component.axes[c];g<m.length;g++){var y=m[g];var b=y.getWithExplicit("orient"),x=b.value,_=b.explicit;if(E1(x)){continue}if(a[x]>0&&!_){var w=Tue[x];if(a[x]>a[w]){y.set("orient",w,false)}}a[x]++}}delete s.component.axes[c]}if(i.axis[c]==="independent"&&r[c]&&r[c].length>1){for(var A=0,O=r[c];A<O.length;A++){var E=O[A];if(!!E.get("grid")&&!E.explicit.grid){E.implicit.grid=false}}}}}function Pue(e,t){if(e){if(e.length!==t.length){return undefined}var n=e.length;for(var r=0;r<n;r++){var i=e[r];var a=t[r];if(!!i!==!!a){return undefined}else if(i&&a){var o=i.getWithExplicit("orient");var u=a.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value){return undefined}else{e[r]=Rue(i,a)}}}}else{return t.map((function(e){return e.clone()}))}return e}function Rue(e,t){var n=function(n){var r=Wee(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(function(e,t){switch(n){case"title":return Q1(e,t);case"gridScale":return{explicit:e.explicit,value:yK(e.value,t.value)}}return qee(e,t,n,"axis")}));e.setWithExplicit(n,r)};for(var r=0,i=jue;r<i.length;r++){var a=i[r];n(a)}return e}function Lue(e,t,n,r,i){if(t==="disable"){return n!==undefined}n=n||{};switch(t){case"titleAngle":case"labelAngle":return e===(E1(n.labelAngle)?n.labelAngle:OK(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===dre(r,i)){return true}}return e===n[t]}var Iue=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Uue(e,t){var n,r,i;var a=t.axis(e);var o=new Mue;var u=K4(t.encoding[e]);var s=t.mark,l=t.config;var f=(a===null||a===void 0?void 0:a.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||fre(e);var c=t.getScaleComponent(e).get("type");var d=Zne(e,c,f,t.config);var h=a!==undefined?!a:ere("disable",l.style,a===null||a===void 0?void 0:a.style,d).configValue;o.set("disable",h,a!==undefined);if(h){return o}a=a||{};var p=ire(u,a,e,l.style,d);var v={fieldOrDatumDef:u,axis:a,channel:e,model:t,scaleType:c,orient:f,labelAngle:p,mark:s,config:l};for(var g=0,m=jue;g<m.length;g++){var y=m[g];var b=y in tre?tre[y](v):y8(y)?a[y]:undefined;var x=b!==undefined;var _=Lue(b,y,a,t,e);if(x&&_){o.set(y,b,_)}else{var w=y8(y)&&y!=="values"?ere(y,l.style,a.style,d):{},A=w.configValue,O=A===void 0?undefined:A,E=w.configFrom,k=E===void 0?undefined:E;var D=O!==undefined;if(x&&!D){o.set(y,b,_)}else if(!(k==="vgAxisConfig")||Iue.has(y)&&D||h8(O)||E1(O)){o.set(y,O,false)}}}var C=(i=a.encoding)!==null&&i!==void 0?i:{};var F=p8.reduce((function(n,r){var i;if(!o.hasAxisPart(r)){return n}var a=Rre((i=C[r])!==null&&i!==void 0?i:{},t);var u=r==="labels"?Bue(t,e,a):a;if(u!==undefined&&!nK(u)){n[r]={update:u}}return n}),{});if(!nK(F)){o.set("encode",F,!!a.encoding||a.labelAngle!==undefined)}return o}function que(e){var t=e.encoding,n=e.size;for(var r=0,i=L0;r<i.length;r++){var a=i[r];var o=j0(a);if(I9(n[o])){if(k4(t[a])){delete n[o];k3(t3(o))}}}return n}function Wue(e,t,n){var r=_1(e);var i=H1("orient",r,n);r.orient=Vue(r.type,t,i);if(i!==undefined&&i!==r.orient){k3(G2(r.orient,i))}if(r.type==="bar"&&r.orient){var a=H1("cornerRadiusEnd",r,n);if(a!==undefined){var o=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:D6[r.orient];for(var u=0,s=o;u<s.length;u++){var l=s[u];r[l]=a}if(r.cornerRadiusEnd!==undefined){delete r.cornerRadiusEnd}}}var f=H1("opacity",r,n);if(f===undefined){r.opacity=Gue(r.type,t)}var c=H1("cursor",r,n);if(c===undefined){r.cursor=Hue(r,t,n)}return r}function Hue(e,t,n){if(t.href||e.href||H1("href",e,n)){return"pointer"}return e.cursor}function Gue(e,t){if(GZ([i6,s6,f6,c6],e)){if(!D8(t)){return.7}}return undefined}function $ue(e,t,n){var r=n.graticule;if(r){return false}var i=G1("filled",e,t);var a=e.type;return yK(i,a!==i6&&a!==r6&&a!==o6)}function Vue(e,t,n){switch(e){case i6:case f6:case c6:case u6:case a6:case n6:return undefined}var r=t.x,i=t.y,a=t.x2,o=t.y2;switch(e){case t6:if(A4(r)&&(g1(r.bin)||A4(i)&&i.aggregate&&!r.aggregate)){return"vertical"}if(A4(i)&&(g1(i.bin)||A4(r)&&r.aggregate&&!i.aggregate)){return"horizontal"}if(o||a){if(n){return n}if(!a){if(A4(r)&&r.type===y5&&!v1(r.bin)||D4(r)){return"horizontal"}}if(!o){if(A4(i)&&i.type===y5&&!v1(i.bin)||D4(i)){return"vertical"}}}case o6:if(a&&!(A4(r)&&g1(r.bin))&&o&&!(A4(i)&&g1(i.bin))){return undefined}case e6:if(o){if(A4(i)&&g1(i.bin)){return"horizontal"}else{return"vertical"}}else if(a){if(A4(r)&&g1(r.bin)){return"vertical"}else{return"horizontal"}}else if(e===o6){if(r&&!i){return"vertical"}else if(i&&!r){return"horizontal"}}case r6:case s6:{var u=k4(r);var s=k4(i);if(n){return n}else if(u&&!s){return e!=="tick"?"horizontal":"vertical"}else if(!u&&s){return e!=="tick"?"vertical":"horizontal"}else if(u&&s){var l=r;var f=i;var c=l.type===x5;var d=f.type===x5;if(c&&!d){return e!=="tick"?"vertical":"horizontal"}else if(!c&&d){return e!=="tick"?"horizontal":"vertical"}if(!l.aggregate&&f.aggregate){return e!=="tick"?"vertical":"horizontal"}else if(l.aggregate&&!f.aggregate){return e!=="tick"?"horizontal":"vertical"}return"vertical"}else{return undefined}}}return"vertical"}var Yue={vgMark:"arc",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Ite("x",e,{defaultPos:"mid"})),Ite("y",e,{defaultPos:"mid"})),Qte(e,"radius")),Qte(e,"theta"))}};var Xue={vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),$te("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),$te("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),sne(e))}};var Jue={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Qte(e,"x")),Qte(e,"y"))}};var Que={vgMark:"shape",encodeEntry:function(e){return Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding;var n=t.shape;var r=Object.assign({type:"geoshape",projection:e.projectionName()},n&&A4(n)&&n.type===w5?{field:P4(n,{expr:"datum"})}:{});return[r]}};var Zue={vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Qte(e,"x")),Qte(e,"y")),Cte(e,"url"))}};var Kue={vgMark:"line",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Ite("x",e,{defaultPos:"mid"})),Ite("y",e,{defaultPos:"mid"})),zte("size",e,{vgChannel:"strokeWidth"})),sne(e))}};var ese={vgMark:"trail",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Ite("x",e,{defaultPos:"mid"})),Ite("y",e,{defaultPos:"mid"})),zte("size",e)),sne(e))}};function tse(e,t){var n=e.config;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Ite("x",e,{defaultPos:"mid"})),Ite("y",e,{defaultPos:"mid"})),zte("size",e)),zte("angle",e)),nse(e,n,t))}function nse(e,t,n){if(n){return{shape:{value:n}}}return zte("shape",e)}var rse={vgMark:"symbol",encodeEntry:function(e){return tse(e)}};var ise={vgMark:"symbol",encodeEntry:function(e){return tse(e,"circle")}};var ase={vgMark:"symbol",encodeEntry:function(e){return tse(e,"square")}};var ose={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Qte(e,"x")),Qte(e,"y"))}};var use={vgMark:"rule",encodeEntry:function(e){var t=e.markDef;var n=t.orient;if(!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude){return{}}return Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),$te("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),$te("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),zte("size",e,{vgChannel:"strokeWidth"}))}};var sse={vgMark:"text",encodeEntry:function(e){var t=e.config,n=e.encoding;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),Ite("x",e,{defaultPos:"mid"})),Ite("y",e,{defaultPos:"mid"})),Cte(e)),zte("size",e,{vgChannel:"fontSize"})),zte("angle",e)),fne("align",lse(e.markDef,n,t))),fne("baseline",fse(e.markDef,n,t))),Ite("radius",e,{defaultPos:null})),Ite("theta",e,{defaultPos:null}))}};function lse(e,t,n){var r=H1("align",e,n);if(r===undefined){return"center"}return undefined}function fse(e,t,n){var r=H1("baseline",e,n);if(r===undefined){return"middle"}return undefined}var cse={vgMark:"rect",encodeEntry:function(e){var t;var n=e.config,r=e.markDef;var i=r.orient;var a=i==="horizontal"?"width":"height";var o=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ine(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Ite("x",e,{defaultPos:"mid",vgChannel:"xc"})),Ite("y",e,{defaultPos:"mid",vgChannel:"yc"})),zte("size",e,{defaultValue:dse(e),vgChannel:a})),(t={},t[o]=R1(H1("thickness",r,n)),t))}};function dse(e){var t;var n=e.config,r=e.markDef;var i=r.orient;var a=i==="horizontal"?"width":"height";var o=e.getScaleComponent(i==="horizontal"?"x":"y");var u=(t=H1("size",r,n,{vgChannel:a}))!==null&&t!==void 0?t:n.tick.bandSize;if(u!==undefined){return u}else{var s=o?o.get("range"):undefined;if(s&&k1(s)&&kn(s.step)){return s.step*3/4}var l=Y9(n.view,a);return l*3/4}}var hse={arc:Yue,area:Xue,bar:Jue,circle:ise,geoshape:Que,image:Zue,line:Kue,point:rse,rect:ose,rule:use,square:ase,text:sse,tick:cse,trail:ese};function pse(e){if(GZ([r6,e6,l6],e.mark)){var t=T8(e.mark,e.encoding);if(t.length>0){return gse(e,t)}}else if(e.mark===t6){var n=B1.some((function(t){return H1(t,e.markDef,e.config)}));if(e.stack&&!e.fieldDef("size")&&n){return yse(e)}}return xse(e)}var vse="faceted_path_";function gse(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:vse+e.requestDataName(Zee.Main),data:e.requestDataName(Zee.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:xse(e,{fromPrefix:vse})}]}var mse="stack_group_";function yse(e){var t;var n=xse(e,{fromPrefix:mse})[0];var r=e.scaleName(e.stack.fieldChannel);var i=function(t){if(t===void 0){t={}}return e.vgField(e.stack.fieldChannel,t)};var a=function(e,t){var n=[i({prefix:"min",suffix:"start",expr:t}),i({prefix:"max",suffix:"start",expr:t}),i({prefix:"min",suffix:"end",expr:t}),i({prefix:"max",suffix:"end",expr:t})];return"".concat(e,"(").concat(n.map((function(e){return"scale('".concat(r,"',").concat(e,")")})).join(","),")")};var o;var u;if(e.stack.fieldChannel==="x"){o=Object.assign(Object.assign({},IZ(n.encode.update,__spreadArray(["y","yc","y2","height"],B1,true))),{x:{signal:a("min","datum")},x2:{signal:a("max","datum")},clip:{value:true}});u={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}};n.encode.update=Object.assign(Object.assign({},UZ(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})}else{o=Object.assign(Object.assign({},IZ(n.encode.update,["x","xc","x2","width"])),{y:{signal:a("min","datum")},y2:{signal:a("max","datum")},clip:{value:true}});u={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}};n.encode.update=Object.assign(Object.assign({},UZ(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}})}for(var s=0,l=B1;s<l.length;s++){var f=l[s];var c=G1(f,e.markDef,e.config);if(n.encode.update[f]){o[f]=n.encode.update[f];delete n.encode.update[f]}else if(c){o[f]=R1(c)}if(c){n.encode.update[f]={value:0}}}var d=[];if(((t=e.stack.groupbyChannels)===null||t===void 0?void 0:t.length)>0){for(var h=0,p=e.stack.groupbyChannels;h<p.length;h++){var v=p[h];var g=e.fieldDef(v);var m=P4(g);if(m){d.push(m)}if((g===null||g===void 0?void 0:g.bin)||(g===null||g===void 0?void 0:g.timeUnit)){d.push(P4(g,{binSuffix:"end"}))}}}var y=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"];o=y.reduce((function(t,r){var i,a;if(n.encode.update[r]){return Object.assign(Object.assign({},t),(i={},i[r]=n.encode.update[r],i))}else{var o=G1(r,e.markDef,e.config);if(o!==undefined){return Object.assign(Object.assign({},t),(a={},a[r]=R1(o),a))}else{return t}}}),o);if(o.stroke){o.strokeForeground={value:true};o.strokeOffset={value:0}}return[{type:"group",from:{facet:{data:e.requestDataName(Zee.Main),name:mse+e.requestDataName(Zee.Main),groupby:d,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:u},marks:[n]}]}]}function bse(e){var t;var n=e.encoding,r=e.stack,i=e.mark,a=e.markDef,o=e.config;var u=n.order;if(!St(u)&&S4(u)&&HZ(u.value)||!u&&HZ(H1("order",a,o))){return undefined}else if((St(u)||A4(u))&&!r){return Y1(u,{expr:"datum"})}else if(h6(i)){var s=a.orient==="horizontal"?"y":"x";var l=n[s];if(A4(l)){var f=l.sort;if(St(f)){return{field:P4(l,{prefix:s,suffix:"sort_index",expr:"datum"})}}else if(o4(f)){return{field:P4({aggregate:D8(e.encoding)?f.op:undefined,field:f.field},{expr:"datum"})}}else if(a4(f)){var c=e.fieldDef(f.encoding);return{field:P4(c,{expr:"datum"}),order:f.order}}else if(f===null){return undefined}else{return{field:P4(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":undefined,expr:"datum"})}}}return undefined}return undefined}function xse(e,t){if(t===void 0){t={fromPrefix:""}}var n=e.mark,r=e.markDef,i=e.encoding,a=e.config;var o=yK(r.clip,_se(e),wse(e));var u=W1(r);var s=i.key;var l=bse(e);var f=Ase(e);var c=H1("aria",r,a);var d=hse[n].postEncodingTransform?hse[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:hse[n].vgMark},o?{clip:true}:{}),u?{style:u}:{}),s?{key:s.field}:{}),l?{sort:l}:{}),f?f:{}),c===false?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(Zee.Main)},encode:{update:hse[n].encodeEntry(e)}}),d?{transform:d}:{})]}function _se(e){var t=e.getScaleComponent("x");var n=e.getScaleComponent("y");return(t===null||t===void 0?void 0:t.get("selectionExtent"))||(n===null||n===void 0?void 0:n.get("selectionExtent"))?true:undefined}function wse(e){var t=e.component.projection;return t&&!t.isFit?true:undefined}function Ase(e){if(!e.component.selection)return null;var t=rK(e.component.selection).length;var n=t;var r=e.parent;while(r&&n===0){n=rK(r.component.selection).length;r=r.parent}return n?{interactive:t>0||!!e.encoding.tooltip}:null}var Ose=function(e){Ee(t,e);function t(t,n,r,i,a){if(i===void 0){i={}}var o=this;var u;o=e.call(this,t,"unit",n,r,a,undefined,U9(t)?t.view:undefined)||this;o.specifiedScales={};o.specifiedAxes={};o.specifiedLegends={};o.specifiedProjection={};o.selection=[];o.children=[];var s=g6(t.mark)?Object.assign({},t.mark):{type:t.mark};var l=s.type;if(s.filled===undefined){s.filled=$ue(s,a,{graticule:t.data&&Qee(t.data)})}var f=o.encoding=S8(t.encoding||{},l,s.filled,a);o.markDef=Wue(s,f,a);o.size=que({encoding:f,size:U9(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i});o.stack=D7(l,f);o.specifiedScales=o.initScales(l,f);o.specifiedAxes=o.initAxes(f);o.specifiedLegends=o.initLegends(f);o.specifiedProjection=t.projection;o.selection=((u=t.params)!==null&&u!==void 0?u:[]).filter((function(e){return M9(e)}));return o}Object.defineProperty(t.prototype,"hasProjection",{get:function(){var e=this.encoding;var t=this.mark===d6;var n=e&&v0.some((function(t){return C4(e[t])}));return t||n},enumerable:false,configurable:true});t.prototype.scaleDomain=function(e){var t=this.specifiedScales[e];return t?t.domain:undefined};t.prototype.axis=function(e){return this.specifiedAxes[e]};t.prototype.legend=function(e){return this.specifiedLegends[e]};t.prototype.initScales=function(e,t){var n=this;return Q0.reduce((function(e,r){var i;var a=K4(t[r]);if(a){e[r]=n.initScale((i=a.scale)!==null&&i!==void 0?i:{})}return e}),{})};t.prototype.initScale=function(e){var t=e.domain,n=e.range;var r=_1(e);if(St(t)){r.domain=t.map(z1)}if(St(n)){r.range=n.map(z1)}return r};t.prototype.initAxes=function(e){var t=this;return L0.reduce((function(n,r){var i=e[r];if(C4(i)||r===SK&&C4(e.x2)||r===jK&&C4(e.y2)){var a=C4(i)?i.axis:undefined;n[r]=a?t.initAxis(Object.assign({},a)):a}return n}),{})};t.prototype.initAxis=function(e){var t=rK(e);var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];var o=e[a];n[a]=h8(o)?T1(o):z1(o)}return n};t.prototype.initLegends=function(e){return V0.reduce((function(t,n){var r=K4(e[n]);if(r&&X0(n)){var i=r.legend;t[n]=i?_1(i):i}return t}),{})};t.prototype.parseData=function(){this.component.data=Due(this)};t.prototype.parseLayoutSize=function(){bue(this)};t.prototype.parseSelections=function(){this.component.selection=Ine(this,this.selection)};t.prototype.parseMarkGroup=function(){this.component.mark=pse(this)};t.prototype.parseAxesAndHeaders=function(){this.component.axes=Nue(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return rte(this,e)};t.prototype.assembleSignals=function(){return __spreadArray(__spreadArray([],Xne(this),true),tte(this,[]),true)};t.prototype.assembleSelectionData=function(e){return ite(this,e)};t.prototype.assembleLayout=function(){return null};t.prototype.assembleLayoutSignals=function(){return Bre(this)};t.prototype.assembleMarks=function(){var e;var t=(e=this.component.mark)!==null&&e!==void 0?e:[];if(!this.parent||!Uoe(this.parent)){t=ate(this,t)}return t.map(this.correctDataNames)};t.prototype.assembleGroupStyle=function(){var e=(this.view||{}).style;if(e!==undefined){return e}if(this.encoding.x||this.encoding.y){return"cell"}else{return undefined}};t.prototype.getMapping=function(){return this.encoding};Object.defineProperty(t.prototype,"mark",{get:function(){return this.markDef.type},enumerable:false,configurable:true});t.prototype.channelHasField=function(e){return O8(this.encoding,e)};t.prototype.fieldDef=function(e){var t=this.encoding[e];return Z4(t)};t.prototype.typedFieldDef=function(e){var t=this.fieldDef(e);if(F4(t)){return t}return null};return t}(Woe);var Ese=function(e){Ee(t,e);function t(n,r,i,a,o){var u=e.call(this,n,"layer",r,i,o,n.resolve,n.view)||this;var s=Object.assign(Object.assign(Object.assign({},a),n.width?{width:n.width}:{}),n.height?{height:n.height}:{});u.children=n.layer.map((function(e,n){if(v7(e)){return new t(e,u,u.getName("layer_".concat(n)),s,o)}else if(_8(e)){return new Ose(e,u,u.getName("layer_".concat(n)),s,o)}throw new Error(Z1(e))}));return u}t.prototype.parseData=function(){this.component.data=Due(this);for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseData()}};t.prototype.parseLayoutSize=function(){vue(this)};t.prototype.parseSelections=function(){this.component.selection={};for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseSelections();for(var r=0,i=rK(n.component.selection);r<i.length;r++){var a=i[r];this.component.selection[a]=n.component.selection[a]}}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxesAndHeaders=function(){zue(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)};t.prototype.assembleSignals=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleSignals())}),Xne(this))};t.prototype.assembleLayoutSignals=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLayoutSignals())}),Bre(this))};t.prototype.assembleSelectionData=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)};t.prototype.assembleGroupStyle=function(){var e=new Set;for(var t=0,n=this.children;t<n.length;t++){var r=n[t];for(var i=0,a=tn(r.assembleGroupStyle());i<a.length;i++){var o=a[i];e.add(o)}}var u=Array.from(e);return u.length>1?u:u.length===1?u[0]:undefined};t.prototype.assembleTitle=function(){var t=e.prototype.assembleTitle.call(this);if(t){return t}for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t=i.assembleTitle();if(t){return t}}return undefined};t.prototype.assembleLayout=function(){return null};t.prototype.assembleMarks=function(){return ote(this,this.children.flatMap((function(e){return e.assembleMarks()})))};t.prototype.assembleLegends=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLegends())}),bie(this))};return t}(qoe);function kse(e,t,n,r,i){if(f4(e)){return new wue(e,t,n,i)}else if(v7(e)){return new Ese(e,t,n,r,i)}else if(_8(e)){return new Ose(e,t,n,r,i)}else if(T9(e)){return new Cue(e,t,n,i)}throw new Error(Z1(e))}var Dse=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function Cse(e,t){if(t===void 0){t={}}if(t.logger){O3(t.logger)}if(t.fieldTitle){G4(t.fieldTitle)}try{var n=s7(Bt(t.config,e.config));var r=Dee(e,n);var i=kse(r,null,"",undefined,n);i.parse();Sae(i.component.data,i);var a=Sse(i,Fse(e,r.autosize,n,i),e.datasets,e.usermeta);return{spec:a,normalized:r}}finally{if(t.logger){E3()}if(t.fieldTitle){$4()}}}function Fse(e,t,n,r){var i=r.component.layoutSize.get("width");var a=r.component.layoutSize.get("height");if(t===undefined){t={type:"pad"};if(r.hasAxisOrientSignalRef()){t.resize=true}}else if(Cn(t)){t={type:t}}if(i&&a&&Nee(t.type)){if(i==="step"&&a==="step"){k3(n2());t.type="pad"}else if(i==="step"||a==="step"){var o=i==="step"?"width":"height";k3(n2(W0(o)));var u=o==="width"?"height":"width";t.type=Tee(u)}}return Object.assign(Object.assign(Object.assign({},rK(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),Pee(n,false)),Pee(e,true))}function Sse(e,t,n,r){if(n===void 0){n={}}var i=e.config?d7(e.config):undefined;var a=[].concat(e.assembleSelectionData([]),lue(e.component.data,n));var o=e.assembleProjections();var u=e.assembleTitle();var s=e.assembleGroupStyle();var l=e.assembleGroupEncodeEntry(true);var f=e.assembleLayoutSignals();f=f.filter((function(e){if((e.name==="width"||e.name==="height")&&e.value!==undefined){t[e.name]=+e.value;return false}return true}));var c=t.params,d=Dse(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),u?{title:u}:{}),s?{style:s}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup(__spreadArray(__spreadArray(__spreadArray([],f,true),e.assembleSelectionTopLevelSignals([]),true),N9(c),true))),i?{config:i}:{}),r?{usermeta:r}:{})}var jse=CZ.version;var Mse=Object.freeze({__proto__:null,version:jse,compile:Cse,normalize:Dee,deepEqual:PZ,duplicate:RZ,never:LZ,pick:IZ,omit:UZ,stringify:qZ,hash:WZ,isNullOrFalse:HZ,contains:GZ,some:$Z,every:VZ,mergeDeep:YZ,unique:JZ,isEqual:QZ,setEqual:ZZ,hasIntersection:KZ,prefixGenerator:eK,fieldIntersection:tK,isEmpty:nK,keys:rK,vals:iK,entries:aK,isBoolean:oK,varName:uK,logicalExpr:sK,deleteNestedProperty:lK,titleCase:fK,accessPathWithDatum:cK,flatAccessWithDatum:dK,replacePathInField:pK,replaceAll:vK,removePathFromField:gK,accessPathDepth:mK,getFirstDefined:yK,uniqueId:xK,resetIdCounter:_K,internalField:wK,isInternalField:AK,normalizeAngle:OK,isNumeric:EK});function Bse(e){var t=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3),n=t[0],r=t[1];return{library:n,version:r}}var Nse="vega-themes";var Tse="2.10.0";var zse="Themes for stylized Vega and Vega-Lite visualizations.";var Pse=["vega","vega-lite","themes","style"];var Rse="BSD-3-Clause";var Lse={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"};var Ise=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}];var Use="build/vega-themes.js";var qse="build/vega-themes.module.js";var Wse="build/vega-themes.min.js";var Hse="build/vega-themes.min.js";var Gse="build/vega-themes.module.d.ts";var $se={type:"git",url:"https://github.com/vega/vega-themes.git"};var Vse=["src","build"];var Yse={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"};var Xse={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"};var Jse={vega:"*","vega-lite":"*"};var Qse={name:Nse,version:Tse,description:zse,keywords:Pse,license:Rse,author:Lse,contributors:Ise,main:Use,module:qse,unpkg:Wse,jsdelivr:Hse,types:Gse,repository:$se,files:Vse,scripts:Yse,devDependencies:Xse,peerDependencies:Jse};var Zse="#fff";var Kse="#888";var ele={background:"#333",title:{color:Zse,subtitleColor:Zse},style:{"guide-label":{fill:Zse},"guide-title":{fill:Zse}},axis:{domainColor:Zse,gridColor:Kse,tickColor:Zse}};var tle="#4572a7";var nle={background:"#fff",arc:{fill:tle},area:{fill:tle},line:{stroke:tle,strokeWidth:2},path:{stroke:tle},rect:{fill:tle},shape:{stroke:tle},symbol:{fill:tle,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:true,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:false,tickExtra:true},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}};var rle="#30a2da";var ile="#cbcbcb";var ale="#999";var ole="#333";var ule="#f0f0f0";var sle="#333";var lle={arc:{fill:rle},area:{fill:rle},axis:{domainColor:ile,grid:true,gridColor:ile,gridWidth:1,labelColor:ale,labelFontSize:10,titleColor:ole,tickColor:ile,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:false},background:ule,group:{fill:ule},legend:{labelColor:sle,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:sle,titleFontSize:14,titlePadding:10},line:{stroke:rle,strokeWidth:2},path:{stroke:rle,strokeWidth:.5},rect:{fill:rle},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:true,shape:"circle"},shape:{stroke:rle},bar:{binSpacing:2,fill:rle,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}};var fle="#000";var cle={group:{fill:"#e5e5e5"},arc:{fill:fle},area:{fill:fle},line:{stroke:fle},path:{stroke:fle},rect:{fill:fle},shape:{stroke:fle},symbol:{fill:fle,size:40},axis:{domain:false,grid:true,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}};var dle=22;var hle="normal";var ple="Benton Gothic, sans-serif";var vle=11.5;var gle="normal";var mle="#82c6df";var yle="Benton Gothic Bold, sans-serif";var ble="normal";var xle=13;var _le={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]};var wle={background:"#ffffff",title:{anchor:"start",color:"#000000",font:yle,fontSize:dle,fontWeight:hle},arc:{fill:mle},area:{fill:mle},line:{stroke:mle,strokeWidth:2},path:{stroke:mle},rect:{fill:mle},shape:{stroke:mle},symbol:{fill:mle,size:30},axis:{labelFont:ple,labelFontSize:vle,labelFontWeight:gle,titleFont:yle,titleFontSize:xle,titleFontWeight:ble},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:ple,labelFontSize:vle,symbolType:"square",titleFont:yle,titleFontSize:xle,titleFontWeight:ble},range:{category:_le["category-6"],diverging:_le["fireandice-6"],heatmap:_le["fire-7"],ordinal:_le["fire-7"],ramp:_le["fire-7"]}};var Ale="#ab5787";var Ole="#979797";var Ele={background:"#f9f9f9",arc:{fill:Ale},area:{fill:Ale},line:{stroke:Ale},path:{stroke:Ale},rect:{fill:Ale},shape:{stroke:Ale},symbol:{fill:Ale,size:30},axis:{domainColor:Ole,domainWidth:.5,gridWidth:.2,labelColor:Ole,tickColor:Ole,tickWidth:.2,titleColor:Ole},axisBand:{grid:false},axisX:{grid:true,tickSize:10},axisY:{domain:false,grid:true,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}};var kle="#3e5c69";var Dle={background:"#fff",arc:{fill:kle},area:{fill:kle},line:{stroke:kle},path:{stroke:kle},rect:{fill:kle},shape:{stroke:kle},symbol:{fill:kle},axis:{domainWidth:.5,grid:true,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:false},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}};var Cle="#1696d2";var Fle="#000000";var Sle="#FFFFFF";var jle="Lato";var Mle="Lato";var Ble="Lato";var Nle="#DEDDDD";var Tle=18;var zle={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]};var Ple={background:Sle,title:{anchor:"start",fontSize:Tle,font:jle},axisX:{domain:true,domainColor:Fle,domainWidth:1,grid:false,labelFontSize:12,labelFont:Mle,labelAngle:0,tickColor:Fle,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:jle},axisY:{domain:false,domainWidth:1,grid:true,gridColor:Nle,gridWidth:1,labelFontSize:12,labelFont:Mle,labelPadding:8,ticks:false,titleFontSize:12,titlePadding:10,titleFont:jle,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Mle,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:jle,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:zle["six-groups-cat-1"],diverging:zle["diverging-colors"],heatmap:zle["diverging-colors"],ordinal:zle["six-groups-seq"],ramp:zle["shades-blue"]},area:{fill:Cle},rect:{fill:Cle},line:{color:Cle,stroke:Cle,strokeWidth:5},trail:{color:Cle,stroke:Cle,strokeWidth:0,size:1},path:{stroke:Cle,strokeWidth:.5},point:{filled:true},text:{font:Ble,color:Cle,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Cle,stroke:null}},arc:{fill:Cle},shape:{stroke:Cle},symbol:{fill:Cle,size:30}};var Rle="#3366CC";var Lle="#ccc";var Ile="Arial, sans-serif";var Ule={arc:{fill:Rle},area:{fill:Rle},path:{stroke:Rle},rect:{fill:Rle},shape:{stroke:Rle},symbol:{stroke:Rle},circle:{fill:Rle},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Ile,fontSize:12},"guide-title":{font:Ile,fontSize:12},"group-title":{font:Ile,fontSize:12}},title:{font:Ile,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Lle,tickColor:Lle,domain:false,grid:true},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}};var qle=Qse.version;var Wle=Object.freeze({__proto__:null,dark:ele,excel:nle,fivethirtyeight:lle,ggplot2:cle,googlecharts:Ule,latimes:wle,quartz:Ele,urbaninstitute:Ple,version:qle,vox:Dle});
/*! *****************************************************************************
      Copyright (c) Microsoft Corporation.

      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.

      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */function Hle(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n}function Gle(e,t,n){if(St(e)){return"[".concat(e.map((function(e){return t(Cn(e)?e:Vle(e,n))})).join(", "),"]")}if(jt(e)){var r="";var i=e,a=i.title,o=i.image,u=Hle(i,["title","image"]);if(a){r+="<h2>".concat(t(a),"</h2>")}if(o){r+='<img src="'.concat(t(o),'">')}var s=Object.keys(u);if(s.length>0){r+="<table>";for(var l=0,f=s;l<f.length;l++){var c=f[l];var d=u[c];if(d===undefined){continue}if(jt(d)){d=Vle(d,n)}r+='<tr><td class="key">'.concat(t(c),':</td><td class="value">').concat(t(d),"</td></tr>")}r+="</table>"}return r||"{}"}return t(e)}function $le(e){var t=[];return function(n,r){if(typeof r!=="object"||r===null){return r}var i=t.indexOf(this)+1;t.length=i;if(t.length>e){return"[Object]"}if(t.indexOf(r)>=0){return"[Circular]"}t.push(r);return r}}function Vle(e,t){return JSON.stringify(e,$le(t))}var Yle="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element img {\n  max-width: 200px;\n  max-height: 200px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n";var Xle="vg-tooltip-element";var Jle={offsetX:10,offsetY:10,id:Xle,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:false,sanitize:Qle,maxDepth:2,formatTooltip:Gle};function Qle(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function Zle(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e)){throw new Error("Invalid HTML ID")}return Yle.toString().replace(Xle,e)}function Kle(e,t,n,r){var i=e.clientX+n;if(i+t.width>window.innerWidth){i=+e.clientX-n-t.width}var a=e.clientY+r;if(a+t.height>window.innerHeight){a=+e.clientY-r-t.height}return{x:i,y:a}}var efe=function(){function e(e){this.options=Object.assign(Object.assign({},Jle),e);var t=this.options.id;this.el=null;this.call=this.tooltipHandler.bind(this);if(!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var n=document.createElement("style");n.setAttribute("id",this.options.styleId);n.innerHTML=Zle(t);var r=document.head;if(r.childNodes.length>0){r.insertBefore(n,r.childNodes[0])}else{r.appendChild(n)}}}e.prototype.tooltipHandler=function(e,t,n,r){var i;this.el=document.getElementById(this.options.id);if(!this.el){this.el=document.createElement("div");this.el.setAttribute("id",this.options.id);this.el.classList.add("vg-tooltip");var a=(i=document.fullscreenElement)!==null&&i!==void 0?i:document.body;a.appendChild(this.el)}if(r==null||r===""){this.el.classList.remove("visible","".concat(this.options.theme,"-theme"));return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth);this.el.classList.add("visible","".concat(this.options.theme,"-theme"));var o=Kle(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),u=o.x,s=o.y;this.el.setAttribute("style","top: ".concat(s,"px; left: ").concat(u,"px"))};return e}();function tfe(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}function nfe(e,t,n,r,i,a,o){try{var u=e[a](o);var s=u.value}catch(pt){n(pt);return}if(u.done){t(s)}else{Promise.resolve(s).then(r,i)}}function rfe(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){nfe(a,r,i,o,u,"next",e)}function u(e){nfe(a,r,i,o,u,"throw",e)}o(undefined)}))}}var ife=Object.prototype;var afe=ife.hasOwnProperty;var ofe;var ufe=typeof Symbol==="function"?Symbol:{};var sfe=ufe.iterator||"@@iterator";var lfe=ufe.asyncIterator||"@@asyncIterator";var ffe=ufe.toStringTag||"@@toStringTag";function cfe(e,t,n,r){var i=t&&t.prototype instanceof yfe?t:yfe;var a=Object.create(i.prototype);var o=new Tfe(r||[]);a._invoke=jfe(e,n,o);return a}function dfe(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}var hfe="suspendedStart";var pfe="suspendedYield";var vfe="executing";var gfe="completed";var mfe={};function yfe(){}function bfe(){}function xfe(){}var _fe={};_fe[sfe]=function(){return this};var wfe=Object.getPrototypeOf;var Afe=wfe&&wfe(wfe(Pfe([])));if(Afe&&Afe!==ife&&afe.call(Afe,sfe)){_fe=Afe}var Ofe=xfe.prototype=yfe.prototype=Object.create(_fe);bfe.prototype=Ofe.constructor=xfe;xfe.constructor=bfe;xfe[ffe]=bfe.displayName="GeneratorFunction";function Efe(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function kfe(e){var t=typeof e==="function"&&e.constructor;return t?t===bfe||(t.displayName||t.name)==="GeneratorFunction":false}function Dfe(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,xfe)}else{e.__proto__=xfe;if(!(ffe in e)){e[ffe]="GeneratorFunction"}}e.prototype=Object.create(Ofe);return e}function Cfe(e){return{__await:e}}function Ffe(e,t){function n(r,i,a,o){var u=dfe(e[r],e,i);if(u.type==="throw"){o(u.arg)}else{var s=u.arg;var l=s.value;if(l&&typeof l==="object"&&afe.call(l,"__await")){return t.resolve(l.__await).then((function(e){n("next",e,a,o)}),(function(e){n("throw",e,a,o)}))}return t.resolve(l).then((function(e){s.value=e;a(s)}),(function(e){return n("throw",e,a,o)}))}}var r;function i(e,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}this._invoke=i}Efe(Ffe.prototype);Ffe.prototype[lfe]=function(){return this};function Sfe(e,t,n,r,i){if(i===void 0)i=Promise;var a=new Ffe(cfe(e,t,n,r),i);return kfe(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))}function jfe(e,t,n){var r=hfe;return function i(a,o){if(r===vfe){throw new Error("Generator is already running")}if(r===gfe){if(a==="throw"){throw o}return Rfe()}n.method=a;n.arg=o;while(true){var u=n.delegate;if(u){var s=Mfe(u,n);if(s){if(s===mfe)continue;return s}}if(n.method==="next"){n.sent=n._sent=n.arg}else if(n.method==="throw"){if(r===hfe){r=gfe;throw n.arg}n.dispatchException(n.arg)}else if(n.method==="return"){n.abrupt("return",n.arg)}r=vfe;var l=dfe(e,t,n);if(l.type==="normal"){r=n.done?gfe:pfe;if(l.arg===mfe){continue}return{value:l.arg,done:n.done}}else if(l.type==="throw"){r=gfe;n.method="throw";n.arg=l.arg}}}}function Mfe(e,t){var n=e.iterator[t.method];if(n===ofe){t.delegate=null;if(t.method==="throw"){if(e.iterator["return"]){t.method="return";t.arg=ofe;Mfe(e,t);if(t.method==="throw"){return mfe}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return mfe}var r=dfe(n,e.iterator,t.arg);if(r.type==="throw"){t.method="throw";t.arg=r.arg;t.delegate=null;return mfe}var i=r.arg;if(!i){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return mfe}if(i.done){t[e.resultName]=i.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=ofe}}else{return i}t.delegate=null;return mfe}Efe(Ofe);Ofe[ffe]="Generator";Ofe[sfe]=function(){return this};Ofe.toString=function(){return"[object Generator]"};function Bfe(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function Nfe(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function Tfe(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(Bfe,this);this.reset(true)}function zfe(e){var t=[];for(var n in e){t.push(n)}t.reverse();return function n(){while(t.length){var r=t.pop();if(r in e){n.value=r;n.done=false;return n}}n.done=true;return n}}function Pfe(e){if(e){var t=e[sfe];if(t){return t.call(e)}if(typeof e.next==="function"){return e}if(!isNaN(e.length)){var n=-1,r=function t(){while(++n<e.length){if(afe.call(e,n)){t.value=e[n];t.done=false;return t}}t.value=ofe;t.done=true;return t};return r.next=r}}return{next:Rfe}}function Rfe(){return{value:ofe,done:true}}Tfe.prototype={constructor:Tfe,reset:function e(t){this.prev=0;this.next=0;this.sent=this._sent=ofe;this.done=false;this.delegate=null;this.method="next";this.arg=ofe;this.tryEntries.forEach(Nfe);if(!t){for(var n in this){if(n.charAt(0)==="t"&&afe.call(this,n)&&!isNaN(+n.slice(1))){this[n]=ofe}}}},stop:function e(){this.done=true;var t=this.tryEntries[0];var n=t.completion;if(n.type==="throw"){throw n.arg}return this.rval},dispatchException:function e(t){if(this.done){throw t}var n=this;function r(e,r){o.type="throw";o.arg=t;n.next=e;if(r){n.method="next";n.arg=ofe}return!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];var o=a.completion;if(a.tryLoc==="root"){return r("end")}if(a.tryLoc<=this.prev){var u=afe.call(a,"catchLoc");var s=afe.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc){return r(a.catchLoc,true)}else if(this.prev<a.finallyLoc){return r(a.finallyLoc)}}else if(u){if(this.prev<a.catchLoc){return r(a.catchLoc,true)}}else if(s){if(this.prev<a.finallyLoc){return r(a.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function e(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&afe.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}if(a&&(t==="break"||t==="continue")&&a.tryLoc<=n&&n<=a.finallyLoc){a=null}var o=a?a.completion:{};o.type=t;o.arg=n;if(a){this.method="next";this.next=a.finallyLoc;return mfe}return this.complete(o)},complete:function e(t,n){if(t.type==="throw"){throw t.arg}if(t.type==="break"||t.type==="continue"){this.next=t.arg}else if(t.type==="return"){this.rval=this.arg=t.arg;this.method="return";this.next="end"}else if(t.type==="normal"&&n){this.next=n}return mfe},finish:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t){this.complete(r.completion,r.afterLoc);Nfe(r);return mfe}}},catch:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var i=r.completion;if(i.type==="throw"){var a=i.arg;Nfe(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function e(t,n,r){this.delegate={iterator:Pfe(t),resultName:n,nextLoc:r};if(this.method==="next"){this.arg=ofe}return mfe}};var Lfe={wrap:cfe,isGeneratorFunction:kfe,AsyncIterator:Ffe,mark:Dfe,awrap:Cfe,async:Sfe,keys:zfe,values:Pfe};var Ife=Ufe;Ufe.Node=Gfe;Ufe.create=Ufe;function Ufe(e){var t=this;if(!(t instanceof Ufe)){t=new Ufe}t.tail=null;t.head=null;t.length=0;if(e&&typeof e.forEach==="function"){e.forEach((function(e){t.push(e)}))}else if(arguments.length>0){for(var n=0,r=arguments.length;n<r;n++){t.push(arguments[n])}}return t}Ufe.prototype.removeNode=function(e){if(e.list!==this){throw new Error("removing node which does not belong to this list")}var t=e.next;var n=e.prev;if(t){t.prev=n}if(n){n.next=t}if(e===this.head){this.head=t}if(e===this.tail){this.tail=n}e.list.length--;e.next=null;e.prev=null;e.list=null;return t};Ufe.prototype.unshiftNode=function(e){if(e===this.head){return}if(e.list){e.list.removeNode(e)}var t=this.head;e.list=this;e.next=t;if(t){t.prev=e}this.head=e;if(!this.tail){this.tail=e}this.length++};Ufe.prototype.pushNode=function(e){if(e===this.tail){return}if(e.list){e.list.removeNode(e)}var t=this.tail;e.list=this;e.prev=t;if(t){t.next=e}this.tail=e;if(!this.head){this.head=e}this.length++};Ufe.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++){Wfe(this,arguments[e])}return this.length};Ufe.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++){Hfe(this,arguments[e])}return this.length};Ufe.prototype.pop=function(){if(!this.tail){return undefined}var e=this.tail.value;this.tail=this.tail.prev;if(this.tail){this.tail.next=null}else{this.head=null}this.length--;return e};Ufe.prototype.shift=function(){if(!this.head){return undefined}var e=this.head.value;this.head=this.head.next;if(this.head){this.head.prev=null}else{this.tail=null}this.length--;return e};Ufe.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++){e.call(t,n.value,r,this);n=n.next}};Ufe.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--){e.call(t,n.value,r,this);n=n.prev}};Ufe.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++){n=n.next}if(t===e&&n!==null){return n.value}};Ufe.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++){n=n.prev}if(t===e&&n!==null){return n.value}};Ufe.prototype.map=function(e,t){t=t||this;var n=new Ufe;for(var r=this.head;r!==null;){n.push(e.call(t,r.value,this));r=r.next}return n};Ufe.prototype.mapReverse=function(e,t){t=t||this;var n=new Ufe;for(var r=this.tail;r!==null;){n.push(e.call(t,r.value,this));r=r.prev}return n};Ufe.prototype.reduce=function(e,t){var n;var r=this.head;if(arguments.length>1){n=t}else if(this.head){r=this.head.next;n=this.head.value}else{throw new TypeError("Reduce of empty list with no initial value")}for(var i=0;r!==null;i++){n=e(n,r.value,i);r=r.next}return n};Ufe.prototype.reduceReverse=function(e,t){var n;var r=this.tail;if(arguments.length>1){n=t}else if(this.tail){r=this.tail.prev;n=this.tail.value}else{throw new TypeError("Reduce of empty list with no initial value")}for(var i=this.length-1;r!==null;i--){n=e(n,r.value,i);r=r.prev}return n};Ufe.prototype.toArray=function(){var e=new Array(this.length);for(var t=0,n=this.head;n!==null;t++){e[t]=n.value;n=n.next}return e};Ufe.prototype.toArrayReverse=function(){var e=new Array(this.length);for(var t=0,n=this.tail;n!==null;t++){e[t]=n.value;n=n.prev}return e};Ufe.prototype.slice=function(e,t){t=t||this.length;if(t<0){t+=this.length}e=e||0;if(e<0){e+=this.length}var n=new Ufe;if(t<e||t<0){return n}if(e<0){e=0}if(t>this.length){t=this.length}for(var r=0,i=this.head;i!==null&&r<e;r++){i=i.next}for(;i!==null&&r<t;r++,i=i.next){n.push(i.value)}return n};Ufe.prototype.sliceReverse=function(e,t){t=t||this.length;if(t<0){t+=this.length}e=e||0;if(e<0){e+=this.length}var n=new Ufe;if(t<e||t<0){return n}if(e<0){e=0}if(t>this.length){t=this.length}for(var r=this.length,i=this.tail;i!==null&&r>t;r--){i=i.prev}for(;i!==null&&r>e;r--,i=i.prev){n.push(i.value)}return n};Ufe.prototype.splice=function(e,t){if(e>this.length){e=this.length-1}if(e<0){e=this.length+e}for(var n=0,r=this.head;r!==null&&n<e;n++){r=r.next}var i=[];for(var n=0;r&&n<t;n++){i.push(r.value);r=this.removeNode(r)}if(r===null){r=this.tail}if(r!==this.head&&r!==this.tail){r=r.prev}for(var n=0;n<(arguments.length<=2?0:arguments.length-2);n++){r=qfe(this,r,n+2<2||arguments.length<=n+2?undefined:arguments[n+2])}return i};Ufe.prototype.reverse=function(){var e=this.head;var t=this.tail;for(var n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next;n.next=r}this.head=t;this.tail=e;return this};function qfe(e,t,n){var r=t===e.head?new Gfe(n,null,t,e):new Gfe(n,t,t.next,e);if(r.next===null){e.tail=r}if(r.prev===null){e.head=r}e.length++;return r}function Wfe(e,t){e.tail=new Gfe(t,e.tail,null,e);if(!e.head){e.head=e.tail}e.length++}function Hfe(e,t){e.head=new Gfe(t,null,e.head,e);if(!e.tail){e.tail=e.head}e.length++}function Gfe(e,t,n,r){if(!(this instanceof Gfe)){return new Gfe(e,t,n,r)}this.list=r;this.value=e;if(t){t.next=this;this.prev=t}else{this.prev=null}if(n){n.prev=this;this.next=n}else{this.next=null}}try{Ufe.prototype[Symbol.iterator]=Lfe.mark((function e(){var t;return Lfe.wrap((function e(n){while(1){switch(n.prev=n.next){case 0:t=this.head;case 1:if(!t){n.next=7;break}n.next=4;return t.value;case 4:t=t.next;n.next=1;break;case 7:case"end":return n.stop()}}}),e,this)}))}catch(Ihe){}var $fe=Ife;var Vfe=Symbol("max");var Yfe=Symbol("length");var Xfe=Symbol("lengthCalculator");var Jfe=Symbol("allowStale");var Qfe=Symbol("maxAge");var Zfe=Symbol("dispose");var Kfe=Symbol("noDisposeOnSet");var ece=Symbol("lruList");var tce=Symbol("cache");var nce=Symbol("updateAgeOnGet");var rce=function(){return 1};var ice=function(){function e(e){if(typeof e==="number")e={max:e};if(!e)e={};if(e.max&&(typeof e.max!=="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[Vfe]=e.max||Infinity;var t=e.length||rce;this[Xfe]=typeof t!=="function"?rce:t;this[Jfe]=e.stale||false;if(e.maxAge&&typeof e.maxAge!=="number")throw new TypeError("maxAge must be a number");this[Qfe]=e.maxAge||0;this[Zfe]=e.dispose;this[Kfe]=e.noDisposeOnSet||false;this[nce]=e.updateAgeOnGet||false;this.reset()}Object.defineProperty(e.prototype,"max",{get:function(){return this[Vfe]},set:function(e){if(typeof e!=="number"||e<0)throw new TypeError("max must be a non-negative number");this[Vfe]=e||Infinity;uce(this)},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"allowStale",{get:function(){return this[Jfe]},set:function(e){this[Jfe]=!!e},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"maxAge",{get:function(){return this[Qfe]},set:function(e){if(typeof e!=="number")throw new TypeError("maxAge must be a non-negative number");this[Qfe]=e;uce(this)},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"lengthCalculator",{get:function(){return this[Xfe]},set:function(e){var t=this;if(typeof e!=="function")e=rce;if(e!==this[Xfe]){this[Xfe]=e;this[Yfe]=0;this[ece].forEach((function(e){e.length=t[Xfe](e.value,e.key);t[Yfe]+=e.length}))}uce(this)},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"length",{get:function(){return this[Yfe]},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"itemCount",{get:function(){return this[ece].length},enumerable:false,configurable:true});e.prototype.rforEach=function(e,t){t=t||this;for(var n=this[ece].tail;n!==null;){var r=n.prev;fce(this,e,n,t);n=r}};e.prototype.forEach=function(e,t){t=t||this;for(var n=this[ece].head;n!==null;){var r=n.next;fce(this,e,n,t);n=r}};e.prototype.keys=function(){return this[ece].toArray().map((function(e){return e.key}))};e.prototype.values=function(){return this[ece].toArray().map((function(e){return e.value}))};e.prototype.reset=function(){var e=this;if(this[Zfe]&&this[ece]&&this[ece].length){this[ece].forEach((function(t){return e[Zfe](t.key,t.value)}))}this[tce]=new Map;this[ece]=new $fe;this[Yfe]=0};e.prototype.dump=function(){var e=this;return this[ece].map((function(t){return oce(e,t)?false:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))};e.prototype.dumpLru=function(){return this[ece]};e.prototype.set=function(e,t,n){n=n||this[Qfe];if(n&&typeof n!=="number")throw new TypeError("maxAge must be a number");var r=n?Date.now():0;var i=this[Xfe](t,e);if(this[tce].has(e)){if(i>this[Vfe]){sce(this,this[tce].get(e));return false}var a=this[tce].get(e);var o=a.value;if(this[Zfe]){if(!this[Kfe])this[Zfe](e,o.value)}o.now=r;o.maxAge=n;o.value=t;this[Yfe]+=i-o.length;o.length=i;this.get(e);uce(this);return true}var u=new lce(e,t,i,r,n);if(u.length>this[Vfe]){if(this[Zfe])this[Zfe](e,t);return false}this[Yfe]+=u.length;this[ece].unshift(u);this[tce].set(e,this[ece].head);uce(this);return true};e.prototype.has=function(e){if(!this[tce].has(e))return false;var t=this[tce].get(e).value;return!oce(this,t)};e.prototype.get=function(e){return ace(this,e,true)};e.prototype.peek=function(e){return ace(this,e,false)};e.prototype.pop=function(){var e=this[ece].tail;if(!e)return null;sce(this,e);return e.value};e.prototype.del=function(e){sce(this,this[tce].get(e))};e.prototype.load=function(e){this.reset();var t=Date.now();for(var n=e.length-1;n>=0;n--){var r=e[n];var i=r.e||0;if(i===0)this.set(r.k,r.v);else{var a=i-t;if(a>0){this.set(r.k,r.v,a)}}}};e.prototype.prune=function(){var e=this;this[tce].forEach((function(t,n){return ace(e,n,false)}))};return e}();var ace=function(e,t,n){var r=e[tce].get(t);if(r){var i=r.value;if(oce(e,i)){sce(e,r);if(!e[Jfe])return undefined}else{if(n){if(e[nce])r.value.now=Date.now();e[ece].unshiftNode(r)}}return i.value}};var oce=function(e,t){if(!t||!t.maxAge&&!e[Qfe])return false;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Qfe]&&n>e[Qfe]};var uce=function(e){if(e[Yfe]>e[Vfe]){for(var t=e[ece].tail;e[Yfe]>e[Vfe]&&t!==null;){var n=t.prev;sce(e,t);t=n}}};var sce=function(e,t){if(t){var n=t.value;if(e[Zfe])e[Zfe](n.key,n.value);e[Yfe]-=n.length;e[tce].delete(n.key);e[ece].removeNode(t)}};var lce=function(){function e(e,t,n,r,i){this.key=e;this.value=t;this.length=n;this.now=r;this.maxAge=i||0}return e}();var fce=function(e,t,n,r){var i=n.value;if(oce(e,i)){sce(e,n);if(!e[Jfe])i=undefined}if(i)t.call(r,i.value,i.key,e)};var cce=ice;var dce=["includePrerelease","loose","rtl"];var hce=function(e){return!e?{}:typeof e!=="object"?{loose:true}:dce.filter((function(t){return e[t]})).reduce((function(e,t){e[t]=true;return e}),{})};var pce=hce;var vce={exports:{}};var gce="2.0.0";var mce=256;var yce=Number.MAX_SAFE_INTEGER||9007199254740991;var bce=16;var xce={SEMVER_SPEC_VERSION:gce,MAX_LENGTH:mce,MAX_SAFE_INTEGER:yce,MAX_SAFE_COMPONENT_LENGTH:bce};var _ce=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}return console.error.apply(console,__spreadArray(["SEMVER"],t,false))}:function(){};var wce=_ce;(function(e,t){var n=xce.MAX_SAFE_COMPONENT_LENGTH;var r=wce;t=e.exports={};var i=t.re=[];var a=t.src=[];var o=t.t={};var u=0;var s=function(e,t,n){var s=u++;r(s,t);o[e]=s;a[s]=t;i[s]=new RegExp(t,n?"g":undefined)};s("NUMERICIDENTIFIER","0|[1-9]\\d*");s("NUMERICIDENTIFIERLOOSE","[0-9]+");s("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");s("MAINVERSION","(".concat(a[o.NUMERICIDENTIFIER],")\\.")+"(".concat(a[o.NUMERICIDENTIFIER],")\\.")+"(".concat(a[o.NUMERICIDENTIFIER],")"));s("MAINVERSIONLOOSE","(".concat(a[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(a[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(a[o.NUMERICIDENTIFIERLOOSE],")"));s("PRERELEASEIDENTIFIER","(?:".concat(a[o.NUMERICIDENTIFIER],"|").concat(a[o.NONNUMERICIDENTIFIER],")"));s("PRERELEASEIDENTIFIERLOOSE","(?:".concat(a[o.NUMERICIDENTIFIERLOOSE],"|").concat(a[o.NONNUMERICIDENTIFIER],")"));s("PRERELEASE","(?:-(".concat(a[o.PRERELEASEIDENTIFIER],"(?:\\.").concat(a[o.PRERELEASEIDENTIFIER],")*))"));s("PRERELEASELOOSE","(?:-?(".concat(a[o.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(a[o.PRERELEASEIDENTIFIERLOOSE],")*))"));s("BUILDIDENTIFIER","[0-9A-Za-z-]+");s("BUILD","(?:\\+(".concat(a[o.BUILDIDENTIFIER],"(?:\\.").concat(a[o.BUILDIDENTIFIER],")*))"));s("FULLPLAIN","v?".concat(a[o.MAINVERSION]).concat(a[o.PRERELEASE],"?").concat(a[o.BUILD],"?"));s("FULL","^".concat(a[o.FULLPLAIN],"$"));s("LOOSEPLAIN","[v=\\s]*".concat(a[o.MAINVERSIONLOOSE]).concat(a[o.PRERELEASELOOSE],"?").concat(a[o.BUILD],"?"));s("LOOSE","^".concat(a[o.LOOSEPLAIN],"$"));s("GTLT","((?:<|>)?=?)");s("XRANGEIDENTIFIERLOOSE","".concat(a[o.NUMERICIDENTIFIERLOOSE],"|x|X|\\*"));s("XRANGEIDENTIFIER","".concat(a[o.NUMERICIDENTIFIER],"|x|X|\\*"));s("XRANGEPLAIN","[v=\\s]*(".concat(a[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(a[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(a[o.XRANGEIDENTIFIER],")")+"(?:".concat(a[o.PRERELEASE],")?").concat(a[o.BUILD],"?")+")?)?");s("XRANGEPLAINLOOSE","[v=\\s]*(".concat(a[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(a[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(a[o.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(a[o.PRERELEASELOOSE],")?").concat(a[o.BUILD],"?")+")?)?");s("XRANGE","^".concat(a[o.GTLT],"\\s*").concat(a[o.XRANGEPLAIN],"$"));s("XRANGELOOSE","^".concat(a[o.GTLT],"\\s*").concat(a[o.XRANGEPLAINLOOSE],"$"));s("COERCE","".concat("(^|[^\\d])"+"(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])");s("COERCERTL",a[o.COERCE],true);s("LONETILDE","(?:~>?)");s("TILDETRIM","(\\s*)".concat(a[o.LONETILDE],"\\s+"),true);t.tildeTrimReplace="$1~";s("TILDE","^".concat(a[o.LONETILDE]).concat(a[o.XRANGEPLAIN],"$"));s("TILDELOOSE","^".concat(a[o.LONETILDE]).concat(a[o.XRANGEPLAINLOOSE],"$"));s("LONECARET","(?:\\^)");s("CARETTRIM","(\\s*)".concat(a[o.LONECARET],"\\s+"),true);t.caretTrimReplace="$1^";s("CARET","^".concat(a[o.LONECARET]).concat(a[o.XRANGEPLAIN],"$"));s("CARETLOOSE","^".concat(a[o.LONECARET]).concat(a[o.XRANGEPLAINLOOSE],"$"));s("COMPARATORLOOSE","^".concat(a[o.GTLT],"\\s*(").concat(a[o.LOOSEPLAIN],")$|^$"));s("COMPARATOR","^".concat(a[o.GTLT],"\\s*(").concat(a[o.FULLPLAIN],")$|^$"));s("COMPARATORTRIM","(\\s*)".concat(a[o.GTLT],"\\s*(").concat(a[o.LOOSEPLAIN],"|").concat(a[o.XRANGEPLAIN],")"),true);t.comparatorTrimReplace="$1$2$3";s("HYPHENRANGE","^\\s*(".concat(a[o.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(a[o.XRANGEPLAIN],")")+"\\s*$");s("HYPHENRANGELOOSE","^\\s*(".concat(a[o.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(a[o.XRANGEPLAINLOOSE],")")+"\\s*$");s("STAR","(<|>)?=?\\s*\\*");s("GTE0","^\\s*>=\\s*0.0.0\\s*$");s("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(vce,vce.exports);var Ace=/^[0-9]+$/;var Oce=function(e,t){var n=Ace.test(e);var r=Ace.test(t);if(n&&r){e=+e;t=+t}return e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1};var Ece=function(e,t){return Oce(t,e)};var kce={compareIdentifiers:Oce,rcompareIdentifiers:Ece};var Dce=wce;var Cce=xce.MAX_LENGTH,Fce=xce.MAX_SAFE_INTEGER;var Sce=vce.exports.re,jce=vce.exports.t;var Mce=pce;var Bce=kce.compareIdentifiers;var Nce=function(){function e(t,n){n=Mce(n);if(t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease){return t}else{t=t.version}}else if(typeof t!=="string"){throw new TypeError("Invalid Version: ".concat(t))}if(t.length>Cce){throw new TypeError("version is longer than ".concat(Cce," characters"))}Dce("SemVer",t,n);this.options=n;this.loose=!!n.loose;this.includePrerelease=!!n.includePrerelease;var r=t.trim().match(n.loose?Sce[jce.LOOSE]:Sce[jce.FULL]);if(!r){throw new TypeError("Invalid Version: ".concat(t))}this.raw=t;this.major=+r[1];this.minor=+r[2];this.patch=+r[3];if(this.major>Fce||this.major<0){throw new TypeError("Invalid major version")}if(this.minor>Fce||this.minor<0){throw new TypeError("Invalid minor version")}if(this.patch>Fce||this.patch<0){throw new TypeError("Invalid patch version")}if(!r[4]){this.prerelease=[]}else{this.prerelease=r[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<Fce){return t}}return e}))}this.build=r[5]?r[5].split("."):[];this.format()}e.prototype.format=function(){this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch);if(this.prerelease.length){this.version+="-".concat(this.prerelease.join("."))}return this.version};e.prototype.toString=function(){return this.version};e.prototype.compare=function(t){Dce("SemVer.compare",this.version,this.options,t);if(!(t instanceof e)){if(typeof t==="string"&&t===this.version){return 0}t=new e(t,this.options)}if(t.version===this.version){return 0}return this.compareMain(t)||this.comparePre(t)};e.prototype.compareMain=function(t){if(!(t instanceof e)){t=new e(t,this.options)}return Bce(this.major,t.major)||Bce(this.minor,t.minor)||Bce(this.patch,t.patch)};e.prototype.comparePre=function(t){if(!(t instanceof e)){t=new e(t,this.options)}if(this.prerelease.length&&!t.prerelease.length){return-1}else if(!this.prerelease.length&&t.prerelease.length){return 1}else if(!this.prerelease.length&&!t.prerelease.length){return 0}var n=0;do{var r=this.prerelease[n];var i=t.prerelease[n];Dce("prerelease compare",n,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return Bce(r,i)}}while(++n)};e.prototype.compareBuild=function(t){if(!(t instanceof e)){t=new e(t,this.options)}var n=0;do{var r=this.build[n];var i=t.build[n];Dce("prerelease compare",n,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return Bce(r,i)}}while(++n)};e.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",t);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",t);break;case"prepatch":this.prerelease.length=0;this.inc("patch",t);this.inc("pre",t);break;case"prerelease":if(this.prerelease.length===0){this.inc("patch",t)}this.inc("pre",t);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0){this.minor++}this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0){this.patch++}this.prerelease=[];break;case"pre":if(this.prerelease.length===0){this.prerelease=[0]}else{var n=this.prerelease.length;while(--n>=0){if(typeof this.prerelease[n]==="number"){this.prerelease[n]++;n=-2}}if(n===-1){this.prerelease.push(0)}}if(t){if(this.prerelease[0]===t){if(isNaN(this.prerelease[1])){this.prerelease=[t,0]}}else{this.prerelease=[t,0]}}break;default:throw new Error("invalid increment argument: ".concat(e))}this.format();this.raw=this.version;return this};return e}();var Tce=Nce;var zce=Tce;var Pce=function(e,t,n){return new zce(e,n).compare(new zce(t,n))};var Rce=Pce;var Lce=Rce;var Ice=function(e,t,n){return Lce(e,t,n)===0};var Uce=Ice;var qce=Rce;var Wce=function(e,t,n){return qce(e,t,n)!==0};var Hce=Wce;var Gce=Rce;var $ce=function(e,t,n){return Gce(e,t,n)>0};var Vce=$ce;var Yce=Rce;var Xce=function(e,t,n){return Yce(e,t,n)>=0};var Jce=Xce;var Qce=Rce;var Zce=function(e,t,n){return Qce(e,t,n)<0};var Kce=Zce;var ede=Rce;var tde=function(e,t,n){return ede(e,t,n)<=0};var nde=tde;var rde=Uce;var ide=Hce;var ade=Vce;var ode=Jce;var ude=Kce;var sde=nde;var lde=function(e,t,n,r){switch(t){case"===":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e===n;case"!==":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e!==n;case"":case"=":case"==":return rde(e,n,r);case"!=":return ide(e,n,r);case">":return ade(e,n,r);case">=":return ode(e,n,r);case"<":return ude(e,n,r);case"<=":return sde(e,n,r);default:throw new TypeError("Invalid operator: ".concat(t))}};var fde=lde;var cde=Symbol("SemVer ANY");var dde=function(){function e(t,n){n=pde(n);if(t instanceof e){if(t.loose===!!n.loose){return t}else{t=t.value}}yde("comparator",t,n);this.options=n;this.loose=!!n.loose;this.parse(t);if(this.semver===cde){this.value=""}else{this.value=this.operator+this.semver.version}yde("comp",this)}Object.defineProperty(e,"ANY",{get:function(){return cde},enumerable:false,configurable:true});e.prototype.parse=function(e){var t=this.options.loose?vde[gde.COMPARATORLOOSE]:vde[gde.COMPARATOR];var n=e.match(t);if(!n){throw new TypeError("Invalid comparator: ".concat(e))}this.operator=n[1]!==undefined?n[1]:"";if(this.operator==="="){this.operator=""}if(!n[2]){this.semver=cde}else{this.semver=new bde(n[2],this.options.loose)}};e.prototype.toString=function(){return this.value};e.prototype.test=function(e){yde("Comparator.test",e,this.options.loose);if(this.semver===cde||e===cde){return true}if(typeof e==="string"){try{e=new bde(e,this.options)}catch(Ihe){return false}}return mde(e,this.operator,this.semver,this.options)};e.prototype.intersects=function(t,n){if(!(t instanceof e)){throw new TypeError("a Comparator is required")}if(!n||typeof n!=="object"){n={loose:!!n,includePrerelease:false}}if(this.operator===""){if(this.value===""){return true}return new xde(t.value,n).test(this.value)}else if(t.operator===""){if(t.value===""){return true}return new xde(this.value,n).test(t.semver)}var r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">");var i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<");var a=this.semver.version===t.semver.version;var o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<=");var u=mde(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<");var s=mde(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||a&&o||u||s};return e}();var hde=dde;var pde=pce;var vde=vce.exports.re,gde=vce.exports.t;var mde=fde;var yde=wce;var bde=Tce;var xde=Ede;function _de(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=wde(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var r=0;var i=function e(){};return{s:i,n:function t(){if(r>=e.length)return{done:true};return{done:false,value:e[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a=true,o=false,u;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();a=t.done;return t},e:function e(t){o=true;u=t},f:function e(){try{if(!a&&n.return!=null)n.return()}finally{if(o)throw u}}}}function wde(e,t){if(!e)return;if(typeof e==="string")return Ade(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ade(e,t)}function Ade(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}var Ode=function(){function e(t,n){var r=this;n=Cde(n);if(t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease){return t}else{return new e(t.raw,n)}}if(t instanceof Fde){this.raw=t.value;this.set=[[t]];this.format();return this}this.options=n;this.loose=!!n.loose;this.includePrerelease=!!n.includePrerelease;this.raw=t;this.set=t.split(/\s*\|\|\s*/).map((function(e){return r.parseRange(e.trim())})).filter((function(e){return e.length}));if(!this.set.length){throw new TypeError("Invalid SemVer Range: ".concat(t))}if(this.set.length>1){var i=this.set[0];this.set=this.set.filter((function(e){return!Pde(e[0])}));if(this.set.length===0)this.set=[i];else if(this.set.length>1){var a=_de(this.set),o;try{for(a.s();!(o=a.n()).done;){var u=o.value;if(u.length===1&&Rde(u[0])){this.set=[u];break}}}catch(s){a.e(s)}finally{a.f()}}}this.format()}e.prototype.format=function(){this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim();return this.range};e.prototype.toString=function(){return this.range};e.prototype.parseRange=function(e){var t=this;e=e.trim();var n=Object.keys(this.options).join(",");var r="parseRange:".concat(n,":").concat(e);var i=Dde.get(r);if(i)return i;var a=this.options.loose;var o=a?Mde[Bde.HYPHENRANGELOOSE]:Mde[Bde.HYPHENRANGE];e=e.replace(o,Jde(this.options.includePrerelease));Sde("hyphen replace",e);e=e.replace(Mde[Bde.COMPARATORTRIM],Nde);Sde("comparator trim",e,Mde[Bde.COMPARATORTRIM]);e=e.replace(Mde[Bde.TILDETRIM],Tde);e=e.replace(Mde[Bde.CARETTRIM],zde);e=e.split(/\s+/).join(" ");var u=a?Mde[Bde.COMPARATORLOOSE]:Mde[Bde.COMPARATOR];var s=e.split(" ").map((function(e){return Ide(e,t.options)})).join(" ").split(/\s+/).map((function(e){return Xde(e,t.options)})).filter(this.options.loose?function(e){return!!e.match(u)}:function(){return true}).map((function(e){return new Fde(e,t.options)}));var l=new Map;var f=_de(s),c;try{for(f.s();!(c=f.n()).done;){var d=c.value;if(Pde(d))return[d];l.set(d.value,d)}}catch(p){f.e(p)}finally{f.f()}if(l.size>1&&l.has(""))l.delete("");var h=__spreadArray([],l.values(),true);Dde.set(r,h);return h};e.prototype.intersects=function(t,n){if(!(t instanceof e)){throw new TypeError("a Range is required")}return this.set.some((function(e){return Lde(e,n)&&t.set.some((function(t){return Lde(t,n)&&e.every((function(e){return t.every((function(t){return e.intersects(t,n)}))}))}))}))};e.prototype.test=function(e){if(!e){return false}if(typeof e==="string"){try{e=new jde(e,this.options)}catch(Ihe){return false}}for(var t=0;t<this.set.length;t++){if(Qde(this.set[t],e,this.options)){return true}}return false};return e}();var Ede=Ode;var kde=cce;var Dde=new kde({max:1e3});var Cde=pce;var Fde=hde;var Sde=wce;var jde=Tce;var Mde=vce.exports.re,Bde=vce.exports.t,Nde=vce.exports.comparatorTrimReplace,Tde=vce.exports.tildeTrimReplace,zde=vce.exports.caretTrimReplace;var Pde=function(e){return e.value==="<0.0.0-0"};var Rde=function(e){return e.value===""};var Lde=function(e,t){var n=true;var r=e.slice();var i=r.pop();while(n&&r.length){n=r.every((function(e){return i.intersects(e,t)}));i=r.pop()}return n};var Ide=function(e,t){Sde("comp",e,t);e=Hde(e,t);Sde("caret",e);e=qde(e,t);Sde("tildes",e);e=$de(e,t);Sde("xrange",e);e=Yde(e,t);Sde("stars",e);return e};var Ude=function(e){return!e||e.toLowerCase()==="x"||e==="*"};var qde=function(e,t){return e.trim().split(/\s+/).map((function(e){return Wde(e,t)})).join(" ")};var Wde=function(e,t){var n=t.loose?Mde[Bde.TILDELOOSE]:Mde[Bde.TILDE];return e.replace(n,(function(t,n,r,i,a){Sde("tilde",e,t,n,r,i,a);var o;if(Ude(n)){o=""}else if(Ude(r)){o=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0")}else if(Ude(i)){o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0")}else if(a){Sde("replaceTilde pr",a);o=">=".concat(n,".").concat(r,".").concat(i,"-").concat(a," <").concat(n,".").concat(+r+1,".0-0")}else{o=">=".concat(n,".").concat(r,".").concat(i," <").concat(n,".").concat(+r+1,".0-0")}Sde("tilde return",o);return o}))};var Hde=function(e,t){return e.trim().split(/\s+/).map((function(e){return Gde(e,t)})).join(" ")};var Gde=function(e,t){Sde("caret",e,t);var n=t.loose?Mde[Bde.CARETLOOSE]:Mde[Bde.CARET];var r=t.includePrerelease?"-0":"";return e.replace(n,(function(t,n,i,a,o){Sde("caret",e,t,n,i,a,o);var u;if(Ude(n)){u=""}else if(Ude(i)){u=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0")}else if(Ude(a)){if(n==="0"){u=">=".concat(n,".").concat(i,".0").concat(r," <").concat(n,".").concat(+i+1,".0-0")}else{u=">=".concat(n,".").concat(i,".0").concat(r," <").concat(+n+1,".0.0-0")}}else if(o){Sde("replaceCaret pr",o);if(n==="0"){if(i==="0"){u=">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(n,".").concat(i,".").concat(+a+1,"-0")}else{u=">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(n,".").concat(+i+1,".0-0")}}else{u=">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(+n+1,".0.0-0")}}else{Sde("no pr");if(n==="0"){if(i==="0"){u=">=".concat(n,".").concat(i,".").concat(a).concat(r," <").concat(n,".").concat(i,".").concat(+a+1,"-0")}else{u=">=".concat(n,".").concat(i,".").concat(a).concat(r," <").concat(n,".").concat(+i+1,".0-0")}}else{u=">=".concat(n,".").concat(i,".").concat(a," <").concat(+n+1,".0.0-0")}}Sde("caret return",u);return u}))};var $de=function(e,t){Sde("replaceXRanges",e,t);return e.split(/\s+/).map((function(e){return Vde(e,t)})).join(" ")};var Vde=function(e,t){e=e.trim();var n=t.loose?Mde[Bde.XRANGELOOSE]:Mde[Bde.XRANGE];return e.replace(n,(function(n,r,i,a,o,u){Sde("xRange",e,n,r,i,a,o,u);var s=Ude(i);var l=s||Ude(a);var f=l||Ude(o);var c=f;if(r==="="&&c){r=""}u=t.includePrerelease?"-0":"";if(s){if(r===">"||r==="<"){n="<0.0.0-0"}else{n="*"}}else if(r&&c){if(l){a=0}o=0;if(r===">"){r=">=";if(l){i=+i+1;a=0;o=0}else{a=+a+1;o=0}}else if(r==="<="){r="<";if(l){i=+i+1}else{a=+a+1}}if(r==="<")u="-0";n="".concat(r+i,".").concat(a,".").concat(o).concat(u)}else if(l){n=">=".concat(i,".0.0").concat(u," <").concat(+i+1,".0.0-0")}else if(f){n=">=".concat(i,".").concat(a,".0").concat(u," <").concat(i,".").concat(+a+1,".0-0")}Sde("xRange return",n);return n}))};var Yde=function(e,t){Sde("replaceStars",e,t);return e.trim().replace(Mde[Bde.STAR],"")};var Xde=function(e,t){Sde("replaceGTE0",e,t);return e.trim().replace(Mde[t.includePrerelease?Bde.GTE0PRE:Bde.GTE0],"")};var Jde=function(e){return function(t,n,r,i,a,o,u,s,l,f,c,d,h){if(Ude(r)){n=""}else if(Ude(i)){n=">=".concat(r,".0.0").concat(e?"-0":"")}else if(Ude(a)){n=">=".concat(r,".").concat(i,".0").concat(e?"-0":"")}else if(o){n=">=".concat(n)}else{n=">=".concat(n).concat(e?"-0":"")}if(Ude(l)){s=""}else if(Ude(f)){s="<".concat(+l+1,".0.0-0")}else if(Ude(c)){s="<".concat(l,".").concat(+f+1,".0-0")}else if(d){s="<=".concat(l,".").concat(f,".").concat(c,"-").concat(d)}else if(e){s="<".concat(l,".").concat(f,".").concat(+c+1,"-0")}else{s="<=".concat(s)}return"".concat(n," ").concat(s).trim()}};var Qde=function(e,t,n){for(var r=0;r<e.length;r++){if(!e[r].test(t)){return false}}if(t.prerelease.length&&!n.includePrerelease){for(var i=0;i<e.length;i++){Sde(e[i].semver);if(e[i].semver===Fde.ANY){continue}if(e[i].semver.prerelease.length>0){var a=e[i].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch){return true}}}return false}return true};var Zde=Ede;var Kde=function(e,t,n){try{t=new Zde(t,n)}catch(Ihe){return false}return t.test(e)};var ehe=Kde;function the(e,t,n){var r=e.open(t);var i=1e4;var a=250;var o=new URL(t),u=o.origin;var s=~~(i/a);function l(t){if(t.source===r){s=0;e.removeEventListener("message",l,false)}}e.addEventListener("message",l,false);function f(){if(s<=0){return}r.postMessage(n,u);setTimeout(f,a);s-=1}setTimeout(f,a)}var nhe='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid #0000;\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid #0000;\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}}function rhe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++){n[r-1]=arguments[r]}for(var i=0,a=n;i<a.length;i++){var o=a[i];ihe(e,o)}return e}function ihe(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Nt(e,i,t[i],true)}}var ahe;function ohe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uhe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ohe(Object(n),!0).forEach((function(t){tfe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ohe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var she=VQ;var lhe=Mse;var fhe=typeof window!=="undefined"?window:undefined;if(lhe===undefined&&fhe!==null&&fhe!==void 0&&(ahe=fhe.vl)!==null&&ahe!==void 0&&ahe.compile){lhe=fhe.vl}var che={export:{svg:true,png:true},source:true,compiled:true,editor:true};var dhe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"};var hhe={vega:"Vega","vega-lite":"Vega-Lite"};var phe={vega:she.version,"vega-lite":lhe?lhe.version:"not available"};var vhe={vega:function(e){return e},"vega-lite":function(e,t){return lhe.compile(e,{config:t}).spec}};var ghe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>';var mhe="chart-wrapper";function yhe(e){return typeof e==="function"}function bhe(e,t,n,r){var i="<html><head>".concat(t,'</head><body><pre><code class="json">');var a="</code></pre>".concat(n,"</body></html>");var o=window.open("");o.document.write(i+e+a);o.document.title="".concat(hhe[r]," JSON Source")}function xhe(e,t){if(e.$schema){var n=Bse(e.$schema);if(t&&t!==n.library){var r;console.warn("The given visualization spec is written in ".concat(hhe[n.library],", but mode argument sets ").concat((r=hhe[t])!==null&&r!==void 0?r:t,"."))}var i=n.library;if(!ehe(phe[i],"^".concat(n.version.slice(1)))){console.warn("The input spec uses ".concat(hhe[i]," ").concat(n.version,", but the current version of ").concat(hhe[i]," is v").concat(phe[i],"."))}return i}if("mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e){return"vega-lite"}if("marks"in e||"signals"in e||"scales"in e||"axes"in e){return"vega"}return t!==null&&t!==void 0?t:"vega"}function _he(e){return!!(e&&"load"in e)}function whe(e){return _he(e)?e:she.loader(e)}function Ahe(e){var t,n;var r=(t=(n=e.usermeta)===null||n===void 0?void 0:n.embedOptions)!==null&&t!==void 0?t:{};if(Cn(r.defaultStyle)){r.defaultStyle=false}return r}function Ohe(e,t){return Ehe.apply(this,arguments)}function Ehe(){Ehe=rfe(Lfe.mark((function e(t,n){var r,i;var a,o,u,s,l,f,c,d,h,p=arguments;return Lfe.wrap((function e(v){while(1){switch(v.prev=v.next){case 0:a=p.length>2&&p[2]!==undefined?p[2]:{};if(!Cn(n)){v.next=10;break}u=whe(a.loader);v.t0=JSON;v.next=6;return u.load(n);case 6:v.t1=v.sent;o=v.t0.parse.call(v.t0,v.t1);v.next=11;break;case 10:o=n;case 11:s=Ahe(o);l=s.loader;if(!u||l){u=whe((f=a.loader)!==null&&f!==void 0?f:l)}v.next=16;return khe(s,u);case 16:c=v.sent;v.next=19;return khe(a,u);case 19:d=v.sent;h=uhe(uhe({},rhe(d,c)),{},{config:Bt((r=d.config)!==null&&r!==void 0?r:{},(i=c.config)!==null&&i!==void 0?i:{})});v.next=23;return Fhe(t,o,h,u);case 23:return v.abrupt("return",v.sent);case 24:case"end":return v.stop()}}}),e)})));return Ehe.apply(this,arguments)}function khe(e,t){return Dhe.apply(this,arguments)}function Dhe(){Dhe=rfe(Lfe.mark((function e(t,n){var r;var i,a;return Lfe.wrap((function e(o){while(1){switch(o.prev=o.next){case 0:if(!Cn(t.config)){o.next=8;break}o.t1=JSON;o.next=4;return n.load(t.config);case 4:o.t2=o.sent;o.t0=o.t1.parse.call(o.t1,o.t2);o.next=9;break;case 8:o.t0=(r=t.config)!==null&&r!==void 0?r:{};case 9:i=o.t0;if(!Cn(t.patch)){o.next=18;break}o.t4=JSON;o.next=14;return n.load(t.patch);case 14:o.t5=o.sent;o.t3=o.t4.parse.call(o.t4,o.t5);o.next=19;break;case 18:o.t3=t.patch;case 19:a=o.t3;return o.abrupt("return",uhe(uhe(uhe({},t),a?{patch:a}:{}),i?{config:i}:{}));case 21:case"end":return o.stop()}}}),e)})));return Dhe.apply(this,arguments)}function Che(e){var t;var n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function Fhe(e,t){return She.apply(this,arguments)}function She(){She=rfe(Lfe.mark((function e(t,n){var r,i,a,o,u,s,l;var f,c,d,h,p,v,g,m,y,b,x,_,w,A,O,E,k,D,C,F,S,j,M,B,N,T,z,P,R,L,I,U,q,W,H,G,$,V,Y,X,J,Q,Z=arguments;return Lfe.wrap((function e(K){while(1){switch(K.prev=K.next){case 0:Q=function e(){if(R){document.removeEventListener("click",R)}M.finalize()};f=Z.length>2&&Z[2]!==undefined?Z[2]:{};c=Z.length>3?Z[3]:undefined;d=f.theme?Bt(Wle[f.theme],(r=f.config)!==null&&r!==void 0?r:{}):f.config;h=An(f.actions)?f.actions:rhe({},che,(i=f.actions)!==null&&i!==void 0?i:{});p=uhe(uhe({},dhe),f.i18n);v=(a=f.renderer)!==null&&a!==void 0?a:"canvas";g=(o=f.logLevel)!==null&&o!==void 0?o:she.Warn;m=(u=f.downloadFileName)!==null&&u!==void 0?u:"visualization";y=typeof t==="string"?document.querySelector(t):t;if(y){K.next=12;break}throw new Error("".concat(t," does not exist"));case 12:if(f.defaultStyle!==false){b="vega-embed-style";x=Che(y),_=x.root,w=x.rootContainer;if(!_.getElementById(b)){A=document.createElement("style");A.id=b;A.innerHTML=f.defaultStyle===undefined||f.defaultStyle===true?nhe.toString():f.defaultStyle;w.appendChild(A)}}O=xhe(n,f.mode);E=vhe[O](n,d);if(O==="vega-lite"){if(E.$schema){k=Bse(E.$schema);if(!ehe(phe.vega,"^".concat(k.version.slice(1)))){console.warn("The compiled spec uses Vega ".concat(k.version,", but current version is v").concat(phe.vega,"."))}}}y.classList.add("vega-embed");if(h){y.classList.add("has-actions")}y.innerHTML="";D=y;if(h){C=document.createElement("div");C.classList.add(mhe);y.appendChild(C);D=C}F=f.patch;if(F){E=F instanceof Function?F(E):qe(E,F,true,false).newDocument}if(f.formatLocale){she.formatLocale(f.formatLocale)}if(f.timeFormatLocale){she.timeFormatLocale(f.timeFormatLocale)}S=f.ast;j=she.parse(E,O==="vega-lite"?{}:d,{ast:S});M=new(f.viewClass||she.View)(j,uhe({loader:c,logLevel:g,renderer:v},S?{expr:(s=(l=she.expressionInterpreter)!==null&&l!==void 0?l:f.expr)!==null&&s!==void 0?s:aZ}:{}));M.addSignalListener("autosize",(function(e,t){var n=t.type;if(n=="fit-x"){D.classList.add("fit-x");D.classList.remove("fit-y")}else if(n=="fit-y"){D.classList.remove("fit-x");D.classList.add("fit-y")}else if(n=="fit"){D.classList.add("fit-x","fit-y")}else{D.classList.remove("fit-x","fit-y")}}));if(f.tooltip!==false){B=yhe(f.tooltip)?f.tooltip:new efe(f.tooltip===true?{}:f.tooltip).call;M.tooltip(B)}N=f.hover;if(N===undefined){N=O==="vega"}if(N){T=typeof N==="boolean"?{}:N,z=T.hoverSet,P=T.updateSet;M.hover(z,P)}if(f){if(f.width!=null){M.width(f.width)}if(f.height!=null){M.height(f.height)}if(f.padding!=null){M.padding(f.padding)}}K.next=36;return M.initialize(D,f.bind).runAsync();case 36:if(h!==false){L=y;if(f.defaultStyle!==false){I=document.createElement("details");I.title=p.CLICK_TO_VIEW_ACTIONS;y.append(I);L=I;U=document.createElement("summary");U.innerHTML=ghe;I.append(U);R=function(e){if(!I.contains(e.target)){I.removeAttribute("open")}};document.addEventListener("click",R)}q=document.createElement("div");L.append(q);q.classList.add("vega-actions");if(h===true||h.export!==false){W=function e(){var t=G[H];if(h===true||h.export===true||h.export[t]){var n=p["".concat(t.toUpperCase(),"_ACTION")];var r=document.createElement("a");r.text=n;r.href="#";r.target="_blank";r.download="".concat(m,".").concat(t);r.addEventListener("mousedown",function(){var e=rfe(Lfe.mark((function e(n){var r;return Lfe.wrap((function e(i){while(1){switch(i.prev=i.next){case 0:n.preventDefault();i.next=3;return M.toImageURL(t,f.scaleFactor);case 3:r=i.sent;this.href=r;case 5:case"end":return i.stop()}}}),e,this)})));return function(t){return e.apply(this,arguments)}}());q.append(r)}};for(H=0,G=["svg","png"];H<G.length;H++){W()}}if(h===true||h.source!==false){$=document.createElement("a");$.text=p.SOURCE_ACTION;$.href="#";$.addEventListener("click",(function(e){var t,r;bhe(ut(n),(t=f.sourceHeader)!==null&&t!==void 0?t:"",(r=f.sourceFooter)!==null&&r!==void 0?r:"",O);e.preventDefault()}));q.append($)}if(O==="vega-lite"&&(h===true||h.compiled!==false)){V=document.createElement("a");V.text=p.COMPILED_ACTION;V.href="#";V.addEventListener("click",(function(e){var t,n;bhe(ut(E),(t=f.sourceHeader)!==null&&t!==void 0?t:"",(n=f.sourceFooter)!==null&&n!==void 0?n:"","vega");e.preventDefault()}));q.append(V)}if(h===true||h.editor!==false){X=(Y=f.editorUrl)!==null&&Y!==void 0?Y:"https://vega.github.io/editor/";J=document.createElement("a");J.text=p.EDITOR_ACTION;J.href="#";J.addEventListener("click",(function(e){the(window,X,{config:d,mode:O,renderer:v,spec:ut(n)});e.preventDefault()}));q.append(J)}}return K.abrupt("return",{view:M,spec:n,vgSpec:E,finalize:Q,embedOptions:f});case 38:case"end":return K.stop()}}}),e)})));return She.apply(this,arguments)}var jhe="application/vnd.vega+json";var Mhe=/(vega|vega-?lite)[/.]v([0-9]+(?:\.[0-9]){0,2})/;var Bhe=function(e){return e==="vega"||e==="vega-lite"?e:"vega"};var Nhe=function(e){if(e===void 0){e=""}var t;var n=(t=Mhe.exec(e))!==null&&t!==void 0?t:[],r=n[1],i=r===void 0?"vega":r,a=n[2],o=a===void 0?"latest":a;var u=i.replace("vegalite","vega-lite");var s=Bhe(u);return{library:s,version:o}};var The=function(e){var t=e.library,n=e.version;return"https://unpkg.com/".concat(t,"@").concat(n)};var zhe=".sc-stencila-image-vega-default-h{display:block}.sc-stencila-image-vega-default-h.imgHidden.sc-stencila-image-vega-default-s>picture>:not(.vega-embed){display:none}";var Phe=".sc-stencila-image-vega-material-h{display:block}.sc-stencila-image-vega-material-h.imgHidden.sc-stencila-image-vega-material-s>picture>:not(.vega-embed){display:none}";var Rhe={vega:undefined,"vega-lite":undefined};var Lhe=e("stencila_image_vega",function(){function e(e){var r=this;t(this,e);this.vegaLoad=n(this,"stencila-vega-load",7);this.detectVegaDependency=function(e){var t=Nhe(typeof e==="object"?e.$schema:e);r.vegaDependency=t;return t};this.options={};this.plotIsRendered=false;this.getPlotContent=function(){if(r.spec!==undefined&&r.spec!==""){return r.spec}var e=r.el.querySelector('[type^="'.concat(jhe,'"]'));if(e){try{var t=e.textContent;var n=JSON.parse(t!==null&&t!==void 0?t:"");return n}catch(i){console.error("Could not parse plot data")}}return undefined};this.renderPlot=function(){var e;var t=r.getPlotContent();r.plotContainer=(e=r.plotContainer)!==null&&e!==void 0?e:de(r.el);if(t!==undefined){return Ohe(r.plotContainer,t,Object.assign({actions:{compiled:false,editor:false}},r.options)).then((function(e){r.plotIsRendered=true;return e}))}return Promise.resolve()}}e.prototype.onVegaLoad=function(e){if(!this.plotIsRendered&&e.detail.library===this.vegaDependency.library){this.renderPlot().catch((function(e){console.log(e)}))}};e.prototype.componentWillLoad=function(){var e=this;this.detectVegaDependency(this.getPlotContent());if(!this.plotIsRendered&&Rhe[this.vegaDependency.library]){return this.renderPlot()}else{he({src:The(this.vegaDependency),onLoad:function(){Rhe[e.vegaDependency.library]=true;e.vegaLoad.emit({library:e.vegaDependency.library})}})}};e.prototype.componentShouldUpdate=function(e,t,n){if(n==="plotIsRendered"&&t===e){return false}return true};e.prototype.componentWillUpdate=function(){this.renderPlot().catch((function(e){console.log(e)}))};e.prototype.render=function(){return r(a,{class:{imgHidden:this.plotIsRendered}})};Object.defineProperty(e.prototype,"el",{get:function(){return i(this)},enumerable:false,configurable:true});return e}());Lhe.style={default:zhe,material:Phe}}}}));
//# sourceMappingURL=p-1dc7f18f.system.entry.js.map