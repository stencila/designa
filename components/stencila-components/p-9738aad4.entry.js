import{r as t,f as s,h as i,c as l,e as o}from"./p-42c7aa22.js";import{c as e,i as a}from"./p-bfd527b9.js";const n="application/vnd.plotly.v1+json";const c=".sc-stencila-image-plotly-default-h{display:block}.sc-stencila-image-plotly-default-h.imgHidden.sc-stencila-image-plotly-default-s>picture>:not(.js-plotly-plot){display:none}";const r=".sc-stencila-image-plotly-material-h{display:block}.sc-stencila-image-plotly-material-h.imgHidden.sc-stencila-image-plotly-material-s>picture>:not(.js-plotly-plot){display:none}";const d="https://cdn.plot.ly/plotly-latest.min.js";let p;const h=class{constructor(i){t(this,i);this.plotlyLoad=s(this,"stencila-plotly-load",7);this.plotIsRendered=false;this.renderPlot=()=>{var t,s,i;const{data:l,layout:o=this.layout,config:a=this.config}=(t=this.getPlotContent())!==null&&t!==void 0?t:{};if(!l)return;this.plotContainer=(s=this.plotContainer)!==null&&s!==void 0?s:e(this.el);(i=window.Plotly)===null||i===void 0?void 0:i.react(this.plotContainer,l,o,a).then((()=>{if(!this.plotIsRendered){this.plotIsRendered=true}})).catch((t=>{console.error("Failed to render plot",t)}))};this.getPlotContent=()=>{if(this.data){return{data:this.data,layout:this.layout,config:this.config}}const t=this.el.querySelector(`[type="${n}"]`);if(t){try{const s=t.textContent;const i=JSON.parse(s!==null&&s!==void 0?s:"");return Array.isArray(i)?{data:i}:i}catch(s){console.error("Could not parse plot data")}}return undefined}}onPlotlyLoad(){if(!this.plotIsRendered){this.renderPlot()}}componentWillLoad(){if(!this.plotIsRendered&&p){this.renderPlot()}else{a({src:d,onLoad:()=>{p=true;this.plotlyLoad.emit()}})}}componentShouldUpdate(t,s,i){if(i==="plotIsRendered"&&s===t){return false}return true}componentWillUpdate(){this.renderPlot()}render(){return i(o,{class:{imgHidden:this.plotIsRendered}})}get el(){return l(this)}};h.style={default:c,material:r};export{h as stencila_image_plotly};
//# sourceMappingURL=p-9738aad4.entry.js.map