{"version":3,"sources":["node_modules/d3-shape/src/symbol/diamond.js","node_modules/d3-shape/src/symbol/square.js","node_modules/d3-shape/src/symbol/star.js","node_modules/d3-shape/src/symbol/triangle.js","node_modules/d3-shape/src/symbol/wye.js","node_modules/d3-timer/src/timeout.js","node_modules/d3-selection/src/namespaces.js","node_modules/d3-selection/src/namespace.js","node_modules/d3-selection/src/creator.js","node_modules/d3-selection/src/selector.js","node_modules/d3-selection/src/selection/select.js","node_modules/d3-selection/src/array.js","node_modules/d3-selection/src/selectorAll.js","node_modules/d3-selection/src/selection/selectAll.js","node_modules/d3-selection/src/matcher.js","node_modules/d3-selection/src/selection/selectChild.js","node_modules/d3-selection/src/selection/selectChildren.js","node_modules/d3-selection/src/selection/filter.js","node_modules/d3-selection/src/selection/sparse.js","node_modules/d3-selection/src/selection/enter.js","node_modules/d3-selection/src/constant.js","node_modules/d3-selection/src/selection/data.js","node_modules/d3-selection/src/selection/exit.js","node_modules/d3-selection/src/selection/join.js","node_modules/d3-selection/src/selection/merge.js","node_modules/d3-selection/src/selection/order.js","node_modules/d3-selection/src/selection/sort.js","node_modules/d3-selection/src/selection/call.js","node_modules/d3-selection/src/selection/nodes.js","node_modules/d3-selection/src/selection/node.js","node_modules/d3-selection/src/selection/size.js","node_modules/d3-selection/src/selection/empty.js","node_modules/d3-selection/src/selection/each.js","node_modules/d3-selection/src/selection/attr.js","node_modules/d3-selection/src/window.js","node_modules/d3-selection/src/selection/style.js","node_modules/d3-selection/src/selection/property.js","node_modules/d3-selection/src/selection/classed.js","node_modules/d3-selection/src/selection/text.js","node_modules/d3-selection/src/selection/html.js","node_modules/d3-selection/src/selection/raise.js","node_modules/d3-selection/src/selection/lower.js","node_modules/d3-selection/src/selection/append.js","node_modules/d3-selection/src/selection/insert.js","node_modules/d3-selection/src/selection/remove.js","node_modules/d3-selection/src/selection/clone.js","node_modules/d3-selection/src/selection/datum.js","node_modules/d3-selection/src/selection/on.js","node_modules/d3-selection/src/selection/dispatch.js","node_modules/d3-selection/src/selection/iterator.js","node_modules/d3-selection/src/selection/index.js","node_modules/d3-selection/src/select.js","node_modules/d3-selection/src/sourceEvent.js","node_modules/d3-selection/src/pointer.js","node_modules/d3-drag/src/noevent.js","node_modules/d3-drag/src/nodrag.js","node_modules/d3-drag/src/constant.js","node_modules/d3-drag/src/event.js","node_modules/d3-drag/src/drag.js","node_modules/d3-polygon/src/cross.js","node_modules/d3-polygon/src/hull.js","src/components/projectGraph/utils/guards.ts","src/components/projectGraph/graphs.ts","node_modules/d3-transition/src/transition/schedule.js","node_modules/d3-transition/src/interrupt.js","node_modules/d3-transition/src/selection/interrupt.js","node_modules/d3-transition/src/transition/tween.js","node_modules/d3-transition/src/transition/interpolate.js","node_modules/d3-transition/src/transition/attr.js","node_modules/d3-transition/src/transition/attrTween.js","node_modules/d3-transition/src/transition/delay.js","node_modules/d3-transition/src/transition/duration.js","node_modules/d3-transition/src/transition/ease.js","node_modules/d3-transition/src/transition/easeVarying.js","node_modules/d3-transition/src/transition/filter.js","node_modules/d3-transition/src/transition/merge.js","node_modules/d3-transition/src/transition/on.js","node_modules/d3-transition/src/transition/remove.js","node_modules/d3-transition/src/transition/select.js","node_modules/d3-transition/src/transition/selectAll.js","node_modules/d3-transition/src/transition/selection.js","node_modules/d3-transition/src/transition/style.js","node_modules/d3-transition/src/transition/styleTween.js","node_modules/d3-transition/src/transition/text.js","node_modules/d3-transition/src/transition/textTween.js","node_modules/d3-transition/src/transition/transition.js","node_modules/d3-transition/src/transition/end.js","node_modules/d3-transition/src/transition/index.js","node_modules/d3-ease/src/cubic.js","node_modules/d3-transition/src/selection/transition.js","node_modules/d3-transition/src/selection/index.js","node_modules/d3-zoom/src/constant.js","node_modules/d3-zoom/src/event.js","node_modules/d3-zoom/src/transform.js","node_modules/d3-zoom/src/noevent.js","node_modules/d3-zoom/src/zoom.js","src/components/projectGraph/utils/index.ts","src/components/projectGraph/utils/nodes.ts","src/components/projectGraph/utils/resource.ts","src/components/projectGraph/utils/symbols.ts","src/components/projectGraph/projectGraph.css?tag=stencila-project-graph&mode=default&encapsulation=shadow","src/components/projectGraph/projectGraph.material.css?tag=stencila-project-graph&mode=material&encapsulation=shadow","src/components/projectGraph/projectGraph.tsx"],"names":["tan30","sqrt","tan30_2","symbolDiamond","draw","context","size","y","x","moveTo","lineTo","closePath","symbolSquare","w","rect","ka","kr","sin","pi","kx","tau","ky","cos","symbolStar","r","i","a_1","c_1","s_1","sqrt3","symbolTriangle","c","s","k","a","symbolWye","x0","y0","x1","y1","x2","y2","timeout","callback","delay","time","t","Timer","restart","elapsed","stop","xhtml","namespaces","svg","xlink","xml","xmlns","namespace","name","prefix","indexOf","slice","hasOwnProperty","space","local","creatorInherit","document","this","ownerDocument","uri","namespaceURI","documentElement","createElement","createElementNS","creatorFixed","fullname","creator","none","selector","querySelector","selection_select","select","groups","_groups","m","length","subgroups","Array","j","group","n","subgroup","node","subnode","call","__data__","Selection","_parents","array","isArray","from","empty","selectorAll","querySelectorAll","arrayAll","apply","arguments","selection_selectAll","parents","push","matcher","matches","childMatcher","find","prototype","childFind","match","children","childFirst","firstElementChild","selection_selectChild","filter","childrenFilter","selection_selectChildren","selectAll","selection_filter","sparse","update","selection_enter","_enter","map","EnterNode","parent","datum","_next","_parent","constructor","appendChild","child","insertBefore","next","constant$2","bindIndex","enter","exit","data","groupLength","dataLength","bindKey","key","nodeByKeyValue","Map","keyValues","keyValue","has","set","get","delete","selection_data","value","bind","constant","arraylike","enterGroup","updateGroup","exitGroup","i0","i1","previous","_exit","selection_exit","selection_join","onenter","onupdate","onexit","selection","append","remove","merge","order","selection_merge","groups0","groups1","m0","m1","Math","min","merges","group0","group1","selection_order","compareDocumentPosition","parentNode","selection_sort","compare","ascending","compareNode","b","sortgroups","sortgroup","sort","NaN","selection_call","selection_nodes","selection_node","selection_size","_i","_d","selection_empty","selection_each","attrRemove","removeAttribute","attrRemoveNS","removeAttributeNS","attrConstant","setAttribute","attrConstantNS","setAttributeNS","attrFunction","v","attrFunctionNS","selection_attr","getAttributeNS","getAttribute","each","defaultView","styleRemove","style","removeProperty","styleConstant","priority","setProperty","styleFunction","selection_style","styleValue","getPropertyValue","getComputedStyle","propertyRemove","propertyConstant","propertyFunction","selection_property","classArray","string","trim","split","classList","ClassList","_node","_names","add","join","splice","contains","classedAdd","names","list","classedRemove","classedTrue","classedFalse","classedFunction","selection_classed","textRemove","textContent","textConstant","textFunction","selection_text","htmlRemove","innerHTML","htmlConstant","htmlFunction","selection_html","raise","nextSibling","selection_raise","lower","previousSibling","firstChild","selection_lower","selection_append","create","constantNull","selection_insert","before","removeChild","selection_remove","selection_cloneShallow","clone","cloneNode","selection_cloneDeep","selection_clone","deep","selection_datum","property","contextListener","listener","event","parseTypenames","typenames","type","onRemove","typename","on","__on","o","removeEventListener","options","onAdd","addEventListener","selection_on","dispatchEvent","params","window","CustomEvent","createEvent","initEvent","bubbles","cancelable","detail","dispatchConstant","dispatchFunction","selection_dispatch","selection_iterator","sent","root","selection_selection","selectChild","selectChildren","nodes","attr","classed","text","html","insert","dispatch","Symbol","iterator","sourceEvent","pointer","undefined","currentTarget","ownerSVGElement","createSVGPoint","point","clientX","clientY","matrixTransform","getScreenCTM","inverse","getBoundingClientRect","left","clientLeft","top","clientTop","pageX","pageY","nonpassive","passive","nonpassivecapture","capture","nopropagation","stopImmediatePropagation","noevent$1","preventDefault","dragDisable","view","noevent","__noselect","MozUserSelect","yesdrag","noclick","setTimeout","constant$1","DragEvent","subject","target","identifier","active","dx","dy","Object","defineProperties","enumerable","configurable","_","defaultFilter","ctrlKey","button","defaultContainer","defaultSubject","d","defaultTouchable","navigator","maxTouchPoints","drag","container","touchable","gestures","listeners","mousedownx","mousedowny","mousemoving","touchending","clickDistance2","mousedowned","touchstarted","touchmoved","touchended","gesture","beforestart","mousemoved","mouseupped","nodrag","mouse","touches","changedTouches","clearTimeout","that","touch","copy","p","p0","clickDistance","cross","lexicographicOrder","computeUpperHullIndexes","points","indexes","polygonHull","sortedPoints","flippedPoints","upperIndexes","lowerIndexes","skipLeft","skipRight","hull","hasPath","resource","hasKind","graphEdgeToLinks","graph","edges","reduce","links","edge","targetNode","to","path","__spreadArray","source","relation","graphToGroupedGraph","files","fileLinkedNodes","groupedGraph","groupLinks","fileIndexByPath","_a","file","index","files_1","fileIndex","fileLinkedNodes_1","isInterGroupLink","emptyOn","emptyTween","CREATED","SCHEDULED","STARTING","STARTED","RUNNING","ENDING","ENDED","schedule","id","timing","schedules","__transition","tween","duration","ease","timer","state","init","Error","self","start","tick","interrupt","selection_interrupt","tweenRemove","tween0","tween1","tweenFunction","transition_tween","_id","tweenValue","transition","interpolate","interpolateNumber","color","interpolateRgb","interpolateString","value1","string00","string1","interpolate0","string0","string10","transition_attr","interpolateTransform","attrTween","attrInterpolate","attrInterpolateNS","attrTweenNS","t0","_value","transition_attrTween","delayFunction","delayConstant","transition_delay","durationFunction","durationConstant","transition_duration","easeConstant","transition_ease","easeVarying","transition_easeVarying","transition_filter","Transition","_name","transition_merge","every","onFunction","on0","on1","sit","transition_on","removeFunction","transition_remove","transition_select","transition_selectAll","inherit","l","transition_selection","styleNull","styleMaybeRemove","listener0","transition_style","styleTween","styleInterpolate","transition_styleTween","transition_text","textInterpolate","textTween","transition_textTween","transition_transition","id0","id1","newId","transition_end","Promise","resolve","reject","cancel","end","selection_prototype","_e","cubicInOut","defaultTiming","easeCubicInOut","concat","selection_transition","now","ZoomEvent","transform","Transform","scale","translate","applyX","applyY","invert","location","invertX","invertY","rescaleX","domain","range","rescaleY","toString","identity","defaultExtent","e","SVGElement","hasAttribute","viewBox","baseVal","width","height","clientWidth","clientHeight","defaultTransform","__zoom","defaultWheelDelta","deltaY","deltaMode","defaultConstrain","extent","translateExtent","dx0","dx1","dy0","dy1","max","zoom","constrain","wheelDelta","scaleExtent","Infinity","interpolateZoom","touchstarting","touchfirst","touchDelay","wheelDelay","tapDistance","wheeled","dblclicked","collection","scaleBy","scaleTo","k0","k1","centroid","p1","translateBy","translateTo","args","g","clean","__zooming","Gesture","taps","emit","touch0","touch1","pow","wheel","wheelidled","moved","dragEnable","shiftKey","t1","started","l0","l1","dp","dl","hypot","initGraph","el","elSize","svgContent","zoomFn","String","getNodeX","Number","parseInt","getNodeY","getResourceLabel","language","kind","url","getRelationLabel","auto","getResourceSymbol","symbol","symbolCircle","defaultProjectGraphCss","projectGraphMaterialCss","ProjectGraph","exports","class_1","hostRef","_this","drawGraph","graphRef","simulation","forceSimulation","force","forceLink","strength","iterations","distance","forceManyBody","distanceMin","distanceMax","forceCollide","forceX","forceY","forceCenter","velocityDecay","alphaDecay","click","_event","fx","fy","alpha","dragFn","hullContainer","linkContainer","_b","linkGroup","nodeContainer","_c","drawHull","fileNode","pad","hullFileNodes","rootCoords","targetX","targetY","sourceX","sourceY","line","curve","curveBasisClosed","nodeGroup","updateGraph","nextGraph","componentDidLoad","render","h","Host","ref","class"],"mappings":"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","sourcesContent":["import {sqrt} from \"../math.js\";\n\nconst tan30 = sqrt(1 / 3);\nconst tan30_2 = tan30 * 2;\n\nexport default {\n  draw(context, size) {\n    const y = sqrt(size / tan30_2);\n    const x = y * tan30;\n    context.moveTo(0, -y);\n    context.lineTo(x, 0);\n    context.lineTo(0, y);\n    context.lineTo(-x, 0);\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nexport default {\n  draw(context, size) {\n    const w = sqrt(size);\n    const x = -w / 2;\n    context.rect(x, x, w, w);\n  }\n};\n","import {sin, cos, sqrt, pi, tau} from \"../math.js\";\n\nconst ka = 0.89081309152928522810;\nconst kr = sin(pi / 10) / sin(7 * pi / 10);\nconst kx = sin(tau / 10) * kr;\nconst ky = -cos(tau / 10) * kr;\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size * ka);\n    const x = kx * r;\n    const y = ky * r;\n    context.moveTo(0, -r);\n    context.lineTo(x, y);\n    for (let i = 1; i < 5; ++i) {\n      const a = tau * i / 5;\n      const c = cos(a);\n      const s = sin(a);\n      context.lineTo(s * r, -c * r);\n      context.lineTo(c * x - s * y, s * x + c * y);\n    }\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nconst sqrt3 = sqrt(3);\n\nexport default {\n  draw(context, size) {\n    const y = -sqrt(size / (sqrt3 * 3));\n    context.moveTo(0, y * 2);\n    context.lineTo(-sqrt3 * y, -y);\n    context.lineTo(sqrt3 * y, -y);\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nconst c = -0.5;\nconst s = sqrt(3) / 2;\nconst k = 1 / sqrt(12);\nconst a = (k / 2 + 1) * 3;\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size / a);\n    const x0 = r / 2, y0 = r * k;\n    const x1 = x0, y1 = r * k + r;\n    const x2 = -x1, y2 = y1;\n    context.moveTo(x0, y0);\n    context.lineTo(x1, y1);\n    context.lineTo(x2, y2);\n    context.lineTo(c * x0 - s * y0, s * x0 + c * y0);\n    context.lineTo(c * x1 - s * y1, s * x1 + c * y1);\n    context.lineTo(c * x2 - s * y2, s * x2 + c * y2);\n    context.lineTo(c * x0 + s * y0, c * y0 - s * x0);\n    context.lineTo(c * x1 + s * y1, c * y1 - s * x1);\n    context.lineTo(c * x2 + s * y2, c * y2 - s * x2);\n    context.closePath();\n  }\n};\n","import {Timer} from \"./timer.js\";\n\nexport default function(callback, delay, time) {\n  var t = new Timer;\n  delay = delay == null ? 0 : +delay;\n  t.restart(elapsed => {\n    t.stop();\n    callback(elapsed + delay);\n  }, delay, time);\n  return t;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces.js\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins\n}\n","import namespace from \"./namespace.js\";\nimport {xhtml} from \"./namespaces.js\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","import {Selection} from \"./index.js\";\nimport selector from \"../selector.js\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","// Given something array like (or null), returns something that is strictly an\n// array. This is used to ensure that array-like objects passed to d3.selectAll\n// or selection.selectAll are converted into proper arrays when creating a\n// selection; we dont ever want to create a selection backed by a live\n// HTMLCollection or NodeList. However, note that selection.selectAll will use a\n// static NodeList as a group, since it safely derived from querySelectorAll.\nexport default function array(x) {\n  return x == null ? [] : Array.isArray(x) ? x : Array.from(x);\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","import {Selection} from \"./index.js\";\nimport array from \"../array.js\";\nimport selectorAll from \"../selectorAll.js\";\n\nfunction arrayAll(select) {\n  return function() {\n    return array(select.apply(this, arguments));\n  };\n}\n\nexport default function(select) {\n  if (typeof select === \"function\") select = arrayAll(select);\n  else select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n\nexport function childMatcher(selector) {\n  return function(node) {\n    return node.matches(selector);\n  };\n}\n\n","import {childMatcher} from \"../matcher.js\";\n\nvar find = Array.prototype.find;\n\nfunction childFind(match) {\n  return function() {\n    return find.call(this.children, match);\n  };\n}\n\nfunction childFirst() {\n  return this.firstElementChild;\n}\n\nexport default function(match) {\n  return this.select(match == null ? childFirst\n      : childFind(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {childMatcher} from \"../matcher.js\";\n\nvar filter = Array.prototype.filter;\n\nfunction children() {\n  return Array.from(this.children);\n}\n\nfunction childrenFilter(match) {\n  return function() {\n    return filter.call(this.children, match);\n  };\n}\n\nexport default function(match) {\n  return this.selectAll(match == null ? children\n      : childrenFilter(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {Selection} from \"./index.js\";\nimport matcher from \"../matcher.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import {Selection} from \"./index.js\";\nimport {EnterNode} from \"./enter.js\";\nimport constant from \"../constant.js\";\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that dont fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = new Map,\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + \"\";\n      if (nodeByKeyValue.has(keyValue)) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue.set(keyValue, node);\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = key.call(parent, data[i], i, data) + \"\";\n    if (node = nodeByKeyValue.get(keyValue)) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue.delete(keyValue);\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction datum(node) {\n  return node.__data__;\n}\n\nexport default function(value, key) {\n  if (!arguments.length) return Array.from(this, datum);\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = arraylike(value.call(parent, parent && parent.__data__, j, parents)),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n\n// Given some data, this returns an array-like view of it: an object that\n// exposes a length property and allows numeric indexing. Note that unlike\n// selectAll, this isnt worried about live collections because the resulting\n// array will only be used briefly while data is being bound. (It is possible to\n// cause the data to change while iterating by using a key function, but please\n// dont; wed rather avoid a gratuitous copy.)\nfunction arraylike(data) {\n  return typeof data === \"object\" && \"length\" in data\n    ? data // Array, TypedArray, NodeList, array-like\n    : Array.from(data); // Map, Set, iterable, string, or anything else\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  if (typeof onenter === \"function\") {\n    enter = onenter(enter);\n    if (enter) enter = enter.selection();\n  } else {\n    enter = enter.append(onenter + \"\");\n  }\n  if (onupdate != null) {\n    update = onupdate(update);\n    if (update) update = update.selection();\n  }\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(context) {\n  var selection = context.selection ? context.selection() : context;\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  return Array.from(this);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  let size = 0;\n  for (const node of this) ++size; // eslint-disable-line no-unused-vars\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import namespace from \"../namespace.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window.js\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import creator from \"../creator.js\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","import creator from \"../creator.js\";\nimport selector from \"../selector.js\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","function contextListener(listener) {\n  return function(event) {\n    listener.call(this, event, this.__data__);\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, options) {\n  return function() {\n    var on = this.__on, o, listener = contextListener(value);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n        this.addEventListener(o.type, o.listener = listener, o.options = options);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, options);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, options) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));\n  return this;\n}\n","import defaultView from \"../window.js\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","export default function*() {\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) yield node;\n    }\n  }\n}\n","import selection_select from \"./select.js\";\nimport selection_selectAll from \"./selectAll.js\";\nimport selection_selectChild from \"./selectChild.js\";\nimport selection_selectChildren from \"./selectChildren.js\";\nimport selection_filter from \"./filter.js\";\nimport selection_data from \"./data.js\";\nimport selection_enter from \"./enter.js\";\nimport selection_exit from \"./exit.js\";\nimport selection_join from \"./join.js\";\nimport selection_merge from \"./merge.js\";\nimport selection_order from \"./order.js\";\nimport selection_sort from \"./sort.js\";\nimport selection_call from \"./call.js\";\nimport selection_nodes from \"./nodes.js\";\nimport selection_node from \"./node.js\";\nimport selection_size from \"./size.js\";\nimport selection_empty from \"./empty.js\";\nimport selection_each from \"./each.js\";\nimport selection_attr from \"./attr.js\";\nimport selection_style from \"./style.js\";\nimport selection_property from \"./property.js\";\nimport selection_classed from \"./classed.js\";\nimport selection_text from \"./text.js\";\nimport selection_html from \"./html.js\";\nimport selection_raise from \"./raise.js\";\nimport selection_lower from \"./lower.js\";\nimport selection_append from \"./append.js\";\nimport selection_insert from \"./insert.js\";\nimport selection_remove from \"./remove.js\";\nimport selection_clone from \"./clone.js\";\nimport selection_datum from \"./datum.js\";\nimport selection_on from \"./on.js\";\nimport selection_dispatch from \"./dispatch.js\";\nimport selection_iterator from \"./iterator.js\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nfunction selection_selection() {\n  return this;\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  selectChild: selection_selectChild,\n  selectChildren: selection_selectChildren,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  selection: selection_selection,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch,\n  [Symbol.iterator]: selection_iterator\n};\n\nexport default selection;\n","import {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","export default function(event) {\n  let sourceEvent;\n  while (sourceEvent = event.sourceEvent) event = sourceEvent;\n  return event;\n}\n","import sourceEvent from \"./sourceEvent.js\";\n\nexport default function(event, node) {\n  event = sourceEvent(event);\n  if (node === undefined) node = event.currentTarget;\n  if (node) {\n    var svg = node.ownerSVGElement || node;\n    if (svg.createSVGPoint) {\n      var point = svg.createSVGPoint();\n      point.x = event.clientX, point.y = event.clientY;\n      point = point.matrixTransform(node.getScreenCTM().inverse());\n      return [point.x, point.y];\n    }\n    if (node.getBoundingClientRect) {\n      var rect = node.getBoundingClientRect();\n      return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n    }\n  }\n  return [event.pageX, event.pageY];\n}\n","// These are typically used in conjunction with noevent to ensure that we can\n// preventDefault on the event.\nexport const nonpassive = {passive: false};\nexport const nonpassivecapture = {capture: true, passive: false};\n\nexport function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {select} from \"d3-selection\";\nimport noevent, {nonpassivecapture} from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, nonpassivecapture);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, nonpassivecapture);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, nonpassivecapture);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","export default x => () => x;\n","export default function DragEvent(type, {\n  sourceEvent,\n  subject,\n  target,\n  identifier,\n  active,\n  x, y, dx, dy,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    subject: {value: subject, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    identifier: {value: identifier, enumerable: true, configurable: true},\n    active: {value: active, enumerable: true, configurable: true},\n    x: {value: x, enumerable: true, configurable: true},\n    y: {value: y, enumerable: true, configurable: true},\n    dx: {value: dx, enumerable: true, configurable: true},\n    dy: {value: dy, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n\nDragEvent.prototype.on = function() {\n  var value = this._.on.apply(this._, arguments);\n  return value === this._ ? this : value;\n};\n","import {dispatch} from \"d3-dispatch\";\nimport {select, pointer} from \"d3-selection\";\nimport nodrag, {yesdrag} from \"./nodrag.js\";\nimport noevent, {nonpassive, nonpassivecapture, nopropagation} from \"./noevent.js\";\nimport constant from \"./constant.js\";\nimport DragEvent from \"./event.js\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter(event) {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultContainer() {\n  return this.parentNode;\n}\n\nfunction defaultSubject(event, d) {\n  return d == null ? {x: event.x, y: event.y} : d;\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      container = defaultContainer,\n      subject = defaultSubject,\n      touchable = defaultTouchable,\n      gestures = {},\n      listeners = dispatch(\"start\", \"drag\", \"end\"),\n      active = 0,\n      mousedownx,\n      mousedowny,\n      mousemoving,\n      touchending,\n      clickDistance2 = 0;\n\n  function drag(selection) {\n    selection\n        .on(\"mousedown.drag\", mousedowned)\n      .filter(touchable)\n        .on(\"touchstart.drag\", touchstarted)\n        .on(\"touchmove.drag\", touchmoved, nonpassive)\n        .on(\"touchend.drag touchcancel.drag\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  function mousedowned(event, d) {\n    if (touchending || !filter.call(this, event, d)) return;\n    var gesture = beforestart(this, container.call(this, event, d), event, d, \"mouse\");\n    if (!gesture) return;\n    select(event.view)\n      .on(\"mousemove.drag\", mousemoved, nonpassivecapture)\n      .on(\"mouseup.drag\", mouseupped, nonpassivecapture);\n    nodrag(event.view);\n    nopropagation(event);\n    mousemoving = false;\n    mousedownx = event.clientX;\n    mousedowny = event.clientY;\n    gesture(\"start\", event);\n  }\n\n  function mousemoved(event) {\n    noevent(event);\n    if (!mousemoving) {\n      var dx = event.clientX - mousedownx, dy = event.clientY - mousedowny;\n      mousemoving = dx * dx + dy * dy > clickDistance2;\n    }\n    gestures.mouse(\"drag\", event);\n  }\n\n  function mouseupped(event) {\n    select(event.view).on(\"mousemove.drag mouseup.drag\", null);\n    yesdrag(event.view, mousemoving);\n    noevent(event);\n    gestures.mouse(\"end\", event);\n  }\n\n  function touchstarted(event, d) {\n    if (!filter.call(this, event, d)) return;\n    var touches = event.changedTouches,\n        c = container.call(this, event, d),\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = beforestart(this, c, event, d, touches[i].identifier, touches[i])) {\n        nopropagation(event);\n        gesture(\"start\", event, touches[i]);\n      }\n    }\n  }\n\n  function touchmoved(event) {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        noevent(event);\n        gesture(\"drag\", event, touches[i]);\n      }\n    }\n  }\n\n  function touchended(event) {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        nopropagation(event);\n        gesture(\"end\", event, touches[i]);\n      }\n    }\n  }\n\n  function beforestart(that, container, event, d, identifier, touch) {\n    var dispatch = listeners.copy(),\n        p = pointer(touch || event, container), dx, dy,\n        s;\n\n    if ((s = subject.call(that, new DragEvent(\"beforestart\", {\n        sourceEvent: event,\n        target: drag,\n        identifier,\n        active,\n        x: p[0],\n        y: p[1],\n        dx: 0,\n        dy: 0,\n        dispatch\n      }), d)) == null) return;\n\n    dx = s.x - p[0] || 0;\n    dy = s.y - p[1] || 0;\n\n    return function gesture(type, event, touch) {\n      var p0 = p, n;\n      switch (type) {\n        case \"start\": gestures[identifier] = gesture, n = active++; break;\n        case \"end\": delete gestures[identifier], --active; // falls through\n        case \"drag\": p = pointer(touch || event, container), n = active; break;\n      }\n      dispatch.call(\n        type,\n        that,\n        new DragEvent(type, {\n          sourceEvent: event,\n          subject: s,\n          target: drag,\n          identifier,\n          active: n,\n          x: p[0] + dx,\n          y: p[1] + dy,\n          dx: p[0] - p0[0],\n          dy: p[1] - p0[1],\n          dispatch\n        }),\n        d\n      );\n    };\n  }\n\n  drag.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), drag) : filter;\n  };\n\n  drag.container = function(_) {\n    return arguments.length ? (container = typeof _ === \"function\" ? _ : constant(_), drag) : container;\n  };\n\n  drag.subject = function(_) {\n    return arguments.length ? (subject = typeof _ === \"function\" ? _ : constant(_), drag) : subject;\n  };\n\n  drag.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), drag) : touchable;\n  };\n\n  drag.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? drag : value;\n  };\n\n  drag.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, drag) : Math.sqrt(clickDistance2);\n  };\n\n  return drag;\n}\n","// Returns the 2D cross product of AB and AC vectors, i.e., the z-component of\n// the 3D cross product in a quadrant I Cartesian coordinate system (+x is\n// right, +y is up). Returns a positive value if ABC is counter-clockwise,\n// negative if clockwise, and zero if the points are collinear.\nexport default function(a, b, c) {\n  return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]);\n}\n","import cross from \"./cross.js\";\n\nfunction lexicographicOrder(a, b) {\n  return a[0] - b[0] || a[1] - b[1];\n}\n\n// Computes the upper convex hull per the monotone chain algorithm.\n// Assumes points.length >= 3, is sorted by x, unique in y.\n// Returns an array of indices into points in left-to-right order.\nfunction computeUpperHullIndexes(points) {\n  const n = points.length,\n      indexes = [0, 1];\n  let size = 2, i;\n\n  for (i = 2; i < n; ++i) {\n    while (size > 1 && cross(points[indexes[size - 2]], points[indexes[size - 1]], points[i]) <= 0) --size;\n    indexes[size++] = i;\n  }\n\n  return indexes.slice(0, size); // remove popped points\n}\n\nexport default function(points) {\n  if ((n = points.length) < 3) return null;\n\n  var i,\n      n,\n      sortedPoints = new Array(n),\n      flippedPoints = new Array(n);\n\n  for (i = 0; i < n; ++i) sortedPoints[i] = [+points[i][0], +points[i][1], i];\n  sortedPoints.sort(lexicographicOrder);\n  for (i = 0; i < n; ++i) flippedPoints[i] = [sortedPoints[i][0], -sortedPoints[i][1]];\n\n  var upperIndexes = computeUpperHullIndexes(sortedPoints),\n      lowerIndexes = computeUpperHullIndexes(flippedPoints);\n\n  // Construct the hull polygon, removing possible duplicate endpoints.\n  var skipLeft = lowerIndexes[0] === upperIndexes[0],\n      skipRight = lowerIndexes[lowerIndexes.length - 1] === upperIndexes[upperIndexes.length - 1],\n      hull = [];\n\n  // Add upper hull in right-to-l order.\n  // Then add lower hull in left-to-right order.\n  for (i = upperIndexes.length - 1; i >= 0; --i) hull.push(points[sortedPoints[upperIndexes[i]][2]]);\n  for (i = +skipLeft; i < lowerIndexes.length - skipRight; ++i) hull.push(points[sortedPoints[lowerIndexes[i]][2]]);\n\n  return hull;\n}\n","import { SymbolResource, NodeResource, FileResource, Resource } from '../types'\n\nexport const hasPath = (\n  resource: string | number | Resource\n): resource is SymbolResource | NodeResource | FileResource => {\n  if (\n    typeof resource === 'object' &&\n    (resource.type === 'Symbol' ||\n      resource.type === 'Node' ||\n      resource.type === 'File')\n  ) {\n    return true\n  }\n\n  return false\n}\n\nexport const hasKind = (\n  resource: string | number | Resource\n): resource is SymbolResource | NodeResource => {\n  if (\n    typeof resource === 'object' &&\n    (resource.type === 'Symbol' || resource.type === 'Node')\n  ) {\n    return true\n  }\n\n  return false\n}\n","import { SimulationLinkDatum, SimulationNodeDatum } from 'd3-force'\nimport { FileResource, Graph, GraphNode, Relation } from './types'\nimport { hasPath } from './utils/guards'\n\nexport type GraphLink = SimulationLinkDatum<SimulationNodeDatum & GraphNode> & {\n  relation: Relation\n  group: string\n}\n\nexport const graphEdgeToLinks = (graph: Graph): GraphLink[] =>\n  graph.edges.reduce((links: GraphLink[], edge) => {\n    const targetNode = graph.nodes[edge.to]\n    const group = hasPath(targetNode) ? targetNode.path : 'leaf'\n\n    return [\n      ...links,\n      { source: edge.from, target: edge.to, group, relation: edge.relation },\n    ]\n  }, [])\n\ntype GroupedGraph = {\n  nodes: GraphNode[]\n  links: GraphLink[]\n  groupLinks: GraphLink[]\n  groups: (FileResource & SimulationNodeDatum)[]\n}\n\nexport const graphToGroupedGraph = (graph: Graph): GroupedGraph => {\n  const nodes = [...graph.nodes]\n\n  const files = nodes.filter((node) => node.type === 'File') as FileResource[]\n  const fileLinkedNodes = graph.nodes.filter(\n    (node) => hasPath(node) && node.type !== 'File'\n  )\n\n  const groupedGraph: GroupedGraph = {\n    nodes: graph.nodes,\n    links: graphEdgeToLinks(graph),\n    groupLinks: [],\n    groups: files,\n  }\n\n  const fileIndexByPath = (path: string): number | undefined =>\n    files.find((file) => file.path === path)?.index\n\n  for (const file of files) {\n    const fileIndex = fileIndexByPath(file.path)\n\n    if (fileIndex === undefined) break\n\n    for (const node of fileLinkedNodes) {\n      if (hasPath(node) && node.path === file.path) {\n        groupedGraph.groupLinks.push({\n          source: node.index,\n          target: file.index,\n          group: node.path,\n          relation: {\n            type: '',\n          },\n        })\n      }\n    }\n  }\n\n  return groupedGraph\n}\n\nexport const isInterGroupLink = (\n  source: GraphLink['source'],\n  target: GraphLink['target']\n): boolean => {\n  if (hasPath(source) && hasPath(target)) {\n    return (\n      (target.path !== '' || target.path !== '') && target.path === source.path\n    )\n  }\n\n  return false\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {timer, timeout} from \"d3-timer\";\n\nvar emptyOn = dispatch(\"start\", \"end\", \"cancel\", \"interrupt\");\nvar emptyTween = [];\n\nexport var CREATED = 0;\nexport var SCHEDULED = 1;\nexport var STARTING = 2;\nexport var STARTED = 3;\nexport var RUNNING = 4;\nexport var ENDING = 5;\nexport var ENDED = 6;\n\nexport default function(node, name, id, index, group, timing) {\n  var schedules = node.__transition;\n  if (!schedules) node.__transition = {};\n  else if (id in schedules) return;\n  create(node, id, {\n    name: name,\n    index: index, // For context during callback.\n    group: group, // For context during callback.\n    on: emptyOn,\n    tween: emptyTween,\n    time: timing.time,\n    delay: timing.delay,\n    duration: timing.duration,\n    ease: timing.ease,\n    timer: null,\n    state: CREATED\n  });\n}\n\nexport function init(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > CREATED) throw new Error(\"too late; already scheduled\");\n  return schedule;\n}\n\nexport function set(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > STARTED) throw new Error(\"too late; already running\");\n  return schedule;\n}\n\nexport function get(node, id) {\n  var schedule = node.__transition;\n  if (!schedule || !(schedule = schedule[id])) throw new Error(\"transition not found\");\n  return schedule;\n}\n\nfunction create(node, id, self) {\n  var schedules = node.__transition,\n      tween;\n\n  // Initialize the self timer when the transition is created.\n  // Note the actual delay is not known until the first callback!\n  schedules[id] = self;\n  self.timer = timer(schedule, 0, self.time);\n\n  function schedule(elapsed) {\n    self.state = SCHEDULED;\n    self.timer.restart(start, self.delay, self.time);\n\n    // If the elapsed delay is less than our first sleep, start immediately.\n    if (self.delay <= elapsed) start(elapsed - self.delay);\n  }\n\n  function start(elapsed) {\n    var i, j, n, o;\n\n    // If the state is not SCHEDULED, then we previously errored on start.\n    if (self.state !== SCHEDULED) return stop();\n\n    for (i in schedules) {\n      o = schedules[i];\n      if (o.name !== self.name) continue;\n\n      // While this element already has a starting transition during this frame,\n      // defer starting an interrupting transition until that transition has a\n      // chance to tick (and possibly end); see d3/d3-transition#54!\n      if (o.state === STARTED) return timeout(start);\n\n      // Interrupt the active transition, if any.\n      if (o.state === RUNNING) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"interrupt\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n\n      // Cancel any pre-empted transitions.\n      else if (+i < id) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"cancel\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n    }\n\n    // Defer the first tick to end of the current frame; see d3/d3#1576.\n    // Note the transition may be canceled after start and before the first tick!\n    // Note this must be scheduled before the start event; see d3/d3-transition#16!\n    // Assuming this is successful, subsequent callbacks go straight to tick.\n    timeout(function() {\n      if (self.state === STARTED) {\n        self.state = RUNNING;\n        self.timer.restart(tick, self.delay, self.time);\n        tick(elapsed);\n      }\n    });\n\n    // Dispatch the start event.\n    // Note this must be done before the tween are initialized.\n    self.state = STARTING;\n    self.on.call(\"start\", node, node.__data__, self.index, self.group);\n    if (self.state !== STARTING) return; // interrupted\n    self.state = STARTED;\n\n    // Initialize the tween, deleting null tween.\n    tween = new Array(n = self.tween.length);\n    for (i = 0, j = -1; i < n; ++i) {\n      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {\n        tween[++j] = o;\n      }\n    }\n    tween.length = j + 1;\n  }\n\n  function tick(elapsed) {\n    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),\n        i = -1,\n        n = tween.length;\n\n    while (++i < n) {\n      tween[i].call(node, t);\n    }\n\n    // Dispatch the end event.\n    if (self.state === ENDING) {\n      self.on.call(\"end\", node, node.__data__, self.index, self.group);\n      stop();\n    }\n  }\n\n  function stop() {\n    self.state = ENDED;\n    self.timer.stop();\n    delete schedules[id];\n    for (var i in schedules) return; // eslint-disable-line no-unused-vars\n    delete node.__transition;\n  }\n}\n","import {STARTING, ENDING, ENDED} from \"./transition/schedule.js\";\n\nexport default function(node, name) {\n  var schedules = node.__transition,\n      schedule,\n      active,\n      empty = true,\n      i;\n\n  if (!schedules) return;\n\n  name = name == null ? null : name + \"\";\n\n  for (i in schedules) {\n    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }\n    active = schedule.state > STARTING && schedule.state < ENDING;\n    schedule.state = ENDED;\n    schedule.timer.stop();\n    schedule.on.call(active ? \"interrupt\" : \"cancel\", node, node.__data__, schedule.index, schedule.group);\n    delete schedules[i];\n  }\n\n  if (empty) delete node.__transition;\n}\n","import interrupt from \"../interrupt.js\";\n\nexport default function(name) {\n  return this.each(function() {\n    interrupt(this, name);\n  });\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction tweenRemove(id, name) {\n  var tween0, tween1;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and were done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = tween0 = tween;\n      for (var i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1 = tween1.slice();\n          tween1.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nfunction tweenFunction(id, name, value) {\n  var tween0, tween1;\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and were done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = (tween0 = tween).slice();\n      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1[i] = t;\n          break;\n        }\n      }\n      if (i === n) tween1.push(t);\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nexport default function(name, value) {\n  var id = this._id;\n\n  name += \"\";\n\n  if (arguments.length < 2) {\n    var tween = get(this.node(), id).tween;\n    for (var i = 0, n = tween.length, t; i < n; ++i) {\n      if ((t = tween[i]).name === name) {\n        return t.value;\n      }\n    }\n    return null;\n  }\n\n  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));\n}\n\nexport function tweenValue(transition, name, value) {\n  var id = transition._id;\n\n  transition.each(function() {\n    var schedule = set(this, id);\n    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);\n  });\n\n  return function(node) {\n    return get(node, id).value[name];\n  };\n}\n","import {color} from \"d3-color\";\nimport {interpolateNumber, interpolateRgb, interpolateString} from \"d3-interpolate\";\n\nexport default function(a, b) {\n  var c;\n  return (typeof b === \"number\" ? interpolateNumber\n      : b instanceof color ? interpolateRgb\n      : (c = color(b)) ? (b = c, interpolateRgb)\n      : interpolateString)(a, b);\n}\n","import {interpolateTransformSvg as interpolateTransform} from \"d3-interpolate\";\nimport {namespace} from \"d3-selection\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttribute(name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrConstantNS(fullname, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttributeNS(fullname.space, fullname.local);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttribute(name);\n    string0 = this.getAttribute(name);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction attrFunctionNS(fullname, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);\n    string0 = this.getAttributeNS(fullname.space, fullname.local);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name), i = fullname === \"transform\" ? interpolateTransform : interpolate;\n  return this.attrTween(name, typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, \"attr.\" + name, value))\n      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)\n      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));\n}\n","import {namespace} from \"d3-selection\";\n\nfunction attrInterpolate(name, i) {\n  return function(t) {\n    this.setAttribute(name, i.call(this, t));\n  };\n}\n\nfunction attrInterpolateNS(fullname, i) {\n  return function(t) {\n    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));\n  };\n}\n\nfunction attrTweenNS(fullname, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nfunction attrTween(name, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value) {\n  var key = \"attr.\" + name;\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  var fullname = namespace(name);\n  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));\n}\n","import {get, init} from \"./schedule.js\";\n\nfunction delayFunction(id, value) {\n  return function() {\n    init(this, id).delay = +value.apply(this, arguments);\n  };\n}\n\nfunction delayConstant(id, value) {\n  return value = +value, function() {\n    init(this, id).delay = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? delayFunction\n          : delayConstant)(id, value))\n      : get(this.node(), id).delay;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction durationFunction(id, value) {\n  return function() {\n    set(this, id).duration = +value.apply(this, arguments);\n  };\n}\n\nfunction durationConstant(id, value) {\n  return value = +value, function() {\n    set(this, id).duration = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? durationFunction\n          : durationConstant)(id, value))\n      : get(this.node(), id).duration;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction easeConstant(id, value) {\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    set(this, id).ease = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each(easeConstant(id, value))\n      : get(this.node(), id).ease;\n}\n","import {set} from \"./schedule.js\";\n\nfunction easeVarying(id, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (typeof v !== \"function\") throw new Error;\n    set(this, id).ease = v;\n  };\n}\n\nexport default function(value) {\n  if (typeof value !== \"function\") throw new Error;\n  return this.each(easeVarying(this._id, value));\n}\n","import {matcher} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, this._name, this._id);\n}\n","import {Transition} from \"./index.js\";\n\nexport default function(transition) {\n  if (transition._id !== this._id) throw new Error;\n\n  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Transition(merges, this._parents, this._name, this._id);\n}\n","import {get, set, init} from \"./schedule.js\";\n\nfunction start(name) {\n  return (name + \"\").trim().split(/^|\\s+/).every(function(t) {\n    var i = t.indexOf(\".\");\n    if (i >= 0) t = t.slice(0, i);\n    return !t || t === \"start\";\n  });\n}\n\nfunction onFunction(id, name, listener) {\n  var on0, on1, sit = start(name) ? init : set;\n  return function() {\n    var schedule = sit(this, id),\n        on = schedule.on;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and were done!\n    // Otherwise, copy-on-write.\n    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, listener) {\n  var id = this._id;\n\n  return arguments.length < 2\n      ? get(this.node(), id).on.on(name)\n      : this.each(onFunction(id, name, listener));\n}\n","function removeFunction(id) {\n  return function() {\n    var parent = this.parentNode;\n    for (var i in this.__transition) if (+i !== id) return;\n    if (parent) parent.removeChild(this);\n  };\n}\n\nexport default function() {\n  return this.on(\"end.remove\", removeFunction(this._id));\n}\n","import {selector} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n        schedule(subgroup[i], name, id, i, subgroup, get(node, id));\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, name, id);\n}\n","import {selectorAll} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {\n          if (child = children[k]) {\n            schedule(child, name, id, k, children, inherit);\n          }\n        }\n        subgroups.push(children);\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, parents, name, id);\n}\n","import {selection} from \"d3-selection\";\n\nvar Selection = selection.prototype.constructor;\n\nexport default function() {\n  return new Selection(this._groups, this._parents);\n}\n","import {interpolateTransformCss as interpolateTransform} from \"d3-interpolate\";\nimport {style} from \"d3-selection\";\nimport {set} from \"./schedule.js\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction styleNull(name, interpolate) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        string1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, string10 = string1);\n  };\n}\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = style(this, name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction styleFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        value1 = value(this),\n        string1 = value1 + \"\";\n    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction styleMaybeRemove(id, name) {\n  var on0, on1, listener0, key = \"style.\" + name, event = \"end.\" + key, remove;\n  return function() {\n    var schedule = set(this, id),\n        on = schedule.on,\n        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and were done!\n    // Otherwise, copy-on-write.\n    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, value, priority) {\n  var i = (name += \"\") === \"transform\" ? interpolateTransform : interpolate;\n  return value == null ? this\n      .styleTween(name, styleNull(name, i))\n      .on(\"end.style.\" + name, styleRemove(name))\n    : typeof value === \"function\" ? this\n      .styleTween(name, styleFunction(name, i, tweenValue(this, \"style.\" + name, value)))\n      .each(styleMaybeRemove(this._id, name))\n    : this\n      .styleTween(name, styleConstant(name, i, value), priority)\n      .on(\"end.style.\" + name, null);\n}\n","function styleInterpolate(name, i, priority) {\n  return function(t) {\n    this.style.setProperty(name, i.call(this, t), priority);\n  };\n}\n\nfunction styleTween(name, value, priority) {\n  var t, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);\n    return t;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value, priority) {\n  var key = \"style.\" + (name += \"\");\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, styleTween(name, value, priority == null ? \"\" : priority));\n}\n","import {tweenValue} from \"./tween.js\";\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var value1 = value(this);\n    this.textContent = value1 == null ? \"\" : value1;\n  };\n}\n\nexport default function(value) {\n  return this.tween(\"text\", typeof value === \"function\"\n      ? textFunction(tweenValue(this, \"text\", value))\n      : textConstant(value == null ? \"\" : value + \"\"));\n}\n","function textInterpolate(i) {\n  return function(t) {\n    this.textContent = i.call(this, t);\n  };\n}\n\nfunction textTween(value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(value) {\n  var key = \"text\";\n  if (arguments.length < 1) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, textTween(value));\n}\n","import {Transition, newId} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function() {\n  var name = this._name,\n      id0 = this._id,\n      id1 = newId();\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        var inherit = get(node, id0);\n        schedule(node, name, id1, i, group, {\n          time: inherit.time + inherit.delay + inherit.duration,\n          delay: 0,\n          duration: inherit.duration,\n          ease: inherit.ease\n        });\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id1);\n}\n","import {set} from \"./schedule.js\";\n\nexport default function() {\n  var on0, on1, that = this, id = that._id, size = that.size();\n  return new Promise(function(resolve, reject) {\n    var cancel = {value: reject},\n        end = {value: function() { if (--size === 0) resolve(); }};\n\n    that.each(function() {\n      var schedule = set(this, id),\n          on = schedule.on;\n\n      // If this node shared a dispatch with the previous node,\n      // just assign the updated shared dispatch and were done!\n      // Otherwise, copy-on-write.\n      if (on !== on0) {\n        on1 = (on0 = on).copy();\n        on1._.cancel.push(cancel);\n        on1._.interrupt.push(cancel);\n        on1._.end.push(end);\n      }\n\n      schedule.on = on1;\n    });\n\n    // The selection was empty, resolve end immediately\n    if (size === 0) resolve();\n  });\n}\n","import {selection} from \"d3-selection\";\nimport transition_attr from \"./attr.js\";\nimport transition_attrTween from \"./attrTween.js\";\nimport transition_delay from \"./delay.js\";\nimport transition_duration from \"./duration.js\";\nimport transition_ease from \"./ease.js\";\nimport transition_easeVarying from \"./easeVarying.js\";\nimport transition_filter from \"./filter.js\";\nimport transition_merge from \"./merge.js\";\nimport transition_on from \"./on.js\";\nimport transition_remove from \"./remove.js\";\nimport transition_select from \"./select.js\";\nimport transition_selectAll from \"./selectAll.js\";\nimport transition_selection from \"./selection.js\";\nimport transition_style from \"./style.js\";\nimport transition_styleTween from \"./styleTween.js\";\nimport transition_text from \"./text.js\";\nimport transition_textTween from \"./textTween.js\";\nimport transition_transition from \"./transition.js\";\nimport transition_tween from \"./tween.js\";\nimport transition_end from \"./end.js\";\n\nvar id = 0;\n\nexport function Transition(groups, parents, name, id) {\n  this._groups = groups;\n  this._parents = parents;\n  this._name = name;\n  this._id = id;\n}\n\nexport default function transition(name) {\n  return selection().transition(name);\n}\n\nexport function newId() {\n  return ++id;\n}\n\nvar selection_prototype = selection.prototype;\n\nTransition.prototype = transition.prototype = {\n  constructor: Transition,\n  select: transition_select,\n  selectAll: transition_selectAll,\n  selectChild: selection_prototype.selectChild,\n  selectChildren: selection_prototype.selectChildren,\n  filter: transition_filter,\n  merge: transition_merge,\n  selection: transition_selection,\n  transition: transition_transition,\n  call: selection_prototype.call,\n  nodes: selection_prototype.nodes,\n  node: selection_prototype.node,\n  size: selection_prototype.size,\n  empty: selection_prototype.empty,\n  each: selection_prototype.each,\n  on: transition_on,\n  attr: transition_attr,\n  attrTween: transition_attrTween,\n  style: transition_style,\n  styleTween: transition_styleTween,\n  text: transition_text,\n  textTween: transition_textTween,\n  remove: transition_remove,\n  tween: transition_tween,\n  delay: transition_delay,\n  duration: transition_duration,\n  ease: transition_ease,\n  easeVarying: transition_easeVarying,\n  end: transition_end,\n  [Symbol.iterator]: selection_prototype[Symbol.iterator]\n};\n","export function cubicIn(t) {\n  return t * t * t;\n}\n\nexport function cubicOut(t) {\n  return --t * t * t + 1;\n}\n\nexport function cubicInOut(t) {\n  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\n}\n","import {Transition, newId} from \"../transition/index.js\";\nimport schedule from \"../transition/schedule.js\";\nimport {easeCubicInOut} from \"d3-ease\";\nimport {now} from \"d3-timer\";\n\nvar defaultTiming = {\n  time: null, // Set on use.\n  delay: 0,\n  duration: 250,\n  ease: easeCubicInOut\n};\n\nfunction inherit(node, id) {\n  var timing;\n  while (!(timing = node.__transition) || !(timing = timing[id])) {\n    if (!(node = node.parentNode)) {\n      throw new Error(`transition ${id} not found`);\n    }\n  }\n  return timing;\n}\n\nexport default function(name) {\n  var id,\n      timing;\n\n  if (name instanceof Transition) {\n    id = name._id, name = name._name;\n  } else {\n    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + \"\";\n  }\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        schedule(node, name, id, i, group, timing || inherit(node, id));\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id);\n}\n","import {selection} from \"d3-selection\";\nimport selection_interrupt from \"./interrupt.js\";\nimport selection_transition from \"./transition.js\";\n\nselection.prototype.interrupt = selection_interrupt;\nselection.prototype.transition = selection_transition;\n","export default x => () => x;\n","export default function ZoomEvent(type, {\n  sourceEvent,\n  target,\n  transform,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    transform: {value: transform, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n","export function Transform(k, x, y) {\n  this.k = k;\n  this.x = x;\n  this.y = y;\n}\n\nTransform.prototype = {\n  constructor: Transform,\n  scale: function(k) {\n    return k === 1 ? this : new Transform(this.k * k, this.x, this.y);\n  },\n  translate: function(x, y) {\n    return x === 0 & y === 0 ? this : new Transform(this.k, this.x + this.k * x, this.y + this.k * y);\n  },\n  apply: function(point) {\n    return [point[0] * this.k + this.x, point[1] * this.k + this.y];\n  },\n  applyX: function(x) {\n    return x * this.k + this.x;\n  },\n  applyY: function(y) {\n    return y * this.k + this.y;\n  },\n  invert: function(location) {\n    return [(location[0] - this.x) / this.k, (location[1] - this.y) / this.k];\n  },\n  invertX: function(x) {\n    return (x - this.x) / this.k;\n  },\n  invertY: function(y) {\n    return (y - this.y) / this.k;\n  },\n  rescaleX: function(x) {\n    return x.copy().domain(x.range().map(this.invertX, this).map(x.invert, x));\n  },\n  rescaleY: function(y) {\n    return y.copy().domain(y.range().map(this.invertY, this).map(y.invert, y));\n  },\n  toString: function() {\n    return \"translate(\" + this.x + \",\" + this.y + \") scale(\" + this.k + \")\";\n  }\n};\n\nexport var identity = new Transform(1, 0, 0);\n\ntransform.prototype = Transform.prototype;\n\nexport default function transform(node) {\n  while (!node.__zoom) if (!(node = node.parentNode)) return identity;\n  return node.__zoom;\n}\n","export function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolateZoom} from \"d3-interpolate\";\nimport {select, pointer} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport ZoomEvent from \"./event.js\";\nimport {Transform, identity} from \"./transform.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\n// Ignore right-click, since that should open the context menu.\n// except for pinch-to-zoom, which is sent as a wheel+ctrlKey event\nfunction defaultFilter(event) {\n  return (!event.ctrlKey || event.type === 'wheel') && !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this;\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    if (e.hasAttribute(\"viewBox\")) {\n      e = e.viewBox.baseVal;\n      return [[e.x, e.y], [e.x + e.width, e.y + e.height]];\n    }\n    return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];\n  }\n  return [[0, 0], [e.clientWidth, e.clientHeight]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta(event) {\n  return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * (event.ctrlKey ? 10 : 1);\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(\n    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),\n    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)\n  );\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchfirst,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0,\n      tapDistance = 10;\n\n  function zoom(selection) {\n    selection\n        .property(\"__zoom\", defaultTransform)\n        .on(\"wheel.zoom\", wheeled, {passive: false})\n        .on(\"mousedown.zoom\", mousedowned)\n        .on(\"dblclick.zoom\", dblclicked)\n      .filter(touchable)\n        .on(\"touchstart.zoom\", touchstarted)\n        .on(\"touchmove.zoom\", touchmoved)\n        .on(\"touchend.zoom touchcancel.zoom\", touchended)\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function(collection, transform, point, event) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n    if (collection !== selection) {\n      schedule(collection, transform, point, event);\n    } else {\n      selection.interrupt().each(function() {\n        gesture(this, arguments)\n          .event(event)\n          .start()\n          .zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform)\n          .end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function(selection, k, p, event) {\n    zoom.scaleTo(selection, function() {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    }, p, event);\n  };\n\n  zoom.scaleTo = function(selection, k, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p,\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    }, p, event);\n  };\n\n  zoom.translateBy = function(selection, x, y, event) {\n    zoom.transform(selection, function() {\n      return constrain(this.__zoom.translate(\n        typeof x === \"function\" ? x.apply(this, arguments) : x,\n        typeof y === \"function\" ? y.apply(this, arguments) : y\n      ), extent.apply(this, arguments), translateExtent);\n    }, null, event);\n  };\n\n  zoom.translateTo = function(selection, x, y, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p;\n      return constrain(identity.translate(p0[0], p0[1]).scale(t.k).translate(\n        typeof x === \"function\" ? -x.apply(this, arguments) : -x,\n        typeof y === \"function\" ? -y.apply(this, arguments) : -y\n      ), e, translateExtent);\n    }, p, event);\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, point, event) {\n    transition\n        .on(\"start.zoom\", function() { gesture(this, arguments).event(event).start(); })\n        .on(\"interrupt.zoom end.zoom\", function() { gesture(this, arguments).event(event).end(); })\n        .tween(\"zoom\", function() {\n          var that = this,\n              args = arguments,\n              g = gesture(that, args).event(event),\n              e = extent.apply(that, args),\n              p = point == null ? centroid(e) : typeof point === \"function\" ? point.apply(that, args) : point,\n              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n              a = that.__zoom,\n              b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n          return function(t) {\n            if (t === 1) t = b; // Avoid rounding error on end.\n            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }\n            g.zoom(null, t);\n          };\n        });\n  }\n\n  function gesture(that, args, clean) {\n    return (!clean && that.__zooming) || new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.active = 0;\n    this.sourceEvent = null;\n    this.extent = extent.apply(that, args);\n    this.taps = 0;\n  }\n\n  Gesture.prototype = {\n    event: function(event) {\n      if (event) this.sourceEvent = event;\n      return this;\n    },\n    start: function() {\n      if (++this.active === 1) {\n        this.that.__zooming = this;\n        this.emit(\"start\");\n      }\n      return this;\n    },\n    zoom: function(key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) {\n        delete this.that.__zooming;\n        this.emit(\"end\");\n      }\n      return this;\n    },\n    emit: function(type) {\n      var d = select(this.that).datum();\n      listeners.call(\n        type,\n        this.that,\n        new ZoomEvent(type, {\n          sourceEvent: this.sourceEvent,\n          target: zoom,\n          type,\n          transform: this.that.__zoom,\n          dispatch: listeners\n        }),\n        d\n      );\n    }\n  };\n\n  function wheeled(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, args).event(event),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = pointer(event);\n\n    // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n      clearTimeout(g.wheel);\n    }\n\n    // If this wheel event wont trigger a transform change, ignore it.\n    else if (t.k === k) return;\n\n    // Otherwise, capture the mouse point and location at the start.\n    else {\n      g.mouse = [p, t.invert(p)];\n      interrupt(this);\n      g.start();\n    }\n\n    noevent(event);\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned(event, ...args) {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var currentTarget = event.currentTarget,\n        g = gesture(this, args, true).event(event),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = pointer(event, currentTarget),\n        x0 = event.clientX,\n        y0 = event.clientY;\n\n    dragDisable(event.view);\n    nopropagation(event);\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved(event) {\n      noevent(event);\n      if (!g.moved) {\n        var dx = event.clientX - x0, dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n      g.event(event)\n       .zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = pointer(event, currentTarget), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped(event) {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent(event);\n      g.event(event).end();\n    }\n  }\n\n  function dblclicked(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = pointer(event.changedTouches ? event.changedTouches[0] : event, this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, args), translateExtent);\n\n    noevent(event);\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0, event);\n    else select(this).call(zoom.transform, t1, p0, event);\n  }\n\n  function touchstarted(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.touches,\n        n = touches.length,\n        g = gesture(this, args, event.changedTouches.length === n).event(event),\n        started, i, t, p;\n\n    nopropagation(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;\n      else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;\n    }\n\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n\n    if (started) {\n      if (g.taps < 2) touchfirst = p[0], touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t, p, l;\n\n    noevent(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;\n      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n    t = g.that.__zoom;\n    if (g.touch1) {\n      var p0 = g.touch0[0], l0 = g.touch0[1],\n          p1 = g.touch1[0], l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    }\n    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];\n    else return;\n\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t;\n\n    nopropagation(event);\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, touchDelay);\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;\n      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);\n    else {\n      g.end();\n      // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.\n      if (g.taps === 2) {\n        t = pointer(t, this);\n        if (Math.hypot(touchfirst[0] - t[0], touchfirst[1] - t[1]) < tapDistance) {\n          var p = select(this).on(\"dblclick.zoom\");\n          if (p) p.apply(this, arguments);\n        }\n      }\n    }\n  }\n\n  zoom.wheelDelta = function(_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function(_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function(_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function(_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function(_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  zoom.tapDistance = function(_) {\n    return arguments.length ? (tapDistance = +_, zoom) : tapDistance;\n  };\n\n  return zoom;\n}\n","import { SimulationNodeDatum } from 'd3-force'\nimport { select } from 'd3-selection'\nimport { zoom } from 'd3-zoom'\nimport { Resource } from '../types'\n\nexport type GraphDatum = SimulationNodeDatum & Resource\n\nexport const initGraph = (el: HTMLDivElement) => {\n  const elSize = el.getBoundingClientRect()\n  const height = elSize.height >= 120 ? elSize.height : 600\n  const width = elSize.width >= 100 ? elSize.width : 600\n\n  const svg = select(el)\n    .append('svg')\n    .attr('viewBox', [-width / 2, -height / 2, width, height].join(' '))\n\n  const svgContent = svg.append('g')\n\n  const zoomFn = zoom<SVGSVGElement, unknown>().on('zoom', ({ transform }) => {\n    svgContent.attr('transform', transform)\n  })\n\n  svg.call(zoomFn)\n\n  svg\n    .append('svg:defs')\n    .selectAll('marker')\n    .data(['end'])\n    .enter()\n    .append('svg:marker')\n    .attr('id', String)\n    .attr('viewBox', '0 -6 12 12')\n    .attr('refX', 24)\n    .attr('refY', 0)\n    .attr('markerWidth', 6)\n    .attr('markerHeight', 6)\n    .attr('orient', 'auto')\n    .append('svg:path')\n    .attr('d', 'M0,-6L12,0L0,6')\n\n  return {\n    height,\n    width,\n    svg: svgContent,\n  }\n}\n","import { SimulationNodeDatum } from 'd3-force'\n\ntype NodeType = string | number | SimulationNodeDatum\n\nexport const getNodeX = (node: NodeType): number => {\n  if (typeof node === 'number') {\n    return node\n  } else if (typeof node === 'string') {\n    return Number.parseInt(node, 10)\n  }\n\n  return node.x ?? 0\n}\n\nexport const getNodeY = (node: NodeType): number => {\n  if (typeof node === 'number') {\n    return node\n  } else if (typeof node === 'string') {\n    return Number.parseInt(node, 10)\n  }\n\n  return node.y ?? 0\n}\n","import { Relation, Resource } from '../types'\n\nexport const getResourceLabel = (resource: Resource): string => {\n  switch (resource.type) {\n    case 'Module': {\n      return `${resource.language} ${resource.name}`\n    }\n    case 'Source': {\n      return `${resource.type} ${resource.name}`\n    }\n    case 'Symbol': {\n      return `${resource.kind} ${resource.name}`\n    }\n    case 'Node': {\n      return resource.kind\n    }\n    case 'File': {\n      return resource.path\n    }\n    case 'Url': {\n      return resource.url\n    }\n  }\n}\n\nexport const getRelationLabel = (relation: Relation): string => {\n  switch (relation.type) {\n    case 'Assign':\n    case 'Read':\n    case 'Use': {\n      return `${relation.type}s`\n    }\n    case 'Convert':\n    case 'Import': {\n      return `${relation.type}s${relation.auto ? ' (auto)' : ''}`\n    }\n    default: {\n      return `${relation.type}s`\n    }\n  }\n}\n","import {\n  symbol,\n  symbolCircle,\n  symbolDiamond,\n  symbolSquare,\n  symbolStar,\n  symbolTriangle,\n  symbolWye,\n} from 'd3-shape'\nimport { Resource } from '../types'\n\nexport const getResourceSymbol = (resource: Resource, size = 512) => {\n  switch (resource.type) {\n    case 'Node': {\n      return symbol(symbolTriangle, size)\n    }\n    case 'Symbol': {\n      return symbol(symbolDiamond, size)\n    }\n    case 'Source': {\n      return symbol(symbolStar, size)\n    }\n    case 'File': {\n      return symbol(symbolWye, size)\n    }\n    case 'Url': {\n      return symbol(symbolSquare, size)\n    }\n    case 'Module':\n    default: {\n      return symbol(symbolCircle, size)\n    }\n  }\n}\n",":host,\nstencila-project-graph,\n.projectGraph {\n  display: block;\n  height: 100%;\n  width: 100%;\n\n  --graph-background: #fff;\n  --graphColor-text: var(--color-key, #000);\n  --graphColor-link: var(--color-neutral-100);\n  --graphColor-default: var(--color-neutral-300);\n  --graphColor-file: #ffec6f;\n  --graphColor-source: #ccebc5;\n  --graphColor-symbol: #bc80bd;\n  --graphColor-module: #d9d9d9;\n  --graphColor-node: #fccde5;\n  --graphColor-url: #80b1d3;\n  --graphColor-file: #b3de69;\n  --graphColor-file: #fdb462;\n  --graphColor-file: #fb7f72;\n  --graphColor-file: #bebada;\n}\n\n.hullContainer path {\n  fill: var(--graphColor-file);\n  opacity: 0.2;\n}\n\n.linkContainer line {\n  stroke: var(--graphColor-link);\n  stroke-width: 2;\n}\n\n.groupLinkContainer text,\n.groupLinkContainer line {\n  opacity: 0;\n}\n\n.groupLinkContainer line {\n  stroke: var(--graphColor-symbol);\n}\n\n.projectGraph:hover .groupLinkContainer text,\n.projectGraph:hover .groupLinkContainer line {\n  opacity: 1;\n}\n\n.linkContainer text {\n  font-size: 0.5rem;\n}\n\nsvg {\n  cursor: move;\n  height: 100%;\n  width: 100%;\n}\n\nsvg text {\n  fill: var(--color-key);\n  font-size: 0.75rem;\n  font-family: var(--font-family-mono);\n  text-anchor: middle;\n}\n\nsvg text.textBackdrop {\n  stroke: var(--graph-background);\n  stroke-width: 2px;\n}\n\nsvg circle,\nsvg path {\n  fill: var(--graphColor-default);\n}\n\nsvg g {\n  cursor: grab;\n}\n\nsvg g:active {\n  cursor: grabbing;\n}\n\nsvg g.File text,\nsvg g.Source text {\n  font-size: 1rem;\n  font-weight: bold;\n}\n\nsvg path.File {\n  fill: var(--graphColor-file);\n}\n\nsvg path.Source {\n  stroke: var(--graphColor-source);\n  stroke-width: 1;\n}\n\nsvg path.Symbol {\n  fill: var(--graphColor-symbol);\n}\n\nsvg path.Module {\n  fill: var(--graphColor-module);\n}\n\nsvg path.Node {\n  fill: var(--graphColor-node);\n}\n\nsvg path.Url {\n  fill: var(--graphColor-url);\n}\n",null,"import { Component, h, Host, Prop, Watch } from '@stencil/core'\nimport { D3DragEvent, drag } from 'd3-drag'\nimport {\n  forceCenter,\n  forceCollide,\n  forceLink,\n  forceManyBody,\n  forceSimulation,\n  forceX,\n  forceY,\n} from 'd3-force'\nimport { polygonHull } from 'd3-polygon'\nimport { Selection } from 'd3-selection'\nimport { curveBasisClosed, line } from 'd3-shape'\nimport { graphToGroupedGraph, isInterGroupLink } from './graphs'\nimport { FileResource, Graph, SimulationGraphNode } from './types'\nimport { GraphDatum, initGraph } from './utils'\nimport { hasKind } from './utils/guards'\nimport { getNodeX, getNodeY } from './utils/nodes'\nimport { getRelationLabel, getResourceLabel } from './utils/resource'\nimport { getResourceSymbol } from './utils/symbols'\n\ntype NodeDragEvent = D3DragEvent<SVGGElement, GraphDatum, GraphDatum>\n\n@Component({\n  tag: 'stencila-project-graph',\n  styleUrls: {\n    default: 'projectGraph.css',\n    material: 'projectGraph.material.css',\n  },\n  shadow: true,\n})\nexport class ProjectGraph {\n  private el?: HTMLDivElement\n\n  /**\n   * The project graph data to render\n   */\n  @Prop() graph: Graph\n\n  @Watch('graph')\n  updateGraph(nextGraph: Graph): void {\n    this.drawGraph(nextGraph)\n  }\n\n  private graphRef: {\n    height: number\n    width: number\n    svg: Selection<SVGGElement, unknown, null, undefined>\n  }\n\n  private nodeContainer:\n    | Selection<SVGGElement, unknown, null, unknown>\n    | undefined\n\n  private linkContainer:\n    | Selection<SVGGElement, unknown, null, unknown>\n    | undefined\n\n  private hullContainer:\n    | Selection<SVGGElement, unknown, null, unknown>\n    | undefined\n\n  private drawGraph = (graph: Graph) => {\n    const { svg } = this.graphRef\n\n    const groupedGraph = graphToGroupedGraph(graph)\n\n    const simulation = forceSimulation(groupedGraph.nodes)\n      .force(\n        'link',\n        forceLink(groupedGraph.links)\n          .strength((d) =>\n            isInterGroupLink(d.source, d.target) ||\n            (hasKind(d.source) && d.source.kind === 'Link') ||\n            (hasKind(d.target) && d.target.kind === 'Link')\n              ? 1\n              : 0.375\n          )\n          .iterations(2)\n          .distance((d) =>\n            (hasKind(d.source) && d.source.kind === 'Link') ||\n            (hasKind(d.target) && d.target.kind === 'Link')\n              ? 0\n              : 30\n          )\n          .iterations(2)\n      )\n      .force(\n        'link:groups',\n        forceLink(groupedGraph.groupLinks)\n          .strength((d) =>\n            (hasKind(d.source) && d.source.kind === 'Link') ||\n            (hasKind(d.target) && d.target.kind === 'Link')\n              ? 1\n              : 0.375\n          )\n          .iterations(3)\n      )\n      .force(\n        'charge',\n        forceManyBody<SimulationGraphNode>()\n          .strength((d) => {\n            return d.type === 'File' ? -100 : -1500\n          })\n          .distanceMin(10)\n          .distanceMax(1500)\n      )\n      .force('collision', forceCollide(64).strength(1).iterations(4))\n      .force('x', forceX().strength(0.02))\n      .force('y', forceY().strength(0.02))\n      .force('center', forceCenter())\n      .velocityDecay(0.4)\n      .alphaDecay(0.05)\n\n    const click = (_event: Event, d: GraphDatum) => {\n      delete d.fx\n      delete d.fy\n      simulation.alpha(0.5).restart()\n    }\n\n    const dragFn = drag<SVGGElement, GraphDatum, GraphDatum>().on(\n      'drag',\n      (event: NodeDragEvent, d: GraphDatum) => {\n        // d.fx = clamp(event.x, 0, width)\n        // d.fy = clamp(event.y, 0, height)\n        d.fx = event.x\n        d.fy = event.y\n\n        simulation.alpha(0.05).restart()\n      }\n    )\n\n    const hullContainer =\n      this.hullContainer ?? svg.append('g').attr('class', 'hullContainer')\n\n    if (!this.hullContainer) {\n      this.hullContainer = hullContainer\n    }\n\n    const linkContainer =\n      this.linkContainer ?? svg.append('g').attr('class', 'linkContainer')\n\n    if (!this.linkContainer) {\n      this.linkContainer = linkContainer\n    }\n\n    const links = linkContainer\n      .selectAll('g')\n      .data(groupedGraph.links)\n      .join((enter) => {\n        const linkGroup = enter.append('g')\n\n        linkGroup.append('line').attr('marker-end', 'url(#end)')\n\n        linkGroup.append('text').text((d) => {\n          return getRelationLabel(d.relation)\n        })\n\n        return linkGroup\n      })\n\n    const nodeContainer = this.nodeContainer ?? svg.append('g')\n\n    if (!this.nodeContainer) {\n      this.nodeContainer = nodeContainer\n    }\n\n    // Hulls are the container shapes surrounding clusters of nodes\n    // @see https://github.com/d3/d3-polygon/blob/main/README.md#polygonhull\n    const drawHull = (\n      fileNode: string | number | undefined | FileResource\n    ): string => {\n      if (\n        fileNode === undefined ||\n        typeof fileNode === 'string' ||\n        typeof fileNode === 'number'\n      ) {\n        return ''\n      }\n\n      // Padding amount to use when drawing shape around symbols\n      const pad = 32\n\n      const hullFileNodes = groupedGraph.groupLinks.filter(\n        (node) => node.group === fileNode.path\n      )\n\n      const rootCoords: [number, number][] =\n        hullFileNodes.length === 0\n          ? []\n          : [\n              [-pad, -pad],\n              [pad, -pad],\n              [pad, pad],\n              [0, pad],\n            ]\n\n      // The target is always the File node being linked to\n      const targetX = getNodeX(fileNode)\n      const targetY = getNodeY(fileNode)\n\n      const hull = polygonHull(\n        hullFileNodes.reduce((nodes: [number, number][], node) => {\n          const sourceX = getNodeX(node.source)\n          const sourceY = getNodeY(node.source)\n\n          return [\n            ...nodes,\n            [sourceX - targetX - pad, sourceY - targetY - pad],\n            [sourceX - targetX - pad, sourceY - targetY + pad],\n            [sourceX - targetX + pad, sourceY - targetY - pad],\n            [sourceX - targetX + pad, sourceY - targetY + pad],\n          ]\n        }, rootCoords)\n      )\n\n      return hull ? line().curve(curveBasisClosed)(hull) ?? '' : ''\n    }\n\n    const hull = hullContainer\n      .selectAll('path')\n      .data(groupedGraph.groups)\n      .join('path')\n      .attr('d', (d) => drawHull(d) ?? '')\n\n    const node = nodeContainer\n      .selectAll<SVGGElement, GraphDatum>('g')\n      .data<GraphDatum>(groupedGraph.nodes)\n      .join((enter) => {\n        const nodeGroup = enter.append('g')\n\n        nodeGroup\n          .append('path')\n          .attr('d', (d) =>\n            getResourceSymbol(d)(d.type === 'File' ? 1024 : 512)\n          )\n          .attr('class', (d) => {\n            return hasKind(d) ? `${d.type} ${d.kind}` : d.type\n          })\n\n        nodeGroup\n          .append('text')\n          .attr('class', 'textBackdrop')\n          .attr('dy', '.35em')\n          .text(getResourceLabel)\n          .append('text')\n          .exit()\n\n        nodeGroup\n          .append('text')\n          .attr('dy', '.35em')\n          .text(getResourceLabel)\n          .exit()\n\n        nodeGroup.append('title').text((d) => d.type)\n\n        return nodeGroup\n      })\n      .attr('class', (d) => (hasKind(d) ? `${d.type} ${d.kind}` : d.type))\n      .on('click', click)\n      .call(dragFn)\n\n    simulation.on('tick', () => {\n      // Position link lines\n      links\n        .select('line')\n        .attr('x1', ({ source }) =>\n          typeof source === 'object' ? source.x ?? 0 : source\n        )\n        .attr('y1', ({ source }) =>\n          typeof source === 'object' ? source.y ?? 0 : source\n        )\n        .attr('x2', ({ target }) =>\n          typeof target === 'object' ? target.x ?? 0 : target\n        )\n        .attr('y2', ({ target }) =>\n          typeof target === 'object' ? target.y ?? 0 : target\n        )\n\n      // Position link line labels\n      links.select('text').attr('transform', (d) => {\n        if (\n          typeof d.source === 'object' &&\n          typeof d.source.y === 'number' &&\n          typeof d.source.x === 'number' &&\n          typeof d.target === 'object' &&\n          typeof d.target.y === 'number' &&\n          typeof d.target.x === 'number'\n        ) {\n          return `translate(${d.source.x - (d.source.x - d.target.x) / 2}, ${\n            d.source.y - (d.source.y - d.target.y) / 2\n          })`\n        }\n\n        return ''\n      })\n\n      node.attr('transform', ({ x, y }) => `translate(${x ?? 0}, ${y ?? 0})`)\n\n      // Update File node grouping container shape\n      hull\n        .attr('transform', (d) => `translate(${d.x ?? 0}, ${d.y ?? 0})`)\n        .attr('d', (d) => drawHull(d) ?? '')\n    })\n  }\n\n  componentDidLoad() {\n    if (this.el) {\n      this.graphRef = initGraph(this.el)\n      this.drawGraph(this.graph)\n    }\n  }\n\n  public render() {\n    return (\n      <Host>\n        <div ref={(el) => (this.el = el)} class=\"projectGraph\"></div>\n      </Host>\n    )\n  }\n}\n"]}