{"file":"stencila-code-fragment.entry.cjs.js","mappings":";;;;;;;;AAAA,MAAM,sBAAsB,GAAG,u+FAAu+F;;ACAtgG,MAAM,uBAAuB,GAAG,igGAAigG;;MCmCphG,qBAAqB;EARlC;;;;;;;;;IAgBE,SAAI,GAAoB,MAAM,CAAA;;;;IAYvB,yBAAoB,GAAkBA,2BAAa,CAAA;;;;IAMnD,wBAAmB,GACxB,MAAA,MAAA,MAAM,CAAC,iBAAiB,0CAAE,mBAAmB,mCAAI,EAAE,CAAA;;;;IAkB7C,qBAAgB,GAAG,CAAC,QAAgB;MAC1C,IAAI,CAAC,cAAc,CAAC,IAAI,CAACC,0BAAY,CAAC,QAAQ,CAAC,CAAC,CAAA;MAChD,IAAI,CAAC,mBAAmB,GAAG,QAAQ,CAAA;KACpC,CAAA;IAQO,yBAAoB,GAAG,CAAC,CAAQ;;MACtC,MAAM,MAAM,GAAG,CAAC,CAAC,aAAgC,CAAA;MACjD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAA,MAAM,CAAC,WAAW,mCAAI,EAAE,CAAC,CAAA;KAClD,CAAA;IAEO,mBAAc,GAAG,MACvB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;GAmCjC;EAnEC,6BAA6B,CAAC,EAC5B,MAAM,GAC2B;IACjC,IAAI,CAAC,mBAAmB,GAAG,MAAM,CAAC,SAAS,CAAA;GAC5C;;;;EAkCM,MAAM,eAAe;;IAC1B,MAAM,IAAI,GAAG,IAAI,CAAC,cAAc,EAAE,CAAA;IAClC,OAAO,OAAO,CAAC,OAAO,CAAC,MAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,WAAW,mCAAI,EAAE,CAAC,CAAA;GAChD;EAEM,MAAM;;IACX,QACEC,QAACC,UAAI,IAAC,KAAK,EAAC,MAAM,IAChBD,kBAAM,KAAK,EAAC,kBAAkB,IAC5BA,QAACE,mCAAoB,IACnB,cAAc,EAAE,MAAA,IAAI,CAAC,mBAAmB,mCAAI,EAAE,EAC9C,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,EAC7C,aAAa,EAAE,IAAI,CAAC,gBAAgB,EACpC,oBAAoB,EAAE,IAAI,CAAC,oBAAoB,EAC/C,QAAQ,EAAE,IAAI,CAAC,IAAI,KAAK,MAAM,GACR,CACnB,EAEPF,kBACE,KAAK,EAAC,MAAM,EACZ,eAAe,EAAE,IAAI,CAAC,IAAI,KAAK,MAAM,EACrC,OAAO,EAAE,IAAI,CAAC,oBAAoB,EAClC,IAAI,EAAC,SAAS,IAEdA,kBAAM,IAAI,EAAC,MAAM,GAAG,CACf,CACF,EACR;GACF;;;;;;;;;;","names":["fileFormatMap","lookupFormat","h","Host","LanguagePickerInline"],"sources":["./src/components/codeFragment/codeFragment.css?tag=stencila-code-fragment&mode=default&encapsulation=scoped","./src/components/codeFragment/codeFragment.css?tag=stencila-code-fragment&mode=material&encapsulation=scoped","./src/components/codeFragment/codeFragment.tsx"],"sourcesContent":["@import '~@stencila/style-stencila/dist/molecules/codeFragment.css';\n","@import '~@stencila/style-stencila/dist/molecules/codeFragment.css';\n","import {\n  Component,\n  Element,\n  Event,\n  EventEmitter,\n  h,\n  Host,\n  Listen,\n  Method,\n  Prop,\n} from '@stencil/core'\nimport { CodeFragment } from '@stencila/schema'\nimport {\n  CodeComponent,\n  DiscoverExecutableLanguagesEvent,\n} from '../code/codeTypes'\nimport { LanguagePickerInline } from '../codeExpression/languageSelect'\nimport {\n  FileFormat,\n  fileFormatMap,\n  FileFormatMap,\n  lookupFormat,\n} from '../editor/languageUtils'\n\n/**\n * @slot text - The contents of the code fragment\n */\n@Component({\n  tag: 'stencila-code-fragment',\n  styleUrls: {\n    default: 'codeFragment.css',\n    material: 'codeFragment.css',\n  },\n  scoped: true,\n})\nexport class CodeFragmentComponent implements CodeComponent<CodeFragment> {\n  @Element() private el: HTMLStencilaCodeExpressionElement\n\n  /**\n   * The context of the component. In `read` mode the code content and its\n   * language cannot be edited.\n   */\n  @Prop({ reflect: true })\n  mode: 'read' | 'edit' = 'read'\n\n  /**\n   * Programming language of the CodeFragment\n   */\n  @Prop({ mutable: true })\n  public programmingLanguage: string | undefined\n\n  /**\n   * List of all supported programming languages\n   */\n  @Prop()\n  public languageCapabilities: FileFormatMap = fileFormatMap\n\n  /**\n   * List of programming languages that can be executed in the current context\n   */\n  @Prop({ mutable: true })\n  public executableLanguages: FileFormatMap =\n    window.stencilaWebClient?.executableLanguages ?? {}\n\n  @Listen('stencila-discover-executable-languages', { target: 'window' })\n  onDiscoverExecutableLanguages({\n    detail,\n  }: DiscoverExecutableLanguagesEvent): void {\n    this.executableLanguages = detail.languages\n  }\n\n  /**\n   * Event emitted when the language of the editor is changed.\n   */\n  @Event({ eventName: 'stencila-language-change' })\n  languageChange: EventEmitter<FileFormat>\n\n  /**\n   * Function to call when the user selects a new language from the language picker dropdown.\n   */\n  private onSelectLanguage = (language: string): void => {\n    this.languageChange.emit(lookupFormat(language))\n    this.programmingLanguage = language\n  }\n\n  /**\n   * Event emitted when the source code of the `CodeExpression` node is changed.\n   */\n  @Event({ eventName: 'stencila-content-change' })\n  contentChange: EventEmitter<string>\n\n  private contentChangeHandler = (e: Event) => {\n    const target = e.currentTarget as HTMLSpanElement\n    this.contentChange.emit(target.textContent ?? '')\n  }\n\n  private selectTextSlot = (): HTMLElement | null =>\n    this.el.querySelector(`.text`)\n\n  /**\n   * Returns the text contents from the inline code editor\n   */\n  @Method()\n  public async getTextContents(): Promise<string> {\n    const slot = this.selectTextSlot()\n    return Promise.resolve(slot?.textContent ?? '')\n  }\n\n  public render() {\n    return (\n      <Host class=\"text\">\n        <span class=\"actionsSecondary\">\n          <LanguagePickerInline\n            activeLanguage={this.programmingLanguage ?? ''}\n            executableLanguages={this.executableLanguages}\n            onSetLanguage={this.onSelectLanguage}\n            languageCapabilities={this.languageCapabilities}\n            disabled={this.mode === 'read'}\n          ></LanguagePickerInline>\n        </span>\n\n        <span\n          class=\"text\"\n          contentEditable={this.mode === 'edit'}\n          onInput={this.contentChangeHandler}\n          role=\"textbox\"\n        >\n          <slot name=\"text\" />\n        </span>\n      </Host>\n    )\n  }\n}\n"],"version":3}