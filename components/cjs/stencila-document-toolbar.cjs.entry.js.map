{"file":"stencila-document-toolbar.entry.cjs.js","mappings":"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","names":["isPending","h","Host"],"sources":["./src/components/documentToolbar/documentToolbar.css?tag=stencila-document-toolbar&mode=default","./src/components/documentToolbar/documentToolbar.css?tag=stencila-document-toolbar&mode=material","./src/components/documentToolbar/documentToolbar.tsx"],"sourcesContent":["@import '~@stencila/style-stencila/dist/objects/documentToolbar.css';\n","@import '~@stencila/style-stencila/dist/objects/documentToolbar.css';\n","import {\n  Component,\n  ComponentInterface,\n  Event,\n  EventEmitter,\n  h,\n  Host,\n  Listen,\n  Prop,\n  State,\n} from '@stencil/core'\nimport {\n  CodeExecuteCancelEvent,\n  CodeExecuteEvent,\n  DiscoverExecutableLanguagesEvent,\n  ExecuteStatus,\n} from '../code/codeTypes'\nimport { isPending } from '../code/codeUtils'\n\n// =============================================================================\n\n@Component({\n  tag: 'stencila-document-toolbar',\n  styleUrls: {\n    default: 'documentToolbar.css',\n    material: 'documentToolbar.css',\n  },\n})\nexport class StencilaDocumentToolbar implements ComponentInterface {\n  /**\n   * The URL of the document being decorated. Could be a Snapshot from Stencila Hub, a Project URL, or something else.\n   */\n  @Prop()\n  sourceUrl: string\n\n  /**\n   * When `fixed` the Navbar will remain pinned to the top of the screen.\n   * Note that if the Navbar component is not followed by a sibling element,\n   * you will have to set `margin-top: 3rem` on the following element yourself.\n   */\n  @Prop()\n  public position: 'fixed' | 'static' = 'fixed'\n\n  /**\n   * The execution status of the document\n   */\n  @Prop()\n  executeStatus: ExecuteStatus\n\n  @State()\n  isExecutable: boolean =\n    Object.keys(window.stencilaWebClient?.executableLanguages ?? {}).length > 0\n\n  @State()\n  shiftIsPressed = false\n\n  @State()\n  altIsPressed = false\n\n  private onKeyPress = (e: KeyboardEvent): void => {\n    this.shiftIsPressed = e.shiftKey\n    this.altIsPressed = e.altKey\n  }\n\n  private addKeyListeners = () => {\n    window.addEventListener('keydown', this.onKeyPress)\n    window.addEventListener('keyup', this.onKeyPress)\n  }\n\n  private removeKeyListeners = () => {\n    window.removeEventListener('keydown', this.onKeyPress)\n    window.removeEventListener('keyup', this.onKeyPress)\n    this.shiftIsPressed = false\n    this.altIsPressed = false\n  }\n\n  @Listen('stencila-discover-executable-languages', { target: 'window' })\n  onDiscoverExecutableLanguages({\n    detail,\n  }: DiscoverExecutableLanguagesEvent): void {\n    this.isExecutable = Object.keys(detail.languages).length > 0\n  }\n\n  /**\n   * Emitted to indicate that code node should be executed\n   *\n   */\n  @Event({\n    eventName: 'stencila-code-execute',\n  })\n  public codeExecuteEvent: EventEmitter<CodeExecuteEvent['detail']>\n\n  /**\n   * Emitted to indicate that language kernels should be restarted\n   *\n   */\n  @Event({\n    eventName: 'stencila-kernel-restart',\n  })\n  public kernelRestart: EventEmitter<Record<string, never>>\n\n  /**\n   * Emitted to indicate that the execution of the code node should be cancelled/interrupted.\n   */\n  @Event({\n    eventName: 'stencila-code-execute-cancel',\n  })\n  public codeExecuteCancelEvent: EventEmitter<CodeExecuteCancelEvent['detail']>\n\n  private runDocument = (e: MouseEvent) => {\n    if (isPending(this.executeStatus)) {\n      this.codeExecuteCancelEvent.emit({\n        nodeId: null,\n        scope: 'All',\n      })\n    } else {\n      if (this.altIsPressed) {\n        // Restart kernel\n        this.kernelRestart.emit()\n      } else {\n        // Execute document\n        this.codeExecuteEvent.emit({\n          nodeId: null,\n          ordering: e.shiftKey ? 'Appearance' : 'Topological',\n        })\n      }\n    }\n  }\n\n  render(): HTMLElement {\n    return (\n      <Host position={this.position}>\n        <stencila-toolbar>\n          <span slot=\"start\">\n            <stencila-button\n              onKeyDown={this.onKeyPress}\n              color=\"stock\"\n              icon={\n                this.altIsPressed\n                  ? 'restart'\n                  : isPending(this.executeStatus)\n                  ? 'stop'\n                  : 'play'\n              }\n              size=\"small\"\n              onClick={this.runDocument}\n              disabled={!this.isExecutable}\n              dataEl=\"Toolbar/Run Document\"\n              onMouseEnter={this.addKeyListeners}\n              onMouseLeave={this.removeKeyListeners}\n              tooltip={\n                this.altIsPressed\n                  ? undefined\n                  : this.shiftIsPressed\n                  ? 'Run in sequentially, in order of appearance'\n                  : 'Run in topological order'\n              }\n            >\n              {this.altIsPressed\n                ? 'Restart kernels'\n                : isPending(this.executeStatus)\n                ? 'Cancel all'\n                : 'Run all'}\n            </stencila-button>\n          </span>\n\n          {this.sourceUrl !== undefined && (\n            <span slot=\"end\">\n              <stencila-button\n                color=\"stock\"\n                href={this.sourceUrl}\n                target=\"_blank\"\n                rel=\"nofollow noopener\"\n                icon=\"external-link\"\n                size=\"small\"\n                dataEl=\"Toolbar/Project Source\"\n              >\n                Source\n              </stencila-button>\n            </span>\n          )}\n        </stencila-toolbar>\n      </Host>\n    )\n  }\n}\n"],"version":3}